!function(t){var e=window.webpackHotUpdate;window.webpackHotUpdate=function(t,i){!function(t,e){if(v[t]&&b[t]){for(var i in b[t]=!1,e)Object.prototype.hasOwnProperty.call(e,i)&&(p[i]=e[i]);0==--m&&0===w&&E()}}(t,i),e&&e(t,i)};var i,r=!0,s="6a87451ec633004023d8",n=1e4,o={},a=[],h=[];function c(t){var e=_[t];if(!e)return A;var r=function(r){return e.hot.active?(_[r]?-1===_[r].parents.indexOf(t)&&_[r].parents.push(t):(a=[t],i=r),-1===e.children.indexOf(r)&&e.children.push(r)):(console.warn("[HMR] unexpected require("+r+") from disposed module "+t),a=[]),A(r)},s=function(t){return{configurable:!0,enumerable:!0,get:function(){return A[t]},set:function(e){A[t]=e}}};for(var n in A)Object.prototype.hasOwnProperty.call(A,n)&&"e"!==n&&"t"!==n&&Object.defineProperty(r,n,s(n));return r.e=function(t){return"ready"===l&&f("prepare"),w++,A.e(t).then(e,function(t){throw e(),t});function e(){w--,"prepare"===l&&(y[t]||x(t),0===w&&0===m&&E())}},r.t=function(t,e){return 1&e&&(t=r(t)),A.t(t,-2&e)},r}var u=[],l="idle";function f(t){l=t;for(var e=0;e<u.length;e++)u[e].call(null,t)}var d,p,g,m=0,w=0,y={},b={},v={};function k(t){return+t+""===t?+t:t}function S(t){if("idle"!==l)throw new Error("check() is only allowed in idle status");return r=t,f("check"),function(t){return t=t||1e4,new Promise(function(e,i){if("undefined"==typeof XMLHttpRequest)return i(new Error("No browser support"));try{var r=new XMLHttpRequest,n=A.p+""+s+".hot-update.json";r.open("GET",n,!0),r.timeout=t,r.send(null)}catch(t){return i(t)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)i(new Error("Manifest request to "+n+" timed out."));else if(404===r.status)e();else if(200!==r.status&&304!==r.status)i(new Error("Manifest request to "+n+" failed."));else{try{var t=JSON.parse(r.responseText)}catch(t){return void i(t)}e(t)}}})}(n).then(function(t){if(!t)return f("idle"),null;b={},y={},v=t.c,g=t.h,f("prepare");var e=new Promise(function(t,e){d={resolve:t,reject:e}});return p={},x(0),"prepare"===l&&0===w&&0===m&&E(),e})}function x(t){v[t]?(b[t]=!0,m++,function(t){var e=document.getElementsByTagName("head")[0],i=document.createElement("script");i.charset="utf-8",i.src=A.p+""+t+"."+s+".hot-update.js",e.appendChild(i)}(t)):y[t]=!0}function E(){f("ready");var t=d;if(d=null,t)if(r)Promise.resolve().then(function(){return R(r)}).then(function(e){t.resolve(e)},function(e){t.reject(e)});else{var e=[];for(var i in p)Object.prototype.hasOwnProperty.call(p,i)&&e.push(k(i));t.resolve(e)}}function R(e){if("ready"!==l)throw new Error("apply() is only allowed in ready status");var i,r,n,h,c;function u(t){for(var e=[t],i={},r=e.slice().map(function(t){return{chain:[t],id:t}});r.length>0;){var s=r.pop(),n=s.id,o=s.chain;if((h=_[n])&&!h.hot._selfAccepted){if(h.hot._selfDeclined)return{type:"self-declined",chain:o,moduleId:n};if(h.hot._main)return{type:"unaccepted",chain:o,moduleId:n};for(var a=0;a<h.parents.length;a++){var c=h.parents[a],u=_[c];if(u){if(u.hot._declinedDependencies[n])return{type:"declined",chain:o.concat([c]),moduleId:n,parentId:c};-1===e.indexOf(c)&&(u.hot._acceptedDependencies[n]?(i[c]||(i[c]=[]),d(i[c],[n])):(delete i[c],e.push(c),r.push({chain:o.concat([c]),id:c})))}}}}return{type:"accepted",moduleId:t,outdatedModules:e,outdatedDependencies:i}}function d(t,e){for(var i=0;i<e.length;i++){var r=e[i];-1===t.indexOf(r)&&t.push(r)}}e=e||{};var m={},w=[],y={},b=function(){console.warn("[HMR] unexpected require("+x.moduleId+") to disposed module")};for(var S in p)if(Object.prototype.hasOwnProperty.call(p,S)){var x;c=k(S);var E=!1,R=!1,I=!1,O="";switch((x=p[S]?u(c):{type:"disposed",moduleId:S}).chain&&(O="\nUpdate propagation: "+x.chain.join(" -> ")),x.type){case"self-declined":e.onDeclined&&e.onDeclined(x),e.ignoreDeclined||(E=new Error("Aborted because of self decline: "+x.moduleId+O));break;case"declined":e.onDeclined&&e.onDeclined(x),e.ignoreDeclined||(E=new Error("Aborted because of declined dependency: "+x.moduleId+" in "+x.parentId+O));break;case"unaccepted":e.onUnaccepted&&e.onUnaccepted(x),e.ignoreUnaccepted||(E=new Error("Aborted because "+c+" is not accepted"+O));break;case"accepted":e.onAccepted&&e.onAccepted(x),R=!0;break;case"disposed":e.onDisposed&&e.onDisposed(x),I=!0;break;default:throw new Error("Unexception type "+x.type)}if(E)return f("abort"),Promise.reject(E);if(R)for(c in y[c]=p[c],d(w,x.outdatedModules),x.outdatedDependencies)Object.prototype.hasOwnProperty.call(x.outdatedDependencies,c)&&(m[c]||(m[c]=[]),d(m[c],x.outdatedDependencies[c]));I&&(d(w,[x.moduleId]),y[c]=b)}var C,P=[];for(r=0;r<w.length;r++)c=w[r],_[c]&&_[c].hot._selfAccepted&&P.push({module:c,errorHandler:_[c].hot._selfAccepted});f("dispose"),Object.keys(v).forEach(function(t){!1===v[t]&&function(t){delete installedChunks[t]}(t)});for(var B,T,N=w.slice();N.length>0;)if(c=N.pop(),h=_[c]){var M={},U=h.hot._disposeHandlers;for(n=0;n<U.length;n++)(i=U[n])(M);for(o[c]=M,h.hot.active=!1,delete _[c],delete m[c],n=0;n<h.children.length;n++){var H=_[h.children[n]];H&&(C=H.parents.indexOf(c))>=0&&H.parents.splice(C,1)}}for(c in m)if(Object.prototype.hasOwnProperty.call(m,c)&&(h=_[c]))for(T=m[c],n=0;n<T.length;n++)B=T[n],(C=h.children.indexOf(B))>=0&&h.children.splice(C,1);for(c in f("apply"),s=g,y)Object.prototype.hasOwnProperty.call(y,c)&&(t[c]=y[c]);var L=null;for(c in m)if(Object.prototype.hasOwnProperty.call(m,c)&&(h=_[c])){T=m[c];var D=[];for(r=0;r<T.length;r++)if(B=T[r],i=h.hot._acceptedDependencies[B]){if(-1!==D.indexOf(i))continue;D.push(i)}for(r=0;r<D.length;r++){i=D[r];try{i(T)}catch(t){e.onErrored&&e.onErrored({type:"accept-errored",moduleId:c,dependencyId:T[r],error:t}),e.ignoreErrored||L||(L=t)}}}for(r=0;r<P.length;r++){var F=P[r];c=F.module,a=[c];try{A(c)}catch(t){if("function"==typeof F.errorHandler)try{F.errorHandler(t)}catch(i){e.onErrored&&e.onErrored({type:"self-accept-error-handler-errored",moduleId:c,error:i,originalError:t}),e.ignoreErrored||L||(L=i),L||(L=t)}else e.onErrored&&e.onErrored({type:"self-accept-errored",moduleId:c,error:t}),e.ignoreErrored||L||(L=t)}}return L?(f("fail"),Promise.reject(L)):(f("idle"),new Promise(function(t){t(w)}))}var _={};function A(e){if(_[e])return _[e].exports;var r=_[e]={i:e,l:!1,exports:{},hot:function(t){var e={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:i!==t,active:!0,accept:function(t,i){if(void 0===t)e._selfAccepted=!0;else if("function"==typeof t)e._selfAccepted=t;else if("object"==typeof t)for(var r=0;r<t.length;r++)e._acceptedDependencies[t[r]]=i||function(){};else e._acceptedDependencies[t]=i||function(){}},decline:function(t){if(void 0===t)e._selfDeclined=!0;else if("object"==typeof t)for(var i=0;i<t.length;i++)e._declinedDependencies[t[i]]=!0;else e._declinedDependencies[t]=!0},dispose:function(t){e._disposeHandlers.push(t)},addDisposeHandler:function(t){e._disposeHandlers.push(t)},removeDisposeHandler:function(t){var i=e._disposeHandlers.indexOf(t);i>=0&&e._disposeHandlers.splice(i,1)},check:S,apply:R,status:function(t){if(!t)return l;u.push(t)},addStatusHandler:function(t){u.push(t)},removeStatusHandler:function(t){var e=u.indexOf(t);e>=0&&u.splice(e,1)},data:o[t]};return i=void 0,e}(e),parents:(h=a,a=[],h),children:[]};return t[e].call(r.exports,r,r.exports,c(e)),r.l=!0,r.exports}A.m=t,A.c=_,A.d=function(t,e,i){A.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},A.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},A.t=function(t,e){if(1&e&&(t=A(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(A.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)A.d(i,r,function(e){return t[e]}.bind(null,r));return i},A.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return A.d(e,"a",e),e},A.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},A.p="",A.h=function(){return s},c(462)(A.s=462)}([function(t,e,i){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=i(219),s=i(220),n=i(126);function o(){return h.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return h.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=h.prototype:(null===t&&(t=new h(e)),t.length=e),t}function h(t,e,i){if(!(h.TYPED_ARRAY_SUPPORT||this instanceof h))return new h(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return c(this,t,e,i)}function c(t,e,i,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,r){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===i&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,i):new Uint8Array(e,i,r),h.TYPED_ARRAY_SUPPORT?(t=e).__proto__=h.prototype:t=f(t,e),t}(t,e,i,r):"string"==typeof e?function(t,e,i){if("string"==typeof i&&""!==i||(i="utf8"),!h.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,i),s=(t=a(t,r)).write(e,i);return s!==r&&(t=t.slice(0,s)),t}(t,e,i):function(t,e){if(h.isBuffer(e)){var i=0|d(e.length);return 0===(t=a(t,i)).length?t:(e.copy(t,0,0,i),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?a(t,0):f(t,e);if("Buffer"===e.type&&n(e.data))return f(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(u(e),t=a(t,e<0?0:0|d(e)),!h.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function f(t,e){var i=e.length<0?0:0|d(e.length);t=a(t,i);for(var r=0;r<i;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(h.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return F(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return z(t).length;default:if(r)return F(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function m(t,e,i,r,s){if(0===t.length)return-1;if("string"==typeof i?(r=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=s?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(s)return-1;i=t.length-1}else if(i<0){if(!s)return-1;i=0}if("string"==typeof e&&(e=h.from(e,r)),h.isBuffer(e))return 0===e.length?-1:w(t,e,i,r,s);if("number"==typeof e)return e&=255,h.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):w(t,[e],i,r,s);throw new TypeError("val must be string, number or Buffer")}function w(t,e,i,r,s){var n,o=1,a=t.length,h=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,a/=2,h/=2,i/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(s){var u=-1;for(n=i;n<a;n++)if(c(t,n)===c(e,-1===u?0:n-u)){if(-1===u&&(u=n),n-u+1===h)return u*o}else-1!==u&&(n-=n-u),u=-1}else for(i+h>a&&(i=a-h),n=i;n>=0;n--){for(var l=!0,f=0;f<h;f++)if(c(t,n+f)!==c(e,f)){l=!1;break}if(l)return n}return-1}function y(t,e,i,r){i=Number(i)||0;var s=t.length-i;r?(r=Number(r))>s&&(r=s):r=s;var n=e.length;if(n%2!=0)throw new TypeError("Invalid hex string");r>n/2&&(r=n/2);for(var o=0;o<r;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[i+o]=a}return o}function b(t,e,i,r){return V(F(e,t.length-i),t,i,r)}function v(t,e,i,r){return V(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,r)}function k(t,e,i,r){return v(t,e,i,r)}function S(t,e,i,r){return V(z(e),t,i,r)}function x(t,e,i,r){return V(function(t,e){for(var i,r,s,n=[],o=0;o<t.length&&!((e-=2)<0);++o)r=(i=t.charCodeAt(o))>>8,s=i%256,n.push(s),n.push(r);return n}(e,t.length-i),t,i,r)}function E(t,e,i){return 0===e&&i===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,i))}function R(t,e,i){i=Math.min(t.length,i);for(var r=[],s=e;s<i;){var n,o,a,h,c=t[s],u=null,l=c>239?4:c>223?3:c>191?2:1;if(s+l<=i)switch(l){case 1:c<128&&(u=c);break;case 2:128==(192&(n=t[s+1]))&&(h=(31&c)<<6|63&n)>127&&(u=h);break;case 3:n=t[s+1],o=t[s+2],128==(192&n)&&128==(192&o)&&(h=(15&c)<<12|(63&n)<<6|63&o)>2047&&(h<55296||h>57343)&&(u=h);break;case 4:n=t[s+1],o=t[s+2],a=t[s+3],128==(192&n)&&128==(192&o)&&128==(192&a)&&(h=(15&c)<<18|(63&n)<<12|(63&o)<<6|63&a)>65535&&h<1114112&&(u=h)}null===u?(u=65533,l=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),s+=l}return function(t){var e=t.length;if(e<=_)return String.fromCharCode.apply(String,t);for(var i="",r=0;r<e;)i+=String.fromCharCode.apply(String,t.slice(r,r+=_));return i}(r)}e.Buffer=h,e.SlowBuffer=function(t){return+t!=t&&(t=0),h.alloc(+t)},e.INSPECT_MAX_BYTES=50,h.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),h.poolSize=8192,h._augment=function(t){return t.__proto__=h.prototype,t},h.from=function(t,e,i){return c(null,t,e,i)},h.TYPED_ARRAY_SUPPORT&&(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0})),h.alloc=function(t,e,i){return function(t,e,i,r){return u(e),e<=0?a(t,e):void 0!==i?"string"==typeof r?a(t,e).fill(i,r):a(t,e).fill(i):a(t,e)}(null,t,e,i)},h.allocUnsafe=function(t){return l(null,t)},h.allocUnsafeSlow=function(t){return l(null,t)},h.isBuffer=function(t){return!(null==t||!t._isBuffer)},h.compare=function(t,e){if(!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,r=e.length,s=0,n=Math.min(i,r);s<n;++s)if(t[s]!==e[s]){i=t[s],r=e[s];break}return i<r?-1:r<i?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var r=h.allocUnsafe(e),s=0;for(i=0;i<t.length;++i){var o=t[i];if(!h.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,s),s+=o.length}return r},h.byteLength=p,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},h.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},h.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},h.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?R(this,0,t):function(t,e,i){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,i);case"utf8":case"utf-8":return R(this,e,i);case"ascii":return A(this,e,i);case"latin1":case"binary":return I(this,e,i);case"base64":return E(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,i);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},h.prototype.compare=function(t,e,i,r,s){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===r&&(r=0),void 0===s&&(s=this.length),e<0||i>t.length||r<0||s>this.length)throw new RangeError("out of range index");if(r>=s&&e>=i)return 0;if(r>=s)return-1;if(e>=i)return 1;if(e>>>=0,i>>>=0,r>>>=0,s>>>=0,this===t)return 0;for(var n=s-r,o=i-e,a=Math.min(n,o),c=this.slice(r,s),u=t.slice(e,i),l=0;l<a;++l)if(c[l]!==u[l]){n=c[l],o=u[l];break}return n<o?-1:o<n?1:0},h.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},h.prototype.indexOf=function(t,e,i){return m(this,t,e,i,!0)},h.prototype.lastIndexOf=function(t,e,i){return m(this,t,e,i,!1)},h.prototype.write=function(t,e,i,r){if(void 0===e)r="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)r=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===r&&(r="utf8")):(r=i,i=void 0)}var s=this.length-e;if((void 0===i||i>s)&&(i=s),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var n=!1;;)switch(r){case"hex":return y(this,t,e,i);case"utf8":case"utf-8":return b(this,t,e,i);case"ascii":return v(this,t,e,i);case"latin1":case"binary":return k(this,t,e,i);case"base64":return S(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,i);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),n=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _=4096;function A(t,e,i){var r="";i=Math.min(t.length,i);for(var s=e;s<i;++s)r+=String.fromCharCode(127&t[s]);return r}function I(t,e,i){var r="";i=Math.min(t.length,i);for(var s=e;s<i;++s)r+=String.fromCharCode(t[s]);return r}function O(t,e,i){var r=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>r)&&(i=r);for(var s="",n=e;n<i;++n)s+=D(t[n]);return s}function C(t,e,i){for(var r=t.slice(e,i),s="",n=0;n<r.length;n+=2)s+=String.fromCharCode(r[n]+256*r[n+1]);return s}function P(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function B(t,e,i,r,s,n){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>s||e<n)throw new RangeError('"value" argument is out of bounds');if(i+r>t.length)throw new RangeError("Index out of range")}function T(t,e,i,r){e<0&&(e=65535+e+1);for(var s=0,n=Math.min(t.length-i,2);s<n;++s)t[i+s]=(e&255<<8*(r?s:1-s))>>>8*(r?s:1-s)}function N(t,e,i,r){e<0&&(e=4294967295+e+1);for(var s=0,n=Math.min(t.length-i,4);s<n;++s)t[i+s]=e>>>8*(r?s:3-s)&255}function M(t,e,i,r,s,n){if(i+r>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function U(t,e,i,r,n){return n||M(t,0,i,4),s.write(t,e,i,r,23,4),i+4}function H(t,e,i,r,n){return n||M(t,0,i,8),s.write(t,e,i,r,52,8),i+8}h.prototype.slice=function(t,e){var i,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),h.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=h.prototype;else{var s=e-t;i=new h(s,void 0);for(var n=0;n<s;++n)i[n]=this[n+t]}return i},h.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var r=this[t],s=1,n=0;++n<e&&(s*=256);)r+=this[t+n]*s;return r},h.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var r=this[t+--e],s=1;e>0&&(s*=256);)r+=this[t+--e]*s;return r},h.prototype.readUInt8=function(t,e){return e||P(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return e||P(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return e||P(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return e||P(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return e||P(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var r=this[t],s=1,n=0;++n<e&&(s*=256);)r+=this[t+n]*s;return r>=(s*=128)&&(r-=Math.pow(2,8*e)),r},h.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var r=e,s=1,n=this[t+--r];r>0&&(s*=256);)n+=this[t+--r]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*e)),n},h.prototype.readInt8=function(t,e){return e||P(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){e||P(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt16BE=function(t,e){e||P(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt32LE=function(t,e){return e||P(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return e||P(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return e||P(t,4,this.length),s.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return e||P(t,4,this.length),s.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return e||P(t,8,this.length),s.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return e||P(t,8,this.length),s.read(this,t,!1,52,8)},h.prototype.writeUIntLE=function(t,e,i,r){t=+t,e|=0,i|=0,r||B(this,t,e,i,Math.pow(2,8*i)-1,0);var s=1,n=0;for(this[e]=255&t;++n<i&&(s*=256);)this[e+n]=t/s&255;return e+i},h.prototype.writeUIntBE=function(t,e,i,r){t=+t,e|=0,i|=0,r||B(this,t,e,i,Math.pow(2,8*i)-1,0);var s=i-1,n=1;for(this[e+s]=255&t;--s>=0&&(n*=256);)this[e+s]=t/n&255;return e+i},h.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||B(this,t,e,1,255,0),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},h.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||B(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):T(this,t,e,!0),e+2},h.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||B(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):T(this,t,e,!1),e+2},h.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||B(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):N(this,t,e,!0),e+4},h.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||B(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},h.prototype.writeIntLE=function(t,e,i,r){if(t=+t,e|=0,!r){var s=Math.pow(2,8*i-1);B(this,t,e,i,s-1,-s)}var n=0,o=1,a=0;for(this[e]=255&t;++n<i&&(o*=256);)t<0&&0===a&&0!==this[e+n-1]&&(a=1),this[e+n]=(t/o>>0)-a&255;return e+i},h.prototype.writeIntBE=function(t,e,i,r){if(t=+t,e|=0,!r){var s=Math.pow(2,8*i-1);B(this,t,e,i,s-1,-s)}var n=i-1,o=1,a=0;for(this[e+n]=255&t;--n>=0&&(o*=256);)t<0&&0===a&&0!==this[e+n+1]&&(a=1),this[e+n]=(t/o>>0)-a&255;return e+i},h.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||B(this,t,e,1,127,-128),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||B(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):T(this,t,e,!0),e+2},h.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||B(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):T(this,t,e,!1),e+2},h.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||B(this,t,e,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):N(this,t,e,!0),e+4},h.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},h.prototype.writeFloatLE=function(t,e,i){return U(this,t,e,!0,i)},h.prototype.writeFloatBE=function(t,e,i){return U(this,t,e,!1,i)},h.prototype.writeDoubleLE=function(t,e,i){return H(this,t,e,!0,i)},h.prototype.writeDoubleBE=function(t,e,i){return H(this,t,e,!1,i)},h.prototype.copy=function(t,e,i,r){if(i||(i=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<i&&(r=i),r===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-i&&(r=t.length-e+i);var s,n=r-i;if(this===t&&i<e&&e<r)for(s=n-1;s>=0;--s)t[s+e]=this[s+i];else if(n<1e3||!h.TYPED_ARRAY_SUPPORT)for(s=0;s<n;++s)t[s+e]=this[s+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+n),e);return n},h.prototype.fill=function(t,e,i,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),1===t.length){var s=t.charCodeAt(0);s<256&&(t=s)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!h.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var n;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(n=e;n<i;++n)this[n]=t;else{var o=h.isBuffer(t)?t:F(new h(t,r).toString()),a=o.length;for(n=0;n<i-e;++n)this[n+e]=o[n%a]}return this};var L=/[^+\/0-9A-Za-z-_]/g;function D(t){return t<16?"0"+t.toString(16):t.toString(16)}function F(t,e){var i;e=e||1/0;for(var r=t.length,s=null,n=[],o=0;o<r;++o){if((i=t.charCodeAt(o))>55295&&i<57344){if(!s){if(i>56319){(e-=3)>-1&&n.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&n.push(239,191,189);continue}s=i;continue}if(i<56320){(e-=3)>-1&&n.push(239,191,189),s=i;continue}i=65536+(s-55296<<10|i-56320)}else s&&(e-=3)>-1&&n.push(239,191,189);if(s=null,i<128){if((e-=1)<0)break;n.push(i)}else if(i<2048){if((e-=2)<0)break;n.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;n.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;n.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return n}function z(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(L,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,i,r){for(var s=0;s<r&&!(s+i>=e.length||s>=t.length);++s)e[s+i]=t[s];return s}}).call(this,i(12))},function(t,e,i){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function r(t,e){if(t===e)return 0;for(var i=t.length,r=e.length,s=0,n=Math.min(i,r);s<n;++s)if(t[s]!==e[s]){i=t[s],r=e[s];break}return i<r?-1:r<i?1:0}function s(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var n=i(66),o=Object.prototype.hasOwnProperty,a=Array.prototype.slice,h="foo"===function(){}.name;function c(t){return Object.prototype.toString.call(t)}function u(t){return!s(t)&&"function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}var l=t.exports=w,f=/\s*function\s+([^\(\s]*)\s*/;function d(t){if(n.isFunction(t)){if(h)return t.name;var e=t.toString().match(f);return e&&e[1]}}function p(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function g(t){if(h||!n.isFunction(t))return n.inspect(t);var e=d(t);return"[Function"+(e?": "+e:"")+"]"}function m(t,e,i,r,s){throw new l.AssertionError({message:i,actual:t,expected:e,operator:r,stackStartFunction:s})}function w(t,e){t||m(t,!0,e,"==",l.ok)}function y(t,e,i,o){if(t===e)return!0;if(s(t)&&s(e))return 0===r(t,e);if(n.isDate(t)&&n.isDate(e))return t.getTime()===e.getTime();if(n.isRegExp(t)&&n.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(u(t)&&u(e)&&c(t)===c(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===r(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(s(t)!==s(e))return!1;var h=(o=o||{actual:[],expected:[]}).actual.indexOf(t);return-1!==h&&h===o.expected.indexOf(e)||(o.actual.push(t),o.expected.push(e),function(t,e,i,r){if(null===t||void 0===t||null===e||void 0===e)return!1;if(n.isPrimitive(t)||n.isPrimitive(e))return t===e;if(i&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var s=b(t),o=b(e);if(s&&!o||!s&&o)return!1;if(s)return y(t=a.call(t),e=a.call(e),i);var h,c,u=S(t),l=S(e);if(u.length!==l.length)return!1;for(u.sort(),l.sort(),c=u.length-1;c>=0;c--)if(u[c]!==l[c])return!1;for(c=u.length-1;c>=0;c--)if(!y(t[h=u[c]],e[h],i,r))return!1;return!0}(t,e,i,o))}return i?t===e:t==e}function b(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function v(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function k(t,e,i,r){var s;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof i&&(r=i,i=null),s=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(i&&i.name?" ("+i.name+").":".")+(r?" "+r:"."),t&&!s&&m(s,i,"Missing expected exception"+r);var o="string"==typeof r,a=!t&&n.isError(s),h=!t&&s&&!i;if((a&&o&&v(s,i)||h)&&m(s,i,"Got unwanted exception"+r),t&&s&&i&&!v(s,i)||!t&&s)throw s}l.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return p(g(t.actual),128)+" "+t.operator+" "+p(g(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||m;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var i=new Error;if(i.stack){var r=i.stack,s=d(e),n=r.indexOf("\n"+s);if(n>=0){var o=r.indexOf("\n",n+1);r=r.substring(o+1)}this.stack=r}}},n.inherits(l.AssertionError,Error),l.fail=m,l.ok=w,l.equal=function(t,e,i){t!=e&&m(t,e,i,"==",l.equal)},l.notEqual=function(t,e,i){t==e&&m(t,e,i,"!=",l.notEqual)},l.deepEqual=function(t,e,i){y(t,e,!1)||m(t,e,i,"deepEqual",l.deepEqual)},l.deepStrictEqual=function(t,e,i){y(t,e,!0)||m(t,e,i,"deepStrictEqual",l.deepStrictEqual)},l.notDeepEqual=function(t,e,i){y(t,e,!1)&&m(t,e,i,"notDeepEqual",l.notDeepEqual)},l.notDeepStrictEqual=function t(e,i,r){y(e,i,!0)&&m(e,i,r,"notDeepStrictEqual",t)},l.strictEqual=function(t,e,i){t!==e&&m(t,e,i,"===",l.strictEqual)},l.notStrictEqual=function(t,e,i){t===e&&m(t,e,i,"!==",l.notStrictEqual)},l.throws=function(t,e,i){k(!0,t,e,i)},l.doesNotThrow=function(t,e,i){k(!1,t,e,i)},l.ifError=function(t){if(t)throw t};var S=Object.keys||function(t){var e=[];for(var i in t)o.call(t,i)&&e.push(i);return e}}).call(this,i(12))},function(t,e,i){"use strict";(function(e){
/*!
 * reader.js - buffer reader for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(4),n=i(9),o=e.alloc(0);function a(t,i){if(!(this instanceof a))return new a(t,i);r(e.isBuffer(t),"Must pass a Buffer."),this.data=t,this.offset=0,this.zeroCopy=i||!1,this.stack=[]}a.prototype.assert=function t(e){if(!e)throw new s.EncodingError(this.offset,"Out of bounds read",t)},a.prototype.enforce=function t(e,i){if(!e)throw new s.EncodingError(this.offset,i,t)},a.prototype.getSize=function(){return this.data.length},a.prototype.left=function(){return this.assert(this.offset<=this.data.length),this.data.length-this.offset},a.prototype.seek=function(t){return this.assert(this.offset+t>=0),this.assert(this.offset+t<=this.data.length),this.offset+=t,t},a.prototype.start=function(){return this.stack.push(this.offset),this.offset},a.prototype.end=function(){r(this.stack.length>0);const t=this.stack.pop();return this.offset-t},a.prototype.endData=function(t){r(this.stack.length>0);const i=this.stack.pop(),s=this.offset,n=s-i,o=this.data;if(n===o.length)return o;if(this.zeroCopy||t)return o.slice(i,s);const a=e.allocUnsafe(n);return o.copy(a,0,i,s),a},a.prototype.destroy=function(){this.data=o,this.offset=0,this.stack.length=0},a.prototype.readU8=function(){this.assert(this.offset+1<=this.data.length);const t=this.data[this.offset];return this.offset+=1,t},a.prototype.readU16=function(){this.assert(this.offset+2<=this.data.length);const t=this.data.readUInt16LE(this.offset,!0);return this.offset+=2,t},a.prototype.readU16BE=function(){this.assert(this.offset+2<=this.data.length);const t=this.data.readUInt16BE(this.offset,!0);return this.offset+=2,t},a.prototype.readU32=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readUInt32LE(this.offset,!0);return this.offset+=4,t},a.prototype.readU32BE=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readUInt32BE(this.offset,!0);return this.offset+=4,t},a.prototype.readU64=function(){this.assert(this.offset+8<=this.data.length);const t=s.readU64(this.data,this.offset);return this.offset+=8,t},a.prototype.readU64BE=function(){this.assert(this.offset+8<=this.data.length);const t=s.readU64BE(this.data,this.offset);return this.offset+=8,t},a.prototype.readI8=function(){this.assert(this.offset+1<=this.data.length);const t=this.data.readInt8(this.offset,!0);return this.offset+=1,t},a.prototype.readI16=function(){this.assert(this.offset+2<=this.data.length);const t=this.data.readInt16LE(this.offset,!0);return this.offset+=2,t},a.prototype.readI16BE=function(){this.assert(this.offset+2<=this.data.length);const t=this.data.readInt16BE(this.offset,!0);return this.offset+=2,t},a.prototype.readI32=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readInt32LE(this.offset,!0);return this.offset+=4,t},a.prototype.readI32BE=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readInt32BE(this.offset,!0);return this.offset+=4,t},a.prototype.readI64=function(){this.assert(this.offset+8<=this.data.length);const t=s.readI64(this.data,this.offset);return this.offset+=8,t},a.prototype.readI64BE=function(){this.assert(this.offset+8<=this.data.length);const t=s.readI64BE(this.data,this.offset);return this.offset+=8,t},a.prototype.readU64N=function(){this.assert(this.offset+8<=this.data.length);const t=s.readU64N(this.data,this.offset);return this.offset+=8,t},a.prototype.readU64BEN=function(){this.assert(this.offset+8<=this.data.length);const t=s.readU64BEN(this.data,this.offset);return this.offset+=8,t},a.prototype.readI64N=function(){this.assert(this.offset+8<=this.data.length);const t=s.readI64N(this.data,this.offset);return this.offset+=8,t},a.prototype.readI64BEN=function(){this.assert(this.offset+8<=this.data.length);const t=s.readI64BEN(this.data,this.offset);return this.offset+=8,t},a.prototype.readFloat=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readFloatLE(this.offset,!0);return this.offset+=4,t},a.prototype.readFloatBE=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readFloatBE(this.offset,!0);return this.offset+=4,t},a.prototype.readDouble=function(){this.assert(this.offset+8<=this.data.length);const t=this.data.readDoubleLE(this.offset,!0);return this.offset+=8,t},a.prototype.readDoubleBE=function(){this.assert(this.offset+8<=this.data.length);const t=this.data.readDoubleBE(this.offset,!0);return this.offset+=8,t},a.prototype.readVarint=function(){const{size:t,value:e}=s.readVarint(this.data,this.offset);return this.offset+=t,e},a.prototype.readVarintN=function(){const{size:t,value:e}=s.readVarintN(this.data,this.offset);return this.offset+=t,e},a.prototype.readVarint2=function(){const{size:t,value:e}=s.readVarint2(this.data,this.offset);return this.offset+=t,e},a.prototype.readVarint2N=function(){const{size:t,value:e}=s.readVarint2N(this.data,this.offset);return this.offset+=t,e},a.prototype.readBytes=function(t,i){let s;return r(t>=0),this.assert(this.offset+t<=this.data.length),this.zeroCopy||i?s=this.data.slice(this.offset,this.offset+t):(s=e.allocUnsafe(t),this.data.copy(s,0,this.offset,this.offset+t)),this.offset+=t,s},a.prototype.readVarBytes=function(t){return this.readBytes(this.readVarint(),t)},a.prototype.readString=function(t,e){r(e>=0),this.assert(this.offset+e<=this.data.length);const i=this.data.toString(t,this.offset,this.offset+e);return this.offset+=e,i},a.prototype.readHash=function(t){return t?this.readString(t,32):this.readBytes(32)},a.prototype.readVarString=function(t,e){const i=this.readVarint();return this.enforce(!e||i<=e,"String exceeds limit."),this.readString(t,i)},a.prototype.readNullString=function(t){this.assert(this.offset+1<=this.data.length);let e=this.offset;for(;e<this.data.length&&0!==this.data[e];e++);this.assert(e!==this.data.length);const i=this.readString(t,e-this.offset);return this.offset=e+1,i},a.prototype.createChecksum=function(){let t=0;this.stack.length>0&&(t=this.stack[this.stack.length-1]);const e=this.data.slice(t,this.offset);return n.hash256(e).readUInt32LE(0,!0)},a.prototype.verifyChecksum=function(){const t=this.createChecksum(),e=this.readU32();return this.enforce(t===e,"Checksum mismatch."),e},t.exports=a}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t,r){
/*!
 * util.js - utils for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const s=i(1),n=i(66),o=e,a={showHidden:!1,depth:20,colors:!1,customInspect:!0,showProxy:!1,maxArrayLength:1/0,breakLength:60};function h(t,e){for(var i=[];e>0;i[--e]=t);return i.join("")}function c(t){switch(t){case 0:return 1;case 1:return 10;case 2:return 100;case 3:return 1e3;case 4:return 1e4;case 5:return 1e5;case 6:return 1e6;case 7:return 1e7;case 8:return 1e8}throw new Error("Exponent is too large.")}o.sprintf=function(){for(var t,e,i,r,s,n=0,o=arguments[n++],a=[];o;){if(e=/^[^\x25]+/.exec(o))a.push(e[0]);else if(e=/^\x25{2}/.exec(o))a.push("%");else{if(!(e=/^\x25(?:(\d+)\$)?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(o)))throw"Huh ?!";if(null==(t=arguments[e[1]||n++])||void 0==t)throw"Too few arguments.";if(/[^s]/.test(e[7])&&"number"!=typeof t)throw"Expecting number but found "+typeof t;switch(e[7]){case"b":t=t.toString(2);break;case"c":t=String.fromCharCode(t);break;case"d":t=parseInt(t);break;case"e":t=e[6]?t.toExponential(e[6]):t.toExponential();break;case"f":t=e[6]?parseFloat(t).toFixed(e[6]):parseFloat(t);break;case"o":t=t.toString(8);break;case"s":t=(t=String(t))&&e[6]?t.substring(0,e[6]):t;break;case"u":t=Math.abs(t);break;case"x":t=t.toString(16);break;case"X":t=t.toString(16).toUpperCase()}t=/[def]/.test(e[7])&&e[2]&&t>=0?"+"+t:t,r=e[3]?"0"==e[3]?"0":e[3].charAt(1):" ",s=e[5]-String(t).length-"".length,i=e[5]?h(r,s):"",a.push(""+(e[4]?t+i:i+t))}o=o.substring(e[0].length)}return a.join("")},o.isNumber=function(t){return"number"==typeof t&&isFinite(t)&&t>=-Number.MAX_SAFE_INTEGER&&t<=Number.MAX_SAFE_INTEGER},o.waiting=async function(t){await async function(){return new Promise((e,i)=>{setTimeout(()=>{e()},t)})}()},o.isInt=function(t){return Number.isSafeInteger(t)},o.isUint=function(t){return o.isInt(t)&&t>=0},o.isFloat=function(t){return"number"==typeof t&&isFinite(t)},o.isUfloat=function(t){return o.isFloat(t)&&t>=0},o.isI8=function(t){return(0|t)===t&&t>=-128&&t<=127},o.isI16=function(t){return(0|t)===t&&t>=-32768&&t<=32767},o.stringify=function(t,e){let i="";return Object.keys(t).sort().map(r=>{e&&e[r]||(i+=r+t[r])}),i},o.parseJson=function(t,e){try{return JSON.parse(t)}catch(t){return e||(e=null),e}},o.hashInt=function(t){return i(230).str(t)>>>0},o.makeSingleton=function(t){t.singleton=function(){let e;return function(){return e||(e=new t(...arguments))}}()},o.isI32=function(t){return(0|t)===t},o.isI64=function(t){return o.isInt(t)},o.isU8=function(t){return(255&t)===t},o.isU16=function(t){return(65535&t)===t},o.isU32=function(t){return t>>>0===t},o.isU64=function(t){return o.isUint(t)},o.isAscii=function(t){return"string"==typeof t&&/^[\t\n\r -~]*$/.test(t)},o.isBase58=function(t){return"string"==typeof t&&/^[1-9A-Za-z]+$/.test(t)},o.isBech32=function(t){return"string"==typeof t&&(t.toUpperCase()===t||t.toLowerCase()===t)&&!(t.length<8||t.length>90)&&/^[a-z]{2}1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]+$/i.test(t)},o.isHex=function(t){return"string"==typeof t&&t.length%2==0&&/^[0-9A-Fa-f]+$/.test(t)},o.isHex160=function(t){return"string"==typeof t&&40===t.length&&o.isHex(t)},o.isHex256=function(t){return"string"==typeof t&&64===t.length&&o.isHex(t)},o.isSafeAddition=function(t,e){if(s(t>=0),s(e>=0),t<=0xfffffffffffff&&e<=0xfffffffffffff)return!0;let i=t*(1/4294967296)|0;const r=0|t;let n=e*(1/4294967296)|0;const o=0|e,a=r>>31,h=o>>31;let c=(i+n|0)+(1&(a&h|~((r+o|0)>>31)&(a^h)))|0;return n>>>=0,!((c>>>=0)<(i>>>=0)||c<n)&&0==(4292870144&c)},o.inspectify=function(t,e){return"string"==typeof t?t:(a.colors=!1!==e,n.inspect(t,a))},o.fmt=n.format,o.format=function(e,i){return e.length>0&&e[0]&&"object"==typeof e[0]?(null==i&&(i=Boolean(t.stdout&&t.stdout.isTTY)),o.inspectify(e[0],i)):o.fmt(...e)},o.log=function(...e){if(!t.stdout){let t;return e.length>0&&(t="object"!=typeof e[0]?o.fmt(...e):e[0]),void console.log(t)}const i=o.format(e);t.stdout.write(i+"\n")},o.error=function(...e){if(!t.stderr){let t;return e.length>0&&(t="object"!=typeof e[0]?o.fmt(...e):e[0]),void console.error(t)}const i=o.format(e);t.stderr.write(i+"\n")},o.hrtime=function(e){if(!t.hrtime){const t=o.ms();if(e){const[i,r]=e;return t-(1e3*i+r/1e6)}const i=t%1e3;return[(t-i)/1e3,1e6*i]}if(e){const[i,r]=t.hrtime(e);return 1e3*i+r/1e6}return t.hrtime()},o.now=function(){return Math.floor(o.ms()/1e3)},o.ms=function(){return Date.now()},o.date=function(t){return null==t&&(t=o.now()),new Date(1e3*t).toISOString().slice(0,-5)+"Z"},o.dataOfUTC=function(t){return("number"!=typeof t||t>14||t<-12)&&(t=(new Date).getTimezoneOffset()/60*-1),new Date(Date.now()+36e5*t).toISOString().slice(0,-5)+(t>=0?` +${t}`:` ${t}`)},o.time=function(t){return null==t?o.now():new Date(t)/1e3|0},o.random=function(t,e){return Math.floor(Math.random()*(e-t))+t},o.nonce=function(t){let e,i;switch(t||(t=8),t){case 8:i=r.allocUnsafe(8),e=o.random(0,4294967296),i.writeUInt32LE(e,0,!0),e=o.random(0,4294967296),i.writeUInt32LE(e,4,!0);break;case 4:i=r.allocUnsafe(4),e=o.random(0,4294967296),i.writeUInt32LE(e,0,!0);break;default:s(!1,"Bad nonce size.")}return i},o.strcmp=function(t,e){const i=Math.min(t.length,e.length);for(let r=0;r<i;r++){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1}return t.length<e.length?-1:t.length>e.length?1:0},o.mb=function(t){return Math.floor(t/1024/1024)},o.indexOf=function(t,e){s(Array.isArray(t)),s(r.isBuffer(e));for(let i=0;i<t.length;i++){const n=t[i];if(s(r.isBuffer(n)),n.equals(e))return i}return-1},o.pad8=function(t){switch(s("number"==typeof t),s(t>=0),(t=t.toString(10)).length){case 1:return"00"+t;case 2:return"0"+t;case 3:return t}throw new Error("Number too big.")},o.pad32=function(t){switch(s("number"==typeof t),s(t>=0),(t=t.toString(10)).length){case 1:return"000000000"+t;case 2:return"00000000"+t;case 3:return"0000000"+t;case 4:return"000000"+t;case 5:return"00000"+t;case 6:return"0000"+t;case 7:return"000"+t;case 8:return"00"+t;case 9:return"0"+t;case 10:return t}throw new Error("Number too big.")},o.hex8=function(t){switch(s("number"==typeof t),s(t>=0),(t=t.toString(16)).length){case 1:return"0"+t;case 2:return t}throw new Error("Number too big.")},o.hex32=function(t){switch(s("number"==typeof t),s(t>=0),(t=t.toString(16)).length){case 1:return"0000000"+t;case 2:return"000000"+t;case 3:return"00000"+t;case 4:return"0000"+t;case 5:return"000"+t;case 6:return"00"+t;case 7:return"0"+t;case 8:return t}throw new Error("Number too big.")},o.revHex=function(t){s("string"==typeof t),s(t.length>0),s(t.length%2==0);let e="";for(let i=0;i<t.length;i+=2)e=t.slice(i,i+2)+e;return e},o.reverse=function(t){const e={};for(const i of Object.keys(t))e[t[i]]=i;return e},o.binarySearch=function(t,e,i,r){let s=0,n=t.length-1;for(;s<=n;){const r=s+n>>>1,o=i(t[r],e);if(0===o)return r;o<0?s=r+1:n=r-1}return r?s:-1},o.binaryInsert=function(t,e,i,r){const s=o.binarySearch(t,e,i,!0);return r&&s<t.length&&0===i(t[s],e)?-1:(0===s?t.unshift(e):s===t.length?t.push(e):t.splice(s,0,e),s)},o.binaryRemove=function(t,e,i){const r=o.binarySearch(t,e,i,!1);return-1!==r&&(t.splice(r,1),!0)},o.isUpperCase=function(t){return s("string"==typeof t),0!==t.length&&0==(32&t.charCodeAt(0))},o.startsWith=function(t,e){return s("string"==typeof t),t.startsWith?t.startsWith(e):0===t.indexOf(e)},o.memoryUsage=function(){if(!t.memoryUsage)return{total:0,jsHeap:0,jsHeapTotal:0,nativeHeap:0,external:0};const e=t.memoryUsage();return{total:o.mb(e.rss),jsHeap:o.mb(e.heapUsed),jsHeapTotal:o.mb(e.heapTotal),nativeHeap:o.mb(e.rss-e.heapTotal),external:o.mb(e.external)}},o.toFixed=function(t,e){s("number"==typeof t),s(Number.isSafeInteger(t),"Invalid integer value.");let i="";t<0&&(t=-t,i="-");const r=c(e);let n=t%r,o=(t-n)/r;for(n=n.toString(10),o=o.toString(10);n.length<e;)n="0"+n;return n=n.replace(/0+$/,""),s(n.length<=e,"Invalid integer value."),0===n.length&&(n="0"),0===e?`${i}${o}`:`${i}${o}.${n}`},o.fromFixed=function(t,e){s("string"==typeof t),s(t.length<=32,"Fixed number string too large.");let i=1;t.length>0&&"-"===t[0]&&(t=t.substring(1),i=-1);let r=t,n="0";const o=t.indexOf(".");for(-1!==o&&(r=t.substring(0,o),n=t.substring(o+1)),r=r.replace(/^0+/,""),n=n.replace(/0+$/,""),s(r.length<=16-e,"Fixed number string exceeds 2^53-1."),s(n.length<=e,"Too many decimal places in fixed number string."),0===r.length&&(r="0");n.length<e;)n+="0";0===n.length&&(n="0"),s(/^\d+$/.test(r)&&/^\d+$/.test(n),"Non-numeric characters in fixed number string."),r=parseInt(r,10),n=parseInt(n,10);const a=c(e),h=function(t){switch(a){case 1:return 0;case 10:return 1;case 100:return 91;case 1e3:case 1e4:return 991;case 1e5:return 40991;case 1e6:return 740991;case 1e7:return 4740991;case 1e8:return 54740991}throw new Error("Exponent is too large.")}(),u=function(t){switch(a){case 1:return 9007199254740991;case 10:return 900719925474099;case 100:return 90071992547409;case 1e3:return 9007199254740;case 1e4:return 900719925474;case 1e5:return 90071992547;case 1e6:return 9007199254;case 1e7:return 900719925;case 1e8:return 90071992}throw new Error("Exponent is too large.")}();return s(r<u||r===u&&n<=h,"Fixed number string exceeds 2^53-1."),i*(r*a+n)},o.toFloat=function(t,e){return Number(o.toFixed(t,e))},o.checkNum=function(t){return/^[1-9]+[0-9]*]*$/.test(t)},o.fromFloat=function(t,e){return s("number"==typeof t&&isFinite(t)),s(Number.isSafeInteger(e)),o.fromFixed(t.toFixed(e),e)}}).call(this,i(23),i(0).Buffer)},function(t,e,i){"use strict";(function(t){
/*!
 * encoding.js - encoding utils for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const{U64:r,I64:s}=i(87),n=r.UINT64_MAX.shrn(7),o=Number.MAX_SAFE_INTEGER,a=e;function h(t,e){return t<0&&(t=~t,0===e&&(t+=1)),0==(4292870144&t)}function c(t,e,i,r){let s=!1;e<0&&(e=-e,s=!0);let n=e*(1/4294967296)|0,o=0|e;return s&&(0===o?n=1+~n|0:(n=~n,o=1+~o)),r?(i=t.writeInt32BE(n,i,!0),i=t.writeInt32BE(o,i,!0)):(i=t.writeInt32LE(o,i,!0),i=t.writeInt32LE(n,i,!0)),i}function u(t,e){this.size=t,this.value=e}function l(t,e){if(!t)throw new a.EncodingError(e,"Out of bounds read",l)}function f(t,e,i){if(!t)throw new a.EncodingError(e,i,f)}a.DUMMY=t.from([0]),a.ONE_HASH=t.from("0100000000000000000000000000000000000000000000000000000000000000","hex"),a.DefaultChainCode=t.from("1111111111111111111111111111111111111111111111111111111111111111","hex"),a.ZERO_HASH=t.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),a.MAX_HASH=t.from("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff","hex"),a.ZERO_CID="000000000000000000000000000000000000000000000000000000000000000000000000",a.MAX_CID="ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",a.ZERO_OID="000000000000000000000000000000000000",a.MAX_OID="zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz",a.NULL_HASH="0000000000000000000000000000000000000000000000000000000000000000",a.HIGH_HASH="ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",a.ZERO_HASH160=t.from("0000000000000000000000000000000000000000","hex"),a.MAX_HASH160=t.from("ffffffffffffffffffffffffffffffffffffffff","hex"),a.NULL_HASH160="0000000000000000000000000000000000000000",a.HIGH_HASH160="ffffffffffffffffffffffffffffffffffffffff",a.ZERO_KEY=t.from("000000000000000000000000000000000000000000000000000000000000000000","hex"),a.ZERO_SIG=t.from("00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","hex"),a.ZERO_SIG64=t.from("00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","hex"),a.ZERO_U32=t.from("00000000","hex"),a.ZERO_U64=t.from("0000000000000000","hex"),a.readU64=function(t,e){const i=t.readUInt32LE(e+4,!0),r=t.readUInt32LE(e,!0);return f(0==(4292870144&i),e,"Number exceeds 2^53-1"),4294967296*i+r},a.readU64BE=function(t,e){const i=t.readUInt32BE(e,!0),r=t.readUInt32BE(e+4,!0);return f(0==(4292870144&i),e,"Number exceeds 2^53-1"),4294967296*i+r},a.readI64=function(t,e){const i=t.readInt32LE(e+4,!0),r=t.readUInt32LE(e,!0);return f(h(i,r),"Number exceeds 2^53-1"),4294967296*i+r},a.readI64BE=function(t,e){const i=t.readInt32BE(e,!0),r=t.readUInt32BE(e+4,!0);return f(h(i,r),"Number exceeds 2^53-1"),4294967296*i+r},a.writeU64=function(t,e,i){return c(t,e,i,!1)},a.writeU64BE=function(t,e,i){return c(t,e,i,!0)},a.writeI64=function(t,e,i){return c(t,e,i,!1)},a.writeI64BE=function(t,e,i){return c(t,e,i,!0)},a.readU64N=function(t,e){return r.readLE(t,e)},a.readU64BEN=function(t,e){return r.readBE(t,e)},a.readI64N=function(t,e){return s.readLE(t,e)},a.readI64BEN=function(t,e){return s.readBE(t,e)},a.writeU64N=function(t,e,i){return f(!e.sign,i,"Signed"),e.writeLE(t,i)},a.writeU64BEN=function(t,e,i){return f(!e.sign,i,"Signed"),e.writeBE(t,i)},a.writeI64N=function(t,e,i){return f(e.sign,i,"Not signed"),e.writeLE(t,i)},a.writeI64BEN=function(t,e,i){return f(e.sign,i,"Not signed"),e.writeBE(t,i)},a.readVarint=function(t,e){let i,r;switch(l(e<t.length,e),t[e]){case 255:l(e+(r=9)<=t.length,e),f((i=a.readU64(t,e+1))>4294967295,e,"Non-canonical varint");break;case 254:l(e+(r=5)<=t.length,e),f((i=t.readUInt32LE(e+1,!0))>65535,e,"Non-canonical varint");break;case 253:l(e+(r=3)<=t.length,e),f((i=t[e+1]|t[e+2]<<8)>=253,e,"Non-canonical varint");break;default:r=1,i=t[e]}return new u(r,i)},a.writeVarint=function(t,e,i){return e<253?(t[i++]=255&e,i):e<=65535?(t[i++]=253,t[i++]=255&e,t[i++]=e>>8&255,i):e<=4294967295?(t[i++]=254,t[i++]=255&e,t[i++]=e>>8&255,t[i++]=e>>16&255,t[i++]=e>>>24,i):(t[i++]=255,i=a.writeU64(t,e,i))},a.sizeVarint=function(t){return t<253?1:t<=65535?3:t<=4294967295?5:9},a.readVarintN=function(t,e){if(l(e<t.length,e),255===t[e]){const i=9;l(e+i<=t.length,e);const r=a.readU64N(t,e+1);return f(0!==r.hi,e,"Non-canonical varint"),new u(i,r)}const{size:i,value:s}=a.readVarint(t,e);return new u(i,r.fromInt(s))},a.writeVarintN=function(t,e,i){return f(!e.sign,i,"Signed"),0!==e.hi?(t[i++]=255,a.writeU64N(t,e,i)):a.writeVarint(t,e.toInt(),i)},a.sizeVarintN=function(t){return f(!t.sign,0,"Signed"),0!==t.hi?9:a.sizeVarint(t.toInt())},a.readVarint2=function(t,e){let i=0,r=0;for(;;){l(e<t.length,e);const s=t[e++];if(r++,f(i<=70368744177663-(127&s),e,"Number exceeds 2^53-1"),i=128*i+(127&s),0==(128&s))break;f(i!==o,e,"Number exceeds 2^53-1"),i++}return new u(r,i)},a.writeVarint2=function(t,e,i){const r=[];let s=0;for(;r[s]=127&e|(s?128:0),!(e<=127);)e=(e-e%128)/128-1,s++;l(i+s+1<=t.length,i);do{t[i++]=r[s]}while(s--);return i},a.sizeVarint2=function(t){let e=0;for(;e++,!(t<=127);)t=(t-t%128)/128-1;return e},a.readVarint2N=function(t,e){const i=new r;let s=0;for(;;){l(e<t.length,e);const o=t[e++];if(s++,f(i.lte(n),e,"Number exceeds 2^64-1"),i.ishln(7).iorn(127&o),0==(128&o))break;f(!i.eq(r.UINT64_MAX),e,"Number exceeds 2^64-1"),i.iaddn(1)}return new u(s,i)},a.writeVarint2N=function(t,e,i){if(f(!e.sign,i,"Signed"),0===e.hi)return a.writeVarint2(t,e.toInt(),i);e=e.clone();const r=[];let s=0;for(;r[s]=e.andln(127)|(s?128:0),!e.lten(127);)e.ishrn(7).isubn(1),s++;f(i+s+1<=t.length,i,"Out of bounds write");do{t[i++]=r[s]}while(s--);return i},a.sizeVarint2N=function(t){if(f(!t.sign,0,"Signed"),0===t.hi)return a.sizeVarint2(t.toInt());t=t.clone();let e=0;for(;e++,!t.lten(127);)t.ishrn(7).isubn(1);return e},a.U8=function(e){const i=t.allocUnsafe(1);return i[0]=e>>>0,i},a.U32=function(e){const i=t.allocUnsafe(4);return i.writeUInt32LE(e,0,!0),i},a.U32BE=function(e){const i=t.allocUnsafe(4);return i.writeUInt32BE(e,0,!0),i},a.sizeVarBytes=function(t){return a.sizeVarint(t.length)+t.length},a.sizeVarlen=function(t){return a.sizeVarint(t)+t},a.sizeVarString=function(e,i){if("string"!=typeof e)return a.sizeVarBytes(e);const r=t.byteLength(e,i);return a.sizeVarint(r)+r},a.EncodingError=function t(e,i,r){if(!(this instanceof t))return new t(e,i,r);Error.call(this),this.type="EncodingError",this.message=`${i} (offset=${e}).`,Error.captureStackTrace&&Error.captureStackTrace(this,r||t)},Object.setPrototypeOf(a.EncodingError.prototype,Error.prototype)}).call(this,i(0).Buffer)},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e,i){"use strict";(function(e){
/*!
 * staticwriter.js - buffer writer for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(4),n=i(9),o=e.alloc(0);let a=null;function h(t){if(!(this instanceof h))return new h(t);this.data=t?e.allocUnsafe(t):o,this.offset=0}h.pool=function(t){if(t<=102400){a||(a=e.allocUnsafeSlow(102400));const i=new h(0);return i.data=a.slice(0,t),i}return new h(t)},h.prototype.render=function(t=!0){const e=this.data;return t&&r(this.offset===e.length),this.destroy(),e},h.prototype.getSize=function(){return this.offset},h.prototype.seek=function(t){this.offset+=t},h.prototype.destroy=function(){this.data=o,this.offset=0},h.prototype.writeU8=function(t){t>>>=0,this.offset=this.data.writeUInt8(t,this.offset,!0)},h.prototype.writeU16=function(t){t>>>=0,this.offset=this.data.writeUInt16LE(t,this.offset,!0)},h.prototype.writeU16BE=function(t){t>>>=0,this.offset=this.data.writeUInt16BE(t,this.offset,!0)},h.prototype.writeU32=function(t){t>>>=0,this.offset=this.data.writeUInt32LE(t,this.offset,!0)},h.prototype.writeU32BE=function(t){t>>>=0,this.offset=this.data.writeUInt32BE(t,this.offset,!0)},h.prototype.writeU64=function(t){this.offset=s.writeU64(this.data,t,this.offset)},h.prototype.writeU64BE=function(t){this.offset=s.writeU64BE(this.data,t,this.offset)},h.prototype.writeU64N=function(t){this.offset=s.writeU64N(this.data,t,this.offset)},h.prototype.writeU64BEN=function(t){this.offset=s.writeU64BEN(this.data,t,this.offset)},h.prototype.writeI8=function(t){this.offset=this.data.writeInt8(t,this.offset,!0)},h.prototype.writeI16=function(t){this.offset=this.data.writeInt16LE(t,this.offset,!0)},h.prototype.writeI16BE=function(t){this.offset=this.data.writeInt16BE(t,this.offset,!0)},h.prototype.writeI32=function(t){this.offset=this.data.writeInt32LE(t,this.offset,!0)},h.prototype.writeI32BE=function(t){this.offset=this.data.writeInt32BE(t,this.offset,!0)},h.prototype.writeI64=function(t){this.offset=s.writeI64(this.data,t,this.offset)},h.prototype.writeI64BE=function(t){this.offset=s.writeI64BE(this.data,t,this.offset)},h.prototype.writeI64N=function(t){this.offset=s.writeI64N(this.data,t,this.offset)},h.prototype.writeI64BEN=function(t){this.offset=s.writeI64BEN(this.data,t,this.offset)},h.prototype.writeFloat=function(t){this.offset=this.data.writeFloatLE(t,this.offset,!0)},h.prototype.writeFloatBE=function(t){this.offset=this.data.writeFloatBE(t,this.offset,!0)},h.prototype.writeDouble=function(t){this.offset=this.data.writeDoubleLE(t,this.offset,!0)},h.prototype.writeDoubleBE=function(t){this.offset=this.data.writeDoubleBE(t,this.offset,!0)},h.prototype.writeVarint=function(t){this.offset=s.writeVarint(this.data,t,this.offset)},h.prototype.writeVarintN=function(t){this.offset=s.writeVarintN(this.data,t,this.offset)},h.prototype.writeVarint2=function(t){this.offset=s.writeVarint2(this.data,t,this.offset)},h.prototype.writeVarint2N=function(t){this.offset=s.writeVarint2N(this.data,t,this.offset)},h.prototype.writeBytes=function(t){0!==t.length&&(t.copy(this.data,this.offset),this.offset+=t.length)},h.prototype.writeVarBytes=function(t){this.writeVarint(t.length),this.writeBytes(t)},h.prototype.copy=function(t,e,i){const r=i-e;0!==r&&(t.copy(this.data,this.offset,e,i),this.offset+=r)},h.prototype.writeString=function(t,i){if(0===t.length)return;const r=e.byteLength(t,i);this.data.write(t,this.offset,i),this.offset+=r},h.prototype.writeHash=function(t){if("string"!=typeof t)return r(32===t.length),void this.writeBytes(t);r(64===t.length),this.data.write(t,this.offset,"hex"),this.offset+=32},h.prototype.writeVarString=function(t,i){if(0===t.length)return void this.writeVarint(0);const r=e.byteLength(t,i);this.writeVarint(r),this.data.write(t,this.offset,i),this.offset+=r},h.prototype.writeNullString=function(t,e){this.writeString(t,e),this.writeU8(0)},h.prototype.writeChecksum=function(){const t=this.data.slice(0,this.offset);n.hash256(t).copy(this.data,this.offset,0,4),this.offset+=4},h.prototype.fill=function(t,e){r(e>=0),0!==e&&(this.data.fill(t,this.offset,this.offset+e),this.offset+=e)},t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){var r=i(0),s=r.Buffer;function n(t,e){for(var i in t)e[i]=t[i]}function o(t,e,i){return s(t,e,i)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?t.exports=r:(n(r,e),e.Buffer=o),n(s,o),o.from=function(t,e,i){if("number"==typeof t)throw new TypeError("Argument must not be a number");return s(t,e,i)},o.alloc=function(t,e,i){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=s(t);return void 0!==e?"string"==typeof i?r.fill(e,i):r.fill(e):r.fill(0),r},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return s(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,i){(function(t){const i={propSale:"sale",coinbase:"coinbase",notify:"notify",payOrder:"pay",cpRegister:"cpRegister",cpChange:"cpChange",contractCreate:"contractCreate",contractExecute:"contractExecute"},r=Object.keys(i).reduce((t,e)=>(t[e]=i[e],t),{propCreate:"new",propExchange:"exchange",propFound:"found",contractPromise:"contractPromise"});class s{constructor(t,e,i,s,n,o){this.oper=r.payOrder,this.cid=t,this.uid=e,this.sn=i,this.sum=s,this.addr=n,this.gaddr=o}static fromRaw(t){try{let e=JSON.parse(t.toString());return new s(e.cid,e.uid,e.sn,e.sum,e.addr,e.gaddr)}catch(t){}return null}toRaw(){return t.from(JSON.stringify({cid:this.cid,oper:this.oper,sn:this.sn,uid:this.uid,sum:this.sum,addr:this.addr,gaddr:this.gaddr}))}toExtend(){return t.from(JSON.stringify({cid:this.cid,hash:this.hash,height:this.height,oper:this.oper,sn:this.sn,uid:this.uid,sum:this.sum,addr:this.addr,gaddr:this.gaddr}))}static fromExtend(t){try{let e=JSON.parse(t.toString()),i=new s(e.cid,e.uid,e.sn,e.sum,e.addr,e.gaddr);return i.height=e.height||-1,i.hash=e.hash||null,i}catch(t){}return null}}e.OrderData=s,e.NotifyMsg=class{constructor(t,e,i,r){this.oper=t,this.sn=e,this.h=i,this.body=r}static fromRaw(t){try{let e=JSON.parse(t.toString());return new s(e.oper,e.sn,e.h,e.body)}catch(t){}return null}toRaw(){return t.from(JSON.stringify({oper:this.oper,sn:this.sn,h:this.h,body:this.body}))}},e.PropInfo=class{constructor(){this.cid="",this.pid="",this.oid="",this.gold=0}},e.contractStatus={None:0,CreatedOnMem:2,Obsolete:3,Promised:4,Expired:5,Confirmed:6,Exchanged:7,Backed:8},e.OperType=r,e.OperTypeExecutable=i,e.operatorType={WalletInit:1,Wallet:2,Mem:3,DbInit:4,Db:5},e.blockFinalType={Final:0,Waiting:1,Expired:2}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t){
/*!
 * digest-browser.js - hash functions for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(75),n=i(229),o=t.allocUnsafe(64);e.hash=function(e,i){if("sha256"===e)return n.digest(i);const o=s[e];return r(null!=o,"Unknown algorithm."),t.from(o().update(i).digest())},e.ripemd160=function(t){return e.hash("ripemd160",t)},e.sha1=function(t){return e.hash("sha1",t)},e.sha256=function(t){return n.digest(t)},e.hash160=function(t){return e.hash("ripemd160",n.digest(t))},e.hash256=function(t){return n.hash256(t)},e.root256=function(t,i){const s=o;return r(32===t.length),r(32===i.length),t.copy(s,0),i.copy(s,32),e.hash256(s)},e.hmac=function(e,i,n){const o=s[e];r(null!=o,"Unknown algorithm.");const a=s.hmac(o,n);return t.from(a.update(i).digest())}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * consensus.js - consensus constants and helpers for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(43);e.GAMEGOLD_HEARTBEAT=600,e.GAMEGOLD_DAY=1209600,e.BLOCK_DAY=144,e.MAX_BLOCK_NUM=3,e.MEDIAN_BLOCK=10,e.GRAM=100,e.COIN=1e8,e.MINPROPVALUE=100*e.GRAM,e.registerFee=1*e.COIN,e.PROP_SALE_PERIOD=3,e.contractConfirmation=1,e.TRANSACTION_PERIOD=2,e.TRANSACTION_THRESHOLD=5e8,e.TRANSACTION_RATE=.03,e.TRANSACTION_FEE=.003,e.epochType={First:{time:8,token:100,value:0},Second:{time:16,token:200,value:10},Third:{time:24,token:300,value:100},fourth:{time:32,token:400,value:1e3},Fifth:{time:40,token:500,value:1e3},Sixth:{time:48,token:600,value:1e3},Seventh:{time:56,token:700,value:1e3},Eighth:{time:64,token:800,value:1e3},Ninth:{time:72,token:900,value:1e3},Tenth:{time:80,token:1e3,value:1e3}},e.getEpoch=function(t){t=t/e.GAMEGOLD_DAY*e.GAMEGOLD_HEARTBEAT|0;for(let i of Object.keys(e.epochType)){let r=e.epochType[i];if(t<r.time)return r}return e.epochType.Tenth},e.getRealValue=function(t,e){return t*Math.pow(e,.5)},e.getRealValues=function(t){let i=0;for(const r of t)r.height<1||106!=r.script.code[0].value&&(i+=e.getRealValue(r.value,r.height));return i},e.MAX_MONEY=21e6*e.COIN,e.ORIGINAL=525e4*e.COIN,e.BASE_REWARD=50*e.COIN,e.HALF_REWARD=Math.floor(e.BASE_REWARD/2),e.MAX_BLOCK_SIZE=1e6,e.MAX_RAW_BLOCK_SIZE=4e6,e.MAX_BLOCK_WEIGHT=4e6,e.MAX_BLOCK_SIGOPS=2e4,e.MAX_BLOCK_SIGOPS_COST=8e4,e.VERSION_TOP_BITS=536870912,e.VERSION_TOP_MASK=3758096384,e.COINBASE_MATURITY=100,e.WITNESS_SCALE_FACTOR=4,e.LOCKTIME_THRESHOLD=5e8,e.SEQUENCE_DISABLE_FLAG=1<<31>>>0,e.SEQUENCE_TYPE_FLAG=1<<22,e.SEQUENCE_GRANULARITY=9,e.SEQUENCE_MASK=65535,e.MAX_SCRIPT_SIZE=1e4,e.MAX_SCRIPT_STACK=1e3,e.MAX_SCRIPT_PUSH=520,e.MAX_SCRIPT_OPS=201,e.MAX_MULTISIG_PUBKEYS=20,e.compact2BN=function(t){if(0===t)return new s(0);const e=t>>>24,i=t>>>23&1;let r,n=8388607&t;return e<=3?r=new s(n>>>=8*(3-e)):(r=new s(n)).iushln(8*(e-3)),i&&r.ineg(),r},e.bn2Compact=function(t){if(t.isZero())return 0;let e,i=t.byteLength();i<=3?(e=t.toNumber(),e<<=8*(3-i)):e=t.ushrn(8*(i-3)).toNumber(),8388608&e&&(e>>=8,i++);let r=i<<24|e;return t.isNeg()&&(r|=8388608),r>>>0},e.verifyPOW=function(t,i){const r=e.compact2BN(i);return!r.isNeg()&&!r.isZero()&&!new s(t,"le").gt(r)},e.getReward=function(t,i){r(t>=0,"Bad height for reward.");const s=Math.floor(t/i);return s>=33?0:0===s?e.BASE_REWARD:e.HALF_REWARD>>>s-1},e.hasBit=function(t,i){return(t&e.VERSION_TOP_MASK)>>>0===e.VERSION_TOP_BITS&&0!=(t&1<<i)}},function(t,e,i){"use strict";
/*!
 * packetTypes.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */t.exports={ENV:0,EVENT:1,LOG:2,ERROR:3,ERRORRESULT:4,CHECK:5,CHECKRESULT:6,SIGN:7,SIGNRESULT:8,CHECKINPUT:9,CHECKINPUTRESULT:10,SIGNINPUT:11,SIGNINPUTRESULT:12,ECVERIFY:13,ECVERIFYRESULT:14,ECSIGN:15,ECSIGNRESULT:16,MINE:17,MINERESULT:18,SCRYPT:19,SCRYPTRESULT:20}},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";(function(e){
/*!
 * writer.js - buffer writer for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(4),n=i(9);function o(){if(!(this instanceof o))return new o;this.ops=[],this.offset=0}function a(t,e,i,r){this.type=t,this.value=e,this.enc=i,this.size=r}o.prototype.render=function(){const t=e.allocUnsafe(this.offset);let i=0;for(const e of this.ops)switch(e.type){case 0:i+=e.value;break;case 1:e.value>>>=0,i=t.writeUInt8(e.value,i,!0);break;case 2:e.value>>>=0,i=t.writeUInt16LE(e.value,i,!0);break;case 3:e.value>>>=0,i=t.writeUInt16BE(e.value,i,!0);break;case 4:e.value>>>=0,i=t.writeUInt32LE(e.value,i,!0);break;case 5:e.value>>>=0,i=t.writeUInt32BE(e.value,i,!0);break;case 6:i=s.writeU64(t,e.value,i);break;case 7:i=s.writeU64BE(t,e.value,i);break;case 8:i=s.writeU64N(t,e.value,i);break;case 9:i=s.writeU64BEN(t,e.value,i);break;case 10:i=t.writeInt8(e.value,i,!0);break;case 11:i=t.writeInt16LE(e.value,i,!0);break;case 12:i=t.writeInt16BE(e.value,i,!0);break;case 13:i=t.writeInt32LE(e.value,i,!0);break;case 14:i=t.writeInt32BE(e.value,i,!0);break;case 15:i=s.writeI64(t,e.value,i);break;case 16:i=s.writeI64BE(t,e.value,i);break;case 17:i=s.writeI64N(t,e.value,i);break;case 18:i=s.writeI64BEN(t,e.value,i);break;case 19:i=t.writeFloatLE(e.value,i,!0);break;case 20:i=t.writeFloatBE(e.value,i,!0);break;case 21:i=t.writeDoubleLE(e.value,i,!0);break;case 22:i=t.writeDoubleBE(e.value,i,!0);break;case 23:i=s.writeVarint(t,e.value,i);break;case 24:i=s.writeVarintN(t,e.value,i);break;case 25:i=s.writeVarint2(t,e.value,i);break;case 26:i=s.writeVarint2N(t,e.value,i);break;case 27:i+=e.value.copy(t,i);break;case 28:i+=t.write(e.value,i,e.enc);break;case 29:i+=n.hash256(t.slice(0,i)).copy(t,i,0,4);break;case 30:t.fill(e.value,i,i+e.size),i+=e.size;break;default:r(!1,"Bad type.")}return r(i===t.length),this.destroy(),t},o.prototype.getSize=function(){return this.offset},o.prototype.seek=function(t){this.offset+=t,this.ops.push(new a(0,t))},o.prototype.destroy=function(){this.ops.length=0,this.offset=0},o.prototype.writeU8=function(t){this.offset+=1,this.ops.push(new a(1,t))},o.prototype.writeU16=function(t){this.offset+=2,this.ops.push(new a(2,t))},o.prototype.writeU16BE=function(t){this.offset+=2,this.ops.push(new a(3,t))},o.prototype.writeU32=function(t){this.offset+=4,this.ops.push(new a(4,t))},o.prototype.writeU32BE=function(t){this.offset+=4,this.ops.push(new a(5,t))},o.prototype.writeU64=function(t){this.offset+=8,this.ops.push(new a(6,t))},o.prototype.writeU64BE=function(t){this.offset+=8,this.ops.push(new a(7,t))},o.prototype.writeU64N=function(t){this.offset+=8,this.ops.push(new a(8,t))},o.prototype.writeU64BEN=function(t){this.offset+=8,this.ops.push(new a(9,t))},o.prototype.writeI8=function(t){this.offset+=1,this.ops.push(new a(10,t))},o.prototype.writeI16=function(t){this.offset+=2,this.ops.push(new a(11,t))},o.prototype.writeI16BE=function(t){this.offset+=2,this.ops.push(new a(12,t))},o.prototype.writeI32=function(t){this.offset+=4,this.ops.push(new a(13,t))},o.prototype.writeI32BE=function(t){this.offset+=4,this.ops.push(new a(14,t))},o.prototype.writeI64=function(t){this.offset+=8,this.ops.push(new a(15,t))},o.prototype.writeI64BE=function(t){this.offset+=8,this.ops.push(new a(16,t))},o.prototype.writeI64N=function(t){this.offset+=8,this.ops.push(new a(17,t))},o.prototype.writeI64BEN=function(t){this.offset+=8,this.ops.push(new a(18,t))},o.prototype.writeFloat=function(t){this.offset+=4,this.ops.push(new a(19,t))},o.prototype.writeFloatBE=function(t){this.offset+=4,this.ops.push(new a(20,t))},o.prototype.writeDouble=function(t){this.offset+=8,this.ops.push(new a(21,t))},o.prototype.writeDoubleBE=function(t){this.offset+=8,this.ops.push(new a(22,t))},o.prototype.writeVarint=function(t){this.offset+=s.sizeVarint(t),this.ops.push(new a(23,t))},o.prototype.writeVarintN=function(t){this.offset+=s.sizeVarintN(t),this.ops.push(new a(24,t))},o.prototype.writeVarint2=function(t){this.offset+=s.sizeVarint2(t),this.ops.push(new a(25,t))},o.prototype.writeVarint2N=function(t){this.offset+=s.sizeVarint2N(t),this.ops.push(new a(26,t))},o.prototype.writeBytes=function(t){0!==t.length&&(this.offset+=t.length,this.ops.push(new a(27,t)))},o.prototype.writeVarBytes=function(t){this.offset+=s.sizeVarint(t.length),this.ops.push(new a(23,t.length)),0!==t.length&&(this.offset+=t.length,this.ops.push(new a(27,t)))},o.prototype.copy=function(t,e,i){r(i>=e),t=t.slice(e,i),this.writeBytes(t)},o.prototype.writeString=function(t,i){0!==t.length&&(this.offset+=e.byteLength(t,i),this.ops.push(new a(28,t,i)))},o.prototype.writeHash=function(t){if("string"!=typeof t)return r(32===t.length),void this.writeBytes(t);r(64===t.length),this.writeString(t,"hex")},o.prototype.writeVarString=function(t,i){if(0===t.length)return void this.ops.push(new a(23,0));const r=e.byteLength(t,i);this.offset+=s.sizeVarint(r),this.offset+=r,this.ops.push(new a(23,r)),this.ops.push(new a(28,t,i))},o.prototype.writeNullString=function(t,e){this.writeString(t,e),this.writeU8(0)},o.prototype.writeChecksum=function(){this.offset+=4,this.ops.push(new a(29))},o.prototype.fill=function(t,e){r(e>=0),0!==e&&(this.offset+=e,this.ops.push(new a(30,t,null,e)))},t.exports=o}).call(this,i(0).Buffer)},function(t,e,i){(function(t){!function(t,e){"use strict";function r(t,e){if(!t)throw new Error(e||"Assertion failed")}function s(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}function n(t,e,i){if(n.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(i=e,e=10),this._init(t||0,e||10,i||"be"))}var o;"object"==typeof t?t.exports=n:e.BN=n,n.BN=n,n.wordSize=26;try{o=i(231).Buffer}catch(t){}function a(t,e,i){for(var r=0,s=Math.min(t.length,i),n=e;n<s;n++){var o=t.charCodeAt(n)-48;r<<=4,r|=o>=49&&o<=54?o-49+10:o>=17&&o<=22?o-17+10:15&o}return r}function h(t,e,i,r){for(var s=0,n=Math.min(t.length,i),o=e;o<n;o++){var a=t.charCodeAt(o)-48;s*=r,s+=a>=49?a-49+10:a>=17?a-17+10:a}return s}n.isBN=function(t){return t instanceof n||null!==t&&"object"==typeof t&&t.constructor.wordSize===n.wordSize&&Array.isArray(t.words)},n.max=function(t,e){return t.cmp(e)>0?t:e},n.min=function(t,e){return t.cmp(e)<0?t:e},n.prototype._init=function(t,e,i){if("number"==typeof t)return this._initNumber(t,e,i);if("object"==typeof t)return this._initArray(t,e,i);"hex"===e&&(e=16),r(e===(0|e)&&e>=2&&e<=36);var s=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&s++,16===e?this._parseHex(t,s):this._parseBase(t,e,s),"-"===t[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),e,i)},n.prototype._initNumber=function(t,e,i){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(r(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),e,i)},n.prototype._initArray=function(t,e,i){if(r("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var s=0;s<this.length;s++)this.words[s]=0;var n,o,a=0;if("be"===i)for(s=t.length-1,n=0;s>=0;s-=3)o=t[s]|t[s-1]<<8|t[s-2]<<16,this.words[n]|=o<<a&67108863,this.words[n+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,n++);else if("le"===i)for(s=0,n=0;s<t.length;s+=3)o=t[s]|t[s+1]<<8|t[s+2]<<16,this.words[n]|=o<<a&67108863,this.words[n+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,n++);return this.strip()},n.prototype._parseHex=function(t,e){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var r,s,n=0;for(i=t.length-6,r=0;i>=e;i-=6)s=a(t,i,i+6),this.words[r]|=s<<n&67108863,this.words[r+1]|=s>>>26-n&4194303,(n+=24)>=26&&(n-=26,r++);i+6!==e&&(s=a(t,e,i+6),this.words[r]|=s<<n&67108863,this.words[r+1]|=s>>>26-n&4194303),this.strip()},n.prototype._parseBase=function(t,e,i){this.words=[0],this.length=1;for(var r=0,s=1;s<=67108863;s*=e)r++;r--,s=s/e|0;for(var n=t.length-i,o=n%r,a=Math.min(n,n-o)+i,c=0,u=i;u<a;u+=r)c=h(t,u,u+r,e),this.imuln(s),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==o){var l=1;for(c=h(t,u,t.length,e),u=0;u<o;u++)l*=e;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}},n.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},n.prototype.clone=function(){var t=new n(null);return this.copy(t),t},n.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var c=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],l=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function f(t,e,i){i.negative=e.negative^t.negative;var r=t.length+e.length|0;i.length=r,r=r-1|0;var s=0|t.words[0],n=0|e.words[0],o=s*n,a=67108863&o,h=o/67108864|0;i.words[0]=a;for(var c=1;c<r;c++){for(var u=h>>>26,l=67108863&h,f=Math.min(c,e.length-1),d=Math.max(0,c-t.length+1);d<=f;d++){var p=c-d|0;u+=(o=(s=0|t.words[p])*(n=0|e.words[d])+l)/67108864|0,l=67108863&o}i.words[c]=0|l,h=0|u}return 0!==h?i.words[c]=0|h:i.length--,i.strip()}n.prototype.toString=function(t,e){var i;if(t=t||10,e=0|e||1,16===t||"hex"===t){i="";for(var s=0,n=0,o=0;o<this.length;o++){var a=this.words[o],h=(16777215&(a<<s|n)).toString(16);i=0!=(n=a>>>24-s&16777215)||o!==this.length-1?c[6-h.length]+h+i:h+i,(s+=2)>=26&&(s-=26,o--)}for(0!==n&&(i=n.toString(16)+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(t===(0|t)&&t>=2&&t<=36){var f=u[t],d=l[t];i="";var p=this.clone();for(p.negative=0;!p.isZero();){var g=p.modn(d).toString(t);i=(p=p.idivn(d)).isZero()?g+i:c[f-g.length]+g+i}for(this.isZero()&&(i="0"+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(t,e){return r(void 0!==o),this.toArrayLike(o,t,e)},n.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)},n.prototype.toArrayLike=function(t,e,i){var s=this.byteLength(),n=i||Math.max(1,s);r(s<=n,"byte array longer than desired length"),r(n>0,"Requested array length <= 0"),this.strip();var o,a,h="le"===e,c=new t(n),u=this.clone();if(h){for(a=0;!u.isZero();a++)o=u.andln(255),u.iushrn(8),c[a]=o;for(;a<n;a++)c[a]=0}else{for(a=0;a<n-s;a++)c[a]=0;for(a=0;!u.isZero();a++)o=u.andln(255),u.iushrn(8),c[n-a-1]=o}return c},Math.clz32?n.prototype._countBits=function(t){return 32-Math.clz32(t)}:n.prototype._countBits=function(t){var e=t,i=0;return e>=4096&&(i+=13,e>>>=13),e>=64&&(i+=7,e>>>=7),e>=8&&(i+=4,e>>>=4),e>=2&&(i+=2,e>>>=2),i+e},n.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,i=0;return 0==(8191&e)&&(i+=13,e>>>=13),0==(127&e)&&(i+=7,e>>>=7),0==(15&e)&&(i+=4,e>>>=4),0==(3&e)&&(i+=2,e>>>=2),0==(1&e)&&i++,i},n.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var i=this._zeroBits(this.words[e]);if(t+=i,26!==i)break}return t},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},n.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this.strip()},n.prototype.ior=function(t){return r(0==(this.negative|t.negative)),this.iuor(t)},n.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},n.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},n.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var i=0;i<e.length;i++)this.words[i]=this.words[i]&t.words[i];return this.length=e.length,this.strip()},n.prototype.iand=function(t){return r(0==(this.negative|t.negative)),this.iuand(t)},n.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},n.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},n.prototype.iuxor=function(t){var e,i;this.length>t.length?(e=this,i=t):(e=t,i=this);for(var r=0;r<i.length;r++)this.words[r]=e.words[r]^i.words[r];if(this!==e)for(;r<e.length;r++)this.words[r]=e.words[r];return this.length=e.length,this.strip()},n.prototype.ixor=function(t){return r(0==(this.negative|t.negative)),this.iuxor(t)},n.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},n.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},n.prototype.inotn=function(t){r("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),i=t%26;this._expand(e),i>0&&e--;for(var s=0;s<e;s++)this.words[s]=67108863&~this.words[s];return i>0&&(this.words[s]=~this.words[s]&67108863>>26-i),this.strip()},n.prototype.notn=function(t){return this.clone().inotn(t)},n.prototype.setn=function(t,e){r("number"==typeof t&&t>=0);var i=t/26|0,s=t%26;return this._expand(i+1),this.words[i]=e?this.words[i]|1<<s:this.words[i]&~(1<<s),this.strip()},n.prototype.iadd=function(t){var e,i,r;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(i=this,r=t):(i=t,r=this);for(var s=0,n=0;n<r.length;n++)e=(0|i.words[n])+(0|r.words[n])+s,this.words[n]=67108863&e,s=e>>>26;for(;0!==s&&n<i.length;n++)e=(0|i.words[n])+s,this.words[n]=67108863&e,s=e>>>26;if(this.length=i.length,0!==s)this.words[this.length]=s,this.length++;else if(i!==this)for(;n<i.length;n++)this.words[n]=i.words[n];return this},n.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},n.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var i,r,s=this.cmp(t);if(0===s)return this.negative=0,this.length=1,this.words[0]=0,this;s>0?(i=this,r=t):(i=t,r=this);for(var n=0,o=0;o<r.length;o++)n=(e=(0|i.words[o])-(0|r.words[o])+n)>>26,this.words[o]=67108863&e;for(;0!==n&&o<i.length;o++)n=(e=(0|i.words[o])+n)>>26,this.words[o]=67108863&e;if(0===n&&o<i.length&&i!==this)for(;o<i.length;o++)this.words[o]=i.words[o];return this.length=Math.max(this.length,o),i!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(t){return this.clone().isub(t)};var d=function(t,e,i){var r,s,n,o=t.words,a=e.words,h=i.words,c=0,u=0|o[0],l=8191&u,f=u>>>13,d=0|o[1],p=8191&d,g=d>>>13,m=0|o[2],w=8191&m,y=m>>>13,b=0|o[3],v=8191&b,k=b>>>13,S=0|o[4],x=8191&S,E=S>>>13,R=0|o[5],_=8191&R,A=R>>>13,I=0|o[6],O=8191&I,C=I>>>13,P=0|o[7],B=8191&P,T=P>>>13,N=0|o[8],M=8191&N,U=N>>>13,H=0|o[9],L=8191&H,D=H>>>13,F=0|a[0],z=8191&F,V=F>>>13,j=0|a[1],K=8191&j,q=j>>>13,W=0|a[2],X=8191&W,Y=W>>>13,G=0|a[3],$=8191&G,J=G>>>13,Z=0|a[4],Q=8191&Z,tt=Z>>>13,et=0|a[5],it=8191&et,rt=et>>>13,st=0|a[6],nt=8191&st,ot=st>>>13,at=0|a[7],ht=8191&at,ct=at>>>13,ut=0|a[8],lt=8191&ut,ft=ut>>>13,dt=0|a[9],pt=8191&dt,gt=dt>>>13;i.negative=t.negative^e.negative,i.length=19;var mt=(c+(r=Math.imul(l,z))|0)+((8191&(s=(s=Math.imul(l,V))+Math.imul(f,z)|0))<<13)|0;c=((n=Math.imul(f,V))+(s>>>13)|0)+(mt>>>26)|0,mt&=67108863,r=Math.imul(p,z),s=(s=Math.imul(p,V))+Math.imul(g,z)|0,n=Math.imul(g,V);var wt=(c+(r=r+Math.imul(l,K)|0)|0)+((8191&(s=(s=s+Math.imul(l,q)|0)+Math.imul(f,K)|0))<<13)|0;c=((n=n+Math.imul(f,q)|0)+(s>>>13)|0)+(wt>>>26)|0,wt&=67108863,r=Math.imul(w,z),s=(s=Math.imul(w,V))+Math.imul(y,z)|0,n=Math.imul(y,V),r=r+Math.imul(p,K)|0,s=(s=s+Math.imul(p,q)|0)+Math.imul(g,K)|0,n=n+Math.imul(g,q)|0;var yt=(c+(r=r+Math.imul(l,X)|0)|0)+((8191&(s=(s=s+Math.imul(l,Y)|0)+Math.imul(f,X)|0))<<13)|0;c=((n=n+Math.imul(f,Y)|0)+(s>>>13)|0)+(yt>>>26)|0,yt&=67108863,r=Math.imul(v,z),s=(s=Math.imul(v,V))+Math.imul(k,z)|0,n=Math.imul(k,V),r=r+Math.imul(w,K)|0,s=(s=s+Math.imul(w,q)|0)+Math.imul(y,K)|0,n=n+Math.imul(y,q)|0,r=r+Math.imul(p,X)|0,s=(s=s+Math.imul(p,Y)|0)+Math.imul(g,X)|0,n=n+Math.imul(g,Y)|0;var bt=(c+(r=r+Math.imul(l,$)|0)|0)+((8191&(s=(s=s+Math.imul(l,J)|0)+Math.imul(f,$)|0))<<13)|0;c=((n=n+Math.imul(f,J)|0)+(s>>>13)|0)+(bt>>>26)|0,bt&=67108863,r=Math.imul(x,z),s=(s=Math.imul(x,V))+Math.imul(E,z)|0,n=Math.imul(E,V),r=r+Math.imul(v,K)|0,s=(s=s+Math.imul(v,q)|0)+Math.imul(k,K)|0,n=n+Math.imul(k,q)|0,r=r+Math.imul(w,X)|0,s=(s=s+Math.imul(w,Y)|0)+Math.imul(y,X)|0,n=n+Math.imul(y,Y)|0,r=r+Math.imul(p,$)|0,s=(s=s+Math.imul(p,J)|0)+Math.imul(g,$)|0,n=n+Math.imul(g,J)|0;var vt=(c+(r=r+Math.imul(l,Q)|0)|0)+((8191&(s=(s=s+Math.imul(l,tt)|0)+Math.imul(f,Q)|0))<<13)|0;c=((n=n+Math.imul(f,tt)|0)+(s>>>13)|0)+(vt>>>26)|0,vt&=67108863,r=Math.imul(_,z),s=(s=Math.imul(_,V))+Math.imul(A,z)|0,n=Math.imul(A,V),r=r+Math.imul(x,K)|0,s=(s=s+Math.imul(x,q)|0)+Math.imul(E,K)|0,n=n+Math.imul(E,q)|0,r=r+Math.imul(v,X)|0,s=(s=s+Math.imul(v,Y)|0)+Math.imul(k,X)|0,n=n+Math.imul(k,Y)|0,r=r+Math.imul(w,$)|0,s=(s=s+Math.imul(w,J)|0)+Math.imul(y,$)|0,n=n+Math.imul(y,J)|0,r=r+Math.imul(p,Q)|0,s=(s=s+Math.imul(p,tt)|0)+Math.imul(g,Q)|0,n=n+Math.imul(g,tt)|0;var kt=(c+(r=r+Math.imul(l,it)|0)|0)+((8191&(s=(s=s+Math.imul(l,rt)|0)+Math.imul(f,it)|0))<<13)|0;c=((n=n+Math.imul(f,rt)|0)+(s>>>13)|0)+(kt>>>26)|0,kt&=67108863,r=Math.imul(O,z),s=(s=Math.imul(O,V))+Math.imul(C,z)|0,n=Math.imul(C,V),r=r+Math.imul(_,K)|0,s=(s=s+Math.imul(_,q)|0)+Math.imul(A,K)|0,n=n+Math.imul(A,q)|0,r=r+Math.imul(x,X)|0,s=(s=s+Math.imul(x,Y)|0)+Math.imul(E,X)|0,n=n+Math.imul(E,Y)|0,r=r+Math.imul(v,$)|0,s=(s=s+Math.imul(v,J)|0)+Math.imul(k,$)|0,n=n+Math.imul(k,J)|0,r=r+Math.imul(w,Q)|0,s=(s=s+Math.imul(w,tt)|0)+Math.imul(y,Q)|0,n=n+Math.imul(y,tt)|0,r=r+Math.imul(p,it)|0,s=(s=s+Math.imul(p,rt)|0)+Math.imul(g,it)|0,n=n+Math.imul(g,rt)|0;var St=(c+(r=r+Math.imul(l,nt)|0)|0)+((8191&(s=(s=s+Math.imul(l,ot)|0)+Math.imul(f,nt)|0))<<13)|0;c=((n=n+Math.imul(f,ot)|0)+(s>>>13)|0)+(St>>>26)|0,St&=67108863,r=Math.imul(B,z),s=(s=Math.imul(B,V))+Math.imul(T,z)|0,n=Math.imul(T,V),r=r+Math.imul(O,K)|0,s=(s=s+Math.imul(O,q)|0)+Math.imul(C,K)|0,n=n+Math.imul(C,q)|0,r=r+Math.imul(_,X)|0,s=(s=s+Math.imul(_,Y)|0)+Math.imul(A,X)|0,n=n+Math.imul(A,Y)|0,r=r+Math.imul(x,$)|0,s=(s=s+Math.imul(x,J)|0)+Math.imul(E,$)|0,n=n+Math.imul(E,J)|0,r=r+Math.imul(v,Q)|0,s=(s=s+Math.imul(v,tt)|0)+Math.imul(k,Q)|0,n=n+Math.imul(k,tt)|0,r=r+Math.imul(w,it)|0,s=(s=s+Math.imul(w,rt)|0)+Math.imul(y,it)|0,n=n+Math.imul(y,rt)|0,r=r+Math.imul(p,nt)|0,s=(s=s+Math.imul(p,ot)|0)+Math.imul(g,nt)|0,n=n+Math.imul(g,ot)|0;var xt=(c+(r=r+Math.imul(l,ht)|0)|0)+((8191&(s=(s=s+Math.imul(l,ct)|0)+Math.imul(f,ht)|0))<<13)|0;c=((n=n+Math.imul(f,ct)|0)+(s>>>13)|0)+(xt>>>26)|0,xt&=67108863,r=Math.imul(M,z),s=(s=Math.imul(M,V))+Math.imul(U,z)|0,n=Math.imul(U,V),r=r+Math.imul(B,K)|0,s=(s=s+Math.imul(B,q)|0)+Math.imul(T,K)|0,n=n+Math.imul(T,q)|0,r=r+Math.imul(O,X)|0,s=(s=s+Math.imul(O,Y)|0)+Math.imul(C,X)|0,n=n+Math.imul(C,Y)|0,r=r+Math.imul(_,$)|0,s=(s=s+Math.imul(_,J)|0)+Math.imul(A,$)|0,n=n+Math.imul(A,J)|0,r=r+Math.imul(x,Q)|0,s=(s=s+Math.imul(x,tt)|0)+Math.imul(E,Q)|0,n=n+Math.imul(E,tt)|0,r=r+Math.imul(v,it)|0,s=(s=s+Math.imul(v,rt)|0)+Math.imul(k,it)|0,n=n+Math.imul(k,rt)|0,r=r+Math.imul(w,nt)|0,s=(s=s+Math.imul(w,ot)|0)+Math.imul(y,nt)|0,n=n+Math.imul(y,ot)|0,r=r+Math.imul(p,ht)|0,s=(s=s+Math.imul(p,ct)|0)+Math.imul(g,ht)|0,n=n+Math.imul(g,ct)|0;var Et=(c+(r=r+Math.imul(l,lt)|0)|0)+((8191&(s=(s=s+Math.imul(l,ft)|0)+Math.imul(f,lt)|0))<<13)|0;c=((n=n+Math.imul(f,ft)|0)+(s>>>13)|0)+(Et>>>26)|0,Et&=67108863,r=Math.imul(L,z),s=(s=Math.imul(L,V))+Math.imul(D,z)|0,n=Math.imul(D,V),r=r+Math.imul(M,K)|0,s=(s=s+Math.imul(M,q)|0)+Math.imul(U,K)|0,n=n+Math.imul(U,q)|0,r=r+Math.imul(B,X)|0,s=(s=s+Math.imul(B,Y)|0)+Math.imul(T,X)|0,n=n+Math.imul(T,Y)|0,r=r+Math.imul(O,$)|0,s=(s=s+Math.imul(O,J)|0)+Math.imul(C,$)|0,n=n+Math.imul(C,J)|0,r=r+Math.imul(_,Q)|0,s=(s=s+Math.imul(_,tt)|0)+Math.imul(A,Q)|0,n=n+Math.imul(A,tt)|0,r=r+Math.imul(x,it)|0,s=(s=s+Math.imul(x,rt)|0)+Math.imul(E,it)|0,n=n+Math.imul(E,rt)|0,r=r+Math.imul(v,nt)|0,s=(s=s+Math.imul(v,ot)|0)+Math.imul(k,nt)|0,n=n+Math.imul(k,ot)|0,r=r+Math.imul(w,ht)|0,s=(s=s+Math.imul(w,ct)|0)+Math.imul(y,ht)|0,n=n+Math.imul(y,ct)|0,r=r+Math.imul(p,lt)|0,s=(s=s+Math.imul(p,ft)|0)+Math.imul(g,lt)|0,n=n+Math.imul(g,ft)|0;var Rt=(c+(r=r+Math.imul(l,pt)|0)|0)+((8191&(s=(s=s+Math.imul(l,gt)|0)+Math.imul(f,pt)|0))<<13)|0;c=((n=n+Math.imul(f,gt)|0)+(s>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,r=Math.imul(L,K),s=(s=Math.imul(L,q))+Math.imul(D,K)|0,n=Math.imul(D,q),r=r+Math.imul(M,X)|0,s=(s=s+Math.imul(M,Y)|0)+Math.imul(U,X)|0,n=n+Math.imul(U,Y)|0,r=r+Math.imul(B,$)|0,s=(s=s+Math.imul(B,J)|0)+Math.imul(T,$)|0,n=n+Math.imul(T,J)|0,r=r+Math.imul(O,Q)|0,s=(s=s+Math.imul(O,tt)|0)+Math.imul(C,Q)|0,n=n+Math.imul(C,tt)|0,r=r+Math.imul(_,it)|0,s=(s=s+Math.imul(_,rt)|0)+Math.imul(A,it)|0,n=n+Math.imul(A,rt)|0,r=r+Math.imul(x,nt)|0,s=(s=s+Math.imul(x,ot)|0)+Math.imul(E,nt)|0,n=n+Math.imul(E,ot)|0,r=r+Math.imul(v,ht)|0,s=(s=s+Math.imul(v,ct)|0)+Math.imul(k,ht)|0,n=n+Math.imul(k,ct)|0,r=r+Math.imul(w,lt)|0,s=(s=s+Math.imul(w,ft)|0)+Math.imul(y,lt)|0,n=n+Math.imul(y,ft)|0;var _t=(c+(r=r+Math.imul(p,pt)|0)|0)+((8191&(s=(s=s+Math.imul(p,gt)|0)+Math.imul(g,pt)|0))<<13)|0;c=((n=n+Math.imul(g,gt)|0)+(s>>>13)|0)+(_t>>>26)|0,_t&=67108863,r=Math.imul(L,X),s=(s=Math.imul(L,Y))+Math.imul(D,X)|0,n=Math.imul(D,Y),r=r+Math.imul(M,$)|0,s=(s=s+Math.imul(M,J)|0)+Math.imul(U,$)|0,n=n+Math.imul(U,J)|0,r=r+Math.imul(B,Q)|0,s=(s=s+Math.imul(B,tt)|0)+Math.imul(T,Q)|0,n=n+Math.imul(T,tt)|0,r=r+Math.imul(O,it)|0,s=(s=s+Math.imul(O,rt)|0)+Math.imul(C,it)|0,n=n+Math.imul(C,rt)|0,r=r+Math.imul(_,nt)|0,s=(s=s+Math.imul(_,ot)|0)+Math.imul(A,nt)|0,n=n+Math.imul(A,ot)|0,r=r+Math.imul(x,ht)|0,s=(s=s+Math.imul(x,ct)|0)+Math.imul(E,ht)|0,n=n+Math.imul(E,ct)|0,r=r+Math.imul(v,lt)|0,s=(s=s+Math.imul(v,ft)|0)+Math.imul(k,lt)|0,n=n+Math.imul(k,ft)|0;var At=(c+(r=r+Math.imul(w,pt)|0)|0)+((8191&(s=(s=s+Math.imul(w,gt)|0)+Math.imul(y,pt)|0))<<13)|0;c=((n=n+Math.imul(y,gt)|0)+(s>>>13)|0)+(At>>>26)|0,At&=67108863,r=Math.imul(L,$),s=(s=Math.imul(L,J))+Math.imul(D,$)|0,n=Math.imul(D,J),r=r+Math.imul(M,Q)|0,s=(s=s+Math.imul(M,tt)|0)+Math.imul(U,Q)|0,n=n+Math.imul(U,tt)|0,r=r+Math.imul(B,it)|0,s=(s=s+Math.imul(B,rt)|0)+Math.imul(T,it)|0,n=n+Math.imul(T,rt)|0,r=r+Math.imul(O,nt)|0,s=(s=s+Math.imul(O,ot)|0)+Math.imul(C,nt)|0,n=n+Math.imul(C,ot)|0,r=r+Math.imul(_,ht)|0,s=(s=s+Math.imul(_,ct)|0)+Math.imul(A,ht)|0,n=n+Math.imul(A,ct)|0,r=r+Math.imul(x,lt)|0,s=(s=s+Math.imul(x,ft)|0)+Math.imul(E,lt)|0,n=n+Math.imul(E,ft)|0;var It=(c+(r=r+Math.imul(v,pt)|0)|0)+((8191&(s=(s=s+Math.imul(v,gt)|0)+Math.imul(k,pt)|0))<<13)|0;c=((n=n+Math.imul(k,gt)|0)+(s>>>13)|0)+(It>>>26)|0,It&=67108863,r=Math.imul(L,Q),s=(s=Math.imul(L,tt))+Math.imul(D,Q)|0,n=Math.imul(D,tt),r=r+Math.imul(M,it)|0,s=(s=s+Math.imul(M,rt)|0)+Math.imul(U,it)|0,n=n+Math.imul(U,rt)|0,r=r+Math.imul(B,nt)|0,s=(s=s+Math.imul(B,ot)|0)+Math.imul(T,nt)|0,n=n+Math.imul(T,ot)|0,r=r+Math.imul(O,ht)|0,s=(s=s+Math.imul(O,ct)|0)+Math.imul(C,ht)|0,n=n+Math.imul(C,ct)|0,r=r+Math.imul(_,lt)|0,s=(s=s+Math.imul(_,ft)|0)+Math.imul(A,lt)|0,n=n+Math.imul(A,ft)|0;var Ot=(c+(r=r+Math.imul(x,pt)|0)|0)+((8191&(s=(s=s+Math.imul(x,gt)|0)+Math.imul(E,pt)|0))<<13)|0;c=((n=n+Math.imul(E,gt)|0)+(s>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,r=Math.imul(L,it),s=(s=Math.imul(L,rt))+Math.imul(D,it)|0,n=Math.imul(D,rt),r=r+Math.imul(M,nt)|0,s=(s=s+Math.imul(M,ot)|0)+Math.imul(U,nt)|0,n=n+Math.imul(U,ot)|0,r=r+Math.imul(B,ht)|0,s=(s=s+Math.imul(B,ct)|0)+Math.imul(T,ht)|0,n=n+Math.imul(T,ct)|0,r=r+Math.imul(O,lt)|0,s=(s=s+Math.imul(O,ft)|0)+Math.imul(C,lt)|0,n=n+Math.imul(C,ft)|0;var Ct=(c+(r=r+Math.imul(_,pt)|0)|0)+((8191&(s=(s=s+Math.imul(_,gt)|0)+Math.imul(A,pt)|0))<<13)|0;c=((n=n+Math.imul(A,gt)|0)+(s>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,r=Math.imul(L,nt),s=(s=Math.imul(L,ot))+Math.imul(D,nt)|0,n=Math.imul(D,ot),r=r+Math.imul(M,ht)|0,s=(s=s+Math.imul(M,ct)|0)+Math.imul(U,ht)|0,n=n+Math.imul(U,ct)|0,r=r+Math.imul(B,lt)|0,s=(s=s+Math.imul(B,ft)|0)+Math.imul(T,lt)|0,n=n+Math.imul(T,ft)|0;var Pt=(c+(r=r+Math.imul(O,pt)|0)|0)+((8191&(s=(s=s+Math.imul(O,gt)|0)+Math.imul(C,pt)|0))<<13)|0;c=((n=n+Math.imul(C,gt)|0)+(s>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,r=Math.imul(L,ht),s=(s=Math.imul(L,ct))+Math.imul(D,ht)|0,n=Math.imul(D,ct),r=r+Math.imul(M,lt)|0,s=(s=s+Math.imul(M,ft)|0)+Math.imul(U,lt)|0,n=n+Math.imul(U,ft)|0;var Bt=(c+(r=r+Math.imul(B,pt)|0)|0)+((8191&(s=(s=s+Math.imul(B,gt)|0)+Math.imul(T,pt)|0))<<13)|0;c=((n=n+Math.imul(T,gt)|0)+(s>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,r=Math.imul(L,lt),s=(s=Math.imul(L,ft))+Math.imul(D,lt)|0,n=Math.imul(D,ft);var Tt=(c+(r=r+Math.imul(M,pt)|0)|0)+((8191&(s=(s=s+Math.imul(M,gt)|0)+Math.imul(U,pt)|0))<<13)|0;c=((n=n+Math.imul(U,gt)|0)+(s>>>13)|0)+(Tt>>>26)|0,Tt&=67108863;var Nt=(c+(r=Math.imul(L,pt))|0)+((8191&(s=(s=Math.imul(L,gt))+Math.imul(D,pt)|0))<<13)|0;return c=((n=Math.imul(D,gt))+(s>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,h[0]=mt,h[1]=wt,h[2]=yt,h[3]=bt,h[4]=vt,h[5]=kt,h[6]=St,h[7]=xt,h[8]=Et,h[9]=Rt,h[10]=_t,h[11]=At,h[12]=It,h[13]=Ot,h[14]=Ct,h[15]=Pt,h[16]=Bt,h[17]=Tt,h[18]=Nt,0!==c&&(h[19]=c,i.length++),i};function p(t,e,i){return(new g).mulp(t,e,i)}function g(t,e){this.x=t,this.y=e}Math.imul||(d=f),n.prototype.mulTo=function(t,e){var i=this.length+t.length;return 10===this.length&&10===t.length?d(this,t,e):i<63?f(this,t,e):i<1024?function(t,e,i){i.negative=e.negative^t.negative,i.length=t.length+e.length;for(var r=0,s=0,n=0;n<i.length-1;n++){var o=s;s=0;for(var a=67108863&r,h=Math.min(n,e.length-1),c=Math.max(0,n-t.length+1);c<=h;c++){var u=n-c,l=(0|t.words[u])*(0|e.words[c]),f=67108863&l;a=67108863&(f=f+a|0),s+=(o=(o=o+(l/67108864|0)|0)+(f>>>26)|0)>>>26,o&=67108863}i.words[n]=a,r=o,o=s}return 0!==r?i.words[n]=r:i.length--,i.strip()}(this,t,e):p(this,t,e)},g.prototype.makeRBT=function(t){for(var e=new Array(t),i=n.prototype._countBits(t)-1,r=0;r<t;r++)e[r]=this.revBin(r,i,t);return e},g.prototype.revBin=function(t,e,i){if(0===t||t===i-1)return t;for(var r=0,s=0;s<e;s++)r|=(1&t)<<e-s-1,t>>=1;return r},g.prototype.permute=function(t,e,i,r,s,n){for(var o=0;o<n;o++)r[o]=e[t[o]],s[o]=i[t[o]]},g.prototype.transform=function(t,e,i,r,s,n){this.permute(n,t,e,i,r,s);for(var o=1;o<s;o<<=1)for(var a=o<<1,h=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),u=0;u<s;u+=a)for(var l=h,f=c,d=0;d<o;d++){var p=i[u+d],g=r[u+d],m=i[u+d+o],w=r[u+d+o],y=l*m-f*w;w=l*w+f*m,m=y,i[u+d]=p+m,r[u+d]=g+w,i[u+d+o]=p-m,r[u+d+o]=g-w,d!==a&&(y=h*l-c*f,f=h*f+c*l,l=y)}},g.prototype.guessLen13b=function(t,e){var i=1|Math.max(e,t),r=1&i,s=0;for(i=i/2|0;i;i>>>=1)s++;return 1<<s+1+r},g.prototype.conjugate=function(t,e,i){if(!(i<=1))for(var r=0;r<i/2;r++){var s=t[r];t[r]=t[i-r-1],t[i-r-1]=s,s=e[r],e[r]=-e[i-r-1],e[i-r-1]=-s}},g.prototype.normalize13b=function(t,e){for(var i=0,r=0;r<e/2;r++){var s=8192*Math.round(t[2*r+1]/e)+Math.round(t[2*r]/e)+i;t[r]=67108863&s,i=s<67108864?0:s/67108864|0}return t},g.prototype.convert13b=function(t,e,i,s){for(var n=0,o=0;o<e;o++)n+=0|t[o],i[2*o]=8191&n,n>>>=13,i[2*o+1]=8191&n,n>>>=13;for(o=2*e;o<s;++o)i[o]=0;r(0===n),r(0==(-8192&n))},g.prototype.stub=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=0;return e},g.prototype.mulp=function(t,e,i){var r=2*this.guessLen13b(t.length,e.length),s=this.makeRBT(r),n=this.stub(r),o=new Array(r),a=new Array(r),h=new Array(r),c=new Array(r),u=new Array(r),l=new Array(r),f=i.words;f.length=r,this.convert13b(t.words,t.length,o,r),this.convert13b(e.words,e.length,c,r),this.transform(o,n,a,h,r,s),this.transform(c,n,u,l,r,s);for(var d=0;d<r;d++){var p=a[d]*u[d]-h[d]*l[d];h[d]=a[d]*l[d]+h[d]*u[d],a[d]=p}return this.conjugate(a,h,r),this.transform(a,h,f,n,r,s),this.conjugate(f,n,r),this.normalize13b(f,r),i.negative=t.negative^e.negative,i.length=t.length+e.length,i.strip()},n.prototype.mul=function(t){var e=new n(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},n.prototype.mulf=function(t){var e=new n(null);return e.words=new Array(this.length+t.length),p(this,t,e)},n.prototype.imul=function(t){return this.clone().mulTo(t,this)},n.prototype.imuln=function(t){r("number"==typeof t),r(t<67108864);for(var e=0,i=0;i<this.length;i++){var s=(0|this.words[i])*t,n=(67108863&s)+(67108863&e);e>>=26,e+=s/67108864|0,e+=n>>>26,this.words[i]=67108863&n}return 0!==e&&(this.words[i]=e,this.length++),this},n.prototype.muln=function(t){return this.clone().imuln(t)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),i=0;i<e.length;i++){var r=i/26|0,s=i%26;e[i]=(t.words[r]&1<<s)>>>s}return e}(t);if(0===e.length)return new n(1);for(var i=this,r=0;r<e.length&&0===e[r];r++,i=i.sqr());if(++r<e.length)for(var s=i.sqr();r<e.length;r++,s=s.sqr())0!==e[r]&&(i=i.mul(s));return i},n.prototype.iushln=function(t){r("number"==typeof t&&t>=0);var e,i=t%26,s=(t-i)/26,n=67108863>>>26-i<<26-i;if(0!==i){var o=0;for(e=0;e<this.length;e++){var a=this.words[e]&n,h=(0|this.words[e])-a<<i;this.words[e]=h|o,o=a>>>26-i}o&&(this.words[e]=o,this.length++)}if(0!==s){for(e=this.length-1;e>=0;e--)this.words[e+s]=this.words[e];for(e=0;e<s;e++)this.words[e]=0;this.length+=s}return this.strip()},n.prototype.ishln=function(t){return r(0===this.negative),this.iushln(t)},n.prototype.iushrn=function(t,e,i){var s;r("number"==typeof t&&t>=0),s=e?(e-e%26)/26:0;var n=t%26,o=Math.min((t-n)/26,this.length),a=67108863^67108863>>>n<<n,h=i;if(s-=o,s=Math.max(0,s),h){for(var c=0;c<o;c++)h.words[c]=this.words[c];h.length=o}if(0===o);else if(this.length>o)for(this.length-=o,c=0;c<this.length;c++)this.words[c]=this.words[c+o];else this.words[0]=0,this.length=1;var u=0;for(c=this.length-1;c>=0&&(0!==u||c>=s);c--){var l=0|this.words[c];this.words[c]=u<<26-n|l>>>n,u=l&a}return h&&0!==u&&(h.words[h.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(t,e,i){return r(0===this.negative),this.iushrn(t,e,i)},n.prototype.shln=function(t){return this.clone().ishln(t)},n.prototype.ushln=function(t){return this.clone().iushln(t)},n.prototype.shrn=function(t){return this.clone().ishrn(t)},n.prototype.ushrn=function(t){return this.clone().iushrn(t)},n.prototype.testn=function(t){r("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26,s=1<<e;return!(this.length<=i||!(this.words[i]&s))},n.prototype.imaskn=function(t){r("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==e&&i++,this.length=Math.min(i,this.length),0!==e){var s=67108863^67108863>>>e<<e;this.words[this.length-1]&=s}return this.strip()},n.prototype.maskn=function(t){return this.clone().imaskn(t)},n.prototype.iaddn=function(t){return r("number"==typeof t),r(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},n.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},n.prototype.isubn=function(t){if(r("number"==typeof t),r(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.strip()},n.prototype.addn=function(t){return this.clone().iaddn(t)},n.prototype.subn=function(t){return this.clone().isubn(t)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(t,e,i){var s,n,o=t.length+i;this._expand(o);var a=0;for(s=0;s<t.length;s++){n=(0|this.words[s+i])+a;var h=(0|t.words[s])*e;a=((n-=67108863&h)>>26)-(h/67108864|0),this.words[s+i]=67108863&n}for(;s<this.length-i;s++)a=(n=(0|this.words[s+i])+a)>>26,this.words[s+i]=67108863&n;if(0===a)return this.strip();for(r(-1===a),a=0,s=0;s<this.length;s++)a=(n=-(0|this.words[s])+a)>>26,this.words[s]=67108863&n;return this.negative=1,this.strip()},n.prototype._wordDiv=function(t,e){var i=(this.length,t.length),r=this.clone(),s=t,o=0|s.words[s.length-1];0!=(i=26-this._countBits(o))&&(s=s.ushln(i),r.iushln(i),o=0|s.words[s.length-1]);var a,h=r.length-s.length;if("mod"!==e){(a=new n(null)).length=h+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var u=r.clone()._ishlnsubmul(s,1,h);0===u.negative&&(r=u,a&&(a.words[h]=1));for(var l=h-1;l>=0;l--){var f=67108864*(0|r.words[s.length+l])+(0|r.words[s.length+l-1]);for(f=Math.min(f/o|0,67108863),r._ishlnsubmul(s,f,l);0!==r.negative;)f--,r.negative=0,r._ishlnsubmul(s,1,l),r.isZero()||(r.negative^=1);a&&(a.words[l]=f)}return a&&a.strip(),r.strip(),"div"!==e&&0!==i&&r.iushrn(i),{div:a||null,mod:r}},n.prototype.divmod=function(t,e,i){return r(!t.isZero()),this.isZero()?{div:new n(0),mod:new n(0)}:0!==this.negative&&0===t.negative?(a=this.neg().divmod(t,e),"mod"!==e&&(s=a.div.neg()),"div"!==e&&(o=a.mod.neg(),i&&0!==o.negative&&o.iadd(t)),{div:s,mod:o}):0===this.negative&&0!==t.negative?(a=this.divmod(t.neg(),e),"mod"!==e&&(s=a.div.neg()),{div:s,mod:a.mod}):0!=(this.negative&t.negative)?(a=this.neg().divmod(t.neg(),e),"div"!==e&&(o=a.mod.neg(),i&&0!==o.negative&&o.isub(t)),{div:a.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new n(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new n(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new n(this.modn(t.words[0]))}:this._wordDiv(t,e);var s,o,a},n.prototype.div=function(t){return this.divmod(t,"div",!1).div},n.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},n.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},n.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var i=0!==e.div.negative?e.mod.isub(t):e.mod,r=t.ushrn(1),s=t.andln(1),n=i.cmp(r);return n<0||1===s&&0===n?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},n.prototype.modn=function(t){r(t<=67108863);for(var e=(1<<26)%t,i=0,s=this.length-1;s>=0;s--)i=(e*i+(0|this.words[s]))%t;return i},n.prototype.idivn=function(t){r(t<=67108863);for(var e=0,i=this.length-1;i>=0;i--){var s=(0|this.words[i])+67108864*e;this.words[i]=s/t|0,e=s%t}return this.strip()},n.prototype.divn=function(t){return this.clone().idivn(t)},n.prototype.egcd=function(t){r(0===t.negative),r(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var s=new n(1),o=new n(0),a=new n(0),h=new n(1),c=0;e.isEven()&&i.isEven();)e.iushrn(1),i.iushrn(1),++c;for(var u=i.clone(),l=e.clone();!e.isZero();){for(var f=0,d=1;0==(e.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(e.iushrn(f);f-- >0;)(s.isOdd()||o.isOdd())&&(s.iadd(u),o.isub(l)),s.iushrn(1),o.iushrn(1);for(var p=0,g=1;0==(i.words[0]&g)&&p<26;++p,g<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(a.isOdd()||h.isOdd())&&(a.iadd(u),h.isub(l)),a.iushrn(1),h.iushrn(1);e.cmp(i)>=0?(e.isub(i),s.isub(a),o.isub(h)):(i.isub(e),a.isub(s),h.isub(o))}return{a:a,b:h,gcd:i.iushln(c)}},n.prototype._invmp=function(t){r(0===t.negative),r(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var s,o=new n(1),a=new n(0),h=i.clone();e.cmpn(1)>0&&i.cmpn(1)>0;){for(var c=0,u=1;0==(e.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(e.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(h),o.iushrn(1);for(var l=0,f=1;0==(i.words[0]&f)&&l<26;++l,f<<=1);if(l>0)for(i.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(h),a.iushrn(1);e.cmp(i)>=0?(e.isub(i),o.isub(a)):(i.isub(e),a.isub(o))}return(s=0===e.cmpn(1)?o:a).cmpn(0)<0&&s.iadd(t),s},n.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),i=t.clone();e.negative=0,i.negative=0;for(var r=0;e.isEven()&&i.isEven();r++)e.iushrn(1),i.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;i.isEven();)i.iushrn(1);var s=e.cmp(i);if(s<0){var n=e;e=i,i=n}else if(0===s||0===i.cmpn(1))break;e.isub(i)}return i.iushln(r)},n.prototype.invm=function(t){return this.egcd(t).a.umod(t)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(t){return this.words[0]&t},n.prototype.bincn=function(t){r("number"==typeof t);var e=t%26,i=(t-e)/26,s=1<<e;if(this.length<=i)return this._expand(i+1),this.words[i]|=s,this;for(var n=s,o=i;0!==n&&o<this.length;o++){var a=0|this.words[o];n=(a+=n)>>>26,a&=67108863,this.words[o]=a}return 0!==n&&(this.words[o]=n,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(t){var e,i=t<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)e=1;else{i&&(t=-t),r(t<=67108863,"Number is too big");var s=0|this.words[0];e=s===t?0:s<t?-1:1}return 0!==this.negative?0|-e:e},n.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},n.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,i=this.length-1;i>=0;i--){var r=0|this.words[i],s=0|t.words[i];if(r!==s){r<s?e=-1:r>s&&(e=1);break}}return e},n.prototype.gtn=function(t){return 1===this.cmpn(t)},n.prototype.gt=function(t){return 1===this.cmp(t)},n.prototype.gten=function(t){return this.cmpn(t)>=0},n.prototype.gte=function(t){return this.cmp(t)>=0},n.prototype.ltn=function(t){return-1===this.cmpn(t)},n.prototype.lt=function(t){return-1===this.cmp(t)},n.prototype.lten=function(t){return this.cmpn(t)<=0},n.prototype.lte=function(t){return this.cmp(t)<=0},n.prototype.eqn=function(t){return 0===this.cmpn(t)},n.prototype.eq=function(t){return 0===this.cmp(t)},n.red=function(t){return new S(t)},n.prototype.toRed=function(t){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},n.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(t){return this.red=t,this},n.prototype.forceRed=function(t){return r(!this.red,"Already a number in reduction context"),this._forceRed(t)},n.prototype.redAdd=function(t){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},n.prototype.redIAdd=function(t){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},n.prototype.redSub=function(t){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},n.prototype.redISub=function(t){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},n.prototype.redShl=function(t){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},n.prototype.redMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},n.prototype.redIMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},n.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(t){return r(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var m={k256:null,p224:null,p192:null,p25519:null};function w(t,e){this.name=t,this.p=new n(e,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function y(){w.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function b(){w.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function v(){w.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function k(){w.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(t){if("string"==typeof t){var e=n._prime(t);this.m=e.p,this.prime=e}else r(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function x(t){S.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}w.prototype._tmp=function(){var t=new n(null);return t.words=new Array(Math.ceil(this.n/13)),t},w.prototype.ireduce=function(t){var e,i=t;do{this.split(i,this.tmp),e=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(e>this.n);var r=e<this.n?-1:i.ucmp(this.p);return 0===r?(i.words[0]=0,i.length=1):r>0?i.isub(this.p):i.strip(),i},w.prototype.split=function(t,e){t.iushrn(this.n,0,e)},w.prototype.imulK=function(t){return t.imul(this.k)},s(y,w),y.prototype.split=function(t,e){for(var i=Math.min(t.length,9),r=0;r<i;r++)e.words[r]=t.words[r];if(e.length=i,t.length<=9)return t.words[0]=0,void(t.length=1);var s=t.words[9];for(e.words[e.length++]=4194303&s,r=10;r<t.length;r++){var n=0|t.words[r];t.words[r-10]=(4194303&n)<<4|s>>>22,s=n}s>>>=22,t.words[r-10]=s,0===s&&t.length>10?t.length-=10:t.length-=9},y.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,i=0;i<t.length;i++){var r=0|t.words[i];e+=977*r,t.words[i]=67108863&e,e=64*r+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},s(b,w),s(v,w),s(k,w),k.prototype.imulK=function(t){for(var e=0,i=0;i<t.length;i++){var r=19*(0|t.words[i])+e,s=67108863&r;r>>>=26,t.words[i]=s,e=r}return 0!==e&&(t.words[t.length++]=e),t},n._prime=function(t){if(m[t])return m[t];var e;if("k256"===t)e=new y;else if("p224"===t)e=new b;else if("p192"===t)e=new v;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new k}return m[t]=e,e},S.prototype._verify1=function(t){r(0===t.negative,"red works only with positives"),r(t.red,"red works only with red numbers")},S.prototype._verify2=function(t,e){r(0==(t.negative|e.negative),"red works only with positives"),r(t.red&&t.red===e.red,"red works only with red numbers")},S.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},S.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},S.prototype.add=function(t,e){this._verify2(t,e);var i=t.add(e);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},S.prototype.iadd=function(t,e){this._verify2(t,e);var i=t.iadd(e);return i.cmp(this.m)>=0&&i.isub(this.m),i},S.prototype.sub=function(t,e){this._verify2(t,e);var i=t.sub(e);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},S.prototype.isub=function(t,e){this._verify2(t,e);var i=t.isub(e);return i.cmpn(0)<0&&i.iadd(this.m),i},S.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},S.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},S.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},S.prototype.isqr=function(t){return this.imul(t,t.clone())},S.prototype.sqr=function(t){return this.mul(t,t)},S.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(r(e%2==1),3===e){var i=this.m.add(new n(1)).iushrn(2);return this.pow(t,i)}for(var s=this.m.subn(1),o=0;!s.isZero()&&0===s.andln(1);)o++,s.iushrn(1);r(!s.isZero());var a=new n(1).toRed(this),h=a.redNeg(),c=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new n(2*u*u).toRed(this);0!==this.pow(u,c).cmp(h);)u.redIAdd(h);for(var l=this.pow(u,s),f=this.pow(t,s.addn(1).iushrn(1)),d=this.pow(t,s),p=o;0!==d.cmp(a);){for(var g=d,m=0;0!==g.cmp(a);m++)g=g.redSqr();r(m<p);var w=this.pow(l,new n(1).iushln(p-m-1));f=f.redMul(w),l=w.redSqr(),d=d.redMul(l),p=m}return f},S.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},S.prototype.pow=function(t,e){if(e.isZero())return new n(1).toRed(this);if(0===e.cmpn(1))return t.clone();var i=new Array(16);i[0]=new n(1).toRed(this),i[1]=t;for(var r=2;r<i.length;r++)i[r]=this.mul(i[r-1],t);var s=i[0],o=0,a=0,h=e.bitLength()%26;for(0===h&&(h=26),r=e.length-1;r>=0;r--){for(var c=e.words[r],u=h-1;u>=0;u--){var l=c>>u&1;s!==i[0]&&(s=this.sqr(s)),0!==l||0!==o?(o<<=1,o|=l,(4==++a||0===r&&0===u)&&(s=this.mul(s,i[o]),a=0,o=0)):a=0}h=26}return s},S.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},S.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},n.mont=function(t){return new x(t)},s(x,S),x.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},x.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},x.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var i=t.imul(e),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=i.isub(r).iushrn(this.shift),n=s;return s.cmp(this.m)>=0?n=s.isub(this.m):s.cmpn(0)<0&&(n=s.iadd(this.m)),n._forceRed(this)},x.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new n(0)._forceRed(this);var i=t.mul(e),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=i.isub(r).iushrn(this.shift),o=s;return s.cmp(this.m)>=0?o=s.isub(this.m):s.cmpn(0)<0&&(o=s.iadd(this.m)),o._forceRed(this)},x.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t,this)}).call(this,i(188)(t))},function(t,e,i){"use strict";
/*!
 * Packet.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(72);i(198);class s{constructor(){this.id=++s.id>>>0,this.cmd=-1}getSize(){throw new Error("Abstract method.")}toWriter(){throw new Error("Abstract method.")}fromRaw(){throw new Error("Abstract method.")}static fromRaw(){throw new Error("Abstract method.")}workerHandle(t){t.resolveJob(this.id,this)}masterHandle(t){let e=r.execute(this);e.id=this.id,t.send(e)}jobsHandle(t){throw new Error(`Unknown command: "${this.cmd}".`)}}s.id=0,t.exports=s},function(t,e,i){"use strict";
/*!
 * network.js - network object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(3),n=i(132),o=i(10),a=i(133);function h(t){if(!(this instanceof h))return new h(t);r(!h[t.type],"Cannot create two networks."),this.type=t.type,this.seeds=t.seeds,this.txcheckpoint=t.txcheckpoint,this.txchecktime=t.txchecktime,this.magic=t.magic,this.port=t.port,this.wsport=t.wsport,this.checkpointMap=t.checkpointMap,this.lastCheckpoint=t.lastCheckpoint,this.checkpoints=[],this.halvingInterval=t.halvingInterval,this.genesis=t.genesis,this.pow=t.pow,this.block=t.block,this.activationThreshold=t.activationThreshold,this.minerWindow=t.minerWindow,this.deployments=t.deployments,this.deploys=t.deploys,this.unknownBits=~o.VERSION_TOP_MASK,this.keyPrefix=t.keyPrefix,this.addressPrefix=t.addressPrefix,this.requireStandard=t.requireStandard,this.rpcPort=t.rpcPort,this.minRelay=t.minRelay,this.feeRate=t.feeRate,this.maxFeeRate=t.maxFeeRate,this.selfConnect=t.selfConnect,this.requestMempool=t.requestMempool,this.bossId=t.bossId,this.tokenFix=t.tokenFix,this.tokenReg=t.tokenReg,this.stockFix=t.stockFix,this.stockReg=t.stockReg,this.time=new a,this._init()}function c(t,e){return t.bit-e}function u(t,e){return t.height-e.height}function l(t,e){return t.magic===e}function f(t,e){return t.keyPrefix.privkey===e}function d(t,e){return t.keyPrefix.xpubkey===e}function p(t,e){return t.keyPrefix.xprivkey===e}function g(t,e){return t.keyPrefix.xpubkey58===e}function m(t,e){return t.keyPrefix.xprivkey58===e}function w(t,e){const i=t.addressPrefix;switch(e){case i.pubkeyhash:case i.scripthash:case i.witnesspubkeyhash:case i.witnessscripthash:return!0}return!1}function y(t,e){return t.addressPrefix.bech32===e}h.primary=null,h.type=null,h.main=null,h.testnet=null,h.regtest=null,h.segnet4=null,h.simnet=null,h.prototype._init=function(){let t=0;for(const e of this.deploys)t|=1<<e.bit;t|=o.VERSION_TOP_MASK,this.unknownBits=~t;for(const t of Object.keys(this.checkpointMap)){const e=this.checkpointMap[t],i=Number(t);this.checkpoints.push({hash:e,height:i})}this.checkpoints.sort(u)},h.prototype.byBit=function(t){const e=s.binarySearch(this.deploys,t,c);return-1===e?null:this.deploys[e]},h.prototype.now=function(){return this.time.now()},h.prototype.ms=function(){return this.time.ms()},h.create=function(t){if("string"==typeof t&&(t=n[t]),r(t,"Unknown network."),h[t.type])return h[t.type];const e=new h(t);return h[e.type]=e,h.primary||(h.primary=e),e},h.set=function(t){return r("string"==typeof t,"Bad network."),h.primary=h.get(t),h.type=t,h.primary},h.get=function(t){if(!t)return r(h.primary,"No default network."),h.primary;if(t instanceof h)return t;if("string"==typeof t)return h.create(t);throw new Error("Unknown network.")},h.ensure=function(t){return t?t instanceof h?t:"string"==typeof t&&n[t]?h.create(t):(r(h.primary,"No default network."),h.primary):(r(h.primary,"No default network."),h.primary)},h.by=function(t,e,i,r){if(i){if(e(i=h.get(i),t))return i;throw new Error(`Network mismatch for ${r}.`)}for(const r of n.types)if(e(i=n[r],t))return h.get(r);throw new Error(`Network not found for ${r}.`)},h.fromMagic=function(t,e){return h.by(t,l,e,"magic number")},h.fromWIF=function(t,e){return h.by(t,f,e,"WIF")},h.fromPublic=function(t,e){return h.by(t,d,e,"xpubkey")},h.fromPrivate=function(t,e){return h.by(t,p,e,"xprivkey")},h.fromPublic58=function(t,e){return h.by(t,g,e,"xpubkey")},h.fromPrivate58=function(t,e){return h.by(t,m,e,"xprivkey")},h.fromAddress=function(t,e){return h.by(t,w,e,"base58 address")},h.fromBech32=function(t,e){return h.by(t,y,e,"bech32 address")},h.prototype.toString=function(){return this.type},h.prototype.inspect=function(){return`<Network: ${this.type}>`},h.isNetwork=function(t){return t instanceof h},h.set("testnet"),t.exports=h},function(t,e,i){"use strict";(function(e){
/*!
 * tx.js - transaction object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(4),o=i(9),a=i(30),h=i(31),c=i(16),u=i(20),l=i(2),f=i(6),d=i(68),p=i(28),g=i(37),m=i(39),w=i(79),y=i(10),b=i(33),v=i(67),{hashType:k}=i(27);class S{constructor(t){this.version=1,this.inputs=[],this.outputs=[],this.locktime=0,this.mutable=!1,this._hash=null,this._hhash=null,this._whash=null,this._raw=null,this._size=-1,this._witness=-1,this._sigops=-1,this._hashPrevouts=null,this._hashSequence=null,this._hashOutputs=null,t&&this.fromOptions(t)}fromOptions(t){if(r(t,"TX data is required."),null!=t.version&&(r(s.isU32(t.version),"Version must be a uint32."),this.version=t.version),t.inputs){r(Array.isArray(t.inputs),"Inputs must be an array.");for(const e of t.inputs)this.inputs.push(new d(e))}if(t.outputs){r(Array.isArray(t.outputs),"Outputs must be an array.");for(const e of t.outputs)this.outputs.push(new p(e))}return null!=t.locktime&&(r(s.isU32(t.locktime),"Locktime must be a uint32."),this.locktime=t.locktime),this}static fromOptions(t){return(new S).fromOptions(t)}clone(){return(new S).inject(this)}inject(t,e=0){this.version=t.version;for(const i of t.inputs)if(this.inputs.push(i.clone()),0!=e&&this.inputs.length>=e)break;for(const i of t.outputs)if(this.outputs.push(i.clone()),0!=e&&this.outputs.length>=e)break;return this.locktime=t.locktime,this}refresh(){this._hash=null,this._hhash=null,this._whash=null,this._raw=null,this._size=-1,this._witness=-1,this._sigops=-1,this._hashPrevouts=null,this._hashSequence=null,this._hashOutputs=null}hash(t){let e=this._hash;if(e||(e=o.hash256(this.toNormal()),this.mutable||(this._hash=e)),"hex"===t){let t=this._hhash;t||(t=e.toString("hex"),this.mutable||(this._hhash=t)),e=t}return e}witnessHash(t){if(!this.hasWitness())return this.hash(t);let e=this._whash;return e||(e=o.hash256(this.toRaw()),this.mutable||(this._whash=e)),"hex"===t?e.toString("hex"):e}toRaw(){return this.frame().data}toNormal(){return this.hasWitness()?this.frameNormal().data:this.toRaw()}toWriter(t){return this.mutable?this.hasWitness()?this.writeWitness(t):this.writeNormal(t):(t.writeBytes(this.toRaw()),t)}toNormalWriter(t){return this.hasWitness()?(this.writeNormal(t),t):this.toWriter(t)}frame(){if(this.mutable)return r(!this._raw),this.hasWitness()?this.frameWitness():this.frameNormal();if(this._raw){r(this._size>=0),r(this._witness>=0);const t=new x(this._size,this._witness);return t.data=this._raw,t}let t;return t=this.hasWitness()?this.frameWitness():this.frameNormal(),this._raw=t.data,this._size=t.size,this._witness=t.witness,t}getSizes(){return this.mutable?this.hasWitness()?this.getWitnessSizes():this.getNormalSizes():this.frame()}getVirtualSize(){const t=y.WITNESS_SCALE_FACTOR;return(this.getWeight()+t-1)/t|0}getSigopsSize(t){const e=y.WITNESS_SCALE_FACTOR,i=b.BYTES_PER_SIGOP;return(Math.max(this.getWeight(),t*i)+e-1)/e|0}getWeight(){const t=this.getSizes();return(t.size-t.witness)*(y.WITNESS_SCALE_FACTOR-1)+t.size}getSize(){return this.getSizes().size}getBaseSize(){const t=this.getSizes();return t.size-t.witness}hasWitness(){if(-1!==this._witness)return 0!==this._witness;for(const t of this.inputs)if(t.witness.items.length>0)return!0;return!1}signatureHash(t,e,i,s,n){if(r(t>=0&&t<this.inputs.length),r(e instanceof u),r("number"==typeof i),r("number"==typeof s),0===n)return this.signatureHashV0(t,e,s);if(1===n)return this.signatureHashV1(t,e,i,s);throw new Error("Unknown sighash version.")}signatureHashV0(t,i,r){if((31&r)===k.SINGLE){if(t>=this.outputs.length)return e.from(n.ONE_HASH)}else if((31&r)===k.ZERO&&0==this.outputs.length)return e.from(n.ONE_HASH);i=i.removeSeparators();const s=this.hashSize(t,i,r),a=f.pool(s);if(a.writeU32(this.version),r&k.ANYONECANPAY){const e=this.inputs[t];a.writeVarint(1),e.prevout.toWriter(a),a.writeVarBytes(i.toRaw()),a.writeU32(e.sequence)}else{a.writeVarint(this.inputs.length);for(let e=0;e<this.inputs.length;e++){const s=this.inputs[e];if(s.prevout.toWriter(a),e!==t)switch(a.writeVarint(0),31&r){case k.NONE:case k.SINGLE:case k.ZERO:a.writeU32(0);break;default:a.writeU32(s.sequence)}else a.writeVarBytes(i.toRaw()),a.writeU32(s.sequence)}}switch(31&r){case k.NONE:a.writeVarint(0);break;case k.SINGLE:{const e=this.outputs[t];a.writeVarint(t+1);for(let e=0;e<t;e++)a.writeI64(-1),a.writeVarint(0);e.toWriter(a);break}case k.ZERO:{const t=this.outputs[0];a.writeVarint(1),t.toWriter(a);break}default:a.writeVarint(this.outputs.length);for(const t of this.outputs)t.toWriter(a)}return a.writeU32(this.locktime),a.writeU32(r),o.hash256(a.render())}hashSize(t,e,i){let r=0;switch(r+=4,i&k.ANYONECANPAY?(r+=1,r+=36,r+=e.getVarSize(),r+=4):(r+=n.sizeVarint(this.inputs.length),r+=41*(this.inputs.length-1),r+=36,r+=e.getVarSize(),r+=4),31&i){case k.NONE:r+=1;break;case k.SINGLE:r+=n.sizeVarint(t+1),r+=9*t,r+=this.outputs[t].getSize();break;case k.ZERO:this.outputs.length>0?(r+=n.sizeVarint(1),r+=this.outputs[0].getSize()):r+=1;break;default:r+=n.sizeVarint(this.outputs.length);for(const t of this.outputs)r+=t.getSize()}return r+8}signatureHashV1(t,e,i,r){const s=this.inputs[t];let a=n.ZERO_HASH,h=n.ZERO_HASH,c=n.ZERO_HASH;if(!(r&k.ANYONECANPAY))if(this._hashPrevouts)a=this._hashPrevouts;else{const t=f.pool(36*this.inputs.length);for(const e of this.inputs)e.prevout.toWriter(t);a=o.hash256(t.render()),this.mutable||(this._hashPrevouts=a)}if(!(r&k.ANYONECANPAY)&&(31&r)!==k.ZERO&&(31&r)!==k.SINGLE&&(31&r)!==k.NONE)if(this._hashSequence)h=this._hashSequence;else{const t=f.pool(4*this.inputs.length);for(const e of this.inputs)t.writeU32(e.sequence);h=o.hash256(t.render()),this.mutable||(this._hashSequence=h)}if((31&r)!==k.SINGLE&&(31&r)!==k.ZERO&&(31&r)!==k.NONE)if(this._hashOutputs)c=this._hashOutputs;else{let t=0;for(const e of this.outputs)t+=e.getSize();const e=f.pool(t);for(const t of this.outputs)t.toWriter(e);c=o.hash256(e.render()),this.mutable||(this._hashOutputs=c)}else if((31&r)===k.SINGLE){if(t<this.outputs.length){const e=this.outputs[t];c=o.hash256(e.toRaw())}}else if((31&r)===k.ZERO&&0<this.outputs.length){const t=this.outputs[0];c=o.hash256(t.toRaw())}const u=156+e.getVarSize(),l=f.pool(u);return l.writeU32(this.version),l.writeBytes(a),l.writeBytes(h),l.writeHash(s.prevout.hash),l.writeU32(s.prevout.index),l.writeVarBytes(e.toRaw()),l.writeI64(i),l.writeU32(s.sequence),l.writeBytes(c),l.writeU32(this.locktime),l.writeU32(r),o.hash256(l.render())}checksig(t,e,i,r,s,n){if(0===r.length)return!1;const o=r[r.length-1],h=this.signatureHash(t,e,i,o,n);return a.verify(h,r.slice(0,-1),s)}signature(t,e,i,r,s,n){null==s&&(s=k.ALL),null==n&&(n=0);const o=this.signatureHash(t,e,i,s,n),h=a.sign(o,r),c=new f(h.length+1);return c.writeBytes(h),c.writeU8(s),c.render()}check(t,e,i){if(0===this.inputs.length)throw new v("UNKNOWN_ERROR","No inputs.");if(!this.isCoinbase())for(let r=0;r<this.inputs.length;r++){const{prevout:s}=this.inputs[r],n=t.getOutput(s);if(!n)throw new v("UNKNOWN_ERROR","No coin available.");this.checkInput(r,n,e,i)}}checkInput(t,e,i,s){const n=this.inputs[t];r(n,"Input does not exist."),r(e,"No coin passed.");try{u.verifyScript(n.script,n.witness,e.script,this,t,e.value,i,s)}catch(t){throw t}}async checkAsync(t,e,i,r){if(0===this.inputs.length)throw new v("UNKNOWN_ERROR","No inputs.");this.isCoinbase()||(r&&r.enabled?await r.check(this,t,e,i):this.check(t,e,i))}async checkInputAsync(t,e,i,s,n){const o=this.inputs[t];r(o,"Input does not exist."),r(e,"No coin passed."),n&&n.enabled?await n.checkInput(this,t,e,i,s):this.checkInput(t,e,i,s)}verify(t,e,i){try{this.check(t,e,i)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0}verifyInputs(t,e){const[i]=this.checkInputs(t,e);return-1!==i}verifyInput(t,e,i,r){try{this.checkInput(t,e,i,r)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0}async verifyAsync(t,e,i,r){try{await this.checkAsync(t,e,i,r)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0}isCoinbase(){return 1===this.inputs.length&&this.inputs[0].prevout.isNull()}isRBF(){if(2===this.version)return!1;for(const t of this.inputs)if(t.isRBF())return!0;return!1}getFee(t){return this.hasCoins(t)?this.getInputValue(t)-this.getOutputValue():0}getInputValue(t){let e=0;for(const{prevout:i}of this.inputs){const r=t.getOutput(i);if(!r)return 0;e+=r.value}return e}getOutputValue(){let t=0;for(const e of this.outputs)t+=e.value;return t}_getInputAddresses(t){const e=Object.create(null),i=[];if(this.isCoinbase())return[i,e];for(const r of this.inputs){const s=t?t.getOutputFor(r):null,n=r.getAddress(s);if(!n)continue;const o=n.getHash("hex");e[o]||(e[o]=!0,i.push(n))}return[i,e]}_getOutputAddresses(){const t=Object.create(null),e=[];for(const i of this.outputs){const r=i.getAddress();if(!r)continue;const s=r.getHash("hex");t[s]||(t[s]=!0,e.push(r))}return[e,t]}_getAddresses(t){const[e,i]=this._getInputAddresses(t),r=this.getOutputAddresses();for(const t of r){const r=t.getHash("hex");i[r]||(i[r]=!0,e.push(t))}return[e,i]}getInputAddresses(t){const[e]=this._getInputAddresses(t);return e}getOutputAddresses(){const[t]=this._getOutputAddresses();return t}getAddresses(t){const[e]=this._getAddresses(t);return e}getInputHashes(t,e){if("hex"===e){const[,e]=this._getInputAddresses(t);return Object.keys(e)}const i=this.getInputAddresses(t),r=[];for(const t of i)r.push(t.getHash());return r}getOutputHashes(t){if("hex"===t){const[,t]=this._getOutputAddresses();return Object.keys(t)}const e=this.getOutputAddresses(),i=[];for(const t of e)i.push(t.getHash());return i}getHashes(t,e){if("hex"===e){const[,e]=this._getAddresses(t);return Object.keys(e)}const i=this.getAddresses(t),r=[];for(const t of i)r.push(t.getHash());return r}hasCoins(t){if(0===this.inputs.length)return!1;for(const{prevout:e}of this.inputs)if(!t.hasEntry(e))return!1;return!0}isFinal(t,e){const i=y.LOCKTIME_THRESHOLD;if(0===this.locktime)return!0;if(this.locktime<(this.locktime<i?t:e))return!0;for(const t of this.inputs)if(4294967295!==t.sequence)return!1;return!0}static mergeOrder(t){return r(Array.isArray(t)),t.reduce((t,e)=>(null==t?t=e:(1==t.outputs.length||e.outputs.length>1&&e.outputs[1].value>t.outputs[1].value)&&(t=e),t),null)}verifyLocktime(t,e){const i=y.LOCKTIME_THRESHOLD,s=this.inputs[t];return r(s,"Input does not exist."),r(e>=0,"Locktime must be non-negative."),this.locktime<i==e<i&&!(e>this.locktime)&&4294967295!==s.sequence}verifySequence(t,e){const i=y.SEQUENCE_DISABLE_FLAG,s=y.SEQUENCE_TYPE_FLAG,n=y.SEQUENCE_MASK,o=this.inputs[t];return r(o,"Input does not exist."),r(e>=0,"Locktime must be non-negative."),!(!(e&i)&&(this.version<2||o.sequence&i||(o.sequence&s)!=(e&s)||(e&n)>(o.sequence&n)))}getLegacySigops(){if(-1!==this._sigops)return this._sigops;let t=0;for(const e of this.inputs)t+=e.script.getSigops(!1);for(const e of this.outputs)t+=e.script.getSigops(!1);return this.mutable||(this._sigops=t),t}getScripthashSigops(t){if(this.isCoinbase())return 0;let e=0;for(const i of this.inputs){const r=t.getOutputFor(i);r&&r.script.isScripthash()&&(e+=r.script.getScripthashSigops(i.script))}return e}getWitnessSigops(t){if(this.isCoinbase())return 0;let e=0;for(const i of this.inputs){const r=t.getOutputFor(i);r&&(e+=r.script.getWitnessSigops(i.script,i.witness))}return e}getSigopsCost(t,e){null==e&&(e=u.flags.STANDARD_VERIFY_FLAGS);const i=y.WITNESS_SCALE_FACTOR;let r=this.getLegacySigops()*i;return e&u.flags.VERIFY_P2SH&&(r+=this.getScripthashSigops(t)*i),e&u.flags.VERIFY_WITNESS&&(r+=this.getWitnessSigops(t)),r}getSigops(t,e){const i=y.WITNESS_SCALE_FACTOR;return(this.getSigopsCost(t,e)+i-1)/i|0}isSane(){const[t]=this.checkSanity();return t}checkSanity(){if(0===this.inputs.length)return[!1,"bad-txns-vin-empty",100];if(0===this.outputs.length)return[!1,"bad-txns-vout-empty",100];if(this.getBaseSize()>y.MAX_BLOCK_SIZE)return[!1,"bad-txns-oversize",100];let t=0;for(const e of this.outputs){if(e.value<0)return[!1,"bad-txns-vout-negative",100];if(e.value>y.MAX_MONEY)return[!1,"bad-txns-vout-toolarge",100];if((t+=e.value)<0||t>y.MAX_MONEY)return[!1,"bad-txns-txouttotal-toolarge",100]}const e=new Set;for(const t of this.inputs){const i=t.prevout.toKey();if(e.has(i))return[!1,"bad-txns-inputs-duplicate",100];e.add(i)}if(this.isCoinbase()){const t=this.inputs[0].script.getSize();if(t<2||t>100)return[!1,"bad-cb-length",100]}else for(const t of this.inputs)if(t.prevout.isNull())return[!1,"bad-txns-prevout-null",10];return[!0,"valid",0]}isStandard(){const[t]=this.checkStandard();return t}checkStandard(){if(this.version<1||this.version>b.MAX_TX_VERSION)return[!1,"version",0];if(this.getWeight()>=b.MAX_TX_WEIGHT)return[!1,"tx-size",0];for(const t of this.inputs){if(t.script.getSize()>1650)return[!1,"scriptsig-size",0];if(!t.script.isPushOnly())return[!1,"scriptsig-not-pushonly",0]}let t=0;for(const e of this.outputs){if(!e.script.isStandard())return[!1,"scriptpubkey",0];if(e.script.isNulldata())t++;else{if(e.script.isMultisig()&&!b.BARE_MULTISIG)return[!1,"bare-multisig",0];if(e.isDust(b.MIN_RELAY))return[!1,"dust",0]}}return t>1?[!1,"multi-op-return",0]:[!0,"valid",0]}hasStandardInputs(t){if(this.isCoinbase())return!0;for(const e of this.inputs){const i=t.getOutputFor(e);if(!i)return!1;if(!i.script.isPubkeyhash())if(i.script.isScripthash()){const t=e.script.getRedeem();if(!t)return!1;if(t.getSigops(!0)>b.MAX_P2SH_SIGOPS)return!1}else if(i.script.isUnknown())return!1}return!0}hasStandardWitness(t){if(this.isCoinbase())return!0;for(const e of this.inputs){const i=e.witness,r=t.getOutputFor(e);if(!r)continue;if(0===i.items.length)continue;let s=r.script;if(s.isScripthash()&&!(s=e.script.getRedeem()))return!1;if(!s.isProgram())return!1;if(s.isWitnessPubkeyhash()){if(2!==i.items.length)return!1;if(i.items[0].length>73)return!1;if(i.items[1].length>65)return!1}else if(s.isWitnessScripthash()){if(i.items.length-1>b.MAX_P2WSH_STACK)return!1;for(let t=0;t<i.items.length-1;t++)if(i.items[t].length>b.MAX_P2WSH_PUSH)return!1;const t=i.items[i.items.length-1];if(t.length>b.MAX_P2WSH_SIZE)return!1;const r=u.fromRaw(t);if(r.isPubkey()){if(i.items.length-1!=1)return!1;if(i.items[0].length>73)return!1;continue}if(r.isPubkeyhash()){if(e.witness.items.length-1!=2)return!1;if(i.items[0].length>73)return!1;if(i.items[1].length>65)return!1;continue}const[s]=r.getMultisig();if(-1!==s){if(i.items.length-1!==s+1)return!1;if(0!==i.items[0].length)return!1;for(let t=1;t<i.items.length-1;t++)if(i.items[t].length>73)return!1}}else{if(i.items.length>b.MAX_P2WSH_STACK)return!1;for(const t of i.items)if(t.length>b.MAX_P2WSH_PUSH)return!1}}return!0}checkInputs(t,e){r("number"==typeof e);let i=0;for(const{prevout:s}of this.inputs){const n=t.getEntry(s);if(!n)return[-1,"bad-txns-inputs-missingorspent",0];if(n.coinbase&&e-n.height<y.COINBASE_MATURITY)return[-1,"bad-txns-premature-spend-of-coinbase",0];const o=t.getOutput(s);if(r(o),o.value<0||o.value>y.MAX_MONEY)return[-1,"bad-txns-inputvalues-outofrange",100];if((i+=o.value)<0||i>y.MAX_MONEY)return[-1,"bad-txns-inputvalues-outofrange",100]}const s=this.getOutputValue();if(i<s)return[-1,"bad-txns-in-belowout",100];const n=i-s;return n<0?[-1,"bad-txns-fee-negative",100]:n>y.MAX_MONEY?[-1,"bad-txns-fee-outofrange",100]:[n,"valid",0]}getModifiedSize(t){null==t&&(t=this.getVirtualSize());for(const e of this.inputs){const i=41+Math.min(110,e.script.getSize());t>i&&(t-=i)}return t}getPriority(t,e,i){if(r("number"==typeof e,"Must pass in height."),this.isCoinbase())return 0;null==i&&(i=this.getVirtualSize());let s=0;for(const{prevout:i}of this.inputs){const r=t.getOutput(i);if(!r)continue;const n=t.getHeight(i);if(-1!==n&&n<=e){const t=e-n;s+=r.value*t}}return Math.floor(s/i)}getChainValue(t){if(this.isCoinbase())return 0;let e=0;for(const{prevout:i}of this.inputs){const r=t.getOutput(i);r&&-1!==t.getHeight(i)&&(e+=r.value)}return e}isFree(t,e,i){return this.getPriority(t,e,i)>b.FREE_THRESHOLD}getMinFee(t,e){return null==t&&(t=this.getVirtualSize()),b.getMinFee(t,e)}getRoundFee(t,e){return null==t&&(t=this.getVirtualSize()),b.getRoundFee(t,e)}getRate(t,e){const i=this.getFee(t);return i<0?0:(null==e&&(e=this.getVirtualSize()),b.getRate(e,i))}getPrevout(){if(this.isCoinbase())return[];const t=Object.create(null);for(const e of this.inputs)t[e.prevout.hash]=!0;return Object.keys(t)}isWatched(t){let e=!1;t.test(this.hash())&&(e=!0);for(let i=0;i<this.outputs.length;i++){const r=this.outputs[i];if(r.script.test(t)){if(t.update===w.flags.ALL){const e=g.fromTX(this,i);t.add(e.toRaw())}else if(t.update===w.flags.PUBKEY_ONLY&&(r.script.isPubkey()||r.script.isMultisig())){const e=g.fromTX(this,i);t.add(e.toRaw())}e=!0}}if(e)return e;for(const e of this.inputs){const i=e.prevout;if(t.test(i.toRaw()))return!0;if(e.script.test(t))return!0}return!1}rhash(){return s.revHex(this.hash("hex"))}rwhash(){return s.revHex(this.witnessHash("hex"))}txid(){return this.rhash()}wtxid(){return this.rwhash()}toInv(){return new m(m.types.TX,this.hash("hex"))}inspect(){return this.format()}format(t,e,i){let r=0,n=0,o=-1,a=null,c=0,u=null;return t&&(n=this.getFee(t),r=this.getRate(t),Number.isSafeInteger(r)||(r=0)),e&&(o=e.height,a=s.revHex(e.hash),c=e.time,u=s.date(c)),null==i&&(i=-1),{hash:this.txid(),witnessHash:this.wtxid(),size:this.getSize(),virtualSize:this.getVirtualSize(),value:h.btc(this.getOutputValue()),fee:h.btc(n),rate:h.btc(r),minFee:h.btc(this.getMinFee()),height:o,block:a,time:c,date:u,index:i,version:this.version,inputs:this.inputs.map(e=>{const i=t?t.getOutputFor(e):null;return e.format(i)}),outputs:this.outputs,locktime:this.locktime}}formatInsight(t,e=0){return null!=t&&void 0!=t||(t=-1),{hash:this.hash("hex"),rhash:this.txid(),witnessHash:this.wtxid(),txid:function(){return this.rhash},ps:e,index:t,version:this.version,flag:1,locktime:this.locktime,raw:this.toRaw(),inputs:this.inputs.map(t=>t.formatInsight()),outputs:this.outputs.map(t=>t.formatInsight())}}static EncodeSpenderValue(t,i,r,s){const n=e.allocUnsafe(72);return n.write(t,0,"hex"),n.writeUInt32BE(i,32,!0),n.writeUInt32BE(r,36,!0),n.write(s,40,"hex"),n}static DecodeSpenderValue(t){return r(e.isBuffer(t)),r(72===key.length),{txid:key.toString("hex",0,32),inputIndex:key.readUInt32BE(32,!0),blockHeight:key.readUInt32BE(36,!0),blockHash:key.toString("hex",40,32)}}toJSON(){return this.getJSON()}getJSON(t,e,i,r){let n,o,a,h,u,l;return e&&(o=this.getFee(e),n=this.getRate(e),Number.isSafeInteger(n)||(n=0)),i&&(a=i.height,h=s.revHex(i.hash),u=i.time,l=s.date(u)),t=c.get(t),{hash:this.txid(),witnessHash:this.wtxid(),fee:o,rate:n,mtime:s.now(),height:a,block:h,time:u,date:l,index:r,version:this.version,inputs:this.inputs.map(i=>{const r=e?e.getCoinFor(i):null;return i.getJSON(t,r)}),outputs:this.outputs.map(e=>e.getJSON(t)),locktime:this.locktime,hex:this.toRaw().toString("hex")}}fromJSON(t){r(t,"TX data is required."),r(s.isU32(t.version),"Version must be a uint32."),r(Array.isArray(t.inputs),"Inputs must be an array."),r(Array.isArray(t.outputs),"Outputs must be an array."),r(s.isU32(t.locktime),"Locktime must be a uint32."),this.version=t.version;for(const e of t.inputs)this.inputs.push(d.fromJSON(e));for(const e of t.outputs)this.outputs.push(p.fromJSON(e));return this.locktime=t.locktime,this}static fromJSON(t){return(new S).fromJSON(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new S).fromRaw(t)}static fromReader(t){return(new S).fromReader(t)}fromRaw(t){return this.fromReader(new l(t))}fromReader(t){if(function(t){return!(t.left()<6)&&0===t.data[t.offset+4]&&0!==t.data[t.offset+5]}(t))return this.fromWitnessReader(t);t.start(),this.version=t.readU32();const e=t.readVarint();for(let i=0;i<e;i++)this.inputs.push(d.fromReader(t));const i=t.readVarint();for(let e=0;e<i;e++)this.outputs.push(p.fromReader(t));return this.locktime=t.readU32(),this.mutable?t.end():(this._raw=t.endData(),this._size=this._raw.length,this._witness=0),this}fromWitnessReader(t){t.start(),this.version=t.readU32(),r(0===t.readU8(),"Non-zero marker.");let e=t.readU8();r(0!==e,"Flags byte is zero.");const i=t.readVarint();for(let e=0;e<i;e++)this.inputs.push(d.fromReader(t));const s=t.readVarint();for(let e=0;e<s;e++)this.outputs.push(p.fromReader(t));let n=0,o=!1;if(1&e){e^=1,n=t.offset;for(const e of this.inputs)e.witness.fromReader(t),e.witness.items.length>0&&(o=!0);n=t.offset-n+2}if(0!==e)throw new Error("Unknown witness flag.");if(0===this.inputs.length&&0!==this.outputs.length)throw new Error("Zero input witness tx.");return this.locktime=t.readU32(),!this.mutable&&o?(this._raw=t.endData(),this._size=this._raw.length,this._witness=n):t.end(),this}frameNormal(){const t=this.getNormalSizes(),e=new f(t.size);return this.writeNormal(e),t.data=e.render(),t}frameWitness(){const t=this.getWitnessSizes(),e=new f(t.size);return this.writeWitness(e),t.data=e.render(),t}writeNormal(t){if(0===this.inputs.length&&0!==this.outputs.length)throw new Error("Cannot serialize zero-input tx.");t.writeU32(this.version),t.writeVarint(this.inputs.length);for(const e of this.inputs)e.toWriter(t);t.writeVarint(this.outputs.length);for(const e of this.outputs)e.toWriter(t);return t.writeU32(this.locktime),t}writeWitness(t){if(0===this.inputs.length&&0!==this.outputs.length)throw new Error("Cannot serialize zero-input tx.");t.writeU32(this.version),t.writeU8(0),t.writeU8(1),t.writeVarint(this.inputs.length);for(const e of this.inputs)e.toWriter(t);t.writeVarint(this.outputs.length);for(const e of this.outputs)e.toWriter(t);const e=t.offset;for(const e of this.inputs)e.witness.toWriter(t);const i=t.offset-e;if(t.writeU32(this.locktime),i===this.inputs.length)throw new Error("Cannot serialize empty-witness tx.");return t}getNormalSizes(){let t=0;t+=4,t+=n.sizeVarint(this.inputs.length);for(const e of this.inputs)t+=e.getSize();t+=n.sizeVarint(this.outputs.length);for(const e of this.outputs)t+=e.getSize();return new x(t+=4,0)}getWitnessSizes(){let t=0,e=0;t+=4,e+=2,t+=n.sizeVarint(this.inputs.length);for(const i of this.inputs)t+=i.getSize(),e+=i.witness.getVarSize();t+=n.sizeVarint(this.outputs.length);for(const e of this.outputs)t+=e.getSize();return new x((t+=4)+e,e)}static isTX(t){return t instanceof S}}function x(t,e){this.data=null,this.size=t,this.witness=e}t.exports=S}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * peer.js - peer object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(24),n=i(3),o=i(35),a=i(412),h=i(413),c=(i(10),i(60)),u=i(39),l=i(34),f=i(204),d=i(208),p=i(206),g=(i(367),i(184)),m=i(52),w=i(17),y=(i(4),i(82)),b=i(16),v=i(45),k=i(185),S=c.services,x=u.types,E=i(94),R=E.types;i(25);class _ extends s{constructor(t){super(),this.options=t,this.network=this.options.network,this.logger=this.options.logger.context("peer"),this.locker=new l,this.parser=new a(this.network),this.framer=new h(this.network),this.id=-1,this.socket=null,this.opened=!1,this.outbound=!1,this.loader=!1,this.address=new y,this.local=new y,this.connected=!1,this.destroyed=!1,this.ack=!1,this.handshake=!1,this.time=0,this.lastSend=0,this.lastRecv=0,this.drainSize=0,this.drainQueue=[],this.banScore=0,this.invQueue=[],this.onPacket=null,this.next=null,this.prev=null,this.version=-1,this.services=0,this.height=-1,this.agent=null,this.noRelay=!1,this.preferHeaders=!1,this.hashContinue=null,this.spvFilter=null,this.feeRate=-1,this.bip151=null,this.bip150=null,this.compactMode=-1,this.compactWitness=!1,this.merkleBlock=null,this.merkleTime=-1,this.merkleMatches=0,this.merkleMap=null,this.syncing=!1,this.sentAddr=!1,this.sentGetAddr=!1,this.challenge=null,this.lastPong=-1,this.lastPing=-1,this.minPing=-1,this.blockTime=-1,this.bestHash=null,this.bestHeight=-1,this.connectTimeout=null,this.pingTimer=null,this.invTimer=null,this.stallTimer=null,this.addrFilter=new f(5e3,.001),this.invFilter=new f(5e4,1e-6),this.blockMap=new Map,this.txMap=new Map,this.responseMap=new Map,this.compactBlocks=new Map,this._init()}static fromInbound(t,e){const i=new _(t);return i.accept(e),i}static fromOutbound(t,e){const i=new _(t);return i.connect(e),i}static fromOptions(t){return new _(new A(t))}_init(){this.parser.on("packet",async t=>{try{await this.readPacket(t)}catch(e){this.logger.error("packet parse error:",t.type,t.cmd,e.message),this.error(e),this.destroy()}}),this.parser.on("error",t=>{this.destroyed||(this.error(t),this.sendReject("malformed","error parsing message"),this.increaseBan(10))})}hostname(){return this.address.hostname}framePacket(t,e,i){return this.bip151&&this.bip151.handshake?this.bip151.packet(t,e):this.framer.packet(t,e,i)}feedParser(t){return this.bip151&&this.bip151.handshake?this.bip151.feed(t):this.parser.feed(t)}setCipher(t){r(!this.bip151,"BIP151 already set."),r(this.socket,"Peer must be initialized with a socket."),r(!this.opened,"Cannot set cipher after open."),this.bip151=new d(t),this.bip151.on("error",t=>{this.error(t),this.destroy()}),this.bip151.on("rekey",()=>{this.destroyed||(this.logger.debug("Rekeying with peer (%s).",this.hostname()),this.send(this.bip151.toRekey()))}),this.bip151.on("packet",(t,e)=>{let i=null;try{i=this.parser.parsePayload(t,e)}catch(t){return void this.parser.error(t)}this.parser.emit("packet",i)})}setAuth(t,e){const i=this.bip151,s=this.hostname(),n=this.outbound;r(this.bip151,"BIP151 not set."),r(!this.bip150,"BIP150 already set."),r(this.socket,"Peer must be initialized with a socket."),r(!this.opened,"Cannot set auth after open."),this.bip150=new p(i,s,n,t,e),this.bip151.bip150=this.bip150}bind(t){r(!this.socket),this.socket=t,this.socket.once("error",t=>{this.connected&&(this.error(t),this.destroy())}),this.socket.once("close",()=>{this.error("Socket hangup."),this.destroy()}),this.socket.on("drain",()=>{this.handleDrain()}),this.socket.on("data",t=>{this.lastRecv=n.ms(),this.feedParser(t)}),this.socket.setNoDelay(!0)}accept(t){return r(!this.socket),this.address=y.fromSocket(t,this.network),this.address.services=0,this.time=n.ms(),this.outbound=!1,this.connected=!0,this.bind(t),t}connect(t){r(!this.socket);const e=this.options.createSocket(t.port,t.host);return this.address=t,this.outbound=!0,this.connected=!1,this.bind(e),e}async tryOpen(){try{await this.open()}catch(t){}}async open(){try{await this._open()}catch(t){throw this.error(t),this.destroy(),t}}async _open(){this.opened=!0,await this.initConnect(),await this.initStall(),await this.initBIP151(),await this.initBIP150(),await this.initVersion(),await this.finalize(),r(!this.destroyed),this.emit("open")}initConnect(){return this.connected?(r(!this.outbound),Promise.resolve()):new Promise((t,e)=>{const i=()=>{null!=this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=null),this.socket.removeListener("error",r)},r=t=>{i(),e(t)};this.socket.once("connect",()=>{this.time=n.ms(),this.connected=!0,this.emit("connect"),i(),t()}),this.socket.once("error",r),this.connectTimeout=setTimeout(()=>{this.connectTimeout=null,i(),e(new Error("Connection timed out."))},1e4)})}initStall(){return r(!this.stallTimer),r(!this.destroyed),this.stallTimer=setInterval(()=>{this.maybeTimeout()},_.STALL_INTERVAL),Promise.resolve()}async initBIP151(){if(r(!this.destroyed),this.bip151){r(!this.bip151.completed),this.logger.info("Attempting BIP151 handshake (%s).",this.hostname()),this.send(this.bip151.toEncinit());try{await this.bip151.wait(3e3)}catch(t){this.error(t)}if(this.destroyed)throw new Error("Peer was destroyed during BIP151 handshake.");r(this.bip151.completed),this.bip151.handshake&&(this.logger.info("BIP151 handshake complete (%s).",this.hostname()),this.logger.info("Connection is encrypted (%s).",this.hostname()))}}async initBIP150(){if(r(!this.destroyed),this.bip150){if(r(this.bip151),r(!this.bip150.completed),!this.bip151.handshake)throw new Error("BIP151 handshake was not completed for BIP150.");if(this.logger.info("Attempting BIP150 handshake (%s).",this.hostname()),this.bip150.outbound){if(!this.bip150.peerIdentity)throw new Error("No known identity for peer.");this.send(this.bip150.toChallenge())}await this.bip150.wait(3e3),r(!this.destroyed),r(this.bip150.completed),this.bip150.auth&&(this.logger.info("BIP150 handshake complete (%s).",this.hostname()),this.logger.info("Peer is authed (%s): %s.",this.hostname(),this.bip150.getAddress()))}}async initVersion(){if(r(!this.destroyed),this.sendVersion(),this.ack||(await this.wait(R.VERACK,1e4),r(this.ack)),-1===this.version&&(this.logger.debug("Peer sent a verack without a version (%s).",this.hostname()),await this.wait(R.VERSION,1e4),r(-1!==this.version)),this.destroyed)throw new Error("Peer was destroyed during handshake.");this.handshake=!0,this.logger.debug("Version handshake complete (%s).",this.hostname())}async finalize(){r(!this.destroyed),this.pingTimer=setInterval(()=>{this.sendPing()},_.PING_INTERVAL),this.invTimer=setInterval(()=>{this.flushInv()},_.INV_INTERVAL)}announceBlock(t){if(!this.handshake)return;if(this.destroyed)return;Array.isArray(t)||(t=[t]);const e=[];for(const i of t)r(i instanceof m),this.invFilter.test(i.hash())||(1!==this.compactMode?this.preferHeaders?e.push(i.toHeaders()):e.push(i.toInv()):(this.invFilter.add(i.hash()),this.sendCompactBlock(i)));this.preferHeaders?this.sendHeaders(e):this.queueInv(e)}announceTX(t){if(!this.handshake)return;if(this.destroyed)return;if(this.noRelay)return;Array.isArray(t)||(t=[t]);const e=[];for(const i of t)if(r(i instanceof w),!this.invFilter.test(i.hash())&&(!this.spvFilter||i.isWatched(this.spvFilter))){if(-1!==this.feeRate){const t=i.hash("hex"),e=this.options.getRate(t);if(-1!==e&&e<this.feeRate)continue}e.push(i.toInv())}this.queueInv(e)}queueInv(t){if(!this.handshake)return;if(this.destroyed)return;Array.isArray(t)||(t=[t]);let e=!1;for(const i of t)i.type===x.BLOCK&&(e=!0),this.invQueue.push(i);(this.invQueue.length>=500||e)&&this.flushInv()}flushInv(){if(this.destroyed)return;const t=this.invQueue;if(0===t.length)return;this.invQueue=[],this.logger.spam("Serving %d inv items to %s.",t.length,this.hostname());const e=[];for(const i of t)this.invFilter.added(i.hash,"hex")&&e.push(i);for(let t=0;t<e.length;t+=1e3){const i=e.slice(t,t+1e3);this.send(new E.InvPacket(i))}}sendInv(t){if(this.handshake&&!this.destroyed){Array.isArray(t)||(t=[t]);for(const e of t)this.invFilter.add(e.hash,"hex");if(0!==t.length){this.logger.spam("Serving %d inv items to %s.",t.length,this.hostname());for(let e=0;e<t.length;e+=1e3){const i=t.slice(e,e+1e3);this.send(new E.InvPacket(i))}}}}sendHeaders(t){if(this.handshake&&!this.destroyed){Array.isArray(t)||(t=[t]);for(const e of t)this.invFilter.add(e.hash());if(0!==t.length){this.logger.spam("Serving %d headers to %s.",t.length,this.hostname());for(let e=0;e<t.length;e+=2e3){const i=t.slice(e,e+2e3);this.send(new E.HeadersPacket(i))}}}}sendCompactBlock(t){const e=this.compactWitness,i=g.CompactBlock.fromBlock(t,e);this.send(new E.CmpctBlockPacket(i,e))}sendVersion(){const t=new E.VersionPacket;t.version=this.options.version,t.services=this.options.services,t.time=this.network.now(),t.remote=this.address,t.local.setNull(),t.local.services=this.options.services,t.nonce=this.options.createNonce(this.hostname()),t.agent=this.options.agent,t.height=this.options.getHeight(),t.noRelay=this.options.noRelay,this.send(t)}sendGetAddr(){this.sentGetAddr||(this.sentGetAddr=!0,this.send(new E.GetAddrPacket))}sendPing(){this.handshake&&(this.version<=c.PONG_VERSION?this.send(new E.PingPacket):this.challenge?this.logger.debug("Peer has not responded to ping (%s).",this.hostname()):(this.lastPing=n.ms(),this.challenge=n.nonce(),this.send(new E.PingPacket(this.challenge))))}sendFilterLoad(t){this.handshake&&this.options.spv&&this.services&S.BLOOM&&(console.log("Filter: spv send bloom filter: ",t),this.send(new E.FilterLoadPacket(t)))}sendFeeRate(t){this.handshake&&this.send(new E.FeeFilterPacket(t))}destroy(){const t=this.connected;if(this.destroyed)return;this.destroyed=!0,this.connected=!1,this.socket.destroy(),this.socket=null,this.bip151&&this.bip151.destroy(),this.bip150&&this.bip150.destroy(),null!=this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=null),null!=this.invTimer&&(clearInterval(this.invTimer),this.invTimer=null),null!=this.stallTimer&&(clearInterval(this.stallTimer),this.stallTimer=null),null!=this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=null);const e=this.drainQueue;this.drainSize=0,this.drainQueue=[];for(const t of e)t.reject(new Error("Peer was destroyed."));for(const[t,e]of this.responseMap)this.responseMap.delete(t),e.reject(new Error("Peer was destroyed."));this.locker.destroy(),this.emit("close",t)}write(t){if(this.destroyed)throw new Error("Peer is destroyed (write).");this.lastSend=n.ms(),!1===this.socket.write(t)&&this.needsDrain(t.length)}send(t){if(this.destroyed)throw new Error("Peer is destroyed (send).");let e=null;if(t.type===R.TX){const i=t.tx;t.witness?i.isCoinbase()||(e=i.witnessHash()):e=i.hash()}this.sendRaw(t.cmd,t.toRaw(),e),this.addTimeout(t)}sendRaw(t,e,i){const r=this.framePacket(t,e,i);this.write(r)}drain(){return this.destroyed?Promise.reject(new Error("Peer is destroyed.")):0===this.drainSize?Promise.resolve():new Promise((t,e)=>{this.drainQueue.push(o.job(t,e))})}handleDrain(){const t=this.drainQueue;if(this.drainSize=0,0!==t.length){this.drainQueue=[];for(const e of t)e.resolve()}}needsDrain(t){this.drainSize+=t,this.drainSize>=_.DRAIN_MAX&&(this.logger.warning("Peer is not reading: %dmb buffered (%s).",n.mb(this.drainSize),this.hostname()),this.error("Peer stalled (drain)."),this.destroy())}addTimeout(t){const e=_.RESPONSE_TIMEOUT;if(this.outbound)switch(t.type){case R.MEMPOOL:this.request(R.INV,e);break;case R.GETBLOCKS:this.options.isFull()||this.request(R.INV,e);break;case R.GETHEADERS:this.request(R.HEADERS,2*e);break;case R.GETDATA:this.request(R.DATA,2*e);break;case R.GETBLOCKTXN:this.request(R.BLOCKTXN,e)}}fulfill(t){switch(t.type){case R.BLOCK:case R.CMPCTBLOCK:case R.MERKLEBLOCK:case R.TX:case R.NOTFOUND:{const e=this.response(R.DATA,t);r(!e||0===e.jobs.length);break}}return this.response(t.type,t)}maybeTimeout(){const t=n.ms();for(const[e,i]of this.responseMap)if(t>i.timeout){const t=E.typesByVal[e];return this.error("Peer is stalling (%s).",t.toLowerCase()),void this.destroy()}if(this.merkleBlock&&(r(-1!==this.merkleTime),t>this.merkleTime+_.BLOCK_TIMEOUT))return this.error("Peer is stalling (merkleblock)."),void this.destroy();if(this.syncing&&this.loader&&!this.options.isFull()&&t>this.blockTime+_.BLOCK_TIMEOUT)return this.error("Peer is stalling (block)."),void this.destroy();if(this.options.isFull()||!this.syncing){for(const e of this.blockMap.values())if(t>e+_.BLOCK_TIMEOUT)return this.error("Peer is stalling (block)."),void this.destroy();for(const e of this.txMap.values())if(t>e+_.TX_TIMEOUT)return this.error("Peer is stalling (tx)."),void this.destroy();for(const e of this.compactBlocks.values())if(t>e.now+_.RESPONSE_TIMEOUT)return this.error("Peer is stalling (blocktxn)."),void this.destroy()}if(t>this.time+6e4){if(r(0!==this.time),0===this.lastRecv||0===this.lastSend)return this.error("Peer is stalling (no message)."),void this.destroy();if(t>this.lastSend+_.TIMEOUT_INTERVAL)return this.error("Peer is stalling (send)."),void this.destroy();const e=this.version<=c.PONG_VERSION?4:1;if(t>this.lastRecv+_.TIMEOUT_INTERVAL*e)return this.error("Peer is stalling (recv)."),void this.destroy();if(this.challenge&&t>this.lastPing+_.TIMEOUT_INTERVAL)return this.error("Peer is stalling (ping)."),void this.destroy()}}request(t,e){if(this.destroyed)return null;let i=this.responseMap.get(t);return i||(i=new I,this.responseMap.set(t,i)),i.setTimeout(e),i}response(t,e){const i=this.responseMap.get(t);return i?(this.responseMap.delete(t),i):null}wait(t,e){return new Promise((i,r)=>{if(this.destroyed)return void r(new Error("Peer is destroyed (request)."));const s=this.request(t);s.setTimeout(e),s.addJob(i,r)})}error(t){if(!this.destroyed){if("string"==typeof t){const e=n.fmt.apply(n,arguments);(t=new Error(e)).message+=` (${this.hostname()})`}if("string"==typeof t.code&&"E"===t.code[0]){const e=t.code;(t=new Error(e)).code=e,t.message=`Socket Error: ${e} (${this.hostname()})`}this.emit("error",t)}}blockType(){return this.options.spv?x.FILTERED_BLOCK:this.options.compact&&this.hasCompactSupport()&&this.hasCompact()?x.CMPCT_BLOCK:this.hasWitness()?x.WITNESS_BLOCK:x.BLOCK}txType(){return this.hasWitness()?x.WITNESS_TX:x.TX}getData(t){this.send(new E.GetDataPacket(t))}getItems(t,e){const i=[];for(const r of e)i.push(new u(t,r));0!==i.length&&this.getData(i)}getBlock(t){this.getItems(this.blockType(),t)}getTX(t){this.getItems(this.txType(),t)}getFullBlock(t){r(!this.options.spv);let e=x.BLOCK;this.hasWitness()&&(e|=u.WITNESS_FLAG),this.getItems(e,[t])}async readPacket(t){if(!this.destroyed)switch(t.type){case R.ENCINIT:case R.ENCACK:case R.AUTHCHALLENGE:case R.AUTHREPLY:case R.AUTHPROPOSE:case R.PONG:try{this.socket.pause(),await this.handlePacket(t)}finally{this.destroyed||this.socket.resume()}break;default:{const e=await this.locker.lock();try{this.socket.pause(),await this.handlePacket(t)}finally{this.destroyed||this.socket.resume(),e()}break}}}async handlePacket(t){if(this.destroyed)throw new Error("Destroyed peer sent a packet.");this.bip151&&this.bip151.job&&!this.bip151.completed&&t.type!==R.ENCINIT&&t.type!==R.ENCACK&&this.bip151.reject(new Error("Message before BIP151 handshake.")),this.bip150&&this.bip150.job&&!this.bip150.completed&&t.type!==R.AUTHCHALLENGE&&t.type!==R.AUTHREPLY&&t.type!==R.AUTHPROPOSE&&this.bip150.reject(new Error("Message before BIP150 auth."));const e=this.fulfill(t);await t.peerHandle(this),this.onPacket&&await this.onPacket(t),this.emit("packet",t),e&&e.resolve(t)}sendGetHeaders(t,e){const i=new E.GetHeadersPacket(t,e);let r=null;i.locator.length>0&&(r=n.revHex(i.locator[0]));let s=null;e&&(s=n.revHex(e)),this.logger.debug("Requesting headers packet from peer with getheaders (%s).",this.hostname()),this.logger.debug("Sending getheaders (hash=%s, stop=%s).",r,s),this.send(i)}sendGetBlocks(t,e){const i=new E.GetBlocksPacket(t,e);let r=null;i.locator.length>0&&(r=n.revHex(i.locator[0]));let s=null;e&&(s=n.revHex(e)),this.logger.debug("Requesting inv packet from peer with getblocks (%s).",this.hostname()),this.logger.debug("Sending getblocks (hash=%s, stop=%s).",r,s),this.send(i)}sendMempool(){this.handshake&&(this.services&S.BLOOM?(this.logger.debug("Requesting inv packet from peer with mempool (%s).",this.hostname()),this.send(new E.MempoolPacket)):this.logger.debug("Cannot request mempool for non-bloom peer (%s).",this.hostname()))}sendReject(t,e,i,r){const s=E.RejectPacket.fromReason(t,e,i,r);i?this.logger.debug("Rejecting %s %s (%s): code=%s reason=%s.",i,n.revHex(r),this.hostname(),t,e):this.logger.debug("Rejecting packet from %s: code=%s reason=%s.",this.hostname(),t,e),this.logger.debug("Sending reject packet to peer (%s).",this.hostname()),this.send(s)}sendCompact(t){if(this.services&c.services.WITNESS&&this.version>=c.COMPACT_WITNESS_VERSION)return this.logger.info("Initializing witness compact blocks (%s).",this.hostname()),void this.send(new E.SendCmpctPacket(t,2));this.version>=c.COMPACT_VERSION&&(this.logger.info("Initializing normal compact blocks (%s).",this.hostname()),this.send(new E.SendCmpctPacket(t,1)))}increaseBan(t){return this.banScore+=t,this.banScore>=this.options.banScore&&(this.logger.debug("Ban threshold exceeded (%s).",this.hostname()),this.ban(),!0)}ban(){this.emit("ban")}reject(t,e){return this.sendReject(e.code,e.reason,t,e.hash),this.increaseBan(e.score)}hasServices(t){return(this.services&t)===t}hasWitness(){return 0!=(this.services&S.WITNESS)}hasCompactSupport(){return!(this.version<c.COMPACT_VERSION)&&(!this.options.hasWitness()||!!(this.services&S.WITNESS)&&this.version>=c.COMPACT_WITNESS_VERSION)}hasCompact(){return!(-1===this.compactMode||this.options.hasWitness()&&!this.compactWitness)}inspect(){return"<Peer:"+` handshake=${this.handshake}`+` host=${this.hostname()}`+` outbound=${this.outbound}`+` ping=${this.minPing}`+">"}}_.DRAIN_MAX=10<<20,_.STALL_INTERVAL=5e3,_.PING_INTERVAL=3e4,_.INV_INTERVAL=5e3,_.RESPONSE_TIMEOUT=3e4,_.BLOCK_TIMEOUT=12e4,_.TX_TIMEOUT=12e4,_.TIMEOUT_INTERVAL=12e5;class A{constructor(t){this.network=b.primary,this.logger=v.global,this.createSocket=k.createSocket,this.version=c.PROTOCOL_VERSION,this.services=c.LOCAL_SERVICES,this.agent=c.USER_AGENT,this.noRelay=!1,this.spv=!1,this.compact=!1,this.headers=!1,this.banScore=c.BAN_SCORE,this.getHeight=A.getHeight,this.isFull=A.isFull,this.hasWitness=A.hasWitness,this.createNonce=A.createNonce,this.hasNonce=A.hasNonce,this.getRate=A.getRate,t&&this.fromOptions(t)}fromOptions(t){return r(t,"Options are required."),null!=t.network&&(this.network=b.get(t.network)),null!=t.logger&&(r("object"==typeof t.logger),this.logger=t.logger),null!=t.createSocket&&(r("function"==typeof t.createSocket),this.createSocket=t.createSocket),null!=t.version&&(r("number"==typeof t.version),this.version=t.version),null!=t.services&&(r("number"==typeof t.services),this.services=t.services),null!=t.agent&&(r("string"==typeof t.agent),this.agent=t.agent),null!=t.noRelay&&(r("boolean"==typeof t.noRelay),this.noRelay=t.noRelay),null!=t.spv&&(r("boolean"==typeof t.spv),this.spv=t.spv),null!=t.compact&&(r("boolean"==typeof t.compact),this.compact=t.compact),null!=t.headers&&(r("boolean"==typeof t.headers),this.headers=t.headers),null!=t.banScore&&(r("number"==typeof t.banScore),this.banScore=t.banScore),null!=t.getHeight&&(r("function"==typeof t.getHeight),this.getHeight=t.getHeight),null!=t.isFull&&(r("function"==typeof t.isFull),this.isFull=t.isFull),null!=t.hasWitness&&(r("function"==typeof t.hasWitness),this.hasWitness=t.hasWitness),null!=t.createNonce&&(r("function"==typeof t.createNonce),this.createNonce=t.createNonce),null!=t.hasNonce&&(r("function"==typeof t.hasNonce),this.hasNonce=t.hasNonce),null!=t.getRate&&(r("function"==typeof t.getRate),this.getRate=t.getRate),this}static fromOptions(t){return(new A).fromOptions(t)}static getHeight(){return 0}static isFull(){return!1}static hasWitness(){return!0}static createNonce(t){return n.nonce()}static hasNonce(t){return!1}static getRate(t){return-1}}class I{constructor(){this.timeout=0,this.jobs=[]}addJob(t,e){this.jobs.push(o.job(t,e))}setTimeout(t){this.timeout=n.ms()+t}reject(t){for(const e of this.jobs)e.reject(t);this.jobs.length=0}resolve(t){for(const e of this.jobs)e.resolve(t);this.jobs.length=0}}t.exports=_},function(t,e,i){"use strict";
/*!
 * pool.js - peer management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(59),n=i(3),o=i(48),a=i(35),h=i(60),c=(i(65),i(26)),u=(i(52),i(206)),l=i(367),f=i(208),d=(i(184),i(79)),p=i(204),g=i(30),m=i(34),w=i(18),y=i(427),b=i(186),v=i(428),k=i(429),S=i(39),x=i(94),E=h.services,R=S.types,_=(x.types,v.scores),{UnknownPacket:A}=i(94),I=i(557),O=i(558),C=i(560),P=(i(25),i(430));i(144),i(213);class B extends s{constructor(t){super(),this.options=new O(t),this.node=this.options.node,this.chain=this.options.chain,this.mempool=this.options.mempool,this.network=this.options.network,this.logger=this.options.logger.context("net"),this.server=this.options.createServer(),this.nonces=this.options.nonces,this.locker=new m(!0),this.connected=!1,this.disconnecting=!1,this.syncing=!1,this.spvFilter=null,this.txFilter=null,this.blockMap=new Set,this.txMap=new Set,this.compactBlocks=new Set,this.invMap=new Map,this.pendingFilter=null,this.pendingRefill=null,this.resetCheckpoint(),this.peers=new C,this.authdb=new l(this.options),this.hosts=new v(this.options),this.id=0,this.options.spv&&(this.spvFilter=d.fromRate(2e4,.001,d.flags.ALL)),this.options.mempool||(this.txFilter=new p(5e4,1e-6)),this._init()}getInv(t){return this.invMap.get(t)}setInv(t,e){this.invMap.set(t,e)}delInv(t){this.invMap.delete(t)}hasInv(t){return this.invMap.has(t)}invList(){return this.invMap.values()}_init(){this.server.on("error",t=>{this.emit("error",t)}),this.server.on("connection",t=>{this.handleSocket(t),this.emit("connection",t)}),this.server.on("listening",()=>{const t=this.server.address();this.logger.info("Pool server listening on %s (port=%d).",t.address,t.port),this.emit("listening",t)}),this.chain.on("block",(t,e)=>{this.emit("block",t,e)}),this.chain.on("chain.reset",()=>{this.checkpoints&&this.resetChain(),this.forceSync()}),this.chain.on("chain.full",()=>{this.sync(),this.emit("chain.full"),this.node.emit("chain.full"),this.logger.info("Chain is fully synced (height=%d).",this.chain.height)}),this.chain.on("orphan.bad",(t,e)=>{this.handleBadOrphan("block",t,e)}),this.options.selfish||this.options.spv||this.chain.on("block",t=>{this.chain.synced&&this.announceBlock(t)}),this.mempool&&(this.mempool.on("tx",t=>{this.emit("tx",t)}),this.mempool.on("orphan.bad",(t,e)=>{this.handleBadOrphan("tx",t,e)}),this.options.selfish||this.options.spv||this.mempool.on("tx",t=>{this.announceTX(t)}))}async _open(){if(this.mempool?await this.mempool.open():await this.chain.open(),this.logger.info("Pool loaded (maxpeers=%d).",this.options.maxOutbound),this.options.bip150){const t=g.publicKeyCreate(this.options.identityKey,!0);this.logger.info("Identity public key: %s.",t.toString("hex")),this.logger.info("Identity address: %s.",u.address(t))}this.resetChain()}resetChain(){if(!this.options.checkpoints)return;this.resetCheckpoint();const t=this.chain.tip;this.network.lastCheckpoint&&t.height<this.network.lastCheckpoint&&(this.checkpoints=!0,this.headerTip=this.getNextTip(t.height),this.headerChain.push(new P(t.hash,t.height)),this.logger.info("Initialized header chain to height %d (checkpoint=%s).",t.height,n.revHex(this.headerTip.hash)))}resetCheckpoint(){this.checkpoints=!1,this.headerNext=null,this.headerTip=null,this.headerChain?this.headerChain.reset():this.headerChain=new b}async _close(){await this.disconnect()}async connect(){const t=await this.locker.lock();try{return await this._connect()}finally{t()}}async _connect(){r(this.loaded,"Pool is not loaded."),this.connected||(await this.hosts.open(),await this.authdb.open(),await this.discoverGateway(),await this.discoverExternal(),await this.discoverSeeds(),this.fillOutbound(),await this.listen(),this.startTimer(),this.connected=!0)}async disconnect(){const t=await this.locker.lock();try{return await this._disconnect()}finally{t()}}async _disconnect(){if(r(this.loaded,"Pool is not loaded."),this.connected){this.disconnecting=!0;for(const t of this.invList())t.resolve();this.peers.destroy(),this.blockMap.clear(),this.txMap.clear(),null!=this.pendingFilter&&(clearTimeout(this.pendingFilter),this.pendingFilter=null),null!=this.pendingRefill&&(clearTimeout(this.pendingRefill),this.pendingRefill=null),this.resetCheckpoint(),this.stopTimer(),await this.authdb.close(),await this.hosts.close(),await this.unlisten(),this.disconnecting=!1,this.syncing=!1,this.connected=!1}}async listen(){r(this.server),r(!this.connected,"Already listening."),this.options.listen&&(this.server.maxConnections=this.options.maxInbound,await this.server.listen(this.options.port,this.options.host))}async unlisten(){r(this.server),r(this.connected,"Not listening."),this.options.listen&&await this.server.close()}startTimer(){r(null==this.timer,"Timer already started."),this.timer=a.setInterval(this.discover,B.DISCOVERY_INTERVAL,this)}stopTimer(){r(null!=this.timer,"Timer already stopped."),a.clearInterval(this.timer),this.timer=null}async discover(){await this.discoverGateway(),await this.discoverSeeds(!0)}async discoverGateway(){const t=this.options.publicPort,e=this.options.port;if(!this.options.listen)return!1;if(!this.options.upnp)return!1;let i,r;try{this.logger.debug("Discovering internet gateway (upnp)."),i=await k.discover()}catch(t){return this.logger.debug("Could not discover internet gateway (upnp)."),this.logger.debug(t),!1}try{r=await i.getExternalIP()}catch(t){return this.logger.debug("Could not find external IP (upnp)."),this.logger.debug(t),!1}this.hosts.addLocal(r,t,_.UPNP)&&this.logger.info("External IP found (upnp): %s.",r),this.logger.debug("Adding port mapping %d->%d.",t,e);try{await i.addPortMapping(r,t,e)}catch(t){return this.logger.debug("Could not add port mapping (upnp)."),this.logger.debug(t),!1}return!0}async discoverSeeds(t){if(0===this.hosts.dnsSeeds.length)return;const e=Math.min(2,this.options.maxOutbound),i=this.hosts.size();let r=0;for(let t=this.peers.head();t&&!(t.outbound&&t.connected&&++r>e);t=t.next);(0===i||t&&r<e)&&(this.logger.warning("Could not find enough peers."),this.logger.warning("Hitting DNS seeds..."),await this.hosts.discoverSeeds(),this.logger.info("Resolved %d hosts from DNS seeds.",this.hosts.size()-i),this.refill())}async discoverExternal(){const t=this.options.publicPort;if(!this.options.listen)return;if(this.options.proxy)return;if(this.hosts.local.size>0)return;let e,i;try{e=await y.getIPv4()}catch(t){this.logger.debug("Could not find external IPv4 (http)."),this.logger.debug(t)}e&&this.hosts.addLocal(e,t,_.HTTP)&&this.logger.info("External IPv4 found (http): %s.",e);try{i=await y.getIPv6()}catch(t){this.logger.debug("Could not find external IPv6 (http)."),this.logger.debug(t)}i&&this.hosts.addLocal(i,t,_.HTTP)&&this.logger.info("External IPv6 found (http): %s.",i)}handleSocket(t){if(!t.remoteAddress)return this.logger.debug("Ignoring disconnected peer."),void t.destroy();const e=o.normalize(t.remoteAddress);if(this.peers.inbound>=this.options.maxInbound)return this.logger.debug("Ignoring peer: too many inbound (%s).",e),void t.destroy();if(this.hosts.isBanned(e))return this.logger.debug("Ignoring banned peer (%s).",e),void t.destroy();const i=o.toHostname(e,t.remotePort);r(!this.peers.map[i],"Port collision."),this.addInbound(t)}addLoader(){if(!this.loaded)return;r(!this.peers.load);for(let t=this.peers.head();t;t=t.next)if(t.outbound)return this.logger.info("Repurposing peer for loader (%s).",t.hostname()),void this.setLoader(t);const t=this.getHost();if(!t)return;const e=this.createOutbound(t);this.logger.info("Adding loader peer (%s).",e.hostname()),this.peers.add(e),this.setLoader(e)}setLoader(t){this.loaded&&(r(t.outbound),r(!this.peers.load),r(!t.loader),t.loader=!0,this.peers.load=t,this.sendSync(t),this.emit("loader",t))}getLoader(){return this.peers.load}sendPacket(t){let e=this.getLoader();e&&e.send(t)}startSync(){this.loaded&&(r(this.connected,"Pool is not connected!"),this.syncing=!0,this.resync(!1))}forceSync(){this.loaded&&(r(this.connected,"Pool is not connected!"),this.resync(!0))}sync(t=!1){this.resync(t)}stopSync(){if(this.syncing){this.syncing=!1;for(let t=this.peers.head();t;t=t.next)t.outbound&&t.syncing&&(t.syncing=!1,t.merkleBlock=null,t.merkleTime=-1,t.merkleMatches=0,t.merkleMap=null,t.blockTime=-1,t.blockMap.clear(),t.compactBlocks.clear());this.blockMap.clear(),this.compactBlocks.clear()}}async resync(t){if(!this.syncing)return;let e;try{e=await this.chain.getLocator()}catch(t){return void this.emit("error",t)}for(let i=this.peers.head();i;i=i.next)i.outbound&&(!t&&i.syncing||this.sendLocator(e,i))}isSyncable(t){return!(!this.syncing||t.destroyed||!t.handshake||!(t.services&E.NETWORK)||this.options.hasWitness()&&!t.hasWitness()||!t.loader&&!this.chain.synced)}async sendSync(t){if(t.syncing)return!1;if(!this.isSyncable(t))return!1;let e;t.syncing=!0,t.blockTime=n.ms();try{e=await this.chain.getLocator()}catch(e){return t.syncing=!1,t.blockTime=-1,this.emit("error",e),!1}return this.sendLocator(e,t)}sendLocator(t,e){return!!this.isSyncable(e)&&(this.network.requestMempool&&e.loader&&this.chain.synced&&e.sendMempool(),e.syncing=!0,e.blockTime=n.ms(),this.checkpoints?e.sendGetHeaders(t,this.headerTip.hash):e.sendGetBlocks(t),!0)}sendMempool(){for(let t=this.peers.head();t;t=t.next)t.sendMempool()}sendGetAddr(){for(let t=this.peers.head();t;t=t.next)t.sendGetAddr()}resolveHeaders(t){const e=[];for(let t=this.headerNext;t&&(this.headerNext=t.next,e.push(t.hash),5e4!==e.length);t=t.next);this.getBlock(t,e)}resolveHeight(t,e){let i=0;for(let r=this.peers.head();r;r=r.next)r.bestHash===t&&r.bestHeight!==e&&(r.bestHeight=e,i++);i>0&&this.logger.debug("Resolved height for %d peers.",i)}getNextTip(t){for(const e of this.network.checkpoints)if(e.height>t)return new P(e.hash,e.height);throw new Error("Next checkpoint not found.")}announceList(t){const e=[],i=[];for(const t of this.invList())switch(t.type){case R.BLOCK:e.push(t.msg);break;case R.TX:i.push(t.msg);break;default:r(!1,"Bad item type.")}e.length>0&&t.announceBlock(e),i.length>0&&t.announceTX(i)}getBroadcasted(t,e){const i=e.isTX()?R.TX:R.BLOCK,r=this.getInv(e.hash);return r?i!==r.type?(this.logger.debug("Peer requested item with the wrong type (%s).",t.hostname()),null):(this.logger.debug("Peer requested %s %s as a %s packet (%s).",e.isTX()?"tx":"block",e.rhash(),e.hasWitness()?"witness":"normal",t.hostname()),r.handleAck(t),r.msg):null}async getItem(t,e){return this.getBroadcasted(t,e)||(this.options.selfish?null:e.isTX()?this.mempool?this.mempool.getTX(e.hash):null:this.chain.options.spv?null:this.chain.options.prune?null:await this.chain.getBlock(e.hash))}async sendBlock(t,e,i){const r=this.getBroadcasted(t,e);if(r)return t.send(new x.BlockPacket(r,i)),!0;if(this.options.selfish||this.chain.options.spv||this.chain.options.prune)return!1;if(i||!this.options.hasWitness()){const i=await this.chain.getRawBlock(e.hash);return!!i&&(t.sendRaw("block",i),!0)}const s=await this.chain.getBlock(e.hash);return!!s&&(t.send(new x.BlockPacket(s,i)),!0)}createOutbound(t){const e=f.ciphers.CHACHAPOLY,i=this.options.identityKey,r=w.fromOutbound(this.options,t);return this.hosts.markAttempt(t.hostname),this.options.bip151&&r.setCipher(e),this.options.bip150&&r.setAuth(this.authdb,i),this.bindPeer(r),this.logger.debug("Connecting to %s.",r.hostname()),r.tryOpen(),r}createInbound(t){const e=f.ciphers.CHACHAPOLY,i=this.options.identityKey,r=w.fromInbound(this.options,t);return this.options.bip151&&r.setCipher(e),this.options.bip150&&r.setAuth(this.authdb,i),this.bindPeer(r),r.tryOpen(),r}uid(){const t=Number.MAX_SAFE_INTEGER;this.id>=t-this.peers.size()-1&&(this.id=0);do{this.id+=1}while(this.peers.find(this.id));return this.id}bindPeer(t){t.id=this.uid(),t.onPacket=(e=>this.handlePacket(t,e)),t.on("error",t=>{this.logger.debug(t)}),t.once("connect",()=>{this.handleConnect(t)}),t.once("open",()=>{this.handleOpen(t)}),t.once("close",e=>{this.handleClose(t,e)}),t.once("ban",()=>{this.handleBan(t)})}async handlePacket(t,e){await e.poolHandle(t,this),this.emit("packet",e,t)}async handleConnect(t){this.logger.info("Connected to %s.",t.hostname()),t.outbound&&this.hosts.markSuccess(t.hostname()),this.emit("peer connect",t)}async handleOpen(t){if(!this.options.selfish&&this.options.listen){const e=this.hosts.getLocal(t.address);e&&t.send(new x.AddrPacket([e]))}this.options.compact&&t.sendCompact(this.options.blockMode),this.hosts.isFull()||t.sendGetAddr(),this.spvFilter&&t.sendFilterLoad(this.spvFilter),this.announceList(t),-1!==this.options.feeRate&&t.sendFeeRate(this.options.feeRate),t.outbound&&this.sendSync(t),t.outbound&&(this.hosts.markAck(t.hostname(),t.services),t.loader||this.peers.load&&!this.peers.load.handshake&&(r(this.peers.load.loader),this.peers.load.loader=!1,this.peers.load=null),this.peers.load||this.setLoader(t)),this.emit("peer open",t)}async handleClose(t,e){const i=t.outbound,r=t.loader,s=t.blockMap.size;this.removePeer(t),r&&(this.logger.info("Removed loader peer (%s).",t.hostname()),this.checkpoints&&this.resetChain()),this.nonces.remove(t.hostname()),this.emit("peer close",t,e),this.loaded&&(this.disconnecting||(this.chain.synced&&s>0&&(this.logger.warning("Peer disconnected with requested blocks."),this.logger.warning("Resending sync..."),this.forceSync()),i&&this.refill()))}async handleBan(t){this.ban(t.address),this.emit("ban",t)}async addBlock(t,e,i){const r=await this.locker.lock();try{return await this._addBlock(t,e,i)}finally{r()}}async _addBlock(t,e,i){if(!this.syncing)return;const r=e.hash("hex");if(!this.resolveBlock(t,r))return this.logger.warning("Received unrequested block: %s (%s).",e.rhash(),t.hostname()),void t.destroy();let s;t.blockTime=n.ms();try{s=await this.chain.add(e,i,t.id)}catch(e){if("VerifyError"===e.type)return t.reject("block",e),void this.logger.warning(e);throw e}if(!s){if(this.checkpoints)return void this.logger.warning("Peer sent orphan block with getheaders (%s).",t.hostname());const i=e.getCoinbaseHeight();return-1!==i&&(t.bestHash=r,t.bestHeight=i,this.resolveHeight(r,i)),this.logger.debug("Peer sent an orphan block. Resolving."),void await this.resolveOrphan(t,r)}this.chain.synced&&(t.bestHash=s.hash,t.bestHeight=s.height,this.resolveHeight(s.hash,s.height)),this.logStatus(e),await this.resolveChain(t,r)}async resolveChain(t,e){if(this.checkpoints&&t.loader){if(t.destroyed)throw new Error("Peer was destroyed (header chain resolution).");switch(r(this.headerChain.head),this.checkHash(e)){case-1:this.logger.warning("Header hash mismatch %s != %s (%s).",n.revHex(e),n.revHex(node.hash),t.hostname()),t.destroy();break;case 1:this.resolveHeaders(t);break;case 2:t.sendGetHeaders([e],this.headerTip.hash);break;case 3:this.logger.info("Switching to getblocks (%s).",t.hostname()),await this.getBlocks(t,e)}}}checkHash(t){const e=this.headerChain.head;let i=-1;return t!==e.hash?i=-1:e.height<this.network.lastCheckpoint?e.height===this.headerTip.height?(this.logger.info("Received checkpoint %s (%d).",n.revHex(e.hash),e.height),this.headerTip=this.getNextTip(e.height),i=2):(this.headerChain.shift(),i=1):(this.resetCheckpoint(),i=3),i}handleBadOrphan(t,e,i){const r=this.peers.find(i);r?(this.logger.debug("Punishing peer for sending a bad orphan (%s).",r.hostname()),r.reject(t,e)):this.logger.warning("Could not find offending peer for orphan: %s (%d).",n.revHex(e.hash),i)}logStatus(t){this.chain.height%20==0&&this.logger.debug("Status: time=%s height=%d progress=%s orphans=%d active=%d target=%s peers=%d",n.date(t.time),this.chain.height,(100*this.chain.getProgress()).toFixed(2)+"%",this.chain.orphanMap.size,this.blockMap.size,t.bits,this.peers.size()),this.chain.height%2e3==0&&this.logger.info("Received 2000 more blocks (height=%d, hash=%s).",this.chain.height,t.rhash())}addInbound(t){if(!this.loaded)return void t.destroy();const e=this.createInbound(t);this.logger.info("Added inbound peer (%s).",e.hostname()),this.peers.add(e)}getHost(){for(const t of this.hosts.nodes)if(!this.peers.has(t.hostname))return t;const t=this.options.getRequiredServices(),e=this.network.now();for(let i=0;i<100;i++){const r=this.hosts.getHost();if(!r)break;const s=r.addr;if(!this.peers.has(s.hostname)&&s.isValid()&&s.hasServices(t)&&(this.options.onion||!s.isOnion())&&!(i<30&&e-r.lastAttempt<600||i<50&&s.port!==this.network.port||i<95&&this.hosts.isBanned(s.host)))return r.addr}return null}getOnlineHost(){for(const t of this.hosts.nodes)if(this.peers.has(t.hostname))return t;const t=this.options.getRequiredServices(),e=this.network.now();for(let i=0;i<100;i++){const r=this.hosts.getHost();if(!r)break;const s=r.addr;if(s.isValid()&&s.hasServices(t)&&(this.options.onion||!s.isOnion())&&!(i<30&&e-r.lastAttempt<600||i<50&&s.port!==this.network.port||i<95&&this.hosts.isBanned(s.host)))return r.addr}return null}addOutbound(){if(!this.loaded)return;if(this.peers.outbound>=this.options.maxOutbound)return;if(!this.peers.load)return;const t=this.getHost();if(!t)return;const e=this.createOutbound(t);this.peers.add(e),this.emit("peer",e)}fillOutbound(){const t=this.options.maxOutbound-this.peers.outbound;if(this.peers.load||this.addLoader(),!(t<=0)){this.logger.debug("Refilling peers (%d/%d).",this.peers.outbound,this.options.maxOutbound);for(let e=0;e<t;e++)this.addOutbound()}}refill(){null==this.pendingRefill&&(this.pendingRefill=setTimeout(()=>{this.pendingRefill=null,this.fillOutbound()},3e3))}removePeer(t){this.peers.remove(t);for(const e of t.blockMap.keys())this.resolveBlock(t,e);for(const e of t.txMap.keys())this.resolveTX(t,e);for(const e of t.compactBlocks.keys())r(this.compactBlocks.has(e)),this.compactBlocks.delete(e);t.compactBlocks.clear()}ban(t){const e=this.peers.get(t.hostname);this.logger.debug("Banning peer (%s).",t.hostname),this.hosts.ban(t.host),this.hosts.remove(t.hostname),e&&e.destroy()}unban(t){this.hosts.unban(t.host)}async setFilter(t){this.options.spv&&(this.spvFilter=t,this.queueFilterLoad())}watch(t,e){this.options.spv&&(this.spvFilter.add(t,e),this.queueFilterLoad())}unwatch(){this.options.spv&&(this.spvFilter.reset(),this.queueFilterLoad())}queueFilterLoad(){this.options.spv&&null==this.pendingFilter&&(this.pendingFilter=setTimeout(()=>{this.pendingFilter=null,this.sendFilterLoad()},100))}sendFilterLoad(){if(this.options.spv){r(this.spvFilter);for(let t=this.peers.head();t;t=t.next)t.sendFilterLoad(this.spvFilter)}}watchAddress(t){const e=c.getHash(t);this.watch(e)}watchOutpoint(t){this.watch(t.toRaw())}async resolveOrphan(t,e){const i=await this.chain.getLocator(),s=this.chain.getOrphanRoot(e);r(s),t.sendGetBlocks(i,s)}async getHeaders(t,e,i){const r=await this.chain.getLocator(e);t.sendGetHeaders(r,i)}async getBlocks(t,e,i){const r=await this.chain.getLocator(e);t.sendGetBlocks(r,i)}getBlock(t,e){if(!this.loaded)return;if(!t.handshake)throw new Error("Peer handshake not complete (getdata).");if(t.destroyed)throw new Error("Peer is destroyed (getdata).");let i=n.ms();const r=[];for(const s of e)this.blockMap.has(s)||(this.blockMap.add(s),t.blockMap.set(s,i),this.chain.synced&&(i+=100),r.push(s));0!==r.length&&(this.logger.debug("Requesting %d/%d blocks from peer with getdata (%s).",r.length,this.blockMap.size,t.hostname()),t.getBlock(r))}getTX(t,e){if(!this.loaded)return;if(!t.handshake)throw new Error("Peer handshake not complete (getdata).");if(t.destroyed)throw new Error("Peer is destroyed (getdata).");let i=n.ms();const r=[];for(const s of e)this.txMap.has(s)||(this.txMap.add(s),t.txMap.set(s,i),i+=50,r.push(s));0!==r.length&&(this.logger.debug("Requesting %d/%d txs from peer with getdata (%s).",r.length,this.txMap.size,t.hostname()),t.getTX(r))}async hasBlock(t){return!!this.locker.has(t)||!!await this.chain.has(t)}hasTX(t){if(this.locker.has(t))return!0;if(this.mempool){if(this.mempool.has(t))return!0;if(this.mempool.hasReject(t))return this.logger.spam("Saw known reject of %s.",n.revHex(t)),!0}else if(!this.txFilter.added(t,"hex"))return!0;return!1}ensureTX(t,e){const i=[];for(const t of e)this.hasTX(t)||i.push(t);this.getTX(t,i)}resolveTX(t,e){return!!t.txMap.has(e)&&(t.txMap.delete(e),r(this.txMap.has(e)),this.txMap.delete(e),!0)}resolveBlock(t,e){return!!t.blockMap.has(e)&&(t.blockMap.delete(e),r(this.blockMap.has(e)),this.blockMap.delete(e),!0)}resolveItem(t,e){return e.isBlock()?this.resolveBlock(t,e.hash):!!e.isTX()&&this.resolveTX(t,e.hash)}broadcast(t){const e=t.hash("hex");let i=this.getInv(e);return i?(i.refresh(),i.announce()):((i=new I(this,t)).start(),i.announce()),new Promise((t,e)=>{i.addJob(t,e)})}announceBlock(t){for(let e=this.peers.head();e;e=e.next)e.announceBlock(t)}announceTX(t){for(let e=this.peers.head();e;e=e.next)e.announceTX(t)}}B.DISCOVERY_INTERVAL=12e4,t.exports=B},function(t,e,i){"use strict";(function(e){
/*!
 * script.js - script interpreter for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=e.alloc(0),s=i(1),n=i(134),o=i(107),a=i(77),h=i(67),c=i(57),u=i(27),l=u.opcodes,f=u.types,d=i(10),p=i(33),g=i(9),m=i(96),w=i(30),y=i(4),b=i(248),v=i(3),k=i(13),S=i(2),x=i(6),E=i(26),{OperType:R,contractStatus:_}=i(8),A=i(249),I={none:0,DropCondition:2};class O{constructor(t){this.raw=r,this.code=[],this.indicator=b.inst(0),t&&this.fromOptions(t)}createScript(t,e=f.PUBKEYHASH){switch(e){case f.PUBKEY:this.$fromPubkey(t);break;case f.PUBKEYHASH:this.$fromPubkeyhash(t);break;case f.PROPEXTEND:this.$fromPkhExtend(t);break;case f.MULTISIG:let[i,r,s]=t;this.$fromMultisig(i,r,s);break;case f.SCRIPTHASH:this.$fromScripthash(t);break;case f.NULLDATA:this.$fromNulldata(t);break;case f.WITNESS:let[n,o,a]=t;this.$fromProgram(n,o,a)}return this}static createScript(t,e=f.PUBKEYHASH){return(new O).createScript(t,e)}$fromNulldata(t){s(e.isBuffer(t)),s(t.length<=p.MAX_OP_RETURN,"Nulldata too large."),this.clear(),this.pushOp(l.OP_RETURN),this.pushData(t),this.compile()}$fromPubkey(t){s(e.isBuffer(t)&&(33===t.length||65===t.length)),this.code.length=0,this.code.push(o.fromPush(t)),this.code.push(o.fromOp(l.OP_CHECKSIG)),this.compile()}$fromPubkeyhash(t){s(e.isBuffer(t)&&20===t.length),this.code.length=0,this.code.push(o.fromOp(l.OP_DUP)),this.code.push(o.fromOp(l.OP_HASH160)),this.code.push(o.fromPush(t)),this.code.push(o.fromOp(l.OP_EQUALVERIFY)),this.code.push(o.fromOp(l.OP_CHECKSIG)),this.compile()}$fromPkhExtend(t){s(e.isBuffer(t.info)&&t.info.length<=p.MAX_OP_INFO),s(e.isBuffer(t.hash)&&20===t.hash.length),this.code.length=0,this.code.push(o.fromOp(t.opcode)),this.code.push(o.fromPush(t.info)),this.code.push(o.fromOp(l.OP_DROP)),this.code.push(o.fromOp(l.OP_DUP)),this.code.push(o.fromOp(l.OP_HASH160)),this.code.push(o.fromPush(t.hash)),this.code.push(o.fromOp(l.OP_EQUALVERIFY)),this.code.push(o.fromOp(l.OP_CHECKSIG)),this.compile()}$fromMultisig(t,e,i){s(v.isU8(t)&&v.isU8(e)),s(Array.isArray(i)),s(i.length===e,"`n` keys are required for multisig."),s(t>=1&&t<=e),s(e>=1&&e<=15),this.clear(),this.pushSmall(t);for(const t of i.slice().sort((t,e)=>t.compare(e)))this.pushData(t);this.pushSmall(e),this.pushOp(l.OP_CHECKMULTISIG),this.compile()}$fromScripthash(t){s(e.isBuffer(t)&&20===t.length),this.code.length=0,this.code.push(o.fromOp(l.OP_HASH160)),this.code.push(o.fromPush(t)),this.code.push(o.fromOp(l.OP_EQUAL)),this.compile()}$fromProgram(t,i,r){if(s(v.isU8(t)&&t>=0&&t<=16),s(e.isBuffer(i)&&i.length>=2&&i.length<=40),this.code.length=0,r){let t=e.from(JSON.stringify(r));s(e.isBuffer(t)&&t.length<=p.MAX_OP_INFO),O.OperCodeFromType[r.oper]&&(this.code.push(o.fromOp(O.OperCodeFromType[r.oper])),this.code.push(o.fromPush(t)),this.code.push(o.fromOp(l.OP_DROP)))}this.code.push(o.fromSmall(t)),this.code.push(o.fromPush(i)),this.compile()}get length(){return this.code.length}set length(t){return this.code.length=t,this.code.length}fromOptions(t){if(s(t,"Script data is required."),e.isBuffer(t))return this.fromRaw(t);if(Array.isArray(t))return this.fromArray(t);if(t.raw){if(!t.code)return this.fromRaw(t.raw);s(e.isBuffer(t.raw),"Raw must be a Buffer."),this.raw=t.raw}if(t.code){if(!t.raw)return this.fromArray(t.code);s(Array.isArray(t.code),"Code must be an array."),this.code=t.code}return this}static fromOptions(t){return(new O).fromOptions(t)}entries(){return this.code.entries()}[Symbol.iterator](){return this.code[Symbol.iterator]()}toArray(){return this.code.slice()}fromArray(t){s(Array.isArray(t)),this.clear();for(const e of t)this.push(e);return this.compile()}static fromArray(t){return(new O).fromArray(t)}toItems(){const t=[];for(const e of this.code){const i=e.toPush();if(!i)throw new Error("Non-push opcode in script.");t.push(i)}return t}fromItems(t){s(Array.isArray(t)),this.clear();for(const e of t)this.pushData(e);return this.compile()}static fromItems(t){return(new O).fromItems(t)}toStack(){return new a(this.toItems())}fromStack(t){return this.fromItems(t.items)}static fromStack(t){return(new O).fromStack(t)}clone(){return(new O).inject(this)}inject(t){return this.raw=t.raw,this.code=t.code.slice(),this}equals(t){return s(O.isScript(t)),this.raw.equals(t.raw)}compare(t){return s(O.isScript(t)),this.raw.compare(t.raw)}clear(){return this.raw=r,this.code.length=0,this}inspect(){return`<Script: ${this.toString()}>`}toString(){const t=[];for(const e of this.code)t.push(e.toFormat());return t.join(" ")}toASM(t){this.isNulldata()&&(t=!1);const e=[];for(const i of this.code)e.push(i.toASM(t));return e.join(" ")}compile(){if(0===this.code.length)return this.clear();let t=0;for(const e of this.code)t+=e.getSize();const e=new x(t);for(const t of this.code)t.toWriter(e);return this.raw=e.render(),this}toWriter(t){return t.writeVarBytes(this.raw),t}toRaw(){return this.raw}toJSON(){return this.toRaw().toString("hex")}fromJSON(t){return s("string"==typeof t,"Code must be a string."),this.fromRaw(e.from(t,"hex"))}static fromJSON(t){return(new O).fromJSON(t)}getSubscript(t){if(0===t)return this.clone();const e=new O;for(let i=t;i<this.code.length;i++){const t=this.code[i];if(-1===t.value)break;e.code.push(t)}return e.compile()}removeSeparators(){let t=!1;for(const e of this.code){if(-1===e.value)break;if(e.value===l.OP_CODESEPARATOR){t=!0;break}}if(!t)return this;const e=new O;for(const t of this.code){if(-1===t.value)break;t.value!==l.OP_CODESEPARATOR&&e.code.push(t)}return e.compile()}execute(t,e,i,r,n,o,a){if(null==e&&(e=O.flags.STANDARD_VERIFY_FLAGS),null==a&&(a=0),this.raw.length>d.MAX_SCRIPT_SIZE)throw new h("SCRIPT_SIZE");const u=[],f=[];let p=0,m=0,w=0,y=!1;e&O.flags.VERIFY_MINIMALDATA&&(y=!0);for(let b=0;b<this.code.length;b++){const v=this.code[b];if(-1===v.value)throw new h("BAD_OPCODE",v,b);if(v.data&&v.data.length>d.MAX_SCRIPT_PUSH)throw new h("PUSH_SIZE",v,b);if(v.value>l.OP_16&&++m>d.MAX_SCRIPT_OPS)throw new h("OP_COUNT",v,b);if(v.isDisabled())throw new h("DISABLED_OPCODE",v,b);if(!w||v.isBranch())if(v.data){if(y&&!v.isMinimal())throw new h("MINIMALDATA",v,b);if(t.push(v.data),t.length+f.length>d.MAX_SCRIPT_STACK)throw new h("STACK_SIZE",v,b)}else{switch(v.value){case l.OP_PROPCREATE:case l.OP_PROPEXCHANGE:case l.OP_PROPSALE:case l.OP_CPREGISTER:case l.OP_CPCHANGE:case l.OP_CONTRACTCREATE:case l.OP_COINBASE:break;case l.OP_0:t.pushInt(0);break;case l.OP_1NEGATE:t.pushInt(-1);break;case l.OP_1:case l.OP_2:case l.OP_3:case l.OP_4:case l.OP_5:case l.OP_6:case l.OP_7:case l.OP_8:case l.OP_9:case l.OP_10:case l.OP_11:case l.OP_12:case l.OP_13:case l.OP_14:case l.OP_15:case l.OP_16:t.pushInt(v.value-80);break;case l.OP_NOP:break;case l.OP_CHECKLOCKTIMEVERIFY:{if(!(e&O.flags.VERIFY_CHECKLOCKTIMEVERIFY)){if(e&O.flags.VERIFY_DISCOURAGE_UPGRADABLE_NOPS)throw new h("DISCOURAGE_UPGRADABLE_NOPS",v,b);break}if(!i)throw new h("UNKNOWN_ERROR","No TX passed in.");if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);const s=t.getNum(-1,y,5);if(s.isNeg())throw new h("NEGATIVE_LOCKTIME",v,b);const n=s.toDouble();if(!i.verifyLocktime(r,n))throw new h("UNSATISFIED_LOCKTIME",v,b);break}case l.OP_CHECKSEQUENCEVERIFY:{if(!(e&O.flags.VERIFY_CHECKSEQUENCEVERIFY)){if(e&O.flags.VERIFY_DISCOURAGE_UPGRADABLE_NOPS)throw new h("DISCOURAGE_UPGRADABLE_NOPS",v,b);break}if(!i)throw new h("UNKNOWN_ERROR","No TX passed in.");if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);const s=t.getNum(-1,y,5);if(s.isNeg())throw new h("NEGATIVE_LOCKTIME",v,b);const n=s.toDouble();if(!i.verifySequence(r,n))throw new h("UNSATISFIED_LOCKTIME",v,b);break}case l.OP_NOP1:case l.OP_NOP4:case l.OP_NOP5:case l.OP_NOP6:case l.OP_NOP7:case l.OP_NOP8:case l.OP_NOP9:case l.OP_NOP10:if(e&O.flags.VERIFY_DISCOURAGE_UPGRADABLE_NOPS)throw new h("DISCOURAGE_UPGRADABLE_NOPS",v,b);break;case l.OP_IF:case l.OP_NOTIF:{let i=!1;if(!w){if(t.length<1)throw new h("UNBALANCED_CONDITIONAL",v,b);if(1===a&&e&O.flags.VERIFY_MINIMALIF){const e=t.get(-1);if(e.length>1)throw new h("MINIMALIF");if(1===e.length&&1!==e[0])throw new h("MINIMALIF")}i=t.getBool(-1),v.value===l.OP_NOTIF&&(i=!i),t.pop()}u.push(i),i||(w+=1);break}case l.OP_ELSE:if(0===u.length)throw new h("UNBALANCED_CONDITIONAL",v,b);u[u.length-1]=!u[u.length-1],u[u.length-1]?w-=1:w+=1;break;case l.OP_ENDIF:if(0===u.length)throw new h("UNBALANCED_CONDITIONAL",v,b);u.pop()||(w-=1);break;case l.OP_VERIFY:if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);if(!t.getBool(-1))throw new h("VERIFY",v,b);t.pop();break;case l.OP_RETURN:throw new h("OP_RETURN",v,b);case l.OP_TOALTSTACK:if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);f.push(t.pop());break;case l.OP_FROMALTSTACK:if(0===f.length)throw new h("INVALID_ALTSTACK_OPERATION",v,b);t.push(f.pop());break;case l.OP_2DROP:if(t.length<2)throw new h("INVALID_STACK_OPERATION",v,b);t.pop(),t.pop();break;case l.OP_2DUP:{if(t.length<2)throw new h("INVALID_STACK_OPERATION",v,b);const e=t.get(-2),i=t.get(-1);t.push(e),t.push(i);break}case l.OP_3DUP:{if(t.length<3)throw new h("INVALID_STACK_OPERATION",v,b);const e=t.get(-3),i=t.get(-2),r=t.get(-1);t.push(e),t.push(i),t.push(r);break}case l.OP_2OVER:{if(t.length<4)throw new h("INVALID_STACK_OPERATION",v,b);const e=t.get(-4),i=t.get(-3);t.push(e),t.push(i);break}case l.OP_2ROT:{if(t.length<6)throw new h("INVALID_STACK_OPERATION",v,b);const e=t.get(-6),i=t.get(-5);t.erase(-6,-4),t.push(e),t.push(i);break}case l.OP_2SWAP:if(t.length<4)throw new h("INVALID_STACK_OPERATION",v,b);t.swap(-4,-2),t.swap(-3,-1);break;case l.OP_IFDUP:if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);if(t.getBool(-1)){const e=t.get(-1);t.push(e)}break;case l.OP_DEPTH:t.pushInt(t.length);break;case l.OP_DROP:{if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);let e=t.pop();if(this.indicator.check(I.DropCondition)){this.indicator.unSet(I.DropCondition);try{let i=JSON.parse(e.toString());new A(i,o).run(t)}catch(t){}}break}case l.OP_DUP:if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);t.push(t.get(-1));break;case l.OP_NIP:if(t.length<2)throw new h("INVALID_STACK_OPERATION",v,b);t.remove(-2);break;case l.OP_OVER:if(t.length<2)throw new h("INVALID_STACK_OPERATION",v,b);t.push(t.get(-2));break;case l.OP_PICK:case l.OP_ROLL:{if(t.length<2)throw new h("INVALID_STACK_OPERATION",v,b);const e=t.getInt(-1,y,4);if(t.pop(),e<0||e>=t.length)throw new h("INVALID_STACK_OPERATION",v,b);const i=t.get(-e-1);v.value===l.OP_ROLL&&t.remove(-e-1),t.push(i);break}case l.OP_ROT:if(t.length<3)throw new h("INVALID_STACK_OPERATION",v,b);t.swap(-3,-2),t.swap(-2,-1);break;case l.OP_SWAP:if(t.length<2)throw new h("INVALID_STACK_OPERATION",v,b);t.swap(-2,-1);break;case l.OP_TUCK:if(t.length<2)throw new h("INVALID_STACK_OPERATION",v,b);t.insert(-2,t.get(-1));break;case l.OP_SIZE:if(t.length<1)throw new h("INVALID_STACK_OPERATION",v,b);t.pushInt(t.get(-1).length);break;case l.OP_EQUAL:case l.OP_EQUALVERIFY:{if(t.length<2)throw new h("INVALID_STACK_OPERATION",v,b);const e=t.get(-2),i=t.get(-1),r=e.equals(i);if(t.pop(),t.pop(),t.pushBool(r),v.value===l.OP_EQUALVERIFY){if(!r)throw new h("EQUALVERIFY",v,b);t.pop()}break}case l.OP_1ADD:case l.OP_1SUB:case l.OP_NEGATE:case l.OP_ABS:case l.OP_NOT:case l.OP_0NOTEQUAL:{if(t.length<1)throw new h("INVALID_STACK_OPERATION",v,b);let e,i=t.getNum(-1,y,4);switch(v.value){case l.OP_1ADD:i.iaddn(1);break;case l.OP_1SUB:i.isubn(1);break;case l.OP_NEGATE:i.ineg();break;case l.OP_ABS:i.iabs();break;case l.OP_NOT:e=i.isZero(),i=c.fromBool(e);break;case l.OP_0NOTEQUAL:e=!i.isZero(),i=c.fromBool(e);break;default:s(!1,"Fatal script error.")}t.pop(),t.pushNum(i);break}case l.OP_ADD:case l.OP_SUB:case l.OP_BOOLAND:case l.OP_BOOLOR:case l.OP_NUMEQUAL:case l.OP_NUMEQUALVERIFY:case l.OP_NUMNOTEQUAL:case l.OP_LESSTHAN:case l.OP_GREATERTHAN:case l.OP_LESSTHANOREQUAL:case l.OP_GREATERTHANOREQUAL:case l.OP_MIN:case l.OP_MAX:{if(t.length<2)throw new h("INVALID_STACK_OPERATION",v,b);const e=t.getNum(-2,y,4),i=t.getNum(-1,y,4);let r,n;switch(v.value){case l.OP_ADD:r=e.iadd(i);break;case l.OP_SUB:r=e.isub(i);break;case l.OP_BOOLAND:n=e.toBool()&&i.toBool(),r=c.fromBool(n);break;case l.OP_BOOLOR:n=e.toBool()||i.toBool(),r=c.fromBool(n);break;case l.OP_NUMEQUAL:case l.OP_NUMEQUALVERIFY:n=e.eq(i),r=c.fromBool(n);break;case l.OP_NUMNOTEQUAL:n=!e.eq(i),r=c.fromBool(n);break;case l.OP_LESSTHAN:n=e.lt(i),r=c.fromBool(n);break;case l.OP_GREATERTHAN:n=e.gt(i),r=c.fromBool(n);break;case l.OP_LESSTHANOREQUAL:n=e.lte(i),r=c.fromBool(n);break;case l.OP_GREATERTHANOREQUAL:n=e.gte(i),r=c.fromBool(n);break;case l.OP_MIN:r=c.min(e,i);break;case l.OP_MAX:r=c.max(e,i);break;default:s(!1,"Fatal script error.")}if(t.pop(),t.pop(),t.pushNum(r),v.value===l.OP_NUMEQUALVERIFY){if(!t.getBool(-1))throw new h("NUMEQUALVERIFY",v,b);t.pop()}break}case l.OP_WITHIN:{if(t.length<3)throw new h("INVALID_STACK_OPERATION",v,b);const e=t.getNum(-3,y,4),i=t.getNum(-2,y,4),r=t.getNum(-1,y,4),s=i.lte(e)&&e.lt(r);t.pop(),t.pop(),t.pop(),t.pushBool(s);break}case l.OP_RIPEMD160:if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);t.push(g.ripemd160(t.pop()));break;case l.OP_SHA1:if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);t.push(g.sha1(t.pop()));break;case l.OP_SHA256:if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);t.push(g.sha256(t.pop()));break;case l.OP_HASH160:if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);t.push(g.hash160(t.pop()));break;case l.OP_HASH256:if(0===t.length)throw new h("INVALID_STACK_OPERATION",v,b);t.push(g.hash256(t.pop()));break;case l.OP_CODESEPARATOR:p=b+1;break;case l.OP_PROMISE:this.indicator.set(I.DropCondition);break;case l.OP_CHECKSIG:case l.OP_CHECKSIGVERIFY:{if(!i)throw new h("UNKNOWN_ERROR","No TX passed in.");if(t.length<2)throw new h("INVALID_STACK_OPERATION",v,b);const s=t.get(-2),o=t.get(-1),c=this.getSubscript(p);0===a&&c.findAndDelete(s),P(s,e),C(o,e,a);let u=!1;if(s.length>0){const t=s[s.length-1];u=B(i.signatureHash(r,c,n,t,a),s,o)}if(!u&&e&O.flags.VERIFY_NULLFAIL&&0!==s.length)throw new h("NULLFAIL",v,b);if(t.pop(),t.pop(),t.pushBool(u),v.value===l.OP_CHECKSIGVERIFY){if(!u)throw new h("CHECKSIGVERIFY",v,b);t.pop()}break}case l.OP_CHECKMULTISIG:case l.OP_CHECKMULTISIGVERIFY:{if(!i)throw new h("UNKNOWN_ERROR","No TX passed in.");let s=1;if(t.length<s)throw new h("INVALID_STACK_OPERATION",v,b);let o,c,u=t.getInt(-s,y,4),f=u+2;if(u<0||u>d.MAX_MULTISIG_PUBKEYS)throw new h("PUBKEY_COUNT",v,b);if((m+=u)>d.MAX_SCRIPT_OPS)throw new h("OP_COUNT",v,b);if(o=s+=1,s+=u,t.length<s)throw new h("INVALID_STACK_OPERATION",v,b);let g=t.getInt(-s,y,4);if(g<0||g>u)throw new h("SIG_COUNT",v,b);if(c=s+=1,s+=g,t.length<s)throw new h("INVALID_STACK_OPERATION",v,b);const w=this.getSubscript(p);for(let e=0;e<g;e++){const i=t.get(-c-e);0===a&&w.findAndDelete(i)}let k=!0;for(;k&&g>0;){const s=t.get(-c),h=t.get(-o);if(P(s,e),C(h,e,a),s.length>0){const t=s[s.length-1];B(i.signatureHash(r,w,n,t,a),s,h)&&(c+=1,g-=1)}o+=1,g>(u-=1)&&(k=!1)}for(;s>1;){if(!k&&e&O.flags.VERIFY_NULLFAIL&&0===f&&0!==t.get(-1).length)throw new h("NULLFAIL",v,b);f>0&&(f-=1),t.pop(),s-=1}if(t.length<1)throw new h("INVALID_STACK_OPERATION",v,b);if(e&O.flags.VERIFY_NULLDUMMY&&0!==t.get(-1).length)throw new h("SIG_NULLDUMMY",v,b);if(t.pop(),t.pushBool(k),v.value===l.OP_CHECKMULTISIGVERIFY){if(!k)throw new h("CHECKMULTISIGVERIFY",v,b);t.pop()}break}default:throw new h("BAD_OPCODE",v,b)}if(t.length+f.length>d.MAX_SCRIPT_STACK)throw new h("STACK_SIZE",v,b)}else if(t.length+f.length>d.MAX_SCRIPT_STACK)throw new h("STACK_SIZE",v,b)}if(0!==u.length)throw new h("UNBALANCED_CONDITIONAL")}findAndDelete(t){const e=o.fromPush(t);if(this.raw.length<e.getSize())return 0;let i=!1;for(const t of this.code){if(-1===t.value)break;if(t.equals(e)){i=!0;break}}if(!i)return 0;const r=[];let s=0;for(const t of this.code){if(-1===t.value)break;t.equals(e)?s+=1:r.push(t)}return this.code=r,this.compile(),s}indexOf(t){for(let e=0;e<this.code.length;e++){const i=this.code[e];if(-1===i.value)break;if(i.data&&i.data.equals(t))return e}return-1}isCode(){for(const t of this.code){if(-1===t.value)return!1;if(t.isDisabled())return!1;switch(t.value){case l.OP_RESERVED:case l.OP_NOP:case l.OP_VER:case l.OP_VERIF:case l.OP_VERNOTIF:case l.OP_RESERVED1:case l.OP_RESERVED2:case l.OP_NOP1:return!1}if(t.value>l.OP_PROPMAX)return!1}return!0}fromAddress(t,i){if("string"==typeof t&&(t=E.fromString(t)),s(t instanceof E,"Not an address."),t.isPubkeyhash()){if(i)switch(i.oper){case R.cpRegister:return this.createScript({opcode:O.opcodes.OP_CPREGISTER,hash:t.hash,info:e.from(JSON.stringify(i))},O.types.PROPEXTEND);case R.cpChange:return this.createScript({opcode:O.opcodes.OP_CPCHANGE,hash:t.hash,info:e.from(JSON.stringify(i))},O.types.PROPEXTEND);case R.propCreate:return this.createScript({opcode:O.opcodes.OP_PROPCREATE,hash:t.hash,info:e.from(JSON.stringify(i))},O.types.PROPEXTEND);case R.propExchange:return this.createScript({opcode:O.opcodes.OP_PROPEXCHANGE,hash:t.hash,info:e.from(JSON.stringify(i))},O.types.PROPEXTEND);case R.coinbase:return this.createScript({opcode:O.opcodes.OP_COINBASE,hash:t.hash,info:e.from(JSON.stringify(i))},O.types.PROPEXTEND)}return this.createScript(t.hash)}if(t.isScripthash())return this.createScript(t.hash,O.types.SCRIPTHASH);if(t.isProgram())return this.createScript([t.version,t.hash,i],O.types.WITNESS);throw new Error("Unknown address type.")}static fromAddress(t,e){return(new O).fromAddress(t,e)}fromCommitment(t,e){const i=new x(36);return i.writeU32BE(2854332909),i.writeHash(t),this.clear(),this.pushOp(l.OP_RETURN),this.pushData(i.render()),e&&this.pushData(e),this.compile()}static fromCommitment(t,e){return(new O).fromCommitment(t,e)}getRedeem(){let t=null;for(const e of this.code){if(-1===e.value)return null;if(e.value>l.OP_16)return null;t=e.data}return t?O.fromRaw(t):null}getType(){return this.isPubkey()?f.PUBKEY:this.isPubkeyhash()?f.PUBKEYHASH:this.isScripthash()?f.SCRIPTHASH:this.isWitnessPubkeyhash()?f.WITNESSPUBKEYHASH:this.isWitnessScripthash()?f.WITNESSSCRIPTHASH:this.isWitnessMasthash()?f.WITNESSMASTHASH:this.isMultisig()?f.MULTISIG:this.isNulldata()?f.NULLDATA:f.NONSTANDARD}isPubkey(t){if(t)return this.raw.length>=35&&(33===this.raw[0]||65===this.raw[0])&&this.raw[0]+2===this.raw.length&&this.raw[this.raw.length-1]===l.OP_CHECKSIG;if(2!==this.code.length)return!1;const e=this.getLength(0);return(33===e||65===e)&&this.getOp(1)===l.OP_CHECKSIG}isPromise(){return 10==this.code.length&&this.getOp(0)===l.OP_PROMISE}isPubkeyhash(t){if(t||25===this.raw.length)return 25===this.raw.length&&this.raw[0]===l.OP_DUP&&this.raw[1]===l.OP_HASH160&&20===this.raw[2]&&this.raw[23]===l.OP_EQUALVERIFY&&this.raw[24]===l.OP_CHECKSIG;let e=0;for(let t of this.code)if(t.value==l.OP_DUP){e=this.code.indexOf(t);break}return this.code.length===5+e&&this.getOp(0+e)===l.OP_DUP&&this.getOp(1+e)===l.OP_HASH160&&20===this.getLength(2+e)&&this.getOp(3+e)===l.OP_EQUALVERIFY&&this.getOp(4+e)===l.OP_CHECKSIG}isMultisig(t){if(this.code.length<4||this.code.length>19)return!1;if(this.getOp(-1)!==l.OP_CHECKMULTISIG)return!1;const e=this.getSmall(0);if(e<1)return!1;const i=this.getSmall(-2);if(i<1||e>i)return!1;if(this.code.length!==i+3)return!1;for(let e=1;e<i+1;e++){const i=this.code[e],r=i.toLength();if(33!==r&&65!==r)return!1;if(t&&!i.isMinimal())return!1}return!0}isUnknown(){return this.getType()===f.NONSTANDARD}isStandard(){const[t,e]=this.getMultisig();return-1!==t?!(e<1||e>3||t<1||t>e):this.isNulldata()?this.raw.length<=p.MAX_OP_RETURN_BYTES:this.getType()!==f.NONSTANDARD}isScripthash(){return 23===this.raw.length&&this.raw[0]===l.OP_HASH160&&20===this.raw[1]&&this.raw[22]===l.OP_EQUAL}isNulldata(t){if(0===this.code.length)return!1;if(this.getOp(0)!==l.OP_RETURN)return!1;if(1===this.code.length)return!0;if(t&&this.raw.length>p.MAX_OP_RETURN_BYTES)return!1;for(let e=1;e<this.code.length;e++){const i=this.code[e];if(-1===i.value)return!1;if(i.value>l.OP_16)return!1;if(t&&!i.isMinimal())return!1}return!0}isCommitment(){return this.raw.length>=38&&this.raw[0]===l.OP_RETURN&&36===this.raw[1]&&2854332909===this.raw.readUInt32BE(2,!0)}isWitnessPubkeyhash(){return 22===this.raw.length&&this.raw[0]===l.OP_0&&20===this.raw[1]||5==this.code.length&&this.code[2].value==l.OP_DROP&&this.code[3].value==l.OP_0&&20==this.code[4].value}getWitnessPubkeyhash(){return this.isWitnessPubkeyhash()?5==this.code.length?this.getData(4):this.getData(1):null}isWitnessScripthash(){return 34===this.raw.length&&this.raw[0]===l.OP_0&&32===this.raw[1]}getWitnessScripthash(){return this.isWitnessScripthash()?this.getData(1):null}isProgram(){if(2==this.code.length){if(this.raw.length>=4&&this.raw.length<=42&&(this.raw[0]==l.OP_0||this.raw[0]>=l.OP_1&&this.raw[0]<=l.OP_16)&&this.raw[1]+2==this.raw.length)return!0}else if(5==this.code.length&&this.raw.length>=4&&this.code[2].value==l.OP_DROP&&(this.code[3].value==l.OP_0||this.code[3].value>=l.OP_1&&this.code[3].value<=l.OP_16))return!0;return!1}isWitnessMasthash(){return 34===this.raw.length&&this.raw[0]===l.OP_1&&32===this.raw[1]}isUnspendable(){return this.raw.length>d.MAX_SCRIPT_SIZE||this.raw.length>0&&this.raw[0]===l.OP_RETURN}getSize(){return this.raw.length}getVarSize(){return y.sizeVarBytes(this.raw)}hash160(t){let e=g.hash160(this.toRaw());return"hex"===t&&(e=e.toString("hex")),e}sha256(t){let e=g.sha256(this.toRaw());return"hex"===t&&(e=e.toString("hex")),e}getPubkey(t){return this.isPubkey(t)?t?this.raw.slice(1,1+this.raw[0]):this.getData(0):null}getPromises(){return this.isPromise()?[this.getData(5),this.getData(7)]:null}getPubkeyhash(t){if(!this.isPubkeyhash(t))return null;if(t)return this.raw.slice(3,23);for(let t of this.code)if(t.value==l.OP_HASH160)return this.getData(this.code.indexOf(t)+1);return null}getMultisig(t){return this.isMultisig(t)?[this.getSmall(0),this.getSmall(-2)]:[-1,-1]}getScripthash(){return this.isScripthash()?this.getData(1):null}getNulldata(t){if(!this.isNulldata(t))return null;for(let t=1;t<this.code.length;t++){const e=this.code[t].toPush();if(e)return e}return r}getCommitment(){return this.isCommitment()?this.raw.slice(6,38):null}getProgram(){return this.isProgram()?2==this.code.length?new n(this.getSmall(0),this.getData(1)):5==this.code.length?new n(this.getSmall(3),this.getData(4)):null:null}forWitness(){if(this.isProgram())return this.clone();const t=this.getPubkey();if(t){const e=g.hash160(t);return O.createScript([0,e],O.types.WITNESS)}const e=this.getPubkeyhash();return e?O.createScript([0,e],O.types.WITNESS):O.createScript([0,this.sha256()],O.types.WITNESS)}getWitnessMasthash(){return this.isWitnessMasthash()?this.getData(1):null}getInputType(){return this.isPubkeyInput()?f.PUBKEY:this.isPubkeyhashInput()?f.PUBKEYHASH:this.isScripthashInput()?f.SCRIPTHASH:this.isMultisigInput()?f.MULTISIG:f.NONSTANDARD}isPubkeyhashInput(){if(2!==this.code.length)return!1;const t=this.getLength(0),e=this.getLength(1);return t>=9&&t<=73&&(33===e||65===e)}isUnknownInput(){return this.getInputType()===f.NONSTANDARD}isPubkeyInput(){if(1!==this.code.length)return!1;const t=this.getLength(0);return t>=9&&t<=73}isScripthashInput(){if(this.code.length<2)return!1;const t=this.getData(-1);if(!t)return!1;if(0===t.length)return!1;if(u.isSignatureEncoding(t))return!1;if(u.isKeyEncoding(t))return!1;const e=O.fromRaw(t);return!!e.isCode()&&!e.isUnspendable()&&!!this.isPushOnly()}isMultisigInput(){if(this.code.length<2)return!1;if(this.getOp(0)!==l.OP_0)return!1;if(this.getOp(1)>l.OP_PUSHDATA4)return!1;if(this.isScripthashInput())return!1;for(let t=1;t<this.code.length;t++){const e=this.getLength(t);if(e<9||e>73)return!1}return!0}getPubkeyInput(){return this.isPubkeyInput()?this.getData(0):null}getPubkeyhashInput(){return this.isPubkeyhashInput()?[this.getData(0),this.getData(1)]:[null,null]}getMultisigInput(){if(!this.isMultisigInput())return null;const t=[];for(let e=1;e<this.code.length;e++)t.push(this.getData(e));return t}getScripthashInput(){return this.isScripthashInput()?this.getData(-1):null}getCoinbaseHeight(){return O.getCoinbaseHeight(this.raw)}static getCoinbaseHeight(t){if(0===t.length)return-1;if(t[0]>=l.OP_1&&t[0]<=l.OP_16)return t[0]-80;if(t[0]>6)return-1;const e=o.fromRaw(t),i=e.toNum();return i?i.isNeg()?-1:e.equals(o.fromNum(i))?i.toDouble():-1:1}test(t){for(const e of this.code){if(-1===e.value)break;if(e.data&&0!==e.data.length){if(t.test(e.data))return!0;if(33==e.data.length&&t.test(g.hash160(e.data)))return!0}}return!1}isPushOnly(){for(const t of this.code){if(-1===t.value)return!1;if(t.value>l.OP_16)return!1}return!0}getSigops(t){let e=0,i=-1;for(const r of this.code){if(-1===r.value)break;switch(r.value){case l.OP_CHECKSIG:case l.OP_CHECKSIGVERIFY:e+=1;break;case l.OP_CHECKMULTISIG:case l.OP_CHECKMULTISIGVERIFY:t&&i>=l.OP_1&&i<=l.OP_16?e+=i-80:e+=d.MAX_MULTISIG_PUBKEYS}i=r.value}return e}getScripthashSigops(t){if(!this.isScripthash())return this.getSigops(!0);const e=t.getRedeem();return e?e.getSigops(!0):0}getWitnessSigops(t,e){let i=this.getProgram();if(!i&&this.isScripthash()){const e=t.getRedeem();e&&(i=e.getProgram())}if(!i)return 0;if(0===i.version){if(20===i.data.length)return 1;if(32===i.data.length&&e.items.length>0)return e.getRedeem().getSigops(!0)}return 0}get(t){return t<0&&(t+=this.code.length),t<0||t>=this.code.length?null:this.code[t]}pop(){return this.code.pop()||null}shift(){return this.code.shift()||null}remove(t){if(t<0&&(t+=this.code.length),t<0||t>=this.code.length)return null;const e=this.code.splice(t,1);return 0===e.length?null:e[0]}set(t,e){return t<0&&(t+=this.code.length),s(o.isOpcode(e)),s(t>=0&&t<=this.code.length),this.code[t]=e,this}push(t){return s(o.isOpcode(t)),this.code.push(t),this}unshift(t){return s(o.isOpcode(t)),this.code.unshift(t),this}insert(t,e){return t<0&&(t+=this.code.length),s(o.isOpcode(e)),s(t>=0&&t<=this.code.length),this.code.splice(t,0,e),this}getOp(t){const e=this.get(t);return e?e.value:-1}popOp(){const t=this.pop();return t?t.value:-1}shiftOp(){const t=this.shift();return t?t.value:-1}removeOp(t){const e=this.remove(t);return e?e.value:-1}setOp(t,e){return this.set(t,o.fromOp(e))}pushOp(t){return this.push(o.fromOp(t))}unshiftOp(t){return this.unshift(o.fromOp(t))}insertOp(t,e){return this.insert(t,o.fromOp(e))}getData(t){const e=this.get(t);return e?e.data:null}popData(){const t=this.pop();return t?t.data:null}shiftData(){const t=this.shift();return t?t.data:null}removeData(t){const e=this.remove(t);return e?e.data:null}setData(t,e){return this.set(t,o.fromData(e))}pushData(t){return this.push(o.fromData(t))}unshiftData(t){return this.unshift(o.fromData(t))}insertData(t,e){return this.insert(t,o.fromData(e))}getLength(t){const e=this.get(t);return e?e.toLength():-1}getPush(t){const e=this.get(t);return e?e.toPush():null}popPush(){const t=this.pop();return t?t.toPush():null}shiftPush(){const t=this.shift();return t?t.toPush():null}removePush(t){const e=this.remove(t);return e?e.toPush():null}setPush(t,e){return this.set(t,o.fromPush(e))}pushPush(t){return this.push(o.fromPush(t))}unshiftPush(t){return this.unshift(o.fromPush(t))}insertPush(t,e){return this.insert(t,o.fromPush(e))}getString(t,e){const i=this.get(t);return i?i.toString(e):null}popString(t){const e=this.pop();return e?e.toString(t):null}shiftString(t){const e=this.shift();return e?e.toString(t):null}removeString(t,e){const i=this.remove(t);return i?i.toString(e):null}setString(t,e,i){return this.set(t,o.fromString(e,i))}pushString(t,e){return this.push(o.fromString(t,e))}unshiftString(t,e){return this.unshift(o.fromString(t,e))}insertString(t,e,i){return this.insert(t,o.fromString(e,i))}getSmall(t){const e=this.get(t);return e?e.toSmall():-1}popSmall(){const t=this.pop();return t?t.toSmall():-1}shiftSmall(){const t=this.shift();return t?t.toSmall():-1}removeSmall(t){const e=this.remove(t);return e?e.toSmall():-1}setSmall(t,e){return this.set(t,o.fromSmall(e))}pushSmall(t){return this.push(o.fromSmall(t))}unshiftSmall(t){return this.unshift(o.fromSmall(t))}insertSmall(t,e){return this.insert(t,o.fromSmall(e))}getNum(t,e,i){const r=this.get(t);return r?r.toNum(e,i):null}popNum(t,e){const i=this.pop();return i?i.toNum(t,e):null}shiftNum(t,e){const i=this.shift();return i?i.toNum(t,e):null}removeNum(t,e,i){const r=this.remove(t);return r?r.toNum(e,i):null}setNum(t,e){return this.set(t,o.fromNum(e))}pushNum(t){return this.push(o.fromNum(t))}unshiftNum(t){return this.unshift(o.fromNum(t))}insertNum(t,e){return this.insert(t,o.fromNum(e))}getInt(t,e,i){const r=this.get(t);return r?r.toInt(e,i):-1}popInt(t,e){const i=this.pop();return i?i.toInt(t,e):-1}shiftInt(t,e){const i=this.shift();return i?i.toInt(t,e):-1}removeInt(t,e,i){const r=this.remove(t);return r?r.toInt(e,i):-1}setInt(t,e){return this.set(t,o.fromInt(e))}pushInt(t){return this.push(o.fromInt(t))}unshiftInt(t){return this.unshift(o.fromInt(t))}insertInt(t,e){return this.insert(t,o.fromInt(e))}getBool(t){const e=this.get(t);return!!e&&e.toBool()}popBool(){const t=this.pop();return!!t&&t.toBool()}shiftBool(){const t=this.shift();return!!t&&t.toBool()}removeBool(t){const e=this.remove(t);return!!e&&e.toBool()}setBool(t,e){return this.set(t,o.fromBool(e))}pushBool(t){return this.push(o.fromBool(t))}unshiftBool(t){return this.unshift(o.fromBool(t))}insertBool(t,e){return this.insert(t,o.fromBool(e))}getSym(t){const e=this.get(t);return e?e.toSymbol():null}popSym(){const t=this.pop();return t?t.toSymbol():null}shiftSym(){const t=this.shift();return t?t.toSymbol():null}removeSym(t){const e=this.remove(t);return e?e.toSymbol():null}setSym(t,e){return this.set(t,o.fromSymbol(e))}pushSym(t){return this.push(o.fromSymbol(t))}unshiftSym(t){return this.unshift(o.fromSymbol(t))}insertSym(t,e){return this.insert(t,o.fromSymbol(e))}fromString(t){if(s("string"==typeof t),0===(t=t.trim()).length)return this;const i=t.split(/\s+/),r=new k;for(const t of i){let i=t;v.isUpperCase(i)||(i=i.toUpperCase()),v.startsWith(i,"OP_")||(i=`OP_${i}`);const n=l[i];if(null!=n)r.writeU8(n);else{if("'"===t[0]){s("'"===t[t.length-1],"Invalid string.");const e=t.slice(1,-1),i=o.fromString(e);r.writeBytes(i.toRaw());continue}if(/^-?\d+$/.test(t)){const e=c.fromString(t,10),i=o.fromNum(e);r.writeBytes(i.toRaw());continue}s(0===t.indexOf("0x"),"Unknown opcode.");const i=t.substring(2),n=e.from(i,"hex");s(n.length===i.length/2,"Invalid hex string."),r.writeBytes(n)}}return this.fromRaw(r.render())}static fromString(t){return(new O).fromString(t)}static verifyScript(t,e,i,r,n,c,u,l){if(null==u&&(u=O.flags.STANDARD_VERIFY_FLAGS),u&O.flags.VERIFY_SIGPUSHONLY&&!t.isPushOnly())throw new h("SIG_PUSHONLY");null==l&&(l=_.None);let f,d=new a;if(t.execute(d,u,r,n,c,l,0),u&O.flags.VERIFY_P2SH&&(f=d.clone()),i.execute(d,u,r,n,c,l,0),0===d.length||!d.getBool(-1))throw new h("EVAL_FALSE");let p=!1;if(u&O.flags.VERIFY_WITNESS&&i.isProgram()){if(p=!0,0!==t.raw.length)throw new h("WITNESS_MALLEATED");O.verifyProgram(e,i,u,r,n,c,l),d.length=1}if(u&O.flags.VERIFY_P2SH&&i.isScripthash()){if(!t.isPushOnly())throw new h("SIG_PUSHONLY");if(0===(d=f).length)throw new h("EVAL_FALSE");const i=d.pop(),s=O.fromRaw(i);if(s.execute(d,u,r,n,c,l,0),0===d.length||!d.getBool(-1))throw new h("EVAL_FALSE");if(u&O.flags.VERIFY_WITNESS&&s.isProgram()){if(p=!0,!t.raw.equals(o.fromPush(i).toRaw()))throw new h("WITNESS_MALLEATED_P2SH");O.verifyProgram(e,s,u,r,n,c,l),d.length=1}}if(u&O.flags.VERIFY_CLEANSTACK&&(s(0!=(u&O.flags.VERIFY_P2SH)),1!==d.length))throw new h("CLEANSTACK");if(u&O.flags.VERIFY_WITNESS&&(s(0!=(u&O.flags.VERIFY_P2SH)),!p&&e.items.length>0))throw new h("WITNESS_UNEXPECTED")}static verifyProgram(t,e,i,r,n,o,a){const c=e.getProgram();s(c,"verifyProgram called on non-witness-program."),s(0!=(i&O.flags.VERIFY_WITNESS));const u=t.toStack();let l;if(0===c.version){if(32===c.data.length){if(0===u.length)throw new h("WITNESS_PROGRAM_WITNESS_EMPTY");const t=u.pop();if(!g.sha256(t).equals(c.data))throw new h("WITNESS_PROGRAM_MISMATCH");l=O.fromRaw(t)}else{if(20!==c.data.length)throw new h("WITNESS_PROGRAM_WRONG_LENGTH");if(2!==u.length)throw new h("WITNESS_PROGRAM_MISMATCH");l=O.createScript(c.data)}for(let t=0;t<u.length;t++)if(u.get(t).length>d.MAX_SCRIPT_PUSH)throw new h("PUSH_SIZE");if(l.execute(u,i,r,n,o,a,1),1!==u.length||!u.getBool(-1))throw new h("EVAL_FALSE")}else{if(i&O.flags.VERIFY_MAST&&1===c.version)return void O.verifyMast(c,u,e,i,r,n,a);if(i&O.flags.VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM)throw new h("DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM")}}static verifyMast(t,e,i,r,n,o,a,c){if(s(1===t.version),s(0!=(r&O.flags.VERIFY_MAST)),e.length<4)throw new h("INVALID_MAST_STACK");const u=e.get(-1);if(u.length<1||u.length>5)throw new h("INVALID_MAST_STACK");const l=u[0];if(0===l||e.length<l+3)throw new h("INVALID_MAST_STACK");let f=l,p=new k;if(p.writeU8(l),0===u[u.length-1])throw new h("INVALID_MAST_STACK");let w=0;for(let t=1;t<u.length;t++)w|=u[t]<<8*(t-1);if(w<0&&(w+=4294967296),w>0&&r&O.flags.DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM)throw new h("DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM");let y=new k;y.writeU32(w);const b=e.get(-2);if(31&b.length)throw new h("INVALID_MAST_STACK");const v=b.length>>>5;if(v>32)throw new h("INVALID_MAST_STACK");if(0===w&&(f+=v)>d.MAX_SCRIPT_OPS)throw new h("OP_COUNT");const S=[];for(let t=0;t<v;t++)S.push(b.slice(32*t,32*t+32));const x=e.get(-3);if(x.length>4)throw new h("INVALID_MAST_STACK");let E=0;if(x.length>0){if(0===x[x.length-1])throw new h("INVALID_MAST_STACK");for(let t=0;t<x.length;t++)E|=x[t]<<8*t;E<0&&(E+=4294967296)}if(v<32&&E>=1<<v>>>0)throw new h("INVALID_MAST_STACK");let R=new k;R.writeBytes(i.raw);for(let t=0;t<l;t++){const i=e.get(-(4+t));if(0===w&&R.offset+i.length>d.MAX_SCRIPT_SIZE)throw new h("SCRIPT_SIZE");p.writeBytes(g.hash256(i)),R.writeBytes(i)}if(p=g.hash256(p.render()),p=m.verifyBranch(p,S,E),y.writeBytes(p),!(y=g.hash256(y.render())).equals(t.data))throw new h("WITNESS_PROGRAM_MISMATCH");if(0===w){e.length-=3+l;for(let t=0;t<e.length;t++)if(e.get(t).length>d.MAX_SCRIPT_PUSH)throw new h("PUSH_SIZE");if(R=R.render(),(i=O.fromRaw(R)).execute(e,r,n,o,a,c,1),0!==e.length)throw new h("EVAL_FALSE")}}fromReader(t){return this.fromRaw(t.readVarBytes())}fromRaw(t){const e=new S(t,!0);for(this.raw=t;e.left();)this.code.push(o.fromReader(e));return this}static fromReader(t){return(new O).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new O).fromRaw(t)}static isScript(t){return t instanceof O}}function C(t,i,r){if(s(e.isBuffer(t)),s("number"==typeof i),s("number"==typeof r),i&O.flags.VERIFY_STRICTENC&&!u.isKeyEncoding(t))throw new h("PUBKEYTYPE");if(1===r&&i&O.flags.VERIFY_WITNESS_PUBKEYTYPE&&!u.isCompressedEncoding(t))throw new h("WITNESS_PUBKEYTYPE");return!0}function P(t,i){if(s(e.isBuffer(t)),s("number"==typeof i),0===t.length)return!0;if((i&O.flags.VERIFY_DERSIG||i&O.flags.VERIFY_LOW_S||i&O.flags.VERIFY_STRICTENC)&&!u.isSignatureEncoding(t))throw new h("SIG_DER");if(i&O.flags.VERIFY_LOW_S&&!u.isLowDER(t))throw new h("SIG_HIGH_S");if(i&O.flags.VERIFY_STRICTENC&&!u.isHashType(t))throw new h("SIG_HASHTYPE");return!0}function B(t,e,i){return w.verify(t,e.slice(0,-1),i)}O.opcodes=u.opcodes,O.opcodesByVal=u.opcodesByVal,O.flags=u.flags,O.hashType=u.hashType,O.hashTypeByVal=u.hashTypeByVal,O.types=u.types,O.typesByVal=u.typesByVal,O.TradeType={btc:1},O.OperCodeFromType={},O.OperCodeFromType[R.propCreate]=l.OP_PROPCREATE,O.OperCodeFromType[R.propExchange]=l.OP_PROPEXCHANGE,O.OperCodeFromType[R.propSale]=l.OP_PROPSALE,O.OperCodeFromType[R.coinbase]=l.OP_COINBASE,O.OperCodeFromType[R.cpRegister]=l.OP_CPREGISTER,O.OperCodeFromType[R.cpChange]=l.OP_CPCHANGE,O.OperCodeFromType[R.contractCreate]=l.OP_CONTRACTCREATE,O.OperCodeFromType[R.contractPromise]=l.OP_PROMISE,O.OperTypeFromCode={},O.OperTypeFromCode[l.OP_PROPCREATE]=R.propCreate,O.OperTypeFromCode[l.OP_PROPEXCHANGE]=R.propExchange,O.OperTypeFromCode[l.OP_PROPSALE]=R.propSale,O.OperTypeFromCode[l.OP_CPREGISTER]=R.cpRegister,O.OperTypeFromCode[l.OP_CPCHANGE]=R.cpChange,O.OperCodeFromType[l.OP_CONTRACTCREATE]=R.contractCreate,O.OperCodeFromType[l.OP_PROMISE]=R.contractPromise,t.exports=O}).call(this,i(0).Buffer)},function(t,e,i){"use strict";var r=e;r.version=i(233).version,r.utils=i(234),r.rand=i(136),r.curve=i(76),r.curves=i(240),r.ec=i(242),r.eddsa=i(245)},function(t,e,i){"use strict";
/*!
 * packetType.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */t.exports={VERSION:0,VERACK:1,PING:2,PONG:3,GETADDR:4,ADDR:5,INV:6,GETDATA:7,NOTFOUND:8,GETBLOCKS:9,GETHEADERS:10,HEADERS:11,SENDHEADERS:12,BLOCK:13,TX:14,REJECT:15,MEMPOOL:16,FILTERLOAD:17,FILTERADD:18,FILTERCLEAR:19,MERKLEBLOCK:20,FEEFILTER:21,SENDCMPCT:22,CMPCTBLOCK:23,GETBLOCKTXN:24,BLOCKTXN:25,ENCINIT:26,ENCACK:27,AUTHCHALLENGE:28,AUTHREPLY:29,AUTHPROPOSE:30,UNKNOWN:31,INTERNAL:100,DATA:101,CPLIST:201,CPLISTACK:202}},function(t,e){var i,r,s=t.exports={};function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===n||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:n}catch(t){i=n}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var h,c=[],u=!1,l=-1;function f(){u&&h&&(u=!1,h.length?c=h.concat(c):l=-1,c.length&&d())}function d(){if(!u){var t=a(f);u=!0;for(var e=c.length;e;){for(h=c,c=[];++l<e;)h&&h[l].run();l=-1,e=c.length}h=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];c.push(new p(t,e)),1!==c.length||u||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=g,s.addListener=g,s.once=g,s.off=g,s.removeListener=g,s.removeAllListeners=g,s.emit=g,s.prependListener=g,s.prependOnceListener=g,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function s(t){return"object"==typeof t&&null!==t}function n(t){return void 0===t}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,i,o,a,h,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}if(n(i=this._events[t]))return!1;if(r(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),i.apply(this,a)}else if(s(i))for(a=Array.prototype.slice.call(arguments,1),o=(c=i.slice()).length,h=0;h<o;h++)c[h].apply(this,a);return!0},i.prototype.addListener=function(t,e){var o;if(!r(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(o=n(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){if(!r(e))throw TypeError("listener must be a function");var i=!1;function s(){this.removeListener(t,s),i||(i=!0,e.apply(this,arguments))}return s.listener=e,this.on(t,s),this},i.prototype.removeListener=function(t,e){var i,n,o,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(o=(i=this._events[t]).length,n=-1,i===e||r(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(i)){for(a=o;a-- >0;)if(i[a]===e||i[a].listener&&i[a].listener===e){n=a;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r(i=this._events[t]))this.removeListener(t,i);else if(i)for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,i){"use strict";(function(e){
/*!
 * Packet.js - Base Packet
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=e.alloc(0),n=(i(2),i(13),i(207));t.exports=class{constructor(t){n[t]?(this.type=t,this.cmd=n[t]):(this.type=-1,this.cmd="")}getSize(){return 0}toWriter(t){return t}toRaw(){return s}fromReader(t){return this}fromRaw(t){return this}async poolHandle(t,e){r(!1,`Pool Get Bad packet type: ${this.type}`)}async peerHandle(t){}}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * address.js - address object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(16),n=i(4),o=i(3),a=i(9),h=i(2),c=i(6),u=i(56),l=i(189);class f{constructor(t){this.hash=n.ZERO_HASH160,this.type=f.types.PUBKEYHASH,this.version=-1,this.network=s.primary,t&&this.fromOptions(t)}fromOptions(t){return"string"==typeof t?this.fromString(t):this.fromHash(t.hash,t.type,t.version,t.network)}static fromOptions(t){return(new f).fromOptions(t)}getHash(t){return"hex"===t?this.hash.toString(t):this.hash}isNull(){if(20===this.hash.length)return this.hash.equals(n.ZERO_HASH160);if(32===this.hash.length)return this.hash.equals(n.ZERO_HASH);for(let t=0;t<this.hash.length;t++)if(0!==this.hash[t])return!1;return!0}equals(t){return r(t instanceof f),this.network===t.network&&this.type===t.type&&this.version===t.version&&this.hash.equals(t.hash)}getType(){return f.typesByVal[this.type].toLowerCase()}getPrefix(t){t||(t=this.network);const e=(t=s.get(t)).addressPrefix;switch(this.type){case f.types.PUBKEYHASH:return e.pubkeyhash;case f.types.SCRIPTHASH:return e.scripthash;case f.types.WITNESS:if(20===this.hash.length)return e.witnesspubkeyhash;if(32===this.hash.length)return e.witnessscripthash}return-1}getSize(){let t=5+this.hash.length;return-1!==this.version&&(t+=2),t}toRaw(t){const e=this.getSize(),i=new c(e),s=this.getPrefix(t);return r(-1!==s,"Not a valid address prefix."),i.writeU8(s),-1!==this.version&&(i.writeU8(this.version),i.writeU8(0)),i.writeBytes(this.hash),i.writeChecksum(),i.render()}toBase58(t){return u.encode(this.toRaw(t))}toBech32(t){const e=this.version,i=this.hash;r(-1!==e,"Cannot convert non-program address to bech32."),t||(t=this.network);const n=(t=s.get(t)).addressPrefix.bech32;return l.encode(n,e,i)}fromString(t,e){if(r("string"==typeof t),r(t.length>0),r(t.length<=100),function(t){let e=!1,i=!1;for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);if(!(n>=48&&n<=57)&&(32&n?(r(n>=97&&n<=122),e=!0):(r(n>=65&&n<=90),i=!0),e&&i))return!0}return!1}(t))return this.fromBase58(t,e);try{return this.fromBech32(t,e)}catch(i){return this.fromBase58(t,e)}}static fromString(t,e){return(new f).fromString(t,e)}toString(t){return-1!==this.version?this.toBech32(t):this.toBase58(t)}fromBase58(t,e){if(r("string"==typeof t),t.length>55)throw new Error("Address is too long.");return this.fromRaw(u.decode(t),e)}fromBech32(t,e){r("string"==typeof t);const i=f.types.WITNESS,n=l.decode(t);return e=s.fromBech32(n.hrp,e),this.fromHash(n.hash,i,n.version,e)}static fromBech32(t,e){return(new f).fromBech32(t,e)}static fromBase58(t,e){return(new f).fromBase58(t,e)}inspect(){return"<Address:"+` type=${this.getType()}`+` version=${this.version}`+` str=${this.toString()}`+">"}fromRaw(t,e){const i=new h(t,!0);if(t.length>40)throw new Error("Address is too long.");const r=i.readU8();e=s.fromAddress(r,e);const n=f.getType(r,e);let o=-1;if(t.length>25&&(o=i.readU8(),0!==i.readU8()))throw new Error("Address version padding is non-zero.");const a=i.readBytes(i.left()-4);return i.verifyChecksum(),this.fromHash(a,n,o,e)}static fromRaw(t,e){return(new f).fromRaw(t,e)}fromScript(t){const e=t.getPubkey();if(e)return this.hash=a.hash160(e),this.type=f.types.PUBKEYHASH,this.version=-1,this;const i=t.getPubkeyhash();if(i)return this.hash=i,this.type=f.types.PUBKEYHASH,this.version=-1,this;const r=t.getScripthash();if(r)return this.hash=r,this.type=f.types.SCRIPTHASH,this.version=-1,this;const s=t.getProgram();return s&&!s.isMalformed()?(this.hash=s.data,this.type=f.types.WITNESS,this.version=s.version,this):t.isMultisig()?(this.hash=t.hash160(),this.type=f.types.SCRIPTHASH,this.version=-1,this):null}static fromScripts(t){let e=[];const i=t.getPromises();if(i&&Array.isArray(i))for(let t of i){let i=new f;i.hash=a.hash160(t),i.type=f.types.PUBKEYHASH,this.version=-1,e.push(i)}else e.push((new f).fromScript(t));return e}static fromScript(t){return(new f).fromScript(t)}fromWitness(t){const[,e]=t.getPubkeyhashInput();if(e)return this.hash=a.hash160(e),this.type=f.types.WITNESS,this.version=0,this;const i=t.getScripthashInput();return i?(this.hash=a.sha256(i),this.type=f.types.WITNESS,this.version=0,this):null}fromInputScript(t){const[,e]=t.getPubkeyhashInput();if(e)return this.hash=a.hash160(e),this.type=f.types.PUBKEYHASH,this.version=-1,this;const i=t.getScripthashInput();return i?(this.hash=a.hash160(i),this.type=f.types.SCRIPTHASH,this.version=-1,this):null}static fromWitness(t){return(new f).fromWitness(t)}static fromInputScript(t){return(new f).fromInputScript(t)}fromHash(t,i,n,a){return"string"==typeof t&&(t=e.from(t,"hex")),"string"==typeof i&&(i=f.types[i.toUpperCase()],r(null!=i,"Not a valid address type.")),null==i&&(i=f.types.PUBKEYHASH),null==n&&(n=-1),a=s.get(a),r(e.isBuffer(t)),r(o.isU8(i)),r(o.isI8(n)),r(i>=f.types.PUBKEYHASH&&i<=f.types.WITNESS,"Not a valid address type."),-1===n?(r(i!==f.types.WITNESS,"Wrong version (witness)"),r(20===t.length,"Hash is the wrong size.")):(r(i===f.types.WITNESS,"Wrong version (non-witness)."),r(n>=0&&n<=16,"Bad program version."),0===n&&i===f.types.WITNESS&&r(20===t.length||32===t.length,"Witness program hash is the wrong size."),r(t.length>=2&&t.length<=40,"Hash is the wrong size.")),this.hash=t,this.type=i,this.version=n,this.network=a,this}static fromHash(t,e,i,r){return(new f).fromHash(t,e,i,r)}fromPubkeyhash(t,e){const i=f.types.PUBKEYHASH;return r(20===t.length,"P2PKH must be 20 bytes."),this.fromHash(t,i,-1,e)}static fromPubkeyhash(t,e){return(new f).fromPubkeyhash(t,e)}fromScripthash(t,e){const i=f.types.SCRIPTHASH;return r(t&&20===t.length,"P2SH must be 20 bytes."),this.fromHash(t,i,-1,e)}static fromScripthash(t,e){return(new f).fromScripthash(t,e)}fromWitnessPubkeyhash(t,e){const i=f.types.WITNESS;return r(t&&20===t.length,"P2WPKH must be 20 bytes."),this.fromHash(t,i,0,e)}static fromWitnessPubkeyhash(t,e){return(new f).fromWitnessPubkeyhash(t,e)}fromWitnessScripthash(t,e){const i=f.types.WITNESS;return r(t&&32===t.length,"P2WPKH must be 32 bytes."),this.fromHash(t,i,0,e)}static fromWitnessScripthash(t,e){return(new f).fromWitnessScripthash(t,e)}fromProgram(t,i,s){const n=f.types.WITNESS;return r(t>=0,"Bad version for witness program."),"string"==typeof i&&(i=e.from(i,"hex")),this.fromHash(i,n,t,s)}static fromProgram(t,e,i){return(new f).fromProgram(t,e,i)}isPubkeyhash(){return this.type===f.types.PUBKEYHASH}isScripthash(){return this.type===f.types.SCRIPTHASH}isWitnessPubkeyhash(){return 0===this.version&&20===this.hash.length}isWitnessScripthash(){return 0===this.version&&32===this.hash.length}isWitnessMasthash(){return 1===this.version&&32===this.hash.length}isProgram(){return-1!==this.version}isUnknown(){return-1!==this.version&&(this.version>0||20!==this.hash.length&&32!==this.hash.length)}static getHash(t,i,r){if(!t)throw new Error("Object is not an address.");let n;if("string"==typeof t){if(40===t.length||64===t.length)return"hex"===i?t:e.from(t,"hex");n=f.fromString(t,r).hash}else if(e.isBuffer(t)){if(20!==t.length&&32!==t.length)throw new Error("Object is not an address.");n=t}else{if(!(t instanceof f))throw new Error("Object is not an address.");if(n=t.hash,r&&(r=s.get(r),t.network!==r))throw new Error("Network mismatch for address.")}return"hex"===i?n.toString("hex"):n}static getType(t,e){const i=e.addressPrefix;switch(t){case i.pubkeyhash:return f.types.PUBKEYHASH;case i.scripthash:return f.types.SCRIPTHASH;case i.witnesspubkeyhash:case i.witnessscripthash:return f.types.WITNESS;default:throw new Error("Unknown address prefix.")}}}f.types={PUBKEYHASH:2,SCRIPTHASH:3,WITNESS:4},f.typesByVal=o.reverse(f.types),t.exports=f}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t){
/*!
 * common.js - common script functions for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(30),o=i(57);e.opcodes={OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_CHECKLOCKTIMEVERIFY:177,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_PROPCREATE:192,OP_PROPEXCHANGE:193,OP_PROPSALE:194,OP_CPREGISTER:195,OP_CPCHANGE:196,OP_CONTRACTCREATE:197,OP_PROMISE:199,OP_COINBASE:200,OP_PROPMAX:207,OP_SMALLDATA:249,OP_SMALLINTEGER:250,OP_PUBKEYS:251,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255},e.opcodesByVal=s.reverse(e.opcodes),e.small=[t.from([129]),t.from([]),t.from([1]),t.from([2]),t.from([3]),t.from([4]),t.from([5]),t.from([6]),t.from([7]),t.from([8]),t.from([9]),t.from([10]),t.from([11]),t.from([12]),t.from([13]),t.from([14]),t.from([15]),t.from([16])],e.flags={VERIFY_NONE:0,VERIFY_P2SH:1,VERIFY_STRICTENC:2,VERIFY_DERSIG:4,VERIFY_LOW_S:8,VERIFY_NULLDUMMY:16,VERIFY_SIGPUSHONLY:32,VERIFY_MINIMALDATA:64,VERIFY_DISCOURAGE_UPGRADABLE_NOPS:128,VERIFY_CLEANSTACK:256,VERIFY_CHECKLOCKTIMEVERIFY:512,VERIFY_CHECKSEQUENCEVERIFY:1024,VERIFY_WITNESS:2048,VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM:4096,VERIFY_MINIMALIF:8192,VERIFY_NULLFAIL:16384,VERIFY_WITNESS_PUBKEYTYPE:32768,VERIFY_MAST:65536},e.flags.MANDATORY_VERIFY_FLAGS=e.flags.VERIFY_P2SH,e.flags.STANDARD_VERIFY_FLAGS=0|e.flags.MANDATORY_VERIFY_FLAGS|e.flags.VERIFY_DERSIG|e.flags.VERIFY_STRICTENC|e.flags.VERIFY_MINIMALDATA|e.flags.VERIFY_NULLDUMMY|e.flags.VERIFY_DISCOURAGE_UPGRADABLE_NOPS|e.flags.VERIFY_CLEANSTACK|e.flags.VERIFY_MINIMALIF|e.flags.VERIFY_NULLFAIL|e.flags.VERIFY_CHECKLOCKTIMEVERIFY|e.flags.VERIFY_CHECKSEQUENCEVERIFY|e.flags.VERIFY_LOW_S|e.flags.VERIFY_WITNESS|e.flags.VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM|e.flags.VERIFY_WITNESS_PUBKEYTYPE,e.flags.ONLY_STANDARD_VERIFY_FLAGS=e.flags.STANDARD_VERIFY_FLAGS&~e.flags.MANDATORY_VERIFY_FLAGS,e.hashType={ALL:1,NONE:2,SINGLE:3,ZERO:4,ANYONECANPAY:128},e.hashTypeByVal=s.reverse(e.hashType),e.types={NONSTANDARD:0,PUBKEY:1,PUBKEYHASH:2,SCRIPTHASH:3,MULTISIG:4,NULLDATA:5,WITNESS:9,PROPEXTEND:114,PROMISE:115,PUBMAX:121,WITNESSMALFORMED:128,WITNESSSCRIPTHASH:129,WITNESSPUBKEYHASH:130,WITNESSMASTHASH:131},e.typesByVal=s.reverse(e.types),e.isHashType=function(i){if(r(t.isBuffer(i)),0===i.length)return!1;const s=i[i.length-1]&~e.hashType.ANYONECANPAY;return s>=e.hashType.ALL&&s<=e.hashType.ZERO},e.isLowDER=function(t){return!!e.isSignatureEncoding(t)&&n.isLowS(t.slice(0,-1))},e.isKeyEncoding=function(e){if(r(t.isBuffer(e)),e.length<33)return!1;if(4===e[0]){if(65!==e.length)return!1}else{if(2!==e[0]&&3!==e[0])return!1;if(33!==e.length)return!1}return!0},e.isCompressedEncoding=function(e){return r(t.isBuffer(e)),33===e.length&&(2===e[0]||3===e[0])},e.isSignatureEncoding=function(e){if(r(t.isBuffer(e)),e.length<9)return!1;if(e.length>73)return!1;if(48!==e[0])return!1;if(e[1]!==e.length-3)return!1;const i=e[3];if(5+i>=e.length)return!1;const s=e[5+i];return!(i+s+7!==e.length||2!==e[2]||0===i||128&e[4]||i>1&&0===e[4]&&!(128&e[5])||2!==e[i+4]||0===s||128&e[i+6]||s>1&&0===e[i+6]&&!(128&e[i+7]))},e.toASM=function(t,i){if(t.length<=4)return o.decode(t).toString(10);if(i&&e.isSignatureEncoding(t)){const i=t[t.length-1];let r=e.hashTypeByVal[31&i]||"";return r&&(i&e.hashType.ANYONECANPAY&&(r+="|ANYONECANPAY"),r=`[${r}]`),t.slice(0,-1).toString("hex")+r}return t.toString("hex")}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * output.js - output object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License)
 */
const r=i(1),s=i(3),n=i(31),o=i(16),a=i(26),h=i(20),c=i(6),u=i(2),l=i(10),f=i(33);class d{constructor(t){this.value=0,this.script=new h,t&&this.fromOptions(t)}getReturnData(t){return t&&this.script.code[0].value!==t?null:s.parseJson(this.script.code[1].data.toString())}fromOptions(t){return r(t,"Output data is required."),t.value&&(r(s.isU64(t.value),"Value must be a uint64."),this.value=t.value),t.script&&this.script.fromOptions(t.script),t.address&&this.script.fromAddress(t.address),this}static fromOptions(t){return(new d).fromOptions(t)}fromScript(t,e,i){return"string"==typeof t&&(t=a.fromString(t)),t instanceof a&&(t=h.fromAddress(t,i)),r(t instanceof h,"Script must be a Script."),r(s.isU64(e),"Value must be a uint64."),this.script=t,this.value=e,this}static fromScript(t,e,i){return(new d).fromScript(t,e,i)}get isColored(){let t=!1;return this.script.code.length>0&&(this.script.code[0].value==h.opcodes.OP_CPCHANGE||this.script.code[0].value==h.opcodes.OP_CPREGISTER?t=!0:this.script.code[0].value==h.opcodes.OP_PROPCREATE||this.script.code[0].value==h.opcodes.OP_PROPEXCHANGE?t=!0:this.script.code[0].value==h.opcodes.OP_PROMISE?t=!0:this.script.code[0].value==h.opcodes.OP_RETURN&&(t=!0)),t}clone(){const t=new d;return t.value=this.value,t.script.inject(this.script),t}equals(t){return r(d.isOutput(t)),this.value===t.value&&this.script.equals(t.script)}compare(t){r(d.isOutput(t));const e=this.value-t.value;return 0!==e?e:this.script.compare(t.script)}getType(){return h.typesByVal[this.script.getType()].toLowerCase()}getAddress(){return a.fromScript(this.script)}getAddresses(){return a.fromScripts(this.script)}getHash(t){const e=this.getAddress();return e?e.getHash(t):null}getHashs(t){let e=[];const i=this.getAddresses();if(!i)return e;if(Array.isArray(i))for(let r of i)e.push(r.getHash(t));else e.push(i.getHash(t));return e}inspect(){return{type:this.getType(),value:n.btc(this.value),script:this.script,address:this.getAddress()}}formatInsight(){return{value:n.btc(this.value),script:this.script,address:this.getAddress()}}toJSON(){return this.getJSON()}getJSON(t){let e=this.getAddress();return t=o.get(t),e&&(e=e.toString(t)),{value:this.value,script:this.script.toJSON(),address:e}}getDustThreshold(t){const e=l.WITNESS_SCALE_FACTOR;if(this.script.isUnspendable())return 0;let i=this.getSize();return this.script.isProgram()?i+=37+(107/e|0)+4:i+=148,3*f.getMinFee(i,t)}getSize(){return 8+this.script.getVarSize()}isDust(t){return this.value<this.getDustThreshold(t)}fromJSON(t){return r(t,"Output data is required."),r(s.isU64(t.value),"Value must be a uint64."),this.value=t.value,this.script.fromJSON(t.script),this}static fromJSON(t){return(new d).fromJSON(t)}toWriter(t){return t.writeI64(this.value),t.writeVarBytes(this.script.toRaw()),t}toRaw(){const t=this.getSize();return this.toWriter(new c(t)).render()}fromReader(t){return this.value=t.readI64(),this.script.fromRaw(t.readVarBytes()),this}fromRaw(t){return this.fromReader(new u(t))}static fromReader(t){return(new d).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new d).fromRaw(t)}static isOutput(t){return t instanceof d}}t.exports=d}).call(this,i(0).Buffer)},function(t,e,i){const{blockFinalType:r}=i(8);t.exports=class{constructor(t,e,i){this.mode=t,this.data=e,this.options=i}async execute(){return!1}async cancel(){return!1}async verify(){return!0}async HandleOutput(t){}isBlockFinal(){return r.Final}}},function(t,e,i){"use strict";(function(t){
/*!
 * secp256k1-elliptic.js - wrapper for elliptic
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(21).ec("secp256k1"),n=i(106),o=i(43),a=s.curve,h=e;function c(t,e){const i=t[e++];if(!(128&i))return[i,e];const r=15&i;let s=0;for(let i=0;i<r;i++)s<<=8,s|=t[e++];return[s,e]}h.binding=!1,h.generatePrivateKey=function(){return s.genKeyPair().getPrivate().toArrayLike(t,"be",32)},h.publicKeyCreate=function(e,i){null==i&&(i=!0),r(t.isBuffer(e));const n=s.keyPair({priv:e});return t.from(n.getPublic(i,"array"))},h.publicKeyConvert=function(e,i){null==i&&(i=!0);const r=a.decodePoint(e);return t.from(r.encode("array",i))},h.privateKeyTweakAdd=function(e,i){const r=new o(i).add(new o(e)).mod(a.n).toArrayLike(t,"be",32);if(!h.privateKeyVerify(r))throw new Error("Private key is invalid.");return r},h.publicKeyTweakAdd=function(e,i,r){null==r&&(r=!0);const s=a.decodePoint(e),n=a.g.mul(new o(i)).add(s),c=t.from(n.encode("array",r));if(!h.publicKeyVerify(c))throw new Error("Public key is invalid.");return c},h.ecdh=function(e,i){return i=s.keyPair({priv:i}),e=s.keyPair({pub:e}),i.derive(e.getPublic()).toArrayLike(t,"be",32)},h.recover=function(e,i,r,n){let o;r||(r=0),null==n&&(n=!0);try{o=s.recoverPubKey(e,i,r)}catch(t){return null}return t.from(o.encode("array",n))},h.verify=function(e,i,n){if(r(t.isBuffer(e)),r(t.isBuffer(i)),r(t.isBuffer(n)),0===i.length)return!1;if(0===n.length)return!1;i=function(t){let e,i=t,r=0;return 48!==i[r++]?t:([e,r]=c(i,r),i.length>e+r&&(i=i.slice(0,e+r)),2!==i[r++]?t:([e,r]=c(i,r),r+=e,2!==i[r++]?t:([e,r]=c(i,r),i.length>e+r&&(i=i.slice(0,e+r)),i)))}(i);try{return s.verify(e,i,n)}catch(t){return!1}},h.publicKeyVerify=function(t){try{return s.keyPair({pub:t}).validate()}catch(t){return!1}},h.privateKeyVerify=function(t){return 32===t.length&&!(t=new o(t)).isZero()&&t.lt(a.n)},h.sign=function(e,i){r(t.isBuffer(e)),r(t.isBuffer(i));const n=s.sign(e,i,{canonical:!0});return t.from(n.toDER())},h.fromDER=function(e){r(t.isBuffer(e));const i=new n(e),s=t.allocUnsafe(64);return i.r.toArrayLike(t,"be",32).copy(s,0),i.s.toArrayLike(t,"be",32).copy(s,32),s},h.toDER=function(e){r(t.isBuffer(e));const i=new n({r:new o(e.slice(0,32),"be"),s:new o(e.slice(32,64),"be")});return t.from(i.toDER())},h.isLowS=function(t){let e;try{e=new n(t)}catch(t){return!1}return!e.s.isZero()&&!e.s.gt(s.nh)}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * amount.js - amount object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(1),s=i(3);function n(t,e){if(!(this instanceof n))return new n(t,e);this.value=0,null!=t&&this.fromOptions(t,e)}n.prototype.fromOptions=function(t,e){return"string"==typeof e?this.from(e,t):"number"==typeof t?this.fromValue(t):this.fromBTC(t)},n.prototype.toValue=function(){return this.value},n.prototype.toSatoshis=function(t){return t?this.value:this.value.toString(10)},n.prototype.toBits=function(t){return n.encode(this.value,2,t)},n.prototype.toMBTC=function(t){return n.encode(this.value,5,t)},n.prototype.toBTC=function(t){return n.encode(this.value,8,t)},n.prototype.to=function(t,e){switch(t){case"sat":return this.toSatoshis(e);case"ubtc":case"bits":return this.toBits(e);case"mbtc":return this.toMBTC(e);case"btc":return this.toBTC(e)}throw new Error(`Unknown unit "${t}".`)},n.prototype.toString=function(){return this.toBTC()},n.prototype.fromValue=function(t){return r(s.isI64(t),"Value must be an int64."),this.value=t,this},n.prototype.fromSatoshis=function(t){return this.value=n.decode(t,0),this},n.prototype.fromBits=function(t){return this.value=n.decode(t,2),this},n.prototype.fromMBTC=function(t){return this.value=n.decode(t,5),this},n.prototype.fromBTC=function(t){return this.value=n.decode(t,8),this},n.prototype.from=function(t,e){switch(t){case"sat":return this.fromSatoshis(e);case"ubtc":case"bits":return this.fromBits(e);case"mbtc":return this.fromMBTC(e);case"btc":return this.fromBTC(e)}throw new Error(`Unknown unit "${t}".`)},n.fromOptions=function(t,e){return(new n).fromOptions(t,e)},n.fromValue=function(t){return(new n).fromValue(t)},n.fromSatoshis=function(t){return(new n).fromSatoshis(t)},n.fromBits=function(t){return(new n).fromBits(t)},n.fromMBTC=function(t){return(new n).fromMBTC(t)},n.fromBTC=function(t){return(new n).fromBTC(t)},n.from=function(t,e){return(new n).from(t,e)},n.prototype.inspect=function(){return`<Amount: ${this.toString()}>`},n.btc=function(t,e){return"string"==typeof t?t:n.encode(t,8,e)},n.value=function(t){return"number"==typeof t?t:n.decode(t,8)},n.encode=function(t,e,i){return i?s.toFloat(t,e):s.toFixed(t,e)},n.decode=function(t,e){return"number"==typeof t?s.fromFloat(t,e):s.fromFixed(t,e)},t.exports=n},function(t,e,i){"use strict";var r=i(54),s=i(5);function n(t,e){return 55296==(64512&t.charCodeAt(e))&&!(e<0||e+1>=t.length)&&56320==(64512&t.charCodeAt(e+1))}function o(t){return(t>>>24|t>>>8&65280|t<<8&16711680|(255&t)<<24)>>>0}function a(t){return 1===t.length?"0"+t:t}function h(t){return 7===t.length?"0"+t:6===t.length?"00"+t:5===t.length?"000"+t:4===t.length?"0000"+t:3===t.length?"00000"+t:2===t.length?"000000"+t:1===t.length?"0000000"+t:t}e.inherits=s,e.toArray=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var i=[];if("string"==typeof t)if(e){if("hex"===e)for((t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t),s=0;s<t.length;s+=2)i.push(parseInt(t[s]+t[s+1],16))}else for(var r=0,s=0;s<t.length;s++){var o=t.charCodeAt(s);o<128?i[r++]=o:o<2048?(i[r++]=o>>6|192,i[r++]=63&o|128):n(t,s)?(o=65536+((1023&o)<<10)+(1023&t.charCodeAt(++s)),i[r++]=o>>18|240,i[r++]=o>>12&63|128,i[r++]=o>>6&63|128,i[r++]=63&o|128):(i[r++]=o>>12|224,i[r++]=o>>6&63|128,i[r++]=63&o|128)}else for(s=0;s<t.length;s++)i[s]=0|t[s];return i},e.toHex=function(t){for(var e="",i=0;i<t.length;i++)e+=a(t[i].toString(16));return e},e.htonl=o,e.toHex32=function(t,e){for(var i="",r=0;r<t.length;r++){var s=t[r];"little"===e&&(s=o(s)),i+=h(s.toString(16))}return i},e.zero2=a,e.zero8=h,e.join32=function(t,e,i,s){var n=i-e;r(n%4==0);for(var o=new Array(n/4),a=0,h=e;a<o.length;a++,h+=4){var c;c="big"===s?t[h]<<24|t[h+1]<<16|t[h+2]<<8|t[h+3]:t[h+3]<<24|t[h+2]<<16|t[h+1]<<8|t[h],o[a]=c>>>0}return o},e.split32=function(t,e){for(var i=new Array(4*t.length),r=0,s=0;r<t.length;r++,s+=4){var n=t[r];"big"===e?(i[s]=n>>>24,i[s+1]=n>>>16&255,i[s+2]=n>>>8&255,i[s+3]=255&n):(i[s+3]=n>>>24,i[s+2]=n>>>16&255,i[s+1]=n>>>8&255,i[s]=255&n)}return i},e.rotr32=function(t,e){return t>>>e|t<<32-e},e.rotl32=function(t,e){return t<<e|t>>>32-e},e.sum32=function(t,e){return t+e>>>0},e.sum32_3=function(t,e,i){return t+e+i>>>0},e.sum32_4=function(t,e,i,r){return t+e+i+r>>>0},e.sum32_5=function(t,e,i,r,s){return t+e+i+r+s>>>0},e.sum64=function(t,e,i,r){var s=t[e],n=r+t[e+1]>>>0,o=(n<r?1:0)+i+s;t[e]=o>>>0,t[e+1]=n},e.sum64_hi=function(t,e,i,r){return(e+r>>>0<e?1:0)+t+i>>>0},e.sum64_lo=function(t,e,i,r){return e+r>>>0},e.sum64_4_hi=function(t,e,i,r,s,n,o,a){var h=0,c=e;return h+=(c=c+r>>>0)<e?1:0,h+=(c=c+n>>>0)<n?1:0,t+i+s+o+(h+=(c=c+a>>>0)<a?1:0)>>>0},e.sum64_4_lo=function(t,e,i,r,s,n,o,a){return e+r+n+a>>>0},e.sum64_5_hi=function(t,e,i,r,s,n,o,a,h,c){var u=0,l=e;return u+=(l=l+r>>>0)<e?1:0,u+=(l=l+n>>>0)<n?1:0,u+=(l=l+a>>>0)<a?1:0,t+i+s+o+h+(u+=(l=l+c>>>0)<c?1:0)>>>0},e.sum64_5_lo=function(t,e,i,r,s,n,o,a,h,c){return e+r+n+a+c>>>0},e.rotr64_hi=function(t,e,i){return(e<<32-i|t>>>i)>>>0},e.rotr64_lo=function(t,e,i){return(t<<32-i|e>>>i)>>>0},e.shr64_hi=function(t,e,i){return t>>>i},e.shr64_lo=function(t,e,i){return(t<<32-i|e>>>i)>>>0}},function(t,e,i){"use strict";
/*!
 * policy.js - bitcoin constants for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(10);e.MAX_TX_VERSION=2,e.MAX_TX_SIZE=s.MAX_BLOCK_SIZE/10,e.MAX_TX_WEIGHT=s.MAX_BLOCK_WEIGHT/10,e.MAX_TX_SIGOPS=s.MAX_BLOCK_SIGOPS/5,e.MAX_TX_SIGOPS_COST=s.MAX_BLOCK_SIGOPS_COST/5,e.BYTES_PER_SIGOP=20,e.MIN_RELAY=1e3,e.BARE_MULTISIG=!0,e.FREE_THRESHOLD=-1,e.MAX_P2SH_SIGOPS=15,e.MAX_OP_RETURN=1024,e.MAX_OP_INFO=1024,e.MAX_OP_RETURN_BYTES=e.MAX_OP_RETURN+3,e.MAX_P2WSH_STACK=100,e.MAX_P2WSH_PUSH=80,e.MAX_P2WSH_SIZE=3600,e.MEMPOOL_MAX_ANCESTORS=25,e.MEMPOOL_MAX_SIZE=1e8,e.MEMPOOL_EXPIRY_TIME=259200,e.MEMPOOL_MAX_ORPHANS=100,e.MIN_BLOCK_WEIGHT=8192,e.MAX_BLOCK_WEIGHT=1e6*s.WITNESS_SCALE_FACTOR,e.BLOCK_PRIORITY_WEIGHT=0,e.BLOCK_PRIORITY_THRESHOLD=e.FREE_THRESHOLD,e.getMinFee=function(t,i){if(null==i&&(i=e.MIN_RELAY),r(t>=0),r(i>=0),0===t)return 0;let s=Math.floor(i*t/1e3);return 0===s&&i>0&&(s=i),s},e.getRoundFee=function(t,i){if(null==i&&(i=e.MIN_RELAY),r(t>=0),r(i>=0),0===t)return 0;let s=i*Math.ceil(t/1e3);return 0===s&&i>0&&(s=i),s},e.getRate=function(t,e){return r(t>=0),r(e>=0),0===t?0:Math.floor(1e3*e/t)}},function(t,e,i){"use strict";
/*!
 * lock.js - lock and queue for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(1);function s(){}t.exports=class{constructor(t){this.noted=!0===t,this.destroyed=!1,this.map=new Map,this.jobs=[],this.busy=!1,this.current=null,this.unlocker=this.unlock.bind(this)}has(t){if(r(this.noted,"Must use named jobs."),this.current===t)return!0;const e=this.map.get(t);return null!=e&&e>0}hasPending(t){r(this.noted,"Must use named jobs.");const e=this.map.get(t);return null!=e&&e>0}lock(t,e){let i,r;if(this.noted?(i=t||null,r=e):(i=null,r=t),this.destroyed)return Promise.reject(new Error("Lock is destroyed."));if(r)return Promise.resolve(s);if(this.busy){if(i){let t=this.map.get(i);t||(t=0),this.map.set(i,t+1)}return new Promise((t,e)=>{this.jobs.push(new function(t,e,i){this.resolve=t,this.reject=e,this.name=i||null}(t,e,i))})}return this.busy=!0,this.current=i,Promise.resolve(this.unlocker)}unlock(){if(this.destroyed||!this.busy)return;if(this.busy=!1,this.current=null,0===this.jobs.length)return;const t=this.jobs.shift();if(t.name){let e=this.map.get(t.name);r(e>0),0==--e?this.map.delete(t.name):this.map.set(t.name,e)}this.busy=!0,this.current=t.name,t.resolve(this.unlocker)}destroy(){if(!this.destroyed){this.destroyed=!0,this.busy=!1,this.current=null;const t=this.jobs;this.jobs=[],this.map.clear();for(const e of t)e.reject(new Error("Lock was destroyed."))}}}},function(t,e,i){"use strict";(function(r){
/*!
 * co.js - promise and generator control flow for gamegold
 * Originally based on yoursnetwork's "asink" module.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const s=i(1);function n(t){return new Promise((e,i)=>{const r=(o,a)=>{let h;try{h=a?t.throw(o):t.next(o)}catch(t){return void i(t)}h.done?e(h.value):function(t){return t&&"function"==typeof t.then}(h.value)?h.value.then(s,n):r(h.value,!1)},s=t=>{r(t,!1)},n=t=>{r(t,!0)};r(void 0,!1)})}function o(t){return function(){return n(t.apply(this,arguments))}}function a(t,e){return function(i,r){i?e(i):t(r)}}(e=o).exec=n,e.spawn=function(t,e){return n(t.call(e))},e.co=o,e.wait=function(){return new Promise(t=>r(t))},e.timeout=function(t){return new Promise(e=>setTimeout(e,t))},e.wrap=a,e.promisify=function(t){return function(...e){return new Promise((i,r)=>{e.push(a(i,r)),t.call(this,...e)})}},e.callbackify=function(t){return function(...e){if(0===e.length||"function"!=typeof e[e.length-1])throw new Error(`${t.name||"Function"} requires a callback.`);const i=e.pop();t.call(this,...e).then(t=>{r(()=>i(null,t))},t=>{r(()=>i(t))})}},e.every=async function(t){const e=await Promise.all(t);for(const t of e)if(!t)return!1;return!0},e.setInterval=function(t,e,i){const r={timer:null,stopped:!1,running:!1,resolve:null},n=async()=>{s(null!=r.timer),r.timer=null;try{r.running=!0,await t.call(i)}finally{r.running=!1,r.stopped?r.resolve&&r.resolve():r.timer=setTimeout(n,e)}};return r.timer=setTimeout(n,e),r},e.clearInterval=function(t){return s(t),null!=t.timer&&(clearTimeout(t.timer),t.timer=null),t.stopped=!0,t.running?new Promise(e=>{t.resolve=e}):Promise.resolve()},e.setTimeout=function(t,e,i){return{timer:setTimeout(t.bind(i),e),stopped:!1}},e.clearTimeout=function(t){s(t),null!=t.timer&&(clearTimeout(t.timer),t.timer=null),t.stopped=!0},e.job=function(t,e){return new function(t,e){this.resolve=t,this.reject=e}(t,e)},t.exports=e}).call(this,i(81).setImmediate)},function(t,e,i){"use strict";
/*!
 * errors.js - error objects for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1);class s extends Error{constructor(t,e,i,n,o){super(),r("string"==typeof e),r("string"==typeof i),r(n>=0),this.type="VerifyError",this.message="",this.code=e,this.reason=i,this.score=n,this.hash=t.hash("hex"),this.malleated=o||!1,this.message=`Verification failure: ${i}`+` (code=${e} score=${n} hash=${t.rhash()})`,Error.captureStackTrace&&Error.captureStackTrace(this,s)}}e.VerifyError=s},function(t,e,i){"use strict";
/*!
 * outpoint.js - outpoint object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(3),n=i(6),o=i(2),a=i(4);class h{constructor(t,e){this.hash=a.NULL_HASH,this.index=4294967295,null!=t&&(r("string"==typeof t,"Hash must be a string."),r(s.isU32(e),"3 - Index must be a uint32."),this.hash=t,this.index=e)}fromOptions(t){return r(t,"Outpoint data is required."),r("string"==typeof t.hash,"Hash must be a string."),r(s.isU32(t.index),"4 - Index must be a uint32."),this.hash=t.hash,this.index=t.index,this}static fromOptions(t){return(new h).fromOptions(t)}clone(){const t=new h;return t.hash=this.value,t.index=this.index,t}equals(t){return r(h.isOutpoint(t)),this.hash===t.hash&&this.index===t.index}compare(t){r(h.isOutpoint(t));const e=s.strcmp(this.txid(),t.txid());return 0!==e?e:this.index-t.index}isNull(){return 4294967295===this.index&&this.hash===a.NULL_HASH}rhash(){return s.revHex(this.hash)}txid(){return this.rhash()}toKey(){return h.toKey(this.hash,this.index)}fromKey(t){return r(t.length>64),this.hash=t.slice(0,64),this.index=parseInt(t.slice(64),10),this}static fromKey(t){return(new h).fromKey(t)}toWriter(t){return t.writeHash(this.hash),t.writeU32(this.index),t}getSize(){return 36}toRaw(){return this.toWriter(new n(36)).render()}fromReader(t){return this.hash=t.readHash("hex"),this.index=t.readU32(),this}fromRaw(t){return this.fromReader(new o(t))}static fromReader(t){return(new h).fromReader(t)}static fromRaw(t){return(new h).fromRaw(t)}fromJSON(t){return r(t,"Outpoint data is required."),r("string"==typeof t.hash,"Hash must be a string."),r(s.isU32(t.index),"5 - Index must be a uint32."),this.hash=s.revHex(t.hash),this.index=t.index,this}toJSON(){return{hash:s.revHex(this.hash),index:this.index}}static fromJSON(t){return(new h).fromJSON(t)}fromTX(t,e){return r(t),r("number"==typeof e),r(e>=0),this.hash=t.hash("hex"),this.index=e,this}static fromTX(t,e){return(new h).fromTX(t,e)}static toKey(t,e){return r("string"==typeof t),r(64===t.length),r(e>=0),t+e}inspect(){return`<Outpoint: ${this.rhash()}/${this.index}>`}static isOutpoint(t){return t instanceof h}}t.exports=h},function(t,e,i){var r=i(7).Buffer,s=i(83).Transform,n=i(90).StringDecoder;function o(t){s.call(this),this.hashMode="string"==typeof t,this.hashMode?this[t]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}i(5)(o,s),o.prototype.update=function(t,e,i){"string"==typeof t&&(t=r.from(t,e));var s=this._update(t);return this.hashMode?this:(i&&(s=this._toString(s,i)),s)},o.prototype.setAutoPadding=function(){},o.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},o.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},o.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},o.prototype._transform=function(t,e,i){var r;try{this.hashMode?this._update(t):this.push(this._update(t))}catch(t){r=t}finally{i(r)}},o.prototype._flush=function(t){var e;try{this.push(this.__final())}catch(t){e=t}t(e)},o.prototype._finalOrDigest=function(t){var e=this.__final()||r.alloc(0);return t&&(e=this._toString(e,t,!0)),e},o.prototype._toString=function(t,e,i){if(this._decoder||(this._decoder=new n(e),this._encoding=e),this._encoding!==e)throw new Error("can't switch encodings");var r=this._decoder.write(t);return i&&(r+=this._decoder.end()),r},t.exports=o},function(t,e,i){"use strict";(function(e){
/*!
 * invitem.js - inv item object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(2),s=(i(13),i(6)),n=i(3);class o{constructor(t,e){this.type=t,this.hash=e}getSize(){return 36}formatInsight(){return{type:this.type,hash:{type:"Buffer",data:this.toRaw()}}}toWriter(t){return t.writeU32(this.type),t.writeHash(this.hash),t}toRaw(){return this.toWriter(new s(36)).render()}fromReader(t){return this.type=t.readU32(),this.hash=t.readHash("hex"),this}fromRaw(t){return this.fromReader(new r(t))}static fromReader(t){return(new o).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new o).fromRaw(t)}isBlock(){switch(this.type){case o.types.BLOCK:case o.types.WITNESS_BLOCK:case o.types.FILTERED_BLOCK:case o.types.WITNESS_FILTERED_BLOCK:case o.types.CMPCT_BLOCK:return!0;default:return!1}}isTX(){switch(this.type){case o.types.TX:case o.types.WITNESS_TX:return!0;default:return!1}}hasWitness(){return 0!=(this.type&o.WITNESS_FLAG)}rhash(){return n.revHex(this.hash)}}o.types={ERROR:0,TX:1,BLOCK:2,FILTERED_BLOCK:3,WITNESS_TX:1|1<<30,WITNESS_BLOCK:2|1<<30,WITNESS_FILTERED_BLOCK:3|1<<30,CMPCT_BLOCK:4},o.typesByVal=n.reverse(o.types),o.WITNESS_FLAG=1<<30,t.exports=o}).call(this,i(0).Buffer)},function(t,e){function i(t,e){if(!t)throw new Error(e||"Assertion failed")}t.exports=i,i.equal=function(t,e,i){if(t!=e)throw new Error(i||"Assertion failed: "+t+" != "+e)}},function(t,e,i){"use strict";(function(e){
/*!
 * coin.js - coin object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(3),n=i(31),o=i(28),a=i(20),h=i(16),c=i(2),u=i(6),l=i(4);i(17);class f extends o{constructor(t){super(t),this.version=1,this.height=-1,this.value=0,this.script=new a,this.coinbase=!1,this.hash=l.NULL_HASH,this.index=0,t&&this.fromOptions(t)}fromOptions(t){return r(t,"Coin data is required."),null!=t.version&&(r(s.isU32(t.version),"Version must be a uint32."),this.version=t.version),null!=t.height&&(-1!==t.height?(r(s.isU32(t.height),"Height must be a uint32."),this.height=t.height):this.height=-1),null!=t.value&&(r(s.isU64(t.value),"Value must be a uint64."),this.value=t.value),t.script&&this.script.fromOptions(t.script),null!=t.coinbase&&(r("boolean"==typeof t.coinbase,"Coinbase must be a boolean."),this.coinbase=t.coinbase),null!=t.hash&&(r("string"==typeof t.hash,"Hash must be a string."),this.hash=t.hash),null!=t.index&&(r(s.isU32(t.index),"1 - Index must be a uint32."),this.index=t.index),this}static fromOptions(t){return(new f).fromOptions(t)}clone(){r(!1,"Coins are not cloneable.")}getDepth(t){return r("number"==typeof t,"Must pass a height."),-1===this.height?0:-1===t?0:t<this.height?0:t-this.height+1}getReturnData(t){return t&&this.script.code[0].value!==t?null:s.parseJson(this.script.code[1].data.toString())}toKey(){return this.hash+this.index}fromKey(t){return r(t.length>64),this.hash=t.slice(0,64),this.index=parseInt(t.slice(64),10),this}static fromKey(t){return(new f).fromKey(t)}rhash(){return s.revHex(this.hash)}txid(){return this.rhash()}inspect(){return{type:this.getType(),version:this.version,height:this.height,value:n.btc(this.value),script:this.script,coinbase:this.coinbase,hash:this.hash?s.revHex(this.hash):null,index:this.index,address:this.getAddress()}}toJSON(){return this.getJSON()}getJSON(t,e){let i=this.getAddress();return t=h.get(t),i&&(i=i.toString(t)),{version:this.version,height:this.height,value:this.value,script:this.script.toJSON(),address:i,coinbase:this.coinbase,hash:e?void 0:this.rhash(),index:e?void 0:this.index}}fromJSON(t){return r(t,"Coin data required."),r(s.isU32(t.version),"Version must be a uint32."),r(-1===t.height||s.isU32(t.height),"Height must be a uint32."),r(s.isU64(t.value),"Value must be a uint64."),r("boolean"==typeof t.coinbase,"Coinbase must be a boolean."),this.version=t.version,this.height=t.height,this.value=t.value,this.script.fromJSON(t.script),this.coinbase=t.coinbase,null!=t.hash&&(r("string"==typeof t.hash,"Hash must be a string."),r(64===t.hash.length,"Hash must be a string."),r(s.isU32(t.index),"2 - Index must be a uint32."),this.hash=s.revHex(t.hash),this.index=t.index),this}static fromJSON(t){return(new f).fromJSON(t)}getSize(){return 17+this.script.getVarSize()}toWriter(t){let e=this.height;return-1===e&&(e=2147483647),t.writeU32(this.version),t.writeU32(e),t.writeI64(this.value),t.writeVarBytes(this.script.toRaw()),t.writeU8(this.coinbase?1:0),t}toRaw(){const t=this.getSize();return this.toWriter(new u(t)).render()}fromReader(t){return this.version=t.readU32(),this.height=t.readU32(),this.value=t.readI64(),this.script.fromRaw(t.readVarBytes()),this.coinbase=1===t.readU8(),2147483647===this.height&&(this.height=-1),this}fromRaw(t){return this.fromReader(new c(t))}static fromReader(t){return(new f).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new f).fromRaw(t)}fromTX(t,e,i){return r("number"==typeof e),r("number"==typeof i),r(e>=0&&e<t.outputs.length),this.version=t.version,this.height=i,this.value=t.outputs[e].value,this.script=t.outputs[e].script,this.coinbase=t.isCoinbase(),this.hash=t.hash("hex"),this.index=e,this}static fromTX(t,e,i){return(new f).fromTX(t,e,i)}static isCoin(t){return t instanceof f}}t.exports=f}).call(this,i(0).Buffer)},function(t,e,i){"use strict";var r=i(80),s=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};t.exports=l;var n=i(58);n.inherits=i(5);var o=i(139),a=i(97);n.inherits(l,o);for(var h=s(a.prototype),c=0;c<h.length;c++){var u=h[c];l.prototype[u]||(l.prototype[u]=a.prototype[u])}function l(t){if(!(this instanceof l))return new l(t);o.call(this,t),a.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||r.nextTick(d,this)}function d(t){t.end()}Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),l.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},function(t,e,i){"use strict";
/*!
 * bn.js - big numbers for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */t.exports=i(14)},function(t,e,i){"use strict";
/*!
 * coinview.js - coin viewpoint object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(191),s=i(137),n=i(88);class o{constructor(){this.map=new Map,this.undo=new s}clone(){let t=new o;for(let[e,i]of this.map)t.map.set(e,i.clone());return t.undo=s.fromRaw(this.undo.toRaw()),t}get(t){return this.map.get(t)}has(t){return this.map.has(t)}add(t,e){return this.map.set(t,e),e}ensure(t){return this.map.get(t)||this.add(t,new r)}remove(t){const e=this.map.get(t);return e?(this.map.delete(t),e):null}addTX(t,e){const i=t.hash("hex"),s=r.fromTX(t,e);return this.add(i,s)}removeTX(t,e){const i=t.hash("hex"),s=r.fromTX(t,e);for(const t of s.outputs.values())t.spent=!0;return this.add(i,s)}addEntry(t,e){const{hash:i,index:r}=t;return this.ensure(i).add(r,e)}addIndex(t,e,i){const r=t.hash("hex");return this.ensure(r).add(e,n.fromTX(t,e,i))}addCoin(t){return this.ensure(t.hash).addCoin(t)}addOutput(t,e){const{hash:i,index:r}=t;return this.ensure(i).addOutput(r,e)}spendEntry(t){const{hash:e,index:i}=t,r=this.get(e);if(!r)return null;const s=r.spend(i);return s?(this.undo.push(s),s):null}removeEntry(t){const{hash:e,index:i}=t,r=this.get(e);return r?r.remove(i):null}hasEntry(t){const{hash:e,index:i}=t,r=this.get(e);return!!r&&r.has(i)}getEntry(t){const{hash:e,index:i}=t,r=this.get(e);return r?r.get(i):null}isUnspent(t){const{hash:e,index:i}=t,r=this.get(e);return!!r&&r.isUnspent(i)}getCoin(t){const e=this.get(t.hash);return e?e.getCoin(t):null}getOutput(t){const{hash:e,index:i}=t,r=this.get(e);return r?r.getOutput(i):null}getHeight(t){const e=this.getEntry(t);return e?e.height:-1}isCoinbase(t){const e=this.getEntry(t);return!!e&&e.coinbase}hasEntryFor(t){return this.hasEntry(t.prevout)}getEntryFor(t){return this.getEntry(t.prevout)}isUnspentFor(t){return this.isUnspent(t.prevout)}getCoinFor(t){return this.getCoin(t.prevout)}getOutputFor(t){return this.getOutput(t.prevout)}getHeightFor(t){return this.getHeight(t.prevout)}isCoinbaseFor(t){return this.isCoinbase(t.prevout)}async readCoin(t,e){const i=this.getEntry(e);if(i)return i;const r=await t.readCoin(e);return r?this.addEntry(e,r):null}async readInputs(t,e){let i=!0;for(const{prevout:r}of e.inputs)await this.readCoin(t,r)||(i=!1);return i}async spendInputs(t,e){let i=0;for(;i<e.inputs.length;){const r=Math.min(i+4,e.inputs.length),s=[];for(;i<r;i++){const{prevout:r}=e.inputs[i];s.push(this.readCoin(t,r))}const n=await Promise.all(s);for(const t of n){if(!t||t.spent)return!1;t.spent=!0,this.undo.push(t)}}return!0}getSize(t){let e=0;e+=t.inputs.length;for(const{prevout:i}of t.inputs){const t=this.getEntry(i);t&&(e+=t.getSize())}return e}toWriter(t,e){for(const{prevout:i}of e.inputs){const e=this.getEntry(i);e?(t.writeU8(1),e.toWriter(t)):t.writeU8(0)}return t}fromReader(t,e){for(const{prevout:i}of e.inputs){if(0===t.readU8())continue;const e=n.fromReader(t);this.addEntry(i,e)}return this}static fromReader(t,e){return(new o).fromReader(t,e)}}t.exports=o},function(t,e,i){"use strict";(function(e,r){
/*!
 * logger.js - basic logger for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const s=i(1),n=i(71),o=i(3),a=i(35),h=i(34);class c{constructor(t){if(!(this instanceof c))return new c(t);this.level=c.levels.NONE,this.colors=c.HAS_TTY,this.console=!0,this.shrink=!0,this.closed=!0,this.closing=!1,this.filename=null,this.stream=null,this.contexts=Object.create(null),this.locker=new h,t&&this.set(t)}set(t){s(t),s(this.closed),"string"!=typeof t?(null!=t.level&&(s("string"==typeof t.level),this.setLevel(t.level)),null!=t.colors&&c.HAS_TTY&&(s("boolean"==typeof t.colors),this.colors=t.colors),null!=t.console&&(s("boolean"==typeof t.console),this.console=t.console),null!=t.shrink&&(s("boolean"==typeof t.shrink),this.shrink=t.shrink),null!=t.filename&&(s("string"==typeof t.filename,"Bad file."),this.filename=t.filename)):this.setLevel(t)}async open(){const t=await this.locker.lock();try{return await this._open()}finally{t()}}async _open(){this.filename?this.stream?this.closed=!1:n.unsupported?this.closed=!1:(this.shrink&&await this.truncate(),this.stream=await l(this.filename),this.stream.once("error",this.handleError.bind(this)),this.closed=!1):this.closed=!1}async close(){const t=await this.locker.lock();try{return await this._close()}finally{t()}}async _close(){if(null!=this.timer&&(a.clearTimeout(this.timer),this.timer=null),n.unsupported)return this.closed=!0,void(this.stream=null);if(this.stream){try{this.closing=!0,await function(t){return new Promise((e,i)=>{const r=()=>{t.removeListener("error",s),t.removeListener("close",n)},s=t=>{r(),i(t)},n=()=>{r(),e(t)};t.removeAllListeners("error"),t.removeAllListeners("close"),t.once("error",s),t.once("close",n),t.close()})}(this.stream)}finally{this.closing=!1}this.stream=null}this.closed=!0}async truncate(){if(!this.filename)return;if(n.unsupported)return;let t;s(!this.stream);try{t=await n.stat(this.filename)}catch(t){if("ENOENT"===t.code)return;throw t}const i=c.MAX_FILE_SIZE;if(t.size<=i+i/10)return;this.debug("Truncating log file to %d bytes.",i);const r=await n.open(this.filename,"r+"),o=e.allocUnsafe(i);await n.read(r,o,0,i,t.size-i),await n.ftruncate(r,i),await n.write(r,o,0,i,0),await n.close(r)}handleError(t){try{this.stream.close()}catch(t){}this.stream=null,this.retry()}async reopen(){const t=await this.locker.lock();try{return await this._reopen()}finally{t()}}async _reopen(){if(!this.stream&&!this.closed&&!n.unsupported){try{this.stream=await l(this.filename)}catch(t){return void this.retry()}this.stream.once("error",this.handleError.bind(this))}}retry(){s(null==this.timer),this.timer=a.setTimeout(()=>{this.timer=null,this.reopen()},1e4,this)}setFile(t){s("string"==typeof t),s(!this.stream,"Log stream has already been created."),this.filename=t}setLevel(t){const e=c.levels[t.toUpperCase()];s(null!=e,"Invalid log level."),this.level=e}error(...t){if(this.level<c.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(c.levels.ERROR,null,e):this.log(c.levels.ERROR,null,t)}warning(...t){if(this.level<c.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(c.levels.WARNING,null,e):this.log(c.levels.WARNING,null,t)}info(...t){if(this.level<c.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(c.levels.INFO,null,e):this.log(c.levels.INFO,null,t)}debug(...t){if(this.level<c.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(c.levels.DEBUG,null,e):this.log(c.levels.DEBUG,null,t)}spam(...t){if(this.level<c.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(c.levels.SPAM,null,e):this.log(c.levels.SPAM,null,t)}log(t,e,i){this.closed||this.level<t||(this.writeConsole(t,e,i),this.writeStream(t,e,i))}context(t){let e=this.contexts[t];return e||(e=new u(this,t),this.contexts[t]=e),e}writeConsole(t,e,i){const n=c.levelsByVal[t];if(s(n,"Invalid log level."),!this.console)return!1;if(!r.stdout){let r=`[${n}] [${o.dataOfUTC()}] `;return e&&(r+=`(${e}) `),"object"==typeof i[0]?t===c.levels.ERROR?console.error(r,i[0]):console.log(r,i[0]):(r+=o.format(i,!1),t===c.levels.ERROR?(console.error(r),!0):(console.log(r),!0))}let a;if(this.colors){const e=c.styles[t];s(e),a=`[${e}m[${n}] [${o.dataOfUTC()}][m `}else a=`[${n}] [${o.dataOfUTC()}] `;return e&&(a+=`(${e}) `),a+=o.format(i,this.colors),a+="\n",t===c.levels.ERROR?r.stderr.write(a):r.stdout.write(a)}writeStream(t,e,i){const r=c.prefixByVal[t];if(s(r,"Invalid log level."),!this.stream)return;if(this.closing)return;let n=`[${r}] [${o.dataOfUTC()}] `;e&&(n+=`(${e}) `),n+=o.format(i,!1),n+="\n",this.stream.write(n)}logError(t,e,i){if(this.closed)return;n.unsupported&&this.console&&t<=c.levels.WARNING&&console.error(i);let r=String(i.message).replace(/^ *Error: */,"");t!==c.levels.ERROR&&(r=`Error: ${r}`),this.log(t,e,[r]),t<=c.levels.WARNING&&this.stream&&this.stream.write(i.stack+"\n")}memory(t){const e=o.memoryUsage();this.log(c.levels.DEBUG,t,["Memory: rss=%dmb, js-heap=%d/%dmb native-heap=%dmb",e.total,e.jsHeap,e.jsHeapTotal,e.nativeHeap])}}class u{constructor(t,e){s("string"==typeof e),this.logger=t,this.module=e}open(){return this.logger.open()}close(){return this.logger.close()}setFile(t){this.logger.setFile(t)}setLevel(t){this.logger.setLevel(t)}error(...t){if(this.logger.level<c.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(c.levels.ERROR,e):this.log(c.levels.ERROR,t)}warning(...t){if(this.logger.level<c.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(c.levels.WARNING,e):this.log(c.levels.WARNING,t)}info(...t){if(this.logger.level<c.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(c.levels.INFO,e):this.log(c.levels.INFO,t)}debug(...t){if(this.logger.level<c.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(c.levels.DEBUG,e):this.log(c.levels.DEBUG,t)}spam(...t){if(this.logger.level<c.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(c.levels.SPAM,e):this.log(c.levels.SPAM,t)}log(t,e){this.logger.log(t,this.module,e)}context(t){return new u(this.logger,t)}logError(t,e){this.logger.logError(t,this.module,e)}memory(){this.logger.memory(this.module)}}function l(t){return new Promise((e,i)=>{const r=n.createWriteStream(t,{flags:"a"}),s=()=>{r.removeListener("error",o),r.removeListener("open",a)},o=t=>{try{r.close()}catch(t){}s(),i(t)},a=()=>{s(),e(r)};r.once("error",o),r.once("open",a)})}c.HAS_TTY=Boolean(r.stdout&&r.stdout.isTTY),c.MAX_FILE_SIZE=20<<20,c.levels={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,SPAM:5},c.levelsByVal=["none","error","warning","info","debug","spam"],c.prefixByVal=["N","E","W","I","D","S"],c.styles=["0","1;31","1;33","94","90","90"],c.global=new c,t.exports=c}).call(this,i(0).Buffer,i(23))},function(t,e,i){"use strict";(function(e){
/*!
 * keyring.js - keyring object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(4),n=i(9),o=i(16),a=i(2),h=i(6),c=i(56),u=i(20),l=i(26),f=i(28),d=i(30),p=i(3);class g{constructor(t,e){this.network=o.primary,this.witness=!1,this.nested=!1,this.publicKey=s.ZERO_KEY,this.privateKey=null,this.script=null,this._keyHash=null,this._keyAddress=null,this._program=null,this._nestedHash=null,this._nestedAddress=null,this._scriptHash160=null,this._scriptHash256=null,this._scriptAddress=null,t&&this.fromOptions(t,e)}fromOptions(t,i){i||(i=t.network);let s=m(t);if(null!=t.witness&&(r("boolean"==typeof t.witness),this.witness=t.witness),null!=t.nested&&(r("boolean"==typeof t.nested),this.nested=t.nested),e.isBuffer(s))return this.fromKey(s,i);s=m(t.key),t.publicKey&&(s=m(t.publicKey)),t.privateKey&&(s=m(t.privateKey));const n=t.script,o=t.compressed;return n?this.fromScript(s,n,o,i):this.fromKey(s,o,i)}static fromOptions(t){return(new g).fromOptions(t)}refresh(){this._keyHash=null,this._keyAddress=null,this._program=null,this._nestedHash=null,this._nestedAddress=null,this._scriptHash160=null,this._scriptHash256=null,this._scriptAddress=null}fromPrivate(t,i,s){return r(e.isBuffer(t),"Private key must be a buffer."),r(d.privateKeyVerify(t),"Not a valid private key."),"boolean"!=typeof i&&(s=i,i=null),this.network=o.get(s),this.privateKey=t,this.publicKey=d.publicKeyCreate(t,!1!==i),this}static fromPrivate(t,e,i){return(new g).fromPrivate(t,e,i)}fromPublic(t,i){return r(e.isBuffer(t),"Public key must be a buffer."),r(d.publicKeyVerify(t),"Not a valid public key."),this.network=o.get(i),this.publicKey=t,this}generate(t,e){"boolean"!=typeof t&&(e=t,t=null);const i=d.generatePrivateKey();return this.fromKey(i,t,e)}static generate(t,e){return(new g).generate(t,e)}static fromPublic(t,e){return(new g).fromPublic(t,e)}fromKey(t,i,s){return r(e.isBuffer(t),"Key must be a buffer."),"boolean"!=typeof i&&(s=i,i=null),32===t.length?this.fromPrivate(t,!1!==i,s):this.fromPublic(t,s)}static fromKey(t,e,i){return(new g).fromKey(t,e,i)}fromScript(t,e,i,s){return r(e instanceof u,"Non-script passed into KeyRing."),"boolean"!=typeof i&&(s=i,i=null),this.fromKey(t,i,s),this.script=e,this}static fromScript(t,e,i,r){return(new g).fromScript(t,e,i,r)}getSecretSize(){let t=0;return t+=1,t+=this.privateKey.length,33===this.publicKey.length&&(t+=1),t+4}toSecret(t){const e=this.getSecretSize(),i=new h(e);return r(this.privateKey,"Cannot serialize without private key."),t||(t=this.network),t=o.get(t),i.writeU8(t.keyPrefix.privkey),i.writeBytes(this.privateKey),33===this.publicKey.length&&i.writeU8(1),i.writeChecksum(),c.encode(i.render())}fromSecret(t,e){const i=new a(c.decode(t),!0),s=i.readU8();e=o.fromWIF(s,e);const n=i.readBytes(32);let h=!1;return i.left()>4&&(r(1===i.readU8(),"Bad compression flag."),h=!0),i.verifyChecksum(),this.fromPrivate(n,h,e)}static fromSecret(t,e){return(new g).fromSecret(t,e)}getPrivateKey(t){return this.privateKey?"base58"===t?this.toSecret():"hex"===t?this.privateKey.toString("hex"):this.privateKey:null}getPublicKey(t){return"base58"===t?c.encode(this.publicKey):"hex"===t?this.publicKey.toString("hex"):this.publicKey}getScript(){return this.script}getProgram(){if(!this.witness)return null;if(!this._program){let t;t=this.script?this.script.sha256():n.hash160(this.publicKey),this._program=u.createScript([0,t],u.types.WITNESS)}return this._program}getNestedHash(t){return this.witness?(this._nestedHash||(this._nestedHash=this.getProgram().hash160()),"hex"===t?this._nestedHash.toString("hex"):this._nestedHash):null}getNestedAddress(t){if(!this.witness)return null;if(!this._nestedAddress){const t=this.getNestedHash(),e=l.fromScripthash(t,this.network);this._nestedAddress=e}return"base58"===t?this._nestedAddress.toBase58():"string"===t?this._nestedAddress.toString():this._nestedAddress}getScriptHash(t){return this.witness?this.getScriptHash256(t):this.getScriptHash160(t)}getScriptHash160(t){return this.script?(this._scriptHash160||(this._scriptHash160=this.script.hash160()),"hex"===t?this._scriptHash160.toString("hex"):this._scriptHash160):null}getScriptHash256(t){return this.script?(this._scriptHash256||(this._scriptHash256=this.script.sha256()),"hex"===t?this._scriptHash256.toString("hex"):this._scriptHash256):null}getScriptAddress(t){if(!this.script)return null;if(!this._scriptAddress){let t;if(this.witness){const e=this.getScriptHash256();t=l.fromWitnessScripthash(e,this.network)}else{const e=this.getScriptHash160();t=l.fromScripthash(e,this.network)}this._scriptAddress=t}return"base58"===t?this._scriptAddress.toBase58():"string"===t?this._scriptAddress.toString():this._scriptAddress}getKeyHash(t){return this._keyHash||(this._keyHash=n.hash160(this.publicKey)),"hex"===t?this._keyHash.toString("hex"):this._keyHash}getKeyAddress(t){if(!this._keyAddress){const t=this.getKeyHash();let e;e=this.witness?l.fromWitnessPubkeyhash(t,this.network):l.fromPubkeyhash(t,this.network),this._keyAddress=e}return"base58"===t?this._keyAddress.toBase58():"string"===t?this._keyAddress.toString():this._keyAddress}getHash(t){return this.nested?this.getNestedHash(t):this.script?this.getScriptHash(t):this.getKeyHash(t)}getAddress(t){return this.nested?this.getNestedAddress(t):this.script?this.getScriptAddress(t):this.getKeyAddress(t)}ownHash(t){if(!t)return!1;let e=!1;if(Array.isArray(t)){for(let i of t)e=e||this.ownHash(i);return e}return!!t.equals(this.getKeyHash())||!(!this.script||!t.equals(this.getScriptHash()))||!(!this.witness||!t.equals(this.getNestedHash()))}ownOutput(t,e){let i;return t instanceof f?i=t:(i=t.outputs[e],r(i,"Output does not exist.")),this.ownHash(i.getHashs())}getRedeem(t){if(this.witness&&t.equals(this.getNestedHash()))return this.getProgram();if(this.script){if(t.equals(this.getScriptHash160()))return this.script;if(t.equals(this.getScriptHash256()))return this.script}return null}sign(t){return r(this.privateKey,"Cannot sign without private key."),d.sign(t,this.privateKey)}verify(t,e){return d.verify(t,e,this.publicKey)}signToken(t,i="bookman"){(t=t||{}).cid||(t.cid=i),t.time&&(t.time=p.now()/300|0),t.addr=this.getAddress("string"),t.pubkey=this.publicKey.toString("hex");let r={data:t},s=n.hash256(e.from(p.stringify(r.data)));return r.sig=this.sign(s).toString("hex"),r}getVersion(){return this.witness?this.nested?-1:0:-1}getType(){return this.nested?l.types.SCRIPTHASH:this.witness?l.types.WITNESS:this.script?l.types.SCRIPTHASH:l.types.PUBKEYHASH}inspect(){return this.toJSON()}toJSON(){return{network:this.network.type,witness:this.witness,nested:this.nested,publicKey:this.publicKey.toString("hex"),script:this.script?this.script.toRaw().toString("hex"):null,program:this.witness?this.getProgram().toRaw().toString("hex"):null,type:l.typesByVal[this.getType()].toLowerCase(),address:this.getAddress("string")}}fromJSON(t){return r(t),r("string"==typeof t.network),r("boolean"==typeof t.witness),r("boolean"==typeof t.nested),r("string"==typeof t.publicKey),r(!t.script||"string"==typeof t.script),this.nework=o.get(t.network),this.witness=t.witness,this.nested=t.nested,this.publicKey=e.from(t.publicKey,"hex"),t.script&&(this.script=e.from(t.script,"hex")),this}static fromJSON(t){return(new g).fromJSON(t)}getSize(){let t=0;return t+=1,this.privateKey?(t+=s.sizeVarBytes(this.privateKey),t+=1):t+=s.sizeVarBytes(this.publicKey),t+(this.script?this.script.getVarSize():1)}toWriter(t){let e=0;return this.witness&&(e|=1),this.nested&&(e|=2),t.writeU8(e),this.privateKey?(t.writeVarBytes(this.privateKey),t.writeU8(33===this.publicKey.length)):t.writeVarBytes(this.publicKey),this.script?t.writeVarBytes(this.script.toRaw()):t.writeVarint(0),t}toRaw(){const t=this.getSize();return this.toWriter(new h(t)).render()}fromReader(t,e){this.network=o.get(e);const i=t.readU8();this.witness=0!=(1&i),this.nested=0!=(2&i);const s=t.readVarBytes();if(32===s.length){const e=1===t.readU8();this.privateKey=s,this.publicKey=d.publicKeyCreate(s,e)}else this.publicKey=s,r(d.publicKeyVerify(s),"Invalid public key.");const n=t.readVarBytes();return n.length>0&&(this.script=u.fromRaw(n)),this}fromRaw(t,e){return this.fromReader(new a(t),e)}static fromReader(t){return(new g).fromReader(t)}static fromRaw(t){return(new g).fromRaw(t)}static isKeyRing(t){return t instanceof g}}function m(t){return t?t.privateKey?t.privateKey:t.publicKey?t.publicKey:t:t}t.exports=g}).call(this,i(0).Buffer)},function(t,e,i){"use strict";e.binding=null},function(t,e,i){"use strict";(function(t){
/*!
 * ip.js - ip utils for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(115),n=i(146),o=e,a=t.from("00000000000000000000000000000000","hex"),h=t.from("00000000000000000000000000000001","hex"),c=t.from("0064ff9b0000000000000000","hex"),u=t.from("fe80000000000000","hex"),l=t.from("0000000000000000ffff0000","hex"),f=t.from("fd87d87eeb43","hex"),d=t.from("00000000000000ffff","hex"),p=/^(\d{1,3}\.){3}\d{1,3}$/,g=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;function m(t,e,i,r,s){this.host=t||"0.0.0.0",this.port=e||0,this.type=i||o.types.IPV4,this.hostname=r||"0.0.0.0:0",this.raw=s||a}o.ZERO_IP=a,o.types={DNS:-1,IPV4:4,IPV6:6,ONION:10,TEREDO:11},o.fromHostname=function(t,e){let i,s;if(r("string"==typeof t),r(t.length>0,"Bad address."),"["===t[0])if("]"===t[t.length-1])i=t.slice(1,-1),s=null;else{const e=(t=t.slice(1)).split("]:");r(2===e.length,"Bad IPv6 address."),i=e[0],s=e[1]}else{const e=t.split(":");switch(e.length){case 2:i=e[0],s=e[1];break;case 1:i=e[0],s=null;break;default:r(o.isV6String(t),"Bad IPv6 address."),i=t,s=null}}r(i.length>0,"Bad host."),null!=s?(r(s.length<=5,"Bad port."),r(/^\d+$/.test(s),"Bad port."),s=parseInt(s,10),r(s<=65535)):s=e||0;const n=o.getStringType(i);let a,h;return n!==o.types.DNS&&(a=o.toBuffer(i),i=o.toString(a)),new m(i,s,n,h=n===o.types.IPV6?`[${i}]:${s}`:`${i}:${s}`,a)},o.toHostname=function(t,e){r("string"==typeof t),r(t.length>0),r("number"==typeof e),r(e>=0&&e<=65535),r(!/[\[\]]/.test(t),"Bad host.");const i=o.getStringType(t);return-1!==t.indexOf(":")&&r(i===o.types.IPV6,"Bad host."),i!==o.types.DNS&&(t=o.normalize(t)),i===o.types.IPV6?`[${t}]:${e}`:`${t}:${e}`},o.getStringType=function(t){return o.isV4String(t)?o.types.IPV4:o.isV6String(t)?o.types.IPV6:o.isOnionString(t)?o.types.ONION:o.types.DNS},o.isV4String=function(t){return r("string"==typeof t),!(t.length<7)&&!(t.length>15)&&p.test(t)},o.isV6String=function(t){return r("string"==typeof t),!(t.length<2)&&!(t.length>39)&&g.test(t)},o.isOnionString=function(t){return r("string"==typeof t),!(t.length<7)&&".onion"===t.slice(-6)},o.isMapped=function(e){return r(t.isBuffer(e)),r(16===e.length),0===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&0===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&255===e[10]&&255===e[11]},o.toBuffer=function(e){r("string"==typeof e);const i=t.allocUnsafe(16);if(o.isV4String(e))return i.fill(0),i[10]=255,i[11]=255,o.parseV4(e,i,12);if(o.isOnionString(e)){f.copy(i,0);const t=n.decode(e.slice(0,-6));return r(10===t.length,"Invalid onion address."),t.copy(i,6),i}return o.parseV6(e,i,0)},o.parseV4=function(t,e,i){const s=t.split(".");r(4===s.length);for(let t of s)r(t.length>0),r(t.length<=3),t=parseInt(t,10),r(t>=0&&t<=255),e[i++]=t;return e},o.parseV6=function(t,e,i){const s=t.split(":");let n=8-s.length;r(s.length>=2,"Not an IPv6 address.");for(const t of s)o.isV4String(t)&&n--;const a=i;let h=!1;for(let t=0;t<s.length;t++){let a=s[t];if(0!==a.length)o.isV4String(a)?(o.parseV4(a,e,i),i+=4):(r(a.length<=4),a=parseInt(a,16),r(a==a,"Non-number in IPv6 address."),e[i++]=a>>8&255,e[i++]=255&a);else{for(r(!h,"Overuse of double colon in IPv6 address."),h=!0,n+=1;t+1<s.length&&0===(a=s[t+1]).length;)n+=1,t++;for(;n>0;)e[i++]=0,e[i++]=0,n--}}return r(0===n,"IPv6 address has missing sections."),r.strictEqual(i,a+16),e},o.toString=function(e){if(r(t.isBuffer(e)),4===e.length){let t="";return t+=e[0],t+="."+e[1],t+="."+e[2],t+="."+e[3]}if(16===e.length){if(o.isMapped(e)){let t="";return t+=e[12],t+="."+e[13],t+="."+e[14],t+="."+e[15]}if(o.isOnion(e))return`${n.encode(e.slice(6))}.onion`;let t="";t+=e.readUInt16BE(0,!0).toString(16);for(let i=2;i<16;i+=2)t+=":",t+=e.readUInt16BE(i,!0).toString(16);return t=(t=t.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3")).replace(/:{3,4}/,"::")}throw new Error(`Invalid IP address: ${e.toString("hex")}.`)},o.normalize=function(t){return o.toString(o.toBuffer(t))},o.isIPv4=function(t){return o.isMapped(t)},o.isIPv6=function(t){return!o.isMapped(t)&&!o.isOnion(t)},o.getType=function(t){if(o.isIPv4(t))return o.types.IPV4;if(o.isIPv6(t))return o.types.IPV6;if(o.isOnion(t))return o.types.ONION;throw new Error("Unknown type.")},o.getNetwork=function(t){return o.isRFC4380(t)?o.types.TEREDO:o.getType(t)},o.isNull=function(t){return o.isIPv4(t)?0===t[12]&&0===t[13]&&0===t[14]&&0===t[15]:o.isEqual(t,a)},o.isBroadcast=function(t){return!!o.isIPv4(t)&&255===t[12]&&255===t[13]&&255===t[14]&&255===t[15]},o.isRFC1918=function(t){return!!o.isIPv4(t)&&(10===t[12]||192===t[12]&&168===t[13]||172===t[12]&&t[13]>=16&&t[13]<=31)},o.isRFC2544=function(t){return!!o.isIPv4(t)&&(198===t[12]&&(18===t[13]||19===t[13])||169===t[12]&&254===t[13])},o.isRFC3927=function(t){return!!o.isIPv4(t)&&169===t[12]&&254===t[13]},o.isRFC6598=function(t){return!!o.isIPv4(t)&&100===t[12]&&t[13]>=64&&t[13]<=127},o.isRFC5737=function(t){return!!o.isIPv4(t)&&(192===t[12]&&0===t[13]&&2===t[14]||198===t[12]&&51===t[13]&&100===t[14]||203===t[12]&&0===t[13]&&113===t[14])},o.isRFC3849=function(t){return 32===t[0]&&1===t[1]&&13===t[2]&&184===t[3]},o.isRFC3964=function(t){return 32===t[0]&&2===t[1]},o.isRFC6052=function(t){return o.hasPrefix(t,c)},o.isRFC4380=function(t){return 32===t[0]&&1===t[1]&&0===t[2]&&0===t[3]},o.isRFC4862=function(t){return o.hasPrefix(t,u)},o.isRFC4193=function(t){return 252==(254&t[0])},o.isRFC6145=function(t){return o.hasPrefix(t,l)},o.isRFC4843=function(t){return 32===t[0]&&1===t[1]&&0===t[2]&&16==(240&t[3])},o.isOnion=function(t){return o.hasPrefix(t,f)},o.isLocal=function(t){return o.isIPv4(t)?127===t[12]&&0===t[13]:!!o.isEqual(t,h)},o.isMulticast=function(t){return o.isIPv4(t)?224==(240&t[12]):255===t[0]},o.isValid=function(t){return!(o.hasPrefix(t,d)||o.isNull(t)||o.isBroadcast(t)||o.isRFC3849(t))},o.isRoutable=function(t){return!(!o.isValid(t)||o.isRFC1918(t)||o.isRFC2544(t)||o.isRFC3927(t)||o.isRFC4862(t)||o.isRFC6598(t)||o.isRFC5737(t)||o.isRFC4193(t)&&!o.isOnion(t)||o.isRFC4843(t)||o.isLocal(t))},o.getReachability=function(t,e){if(!o.isRoutable(t))return 0;const i=o.getNetwork(t),r=o.getNetwork(e),s=o.types;switch(r){case s.IPV4:switch(i){case s.IPV4:return 4;default:return 1}break;case s.IPV6:switch(i){case s.TEREDO:return 2;case s.IPV4:return 4;case s.IPV6:return o.isRFC3964(t)||o.isRFC6052(t)||o.isRFC6145(t)?3:5;default:return 1}break;case s.ONION:switch(i){case s.IPV4:return 4;case s.ONION:return 6;default:return 1}break;case s.TEREDO:switch(i){case s.TEREDO:return 2;case s.IPV6:return 3;case s.IPV4:return 4;default:return 1}break;default:switch(i){case s.TEREDO:return 2;case s.IPV6:return 3;case s.IPV4:return 4;case s.ONION:return 6;default:return 1}}},o.hasPrefix=function(e,i){r(t.isBuffer(e)),r(t.isBuffer(i)),r(e.length>=i.length);for(let t=0;t<i.length;t++)if(e[t]!==i[t])return!1;return!0},o.isEqual=function(t,e){return r(16===t.length),r(16===e.length),t.equals(e)},o.getInterfaces=function(t,e){const i=s.networkInterfaces(),r=[];for(const s of Object.keys(i)){const n=i[s];for(const i of n){const s=i.family.toLowerCase();if(e&&s!==e)continue;if(i.internal)continue;let n;try{n=o.toBuffer(i.address)}catch(t){continue}if(!o.isNull(n)&&!o.isLocal(n)){if("public"===t){if(!o.isRoutable(n))continue}else if("private"===t&&o.isRoutable(n))continue;r.push(o.toString(n))}}}return r},o.getPrivate=function(t){return o.getInterfaces("private",t)},o.getPublic=function(t){return o.getInterfaces("public",t)},o.Address=m}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e,r){var s=i(7).Buffer,n=e.crypto||e.msCrypto;n&&n.getRandomValues?t.exports=function(t,i){if(t>65536)throw new Error("requested too many random bytes");var o=new e.Uint8Array(t);t>0&&n.getRandomValues(o);var a=s.from(o.buffer);return"function"==typeof i?r.nextTick(function(){i(null,a)}):a}:t.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,i(12),i(23))},function(t,e,i){var r=i(7).Buffer;function s(t,e){this._block=r.alloc(t),this._finalSize=e,this._blockSize=t,this._len=0}s.prototype.update=function(t,e){"string"==typeof t&&(e=e||"utf8",t=r.from(t,e));for(var i=this._block,s=this._blockSize,n=t.length,o=this._len,a=0;a<n;){for(var h=o%s,c=Math.min(n-a,s-h),u=0;u<c;u++)i[h+u]=t[a+u];a+=c,(o+=c)%s==0&&this._update(i)}return this._len+=n,this},s.prototype.digest=function(t){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var i=8*this._len;if(i<=4294967295)this._block.writeUInt32BE(i,this._blockSize-4);else{var r=(4294967295&i)>>>0,s=(i-r)/4294967296;this._block.writeUInt32BE(s,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var n=this._hash();return t?n.toString(t):n},s.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=s},function(t,e,i){"use strict";(function(e){
/*!
 * mtx.js - mutable transaction object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(3),n=i(20),o=i(17),a=i(68),h=i(28),c=i(41),u=i(37),l=i(44),f=(i(26),i(4)),d=i(10),p=i(33),g=(i(31),i(77)),m=i(197),{OperType:w}=i(8),y=(i(116),i(46),i(53));class b extends o{constructor(t){super(),this.mutable=!0,this.changeIndex=-1,this.view=new l,t&&this.fromOptions(t)}fromOptions(t){if(null!=t.version&&(r(s.isU32(t.version),"Version must a be uint32."),this.version=t.version),t.inputs){r(Array.isArray(t.inputs),"Inputs must be an array.");for(const e of t.inputs)this.addInput(e)}if(t.outputs){r(Array.isArray(t.outputs),"Outputs must be an array.");for(const e of t.outputs)this.addOutput(e)}return null!=t.locktime&&(r(s.isU32(t.locktime),"Locktime must be a uint32."),this.locktime=t.locktime),null!=t.changeIndex&&(-1!==t.changeIndex?(r(s.isU32(t.changeIndex),"Change index must be a uint32."),this.changeIndex=t.changeIndex):this.changeIndex=-1),this}static fromOptions(t){return(new b).fromOptions(t)}clone(){const t=new b;return t.inject(this),t.changeIndex=this.changeIndex,t.view=this.view.clone(),t}addInput(t){const e=a.fromOptions(t);return this.inputs.push(e),e}addOutpoint(t){const e=u.fromOptions(t),i=a.fromOutpoint(e);return this.inputs.push(i),i}addCoin(t){r(t instanceof c,"Cannot add non-coin.");const e=a.fromCoin(t);return this.inputs.push(e),this.view.addCoin(t),e}addTX(t,e,i){r(t instanceof o,"Cannot add non-transaction."),null==i&&(i=-1);const s=a.fromTX(t,e);return this.inputs.push(s),this.view.addIndex(t,e,i),s}addOutput(t,e){let i;return null!=e?(r(s.isU64(e),"Value must be a uint64."),i=h.fromScript(t,e)):i=h.fromOptions(t),this.outputs.push(i),i}propCreate(t,e){let i=null;if(!e.gold)throw new Error("invalid value param.");return r(s.isU64(e.gold),"Value must be a uint64."),i=h.fromScript(t,e.gold,{oper:e.oper,pid:e.pid,cid:e.cid,oid:e.oid}),this.outputs.push(i),i}propExchange(t,e,i){let r=t.outputs[e].value,s=t.outputs[e].getReturnData();if(!s||s.oper!=w.propExchange&&s.oper!=w.propCreate)throw new Error("not a valid exchange transaction.");let n=this.addTX(t,e),o=h.fromScript(i,r,{pid:s.pid,cid:s.cid,oid:s.oid,oper:w.propExchange,prev:{hash:n.prevout.hash,index:n.prevout.index}});return this.outputs.push(o),this}cpRegister(t,e,i){let n=null;if(null==e)throw new Error("invalid value param.");return r(s.isU64(e),"Value must be a uint64."),n=h.fromScript(t,e,i),this.outputs.push(n),n}static cpChange(t,e){let{newName:i,url:r,ip:s,addr:n}=e,o=t.outputs[0].value,a=y.parseContract(t);if(!a||a.oper!=w.cpRegister&&a.oper!=w.cpChange)throw new Error("not a valid cp transaction.");let c=new b,u=c.addTX(t,0);e.url=e.url||a.url,e.ip=e.ip||a.ip,e.cid=a.cid,e.oper=w.cpChange,e.grate=e.grate||a.grate,e.cls=e.cls||a.cls;let l={oper:w.cpChange,cid:a.cid,name:i,url:e.url,ip:e.ip,grate:e.grate,cls:e.cls,prev:{hash:u.prevout.hash,index:u.prevout.index}},f=h.fromScript(n,o,l);return c.outputs.push(f),c}propSale(t,e){this.addTX(t,e)}check(t){return super.check(this.view,t)}async checkAsync(t,e){return super.checkAsync(this.view,t,e)}verify(t){try{this.check(t)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0}async verifyAsync(t,e){try{await this.checkAsync(t,e)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0}getFee(){return super.getFee(this.view)}getInputValue(){return super.getInputValue(this.view)}getInputAddresses(){return super.getInputAddresses(this.view)}getAddresses(){return super.getAddresses(this.view)}getInputHashes(t){return super.getInputHashes(this.view,t)}getHashes(t){return super.getHashes(this.view,t)}hasCoins(){return super.hasCoins(this.view)}getSigops(t){return super.getSigops(this.view,t)}getSigopsCost(t){return super.getSigopsCost(this.view,t)}getSigopsSize(){return super.getSigopsSize(this.getSigopsCost())}verifyInputs(t){const[e]=this.checkInputs(t);return-1!==e}checkInputs(t){return super.checkInputs(this.view,t)}scriptInput(t,e,i){const s=this.inputs[t];if(r(s,"Input does not exist."),r(e,"No coin passed."),0!==s.script.raw.length||0!==s.witness.items.length)return!0;const o=e.script,a=o.getScripthash();if(a){const t=i.getRedeem(a);if(!t)return!1;if(t.isProgram()){const e=t.getWitnessScripthash();if(e){const r=i.getRedeem(e);if(!r)return!1;const n=this.scriptVector(r,i);return!!n&&(n.push(r.toRaw()),s.witness.fromStack(n),s.script.fromItems([t.toRaw()]),!0)}const r=t.getWitnessPubkeyhash();if(r){const e=n.createScript(r),o=this.scriptVector(e,i);return!!o&&(s.witness.fromStack(o),s.script.fromItems([t.toRaw()]),!0)}return!1}const e=this.scriptVector(t,i);return!!e&&(e.push(t.toRaw()),s.script.fromStack(e),!0)}if(o.isProgram()){const t=o.getWitnessScripthash();if(t){const e=i.getRedeem(t);if(!e)return!1;const r=this.scriptVector(e,i);return!!r&&(r.push(e.toRaw()),s.witness.fromStack(r),!0)}const e=o.getWitnessPubkeyhash();if(e){const t=n.createScript(e),r=this.scriptVector(t,i);return!!r&&(s.witness.fromStack(r),!0)}return!1}const h=this.scriptVector(o,i);return!!h&&(s.script.fromStack(h),!0)}scriptVector(t,e){const i=t.getPubkey();if(i){if(!i.equals(e.publicKey))return null;const t=new g;return t.pushInt(0),t}const r=t.getPromises();if(r&&Array.isArray(r)){for(let t of r){if(!t.equals(e.publicKey))continue;const i=new g;return i.pushInt(0),i}return null}const s=t.getPubkeyhash();if(s){if(!s.equals(e.getKeyHash()))return null;const t=new g;return t.pushInt(0),t.pushData(e.publicKey),t}const[,n]=t.getMultisig();if(-1!==n){if(-1===t.indexOf(e.publicKey))return null;const i=new g;i.pushInt(0);for(let t=0;t<n;t++)i.pushInt(0);return i}return null}$signVector(t,e,i,n){const o=t.getPubkey();if(o){if(!n.publicKey.equals(o))return null;if(0===e.length)throw new Error("Input has not been templated.");return e.get(0).length>0?e:(e.set(0,i),e)}const a=t.getPromises();if(a&&Array.isArray(a)){for(let t of a)if(n.publicKey.equals(t)){if(0===e.length)throw new Error("Input has not been templated.");return e.get(0).length>0?e:(e.set(0,i),e)}return null}const h=t.getPubkeyhash();if(h){if(!n.getKeyHash().equals(h))return null;if(2!==e.length)throw new Error("Input has not been templated.");if(0===e.get(1).length)throw new Error("Input has not been templated.");return e.get(0).length>0?e:(e.set(0,i),e)}const[c,u]=t.getMultisig();if(-1!==c){if(e.length<2)throw new Error("Input has not been templated.");if(0!==e.get(0).length)throw new Error("Input has not been templated.");if(e.length-1>u)throw new Error("Input has not been templated.");let o=0;for(let t=1;t<e.length;t++)e.get(t).length>0&&o++;if(o===c&&e.length-1===c)return e;for(;e.length-1<u;)e.pushInt(0);const a=[];for(const e of t.code)e.data&&a.push(e.data);let h=s.indexOf(a,n.publicKey);if(-1===h)return null;if(++h<e.length&&o<c&&0===e.get(h).length&&(e.set(h,i),o++),o>=c){for(let t=e.length-1;t>=1;t--)0===e.get(t).length&&e.remove(t);for(;o>c;)e.pop(),o--;r(o===c),r(e.length-1===c)}return e}return null}signInput(t,e,i,s){const o=this.inputs[t],a=i.privateKey;r(o,"Input does not exist."),r(e,"No coin passed.");const h=e.value;let c=e.script,u=o.script,l=0,f=!1;if(c.isScripthash()){if(!(c=o.script.getRedeem()))throw new Error("Input has not been templated.");f=!0}if(c.isWitnessScripthash()){if(!(c=o.witness.getRedeem()))throw new Error("Input has not been templated.");u=o.witness,f=!0,l=1}else{const t=c.getWitnessPubkeyhash();t&&(c=n.createScript(t),u=o.witness,f=!1,l=1)}const d=this.signature(t,c,h,a,s,l);if(f){const t=u.toStack(),e=t.pop(),r=this.$signVector(c,t,d,i);return!!r&&(r.push(e),u.fromStack(r),!0)}const p=u.toStack(),g=this.$signVector(c,p,d,i);return!!g&&(u.fromStack(g),!0)}getMultisig(t){let e={m:-1,n:-1,c:0};for(let t=0;t<this.inputs.length;t++){const{prevout:i}=this.inputs[t],r=this.view.getOutput(i);if(!r)continue;const s=this.inputs[t];let o=r.script,a=s.script,h=!1;if(o.isScripthash()){if(!(o=s.script.getRedeem()))continue;h=!0}if(o.isWitnessScripthash()){if(!(o=s.witness.getRedeem()))continue;a=s.witness,h=!0}else{const t=o.getWitnessPubkeyhash();t&&(o=n.createScript(t),a=s.witness,h=!1)}const c=a.toStack();if(h&&c.pop(),o.isPubkey())continue;if(o.isPubkeyhash())continue;const[u,l]=o.getMultisig();if(e.m=u,e.n=l,-1!==u)for(let t=1;t<c.length;t++)c.get(t).length>0&&e.c++;break}return e}isSigned(){for(let t=0;t<this.inputs.length;t++){const{prevout:e}=this.inputs[t],i=this.view.getOutput(e);if(!i)return!1;if(!this.$isInputSigned(t,i))return!1}return!0}$isInputSigned(t,e){const i=this.inputs[t];r(i,"Input does not exist."),r(e,"No coin passed.");let s=e.script,o=i.script,a=!1;if(s.isScripthash()){if(!(s=i.script.getRedeem()))return!1;a=!0}if(s.isWitnessScripthash()){if(!(s=i.witness.getRedeem()))return!1;o=i.witness,a=!0}else{const t=s.getWitnessPubkeyhash();t&&(s=n.createScript(t),o=i.witness,a=!1)}const h=o.toStack();return a&&h.pop(),this.isVectorSigned(s,h)}isVectorSigned(t,e){if(t.isPubkey())return 1===e.length&&0!==e.get(0).length;if(t.isPubkeyhash())return 2===e.length&&0!==e.get(0).length&&0!==e.get(1).length;const[i]=t.getMultisig();if(-1!==i){if(e.length-1!==i)return!1;for(let t=1;t<e.length;t++)if(0===e.get(t).length)return!1;return!0}return!1}sign(t,e,i,s){if(s=s||[],Array.isArray(t)){let r=0;for(const n of t)r+=this.sign(n,e,i,s);return r}e&&r(t.privateKey,"No private key available.");let n=0;for(let r=0;r<this.inputs.length;r++){if(-1!=s.indexOf(r)){n++;continue}const{prevout:o}=this.inputs[r],a=this.view.getOutput(o);a&&t.ownOutput(a)&&this.scriptInput(r,a,t)&&(e&&!this.signInput(r,a,t,i)||n++)}return n}async signAsync(t,e,i,r){return r=r||[],i&&i.enabled?await i.sign(this,t,e,r):this.sign(t,!0,e,r)}async estimateSize(t){const e=d.WITNESS_SCALE_FACTOR;let i=0;i+=4,i+=f.sizeVarint(this.inputs.length),i+=40*this.inputs.length,i+=f.sizeVarint(this.outputs.length);for(const t of this.outputs)i+=t.getSize();i+=4;for(const{prevout:r}of this.inputs){const s=this.view.getOutput(r);if(!s){i+=110;continue}const n=s.script;if(n.isPubkey()){i+=1,i+=74;continue}if(n.isPubkeyhash()){i+=1,i+=74,i+=34;continue}const[o]=n.getMultisig();if(-1===o)if(n.isWitnessPubkeyhash()){let t=0;t+=1,t+=74,i+=t=((t+=34)+e-1)/e|0}else{if(t){const e=await t(n);if(-1!==e){i+=e;continue}}if(n.isScripthash())i+=1,i+=149;else if(n.isWitnessScripthash()){let t=0;t+=1,i+=t=((t+=149)+e-1)/e|0}else i+=110}else{let t=0;t+=1,t+=74*o,i+=t+=f.sizeVarint(t)}}return i}subtractFee(t,e){r("number"==typeof t);let i=0;for(let t=0;t<this.outputs.length;t++){const r=this.outputs[t];e&&!e.has(t)||r.script.isUnspendable()||(i+=1)}if(0===i)throw new Error("Could not subtract fee.");const s=t%i,n=(t-s)/i;for(let t=0;t<this.outputs.length;t++){const i=this.outputs[t];if((!e||e.has(t))&&!i.script.isUnspendable()){if(i.value<n+i.getDustThreshold())throw new Error("Could not subtract fee.");i.value-=n}}for(let t=0;t<this.outputs.length;t++){const i=this.outputs[t];if((!e||e.has(t))&&!i.script.isUnspendable()&&i.value>=s+i.getDustThreshold())return void(i.value-=s)}throw new Error("Could not subtract fee.")}async fund(t,e){r(e,"Options are required."),r(e.changeAddress,"Change address is required."),r(e.allowPreInput||0===this.inputs.length,"TX is already funded.");const i=await new m(this,e).select(t);for(const t of i.chosen)this.addCoin(t);i.subtractFee&&this.subtractFee(i.fee,i.subtractIndex);const s=new h;return s.value=i.change,s.script.fromAddress(i.changeAddress),e.noChange||s.isDust(p.MIN_RELAY)?(this.changeIndex=-1,r.strictEqual(this.getFee(),i.fee+i.change)):(this.outputs.push(s),this.changeIndex=this.outputs.length-1,r.strictEqual(this.getFee(),i.fee)),i}sortMembers(){let t=null;-1!==this.changeIndex&&(t=this.outputs[this.changeIndex],r(t)),this.inputs.sort(v),this.outputs.sort(k),-1!==this.changeIndex&&(this.changeIndex=this.outputs.indexOf(t),r(-1!==this.changeIndex))}avoidFeeSniping(t){r("number"==typeof t,"Must pass in height."),0===s.random(0,10)&&(t-=s.random(0,100))<0&&(t=0),this.setLocktime(t)}setLocktime(t){r(s.isU32(t),"Locktime must be a uint32."),r(this.inputs.length>0,"Cannot set sequence with no inputs.");for(const t of this.inputs)4294967295===t.sequence&&(t.sequence=4294967294);this.locktime=t}setSequence(t,e,i){const n=this.inputs[t];r(n,"Input does not exist."),r(s.isU32(e),"Locktime must be a uint32."),this.version=2,i?(e>>>=d.SEQUENCE_GRANULARITY,e&=d.SEQUENCE_MASK,e|=d.SEQUENCE_TYPE_FLAG):e&=d.SEQUENCE_MASK,n.sequence=e}inspect(){return this.format()}format(){return super.format(this.view)}toJSON(){return super.getJSON(null,this.view)}getJSON(t){return super.getJSON(t,this.view)}static fromJSON(t){return(new b).fromJSON(t)}static fromReader(t){return(new b).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new b).fromRaw(t)}toTX(){return(new o).inject(this)}commit(){return[this.toTX(),this.view]}static fromTX(t,e=0){return(new b).inject(t,e)}static isMTX(t){return t instanceof b}}function v(t,e){return t.compare(e)}function k(t,e){return t.compare(e)}t.exports=b}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * block.js - block object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(3),n=i(4),o=i(9),a=i(96),h=i(10),c=i(110),u=i(2),l=i(6),f=i(17),d=i(111),p=i(69),g=i(16);class m extends c{constructor(t){super(),this.txs=[],this._raw=null,this._size=-1,this._witness=-1,t&&this.fromOptions(t)}fromOptions(t){if(this.parseOptions(t),t.txs){r(Array.isArray(t.txs));for(const e of t.txs)r(e instanceof f),this.txs.push(e)}}static fromOptions(t){return(new m).fromOptions(t)}refresh(t){if(this._refresh(),this._raw=null,this._size=-1,this._witness=-1,t)for(const t of this.txs)t.refresh()}toRaw(){return this.frame().data}toNormal(){return this.hasWitness()?this.frameNormal().data:this.toRaw()}toWriter(t){if(this.mutable)return this.writeWitness(t);const e=this.frame();return t.writeBytes(e.data),t}toNormalWriter(t){return this.hasWitness()?(this.writeNormal(t),t):this.toWriter(t)}frame(){if(this.mutable)return r(!this._raw),this.frameWitness();if(this._raw){r(this._size>=0),r(this._witness>=0);const t=new w(this._size,this._witness);return t.data=this._raw,t}const t=this.frameWitness();return this._raw=t.data,this._size=t.size,this._witness=t.witness,t}getSizes(){return this.mutable?this.getWitnessSizes():this.frame()}getVirtualSize(){const t=h.WITNESS_SCALE_FACTOR;return(this.getWeight()+t-1)/t|0}getWeight(){const t=this.getSizes();return(t.size-t.witness)*(h.WITNESS_SCALE_FACTOR-1)+t.size}getSize(){return this.getSizes().size}getBaseSize(){const t=this.getSizes();return t.size-t.witness}hasWitness(){if(-1!==this._witness)return 0!==this._witness;for(const t of this.txs)if(t.hasWitness())return!0;return!1}hasTX(t){return-1!==this.indexOf(t)}indexOf(t){for(let e=0;e<this.txs.length;e++)if(this.txs[e].hash("hex")===t)return e;return-1}createMerkleRoot(t){const e=[];for(const t of this.txs)e.push(t.hash());const[i,r]=a.createRoot(e);return r?null:"hex"===t?i.toString("hex"):i}createWitnessNonce(){return e.from(n.ZERO_HASH)}createCommitmentHash(t){const e=this.getWitnessNonce(),i=[];r(e,"No witness nonce present."),i.push(n.ZERO_HASH);for(let t=1;t<this.txs.length;t++){const e=this.txs[t];i.push(e.witnessHash())}const[s]=a.createRoot(i),h=o.root256(s,e);return"hex"===t?h.toString("hex"):h}getMerkleRoot(t){return"hex"===t?this.merkleRoot:e.from(this.merkleRoot,"hex")}getWitnessNonce(){if(0===this.txs.length)return null;const t=this.txs[0];if(1!==t.inputs.length)return null;const e=t.inputs[0];return 1!==e.witness.items.length?null:32!==e.witness.items[0].length?null:e.witness.items[0]}getCommitmentHash(t){if(0===this.txs.length)return null;const e=this.txs[0];let i;for(let t=e.outputs.length-1;t>=0;t--){const r=e.outputs[t];if(r.script.isCommitment()){i=r.script.getCommitment();break}}return i?"hex"===t?i.toString("hex"):i:null}verifyBody(){const[t]=this.checkBody();return t}checkBody(){const t=this.createMerkleRoot("hex");if(!t)return[!1,"bad-txns-duplicate",100];if(this.merkleRoot!==t)return[!1,"bad-txnmrklroot",100];if(0===this.txs.length||this.txs.length>h.MAX_BLOCK_SIZE||this.getBaseSize()>h.MAX_BLOCK_SIZE)return[!1,"bad-blk-length",100];if(0===this.txs.length||!this.txs[0].isCoinbase())return[!1,"bad-cb-missing",100];const e=h.WITNESS_SCALE_FACTOR;let i=0;for(let t=0;t<this.txs.length;t++){const r=this.txs[t];if(t>0&&r.isCoinbase())return[!1,"bad-cb-multiple",100];const[s,n,o]=r.checkSanity();if(!s)return[s,n,o];if((i+=r.getLegacySigops())*e>h.MAX_BLOCK_SIGOPS_COST)return[!1,"bad-blk-sigops",100]}return[!0,"valid",0]}getCoinbaseHeight(){if(this.version<2)return-1;if(0===this.txs.length)return-1;const t=this.txs[0];return 0===t.inputs.length?-1:t.inputs[0].script.getCoinbaseHeight()}getClaimed(){return r(this.txs.length>0),r(this.txs[0].isCoinbase()),this.txs[0].getOutputValue()}getPrevout(){const t=Object.create(null);for(let e=1;e<this.txs.length;e++){const i=this.txs[e];for(const e of i.inputs)t[e.prevout.hash]=!0}return Object.keys(t)}inspect(){return this.format()}format(t,e){const i=this.getCommitmentHash("hex");return{hash:this.rhash(),height:null!=e?e:-1,size:this.getSize(),virtualSize:this.getVirtualSize(),date:s.date(this.time),version:s.hex32(this.version),prevBlock:s.revHex(this.prevBlock),merkleRoot:s.revHex(this.merkleRoot),commitmentHash:i?s.revHex(i):null,time:this.time,bits:this.bits,nonce:this.nonce,txs:this.txs.map((e,i)=>e.format(t,null,i))}}formatInsight(){return{hash:this.rhash(),rhash:()=>this.hash,version:s.hex32(this.version),prevBlock:s.revHex(this.prevBlock),merkleRoot:s.revHex(this.merkleRoot),raw:this.toRaw(),ts:this.time,bits:this.bits,nonce:this.nonce,txs:this.txs.map((t,e)=>t.formatInsight(e,this.time))}}toJSON(){return this.getJSON()}getJSON(t,e,i,r){return t=g.get(t),{hash:this.rhash(),height:i,confirmations:r,version:this.version,prevBlock:s.revHex(this.prevBlock),merkleRoot:s.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce,txs:this.txs.map((i,r)=>i.getJSON(t,e,null,r))}}fromJSON(t){r(t,"Block data is required."),r(Array.isArray(t.txs)),this.parseJSON(t);for(const e of t.txs)this.txs.push(f.fromJSON(e));return this}static fromJSON(t){return(new m).fromJSON(t)}fromReader(t){t.start(),this.readHead(t);const e=t.readVarint();let i=0;for(let r=0;r<e;r++){const e=f.fromReader(t);i+=e._witness,this.txs.push(e)}return this.mutable||(this._raw=t.endData(),this._size=this._raw.length,this._witness=i),this}fromRaw(t){return this.fromReader(new u(t))}static fromReader(t){return(new m).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new m).fromRaw(t)}toMerkle(t){return d.fromBlock(this,t)}writeNormal(t){this.writeHead(t),t.writeVarint(this.txs.length);for(const e of this.txs)e.toNormalWriter(t);return t}writeWitness(t){this.writeHead(t),t.writeVarint(this.txs.length);for(const e of this.txs)e.toWriter(t);return t}frameNormal(){const t=this.getNormalSizes(),e=new l(t.size);return this.writeNormal(e),t.data=e.render(),t}frameWitness(){const t=this.getWitnessSizes(),e=new l(t.size);return this.writeWitness(e),t.data=e.render(),t}toHeaders(){return p.fromBlock(this)}getNormalSizes(){let t=0;t+=80,t+=n.sizeVarint(this.txs.length);for(const e of this.txs)t+=e.getBaseSize();return new w(t,0)}getWitnessSizes(){let t=0,e=0;t+=80,t+=n.sizeVarint(this.txs.length);for(const i of this.txs){const r=i.getSizes();t+=r.size,e+=r.witness}return new w(t,e)}static isBlock(t){return t instanceof m}}function w(t,e){this.data=null,this.size=t,this.witness=e}t.exports=m}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * facade.js - 门面对象
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(4),s=i(259),n=i(9),o=i(70),a=i(3),{OperType:h,contractStatus:c,operatorType:u,OperTypeExecutable:l}=i(8),f=Object.values(l),d=i(112),p=i(263),{opcodes:g}=i(27),m=new class{constructor(){this.autoTaskMgr=new s(this),this.transactionList=new o}async FactoryOfContract(t,e,i){i.facade=this,i.tx=e,i.hash=e.hash("hex"),i.raw=e.toRaw().toString("hex");let r={};return r=i.contract?i.contract:this.parseContract(e,await i.finder(e.inputs[0].prevout.hash),e.inputs[0].prevout.index),new(p(r))(t,r,i)}parseContract(t,e,i){if(e&&1==t.inputs.length&&1==t.outputs.length&&t.outputs[0].script.code[0].value!=g.OP_RETURN&&t.outputs[0].script.code[0].value!=g.OP_COINBASE&&t.outputs[0].script.code[0].value!=g.OP_CPREGISTER&&t.outputs[0].script.code[0].value!=g.OP_CPCHANGE&&t.outputs[0].script.code[0].value!=g.OP_PROPEXCHANGE&&t.outputs[0].script.code[0].value!=g.OP_PROPCREATE&&t.inputs[0].prevout.hash!=r.NULL_HASH){let t=e.outputs[i];if(t&&t.script.code[0].value==g.OP_PROPEXCHANGE)return{oper:h.propFound,ori:t.getReturnData(),addr:t.getAddress().toString()}}if(!t.outputs[0]||-1==[g.OP_RETURN,g.OP_COINBASE,g.OP_CPREGISTER,g.OP_CPCHANGE].indexOf(t.outputs[0].script.code[0].value))return null;let s=null;try{t.outputs[0].script.code[1]&&t.outputs[0].script.code[1].data&&(s=t.outputs[0].getReturnData())}catch(t){s=null}if(!s||-1==f.indexOf(s.oper))return null;switch(s.oper){case h.coinbase:{let t={sig:s.sig,oper:h.coinbase};Reflect.deleteProperty(s,"sig"),t.data=s,s=t;break}case h.propSale:if(t.outputs.length>=3)try{s.buyOrder=t.outputs[2].getReturnData(),s.bid=Math.min(t.outputs[1].value,s.fixed)}catch(t){return console.error(t),null}else s.bid=s.price;break;case h.contractCreate:if(t.outputs.length>=2)try{let e=t.outputs[1].getReturnData();e.ori=s,s=e}catch(t){return console.error(t),null}}return s}async checkSum(t,e,i){if(t.txcheckpoint&&t.txcheckpoint.getCheck&&t.txcheckpoint.getCheck(e).length>0)try{let r=t.txcheckpoint.getCheck(e);if(r.length>0){let t=r[Math.floor(Math.random()*r.length)],e=a.sprintf(t.url,i,0),s=await d.pGetUrl(e);if(t.check(s))return!0}}catch(t){}return!1}queryContract(t,e){let i=this.transactionList.get(`${t}.${e}`);return i?i.transStatus:c.None}addTransContract(t,e,i,r){e.id=`${e.type}.${e.addr}`;let s=this.transactionList.get(e.id);switch(t){case u.Mem:s&&(e=s),e.transStatus||(e.transStatus=c.CreatedOnMem),this.saveContract(e,i,r);break;case u.DbInit:case u.WalletInit:this.saveContract(e)}}saveContract(t,i,r){if(t.id=t.id||`${t.type}.${t.addr}`,this.transactionList.set(t.id,t),i&&"function"==typeof r){const s=n.hash256(e.from(t.id)).toString("hex");i.batchPut(r(s),e.from(JSON.stringify(t)))}}promiseContract(t,e,i){let r=!1,s=`${t.type}.${t.addr}`,n=this.transactionList.get(s);return(!n||n.transStatus<=c.Promised)&&((n=t).transStatus=c.Promised,r=!0),this.saveContract(n,e,i),r}confirmContract(t,e,i,r){let s=`${t.type}.${t.addr}`,n=this.transactionList.get(s);n&&n.transStatus==c.Promised&&(e!=c.Confirmed&&e!=c.Expired||(n.transStatus=e,this.saveContract(n,i,r)))}executeContract(t,e,i,r){let s=`${t.type}.${t.addr}`,n=this.transactionList.get(s);!n||n.transStatus!=c.Expired&&n.transStatus!=c.Confirmed||(n.transStatus=e,this.saveContract(n,i,r))}delTransContract(t,i,r){let s=`${t.type}.${t.addr}`,o=this.transactionList.get(s);if(o&&o.oper==t.oper&&(this.transactionList.delete(s),i&&"function"==typeof r)){const t=n.hash256(e.from(s)).toString("hex");i.batchDel(r(t))}}};t.exports=m}).call(this,i(0).Buffer)},function(t,e){function i(t,e){if(!t)throw new Error(e||"Assertion failed")}t.exports=i,i.equal=function(t,e,i){if(t!=e)throw new Error(i||"Assertion failed: "+t+" != "+e)}},function(t,e,i){"use strict";var r=i(32),s=i(54);function n(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}e.BlockHash=n,n.prototype.update=function(t,e){if(t=r.toArray(t,e),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){var i=(t=this.pending).length%this._delta8;this.pending=t.slice(t.length-i,t.length),0===this.pending.length&&(this.pending=null),t=r.join32(t,0,t.length-i,this.endian);for(var s=0;s<t.length;s+=this._delta32)this._update(t,s,s+this._delta32)}return this},n.prototype.digest=function(t){return this.update(this._pad()),s(null===this.pending),this._digest(t)},n.prototype._pad=function(){var t=this.pendingTotal,e=this._delta8,i=e-(t+this.padLength)%e,r=new Array(i+this.padLength);r[0]=128;for(var s=1;s<i;s++)r[s]=0;if(t<<=3,"big"===this.endian){for(var n=8;n<this.padLength;n++)r[s++]=0;r[s++]=0,r[s++]=0,r[s++]=0,r[s++]=0,r[s++]=t>>>24&255,r[s++]=t>>>16&255,r[s++]=t>>>8&255,r[s++]=255&t}else for(r[s++]=255&t,r[s++]=t>>>8&255,r[s++]=t>>>16&255,r[s++]=t>>>24&255,r[s++]=0,r[s++]=0,r[s++]=0,r[s++]=0,n=8;n<this.padLength;n++)r[s++]=0;return r}},function(t,e,i){"use strict";(function(t){
/*!
 * base58.js - base58 for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(47).binding,n="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",o={};for(let t=0;t<n.length;t++)o[n[t]]=t;e.encode=function(e){let i=0,s=0;for(;s<e.length&&0===e[s];s++)i++;const o=t.allocUnsafe(1+(138*e.length/100|0));o.fill(0);let a=0;for(;s<e.length;s++){let t=e[s],i=0;for(let e=o.length-1;e>=0&&!(0===t&&i>=a);e--,i++)t+=256*o[e],o[e]=t%58,t=t/58|0;r(0===t),a=i}for(s=o.length-a;s<o.length&&0===o[s];)s++;let h="";for(let t=0;t<i;t++)h+="1";for(;s<o.length;s++)h+=n[o[s]];return h},s&&(e.encode=s.toBase58),e.decode=function(e){let i=0,s=0;for(;s<e.length&&"1"===e[s];s++)i++;const n=t.allocUnsafe(1+(733*e.length/1e3|0));n.fill(0);let a=0;for(;s<e.length;s++){const t=o[e[s]];if(null==t)throw new Error("Non-base58 character.");let i=t,h=0;for(let t=n.length-1;t>=0&&!(0===i&&h>=a);t--,h++)i+=58*n[t],n[t]=i%256,i=i/256|0;r(0===i),a=h}for(s=0;s<n.length&&0===n[s];)s++;const h=t.allocUnsafe(i+(n.length-s));let c;for(c=0;c<i;c++)h[c]=0;for(;s<n.length;)h[c++]=n[s++];return h},s&&(e.decode=s.fromBase58)}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * scriptnum.js - script number object for gamegold.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),{I64:s}=i(87),n=i(67),o=e.alloc(0);class a extends s{constructor(t,e){super(t,e)}getInt(){return this.lt(s.INT32_MIN)?s.LONG_MIN:this.gt(s.INT32_MAX)?s.LONG_MAX:this.toInt()}toRaw(){let t=this;if(t.isZero())return o;let i=!1;t.isNeg()&&(t=t.neg(),i=!0);const s=t.byteLength();let n=0;t.testn(8*s-1)&&(n=1);const a=e.allocUnsafe(s+n);switch(s){case 8:a[7]=t.hi>>>24&255;case 7:a[6]=t.hi>>16&255;case 6:a[5]=t.hi>>8&255;case 5:a[4]=255&t.hi;case 4:a[3]=t.lo>>>24&255;case 3:a[2]=t.lo>>16&255;case 2:a[1]=t.lo>>8&255;case 1:a[0]=255&t.lo}return 128&a[s-1]?(r(1===n),r(a.length===s+n),a[s]=i?128:0):i?(r(0===n),r(a.length===s),a[s-1]|=128):(r(0===n),r(a.length===s)),a}fromRaw(t){if(r(e.isBuffer(t)),0===t.length)return this;switch(t.length){case 8:this.hi|=t[7]<<24;case 7:this.hi|=t[6]<<16;case 6:this.hi|=t[5]<<8;case 5:this.hi|=t[4];case 4:this.lo|=t[3]<<24;case 3:this.lo|=t[2]<<16;case 2:this.lo|=t[1]<<8;case 1:this.lo|=t[0];break;default:for(let e=0;e<t.length;e++)this.orb(e,t[e])}return 128&t[t.length-1]&&(this.setn(8*t.length-1,0),this.ineg()),this}encode(){return this.toRaw()}decode(t,i,s){if(r(e.isBuffer(t)),null!=s&&t.length>s)throw new n("UNKNOWN_ERROR","Script number overflow.");if(i&&!a.isMinimal(t))throw new n("UNKNOWN_ERROR","Non-minimal script number.");return this.fromRaw(t)}inspect(){return`<ScriptNum: ${this.toString(10)}>`}static isMinimal(t){if(r(e.isBuffer(t)),0===t.length)return!0;if(0==(127&t[t.length-1])){if(1===t.length)return!1;if(0==(128&t[t.length-2]))return!1}return!0}static decode(t,e,i){return(new a).decode(t,e,i)}static isScriptNum(t){return t instanceof a}}t.exports=a}).call(this,i(0).Buffer)},function(t,e,i){(function(t){function i(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===i(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===i(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===i(t)},e.isError=function(t){return"[object Error]"===i(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * async.js - async object class for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(24),n=i(34);t.exports=class extends s{constructor(){super(),this._asyncLock=new n,this._hooks=Object.create(null),this.loading=!1,this.closing=!1,this.loaded=!1,this.$eid=""}get eid(){return this.$eid}set eid(t){this.$eid=t}async open(){const t=await this._asyncLock.lock();try{return await this.__open()}catch(t){throw t}finally{t()}}async __open(){let t=null;if(!this.loaded){await this.fire("preopen"),this.loading=!0;try{t=await this._open()}catch(t){throw this.loading=!1,this.emit("error",t),t}return this.loading=!1,this.loaded=!0,await this.fire("open"),t}}async destroy(){return await this.close()}async close(){const t=await this._asyncLock.lock();try{return await this.__close()}finally{t()}}async __close(){if(this.loaded){await this.fire("preclose"),this.closing=!0;try{await this._close()}catch(t){throw this.closing=!1,this.emit("error",t),t}this.closing=!1,this.loaded=!1,await this.fire("close")}}_open(t){throw new Error("Abstract method.")}_close(t){throw new Error("Abstract method.")}hook(t,e){r("string"==typeof t,"`type` must be a string."),this._hooks[t]||(this._hooks[t]=[]),this._hooks[t].push(e)}async fire(){await this.fireHook.apply(this,arguments),this.emit.apply(this,arguments)}async fireHook(t){r("string"==typeof t,"`type` must be a string.");const e=this._hooks[t];if(!e||0===e.length)return;let i;for(const t of e)switch(arguments.length){case 1:await t();break;case 2:await t(arguments[1]);break;case 3:await t(arguments[1],arguments[2]);break;case 4:await t(arguments[1],arguments[2],arguments[3]);break;default:if(!i){i=new Array(arguments.length-1);for(let t=1;t<arguments.length;t++)i[t-1]=arguments[t]}await t.apply(null,i)}}}},function(t,e,i){"use strict";
/*!
 * common.js - p2p constants for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(114);e.PROTOCOL_VERSION=70015,e.MIN_VERSION=70001,e.HEADERS_VERSION=31800,e.PONG_VERSION=6e4,e.BLOOM_VERSION=70011,e.COMPACT_VERSION=70014,e.COMPACT_WITNESS_VERSION=70015,e.services={NETWORK:1,GETUTXO:2,BLOOM:4,WITNESS:8},e.LOCAL_SERVICES=0|e.services.NETWORK|e.services.WITNESS,e.REQUIRED_SERVICES=0|e.services.NETWORK,e.USER_AGENT=`/gamegold:${r.version}/`,e.MAX_MESSAGE=4e6,e.BAN_TIME=86400,e.BAN_SCORE=100},function(t,e,i){"use strict";(function(e){var r=i(5),s=i(99),n=i(100),o=i(101),a=i(38);function h(t){a.call(this,"digest"),this._hash=t,this.buffers=[]}function c(t){a.call(this,"digest"),this._hash=t}r(h,a),h.prototype._update=function(t){this.buffers.push(t)},h.prototype._final=function(){var t=e.concat(this.buffers),i=this._hash(t);return this.buffers=null,i},r(c,a),c.prototype._update=function(t){this._hash.update(t)},c.prototype._final=function(){return this._hash.digest()},t.exports=function(t){return"md5"===(t=t.toLowerCase())?new h(s):new c("rmd160"===t||"ripemd160"===t?new n:o(t))}}).call(this,i(0).Buffer)},function(t,e,i){(function(e){t.exports=function(t,i){for(var r=Math.min(t.length,i.length),s=new e(r),n=0;n<r;++n)s[n]=t[n]^i[n];return s}}).call(this,i(0).Buffer)},function(t,e,i){var r=e;r.bignum=i(14),r.define=i(315).define,r.base=i(64),r.constants=i(166),r.decoders=i(320),r.encoders=i(322)},function(t,e,i){var r=e;r.Reporter=i(317).Reporter,r.DecoderBuffer=i(165).DecoderBuffer,r.EncoderBuffer=i(165).EncoderBuffer,r.Node=i(318)},function(t,e,i){"use strict";
/*!
 * common.js - constants for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */e.lockFlags={VERIFY_SEQUENCE:1,MEDIAN_TIME_PAST:2},e.lockFlags.MANDATORY_LOCKTIME_FLAGS=0,e.lockFlags.STANDARD_LOCKTIME_FLAGS=0|e.lockFlags.VERIFY_SEQUENCE|e.lockFlags.MEDIAN_TIME_PAST,e.thresholdStates={DEFINED:0,STARTED:1,LOCKED_IN:2,ACTIVE:3,FAILED:4,getName:t=>{let i;switch(t){case e.thresholdStates.DEFINED:i="defined";break;case e.thresholdStates.STARTED:i="started";break;case e.thresholdStates.LOCKED_IN:i="locked_in";break;case e.thresholdStates.ACTIVE:i="active";break;case e.thresholdStates.FAILED:i="failed";break;default:assert(!1,"Bad state.")}return i}},e.flags={VERIFY_NONE:0,VERIFY_POW:1,VERIFY_BODY:2},e.flags.DEFAULT_FLAGS=0|e.flags.VERIFY_POW|e.flags.VERIFY_BODY},function(t,e,i){(function(t,r){var s=/%[sdj%]/g;e.format=function(t){if(!w(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(a(arguments[i]));return e.join(" ")}i=1;for(var r=arguments,n=r.length,o=String(t).replace(s,function(t){if("%%"===t)return"%";if(i>=n)return t;switch(t){case"%s":return String(r[i++]);case"%d":return Number(r[i++]);case"%j":try{return JSON.stringify(r[i++])}catch(t){return"[Circular]"}default:return t}}),h=r[i];i<n;h=r[++i])g(h)||!v(h)?o+=" "+h:o+=" "+a(h);return o},e.deprecate=function(i,s){if(y(t.process))return function(){return e.deprecate(i,s).apply(this,arguments)};if(!0===r.noDeprecation)return i;var n=!1;return function(){if(!n){if(r.throwDeprecation)throw new Error(s);r.traceDeprecation?console.trace(s):console.error(s),n=!0}return i.apply(this,arguments)}};var n,o={};function a(t,i){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(i)?r.showHidden=i:i&&e._extend(r,i),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=h),u(r,t,r.depth)}function h(t,e){var i=a.styles[e];return i?"["+a.colors[i][0]+"m"+t+"["+a.colors[i][1]+"m":t}function c(t,e){return t}function u(t,i,r){if(t.customInspect&&i&&x(i.inspect)&&i.inspect!==e.inspect&&(!i.constructor||i.constructor.prototype!==i)){var s=i.inspect(r,t);return w(s)||(s=u(t,s,r)),s}var n=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(w(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}return m(e)?t.stylize(""+e,"number"):p(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}(t,i);if(n)return n;var o=Object.keys(i),a=function(t){var e={};return o.forEach(function(t,i){e[t]=!0}),e}();if(t.showHidden&&(o=Object.getOwnPropertyNames(i)),S(i)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return l(i);if(0===o.length){if(x(i)){var h=i.name?": "+i.name:"";return t.stylize("[Function"+h+"]","special")}if(b(i))return t.stylize(RegExp.prototype.toString.call(i),"regexp");if(k(i))return t.stylize(Date.prototype.toString.call(i),"date");if(S(i))return l(i)}var c,v="",E=!1,R=["{","}"];return d(i)&&(E=!0,R=["[","]"]),x(i)&&(v=" [Function"+(i.name?": "+i.name:"")+"]"),b(i)&&(v=" "+RegExp.prototype.toString.call(i)),k(i)&&(v=" "+Date.prototype.toUTCString.call(i)),S(i)&&(v=" "+l(i)),0!==o.length||E&&0!=i.length?r<0?b(i)?t.stylize(RegExp.prototype.toString.call(i),"regexp"):t.stylize("[Object]","special"):(t.seen.push(i),c=E?function(t,e,i,r,s){for(var n=[],o=0,a=e.length;o<a;++o)A(e,String(o))?n.push(f(t,e,i,r,String(o),!0)):n.push("");return s.forEach(function(s){s.match(/^\d+$/)||n.push(f(t,e,i,r,s,!0))}),n}(t,i,r,a,o):o.map(function(e){return f(t,i,r,a,e,E)}),t.seen.pop(),function(t,e,i){return t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1]:i[0]+e+" "+t.join(", ")+" "+i[1]}(c,v,R)):R[0]+v+R[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,i,r,s,n){var o,a,h;if((h=Object.getOwnPropertyDescriptor(e,s)||{value:e[s]}).get?a=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(a=t.stylize("[Setter]","special")),A(r,s)||(o="["+s+"]"),a||(t.seen.indexOf(h.value)<0?(a=g(i)?u(t,h.value,null):u(t,h.value,i-1)).indexOf("\n")>-1&&(a=n?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),y(o)){if(n&&s.match(/^\d+$/))return a;(o=JSON.stringify(""+s)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function d(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function g(t){return null===t}function m(t){return"number"==typeof t}function w(t){return"string"==typeof t}function y(t){return void 0===t}function b(t){return v(t)&&"[object RegExp]"===E(t)}function v(t){return"object"==typeof t&&null!==t}function k(t){return v(t)&&"[object Date]"===E(t)}function S(t){return v(t)&&("[object Error]"===E(t)||t instanceof Error)}function x(t){return"function"==typeof t}function E(t){return Object.prototype.toString.call(t)}function R(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(y(n)&&(n=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!o[t])if(new RegExp("\\b"+t+"\\b","i").test(n)){var i=r.pid;o[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,i,r)}}else o[t]=function(){};return o[t]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=p,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=m,e.isString=w,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=b,e.isObject=v,e.isDate=k,e.isError=S,e.isFunction=x,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=i(221);var _=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[R(t.getHours()),R(t.getMinutes()),R(t.getSeconds())].join(":");return[t.getDate(),_[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=i(5),e._extend=function(t,e){if(!e||!v(e))return t;for(var i=Object.keys(e),r=i.length;r--;)t[i[r]]=e[i[r]];return t}}).call(this,i(12),i(23))},function(t,e,i){"use strict";
/*!
 * scripterror.js - script error for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */class r extends Error{constructor(t,e,i){super(),this.type="ScriptError",this.code=t,this.message=t,this.op=-1,this.ip=-1,"string"==typeof e?this.message=e:e&&(this.message=`${t} (op=${e.toSymbol()}, ip=${i})`,this.op=e.value,this.ip=i),Error.captureStackTrace&&Error.captureStackTrace(this,r)}}t.exports=r},function(t,e,i){"use strict";(function(e){
/*!
 * input.js - input object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(3),n=i(16),o=i(20),a=i(78),h=i(37),c=i(6),u=i(2),l=i(26);class f{constructor(t){this.prevout=new h,this.script=new o,this.sequence=4294967295,this.witness=new a,t&&this.fromOptions(t)}fromOptions(t){return r(t,"Input data is required."),this.prevout.fromOptions(t.prevout),t.script&&this.script.fromOptions(t.script),null!=t.sequence&&(r(s.isU32(t.sequence),"Sequence must be a uint32."),this.sequence=t.sequence),t.witness&&this.witness.fromOptions(t.witness),this}static fromOptions(t){return(new f).fromOptions(t)}clone(){const t=new f;return t.prevout=this.prevout,t.script.inject(this.script),t.sequence=this.sequence,t.witness.inject(this.witness),t}equals(t){return r(f.isInput(t)),this.prevout.equals(t.prevout)}compare(t){return r(f.isInput(t)),this.prevout.compare(t.prevout)}getType(t){if(this.isCoinbase())return"coinbase";if(t)return t.getType();let e;return e=this.witness.items.length>0?this.witness.getInputType():this.script.getInputType(),o.typesByVal[e].toLowerCase()}getRedeem(t){if(this.isCoinbase())return null;if(!t)return this.witness.isScripthashInput()?this.witness.getRedeem():this.script.isScripthashInput()?this.script.getRedeem():null;let e=t.script,i=null;return e.isScripthash()&&(i=e=this.script.getRedeem()),e&&e.isWitnessScripthash()&&(i=e=this.witness.getRedeem()),i}getSubtype(t){if(this.isCoinbase())return null;const e=this.getRedeem(t);if(!e)return null;const i=e.getType();return o.typesByVal[i].toLowerCase()}getAddress(t){return this.isCoinbase()?null:t?t.getAddress():this.witness.items.length>0?l.fromWitness(this.witness):l.fromInputScript(this.script)}getHash(t){const e=this.getAddress();return e?e.getHash(t):null}isFinal(){return 4294967295===this.sequence}isRBF(){return this.sequence<4294967294}isCoinbase(){return this.prevout.isNull()}inspect(){return this.format()}format(t){return{type:this.getType(t),subtype:this.getSubtype(t),address:this.getAddress(t),script:this.script,witness:this.witness,redeem:this.getRedeem(t),sequence:this.sequence,prevout:this.prevout,coin:t||null}}formatInsight(){return{prevout:{hash:this.prevout.hash,index:this.prevout.index},script:this.script,witness:this.witness,sequence:this.sequence,address:this.getAddress(),isCoinbase:this.isCoinbase()}}toJSON(t,e){return this.getJSON()}getJSON(t,e){let i;return t=n.get(t),e||(i=this.getAddress())&&(i=i.toString(t)),{prevout:this.prevout.toJSON(),script:this.script.toJSON(),witness:this.witness.toJSON(),sequence:this.sequence,address:i,coin:e?e.getJSON(t,!0):void 0}}fromJSON(t){return r(t,"Input data is required."),r(s.isU32(t.sequence),"Sequence must be a uint32."),this.prevout.fromJSON(t.prevout),this.script.fromJSON(t.script),this.witness.fromJSON(t.witness),this.sequence=t.sequence,this}static fromJSON(t){return(new f).fromJSON(t)}getSize(){return 40+this.script.getVarSize()}toRaw(){const t=this.getSize();return this.toWriter(new c(t)).render()}toWriter(t){return this.prevout.toWriter(t),t.writeVarBytes(this.script.toRaw()),t.writeU32(this.sequence),t}fromReader(t){return this.prevout.fromReader(t),this.script.fromRaw(t.readVarBytes()),this.sequence=t.readU32(),this}fromRaw(t){return this.fromReader(new u(t))}static fromReader(t){return(new f).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new f).fromRaw(t)}fromOutpoint(t){return r("string"==typeof t.hash),r("number"==typeof t.index),this.prevout.hash=t.hash,this.prevout.index=t.index,this}static fromOutpoint(t){return(new f).fromOutpoint(t)}fromCoin(t){return r("string"==typeof t.hash),r("number"==typeof t.index),this.prevout.hash=t.hash,this.prevout.index=t.index,this}static fromCoin(t){return(new f).fromCoin(t)}fromTX(t,e){return r(t),r("number"==typeof e),r(e>=0&&e<t.outputs.length),this.prevout.hash=t.hash("hex"),this.prevout.index=e,this}static fromTX(t,e){return(new f).fromTX(t,e)}static isInput(t){return t instanceof f}}t.exports=f}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * headers.js - headers object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(3),s=i(110),n=i(6),o=i(2);class a extends s{constructor(t){super(),t&&this.parseOptions(t)}verifyBody(t){return!0}getSize(){return 81}toWriter(t){return this.writeHead(t),t.writeVarint(0),t}toRaw(){const t=this.getSize();return this.toWriter(new n(t)).render()}fromReader(t){return this.readHead(t),t.readVarint(),this}fromRaw(t){return this.fromReader(new o(t))}static fromReader(t){return(new a).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new a).fromRaw(t)}static fromHead(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new a).fromHead(t)}static fromEntry(t){const i=new a;return i.version=t.version,i.prevBlock=t.prevBlock,i.merkleRoot=t.merkleRoot,i.time=t.time,i.bits=t.bits,i.nonce=t.nonce,i._hash=e.from(t.hash,"hex"),i._hhash=t.hash,i}toHeaders(){return this}static fromBlock(t){const e=new a(t);return e._hash=t._hash,e._hhash=t._hhash,e}formatInsight(){return{hash:this.rhash(),version:this.version,prevHash:r.revHex(this.prevBlock),merkleRoot:r.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce}}toJSON(){return this.getJSON()}getJSON(t,e,i){return{hash:this.rhash(),height:i,version:this.version,prevBlock:r.revHex(this.prevBlock),merkleRoot:r.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce}}fromJSON(t){return this.parseJSON(t),this}static fromJSON(t){return(new a).fromJSON(t)}inspect(){return this.format()}format(t,e){return{hash:this.rhash(),height:null!=e?e:-1,date:r.date(this.time),version:r.hex32(this.version),prevBlock:r.revHex(this.prevBlock),merkleRoot:r.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce}}static isHeaders(t){return t instanceof a}}t.exports=a}).call(this,i(0).Buffer)},function(t,e){Array.prototype.array_diff=function(...t){return this.reduce((e,i)=>{let r=!1;for(let e=0;e<t.length;e++)-1!=t[e].indexOf(i)&&(r=!0);return r||e.push(i),e},[])};class i{constructor(t){this.data=new Map,this.$dirty=!0,t&&this.load(t)}get dirty(){return this.$dirty}set dirty(t){this.$dirty=t}orderby(t,e){switch(this.items||(this.items=this.ToArray()),e){case"desc":this.items=this.items.sort((e,i)=>i[t]-e[t]);break;case"asc":this.items=this.items.sort((e,i)=>e[t]-i[t])}return this}paginate(t,e,i){return this.items||(this.items=this.ToArray()),e||(e=1),this.pageSize=t,this.items.length%this.pageSize==0?this.pageNum=this.items.length/this.pageSize|0:this.pageNum=1+(this.items.length/this.pageSize|0),this.pageCur=e,this.attrs=i,this}records(t){if(this.items||(this.items=this.ToArray()),0==this.items.length)return[];this.pageSize||(this.pageSize=this.items.length,this.pageNum=1,this.pageCur=1),this.attrs=t;let e=[],i=this;if(this.pageCur>this.pageNum)return e;for(let t=this.pageSize*(this.pageCur-1);t<this.pageSize*this.pageCur&&this.items[t];t++){let r=null;(r=this.attrs&&this.attrs.constructor==Array?this.attrs.reduce((e,r)=>(e[r]=i.items[t][r],e),{}):this.items[t])&&e.push(r)}return e}async predict(t){let e=[...this.data],r=[];for(let[i,s]of e)await t(i,s)&&r.push([i,s]);return new i(r)}where(t){let e=[...this.data];for(let i of t){if(i.constructor!=Array||i.length<2)continue;let t={k:i[0],sign:2==i.length?"==":i[1],v:2==i.length?i[1]:i[2]};e=e.filter(([e,i])=>{if(void 0===i[t.k])return!1;switch(t.sign){case"==":return i[t.k]==t.v;case">":return i[t.k]>t.v;case"<":return i[t.k]<t.v;case"!=":return i[t.k]!=t.v;case">=":return i[t.k]>=t.v;case"<=":return i[t.k]<=t.v;case"include":return-1!=t.v.indexOf(i[t.k]);case"exclude":return-1==t.v.indexOf(i[t.k]);default:return!1}})}return new i(e)}filter(t){return t=t||[],Array.isArray(t)?(t=Array.from(new Set(t))).reduce((t,e)=>(this.has(e)||t.push(e),t),[]):[]}diff(...t){return[...this.data.keys()].array_diff(...t.map(t=>[...t.data.keys()]))}has(t){return this.data.has(t)}set(t,e){e&&(e.status||(e.status=i.status.Init),this.data.set(t,e),this.items=null)}get(t,e){return e&&(t+=e),this.data.get(t)}delete(t){let e=this.data.delete(t);return this.items=null,e}deletes(t){let e=this.where(t).getKeys();for(let t of e)this.data.delete(t);this.items=null}expired(t){let e=this.get(t);e&&e.status==i.status.Init&&(e.status=i.status.Expired)}unexpired(t){let e=this.get(t);e&&e.status==i.status.Expired&&(e.status=i.status.Init)}finished(t){let e=this.get(t);e&&e.status==i.status.Init&&(e.status=i.status.Finished)}load(t){this.data.clear(),this.items=null,t.map(t=>{this.data.set(t[0],t[1])})}clear(){this.data.clear(),this.items=null}forEach(t,e){this.data.forEach(t,e||this)}ToArray(){return[...this.data.values()]}getKeys(){return[...this.data.keys()]}getSize(){return this.data.size}}i.status={Init:1,Finished:2,Expired:3},t.exports=i},function(t,e,i){"use strict";e.unsupported=!0},function(t,e,i){"use strict";
/*!
 * jobs.js - worker jobs for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(30),{derive:s}=i(173),n=i(174),o=i(73),{contractStatus:a}=i(8),h=(i(51),i(15),e);h.execute=function(t){try{return h.handle(t)}catch(t){return new o.ErrorResultPacket(t)}},h.handle=function(t){return t.jobsHandle(h)},h.check=function(t,e,i,r){try{t.check(e,i,r)}catch(t){if("ScriptError"===t.type)return new o.CheckResultPacket(t);throw t}return new o.CheckResultPacket},h.checkInput=function(t,e,i,r,s){try{t.checkInput(e,i,r,s)}catch(t){if("ScriptError"===t.type)return new o.CheckInputResultPacket(t);throw t}return new o.CheckInputResultPacket},h.sign=function(t,e,i,r){const s=t.sign(e,!0,i,r);return o.SignResultPacket.fromTX(t,s)},h.signInput=function(t,e,i,r,s){const n=t.signInput(t,e,i,r,s);return o.SignInputResultPacket.fromTX(t,e,n)},h.ecVerify=function(t,e,i){const s=r.verify(t,e,i);return new o.ECVerifyResultPacket(s)},h.ecSign=function(t,e){const i=r.sign(t,e);return new o.ECSignResultPacket(i)},h.mine=function(t,e,i,r){const s=n(t,e,i,r);return new o.MineResultPacket(s)},h.scrypt=function(t,e,i,r,n,a){const h=s(t,e,i,r,n,a);return new o.ScryptResultPacket(h)}},function(t,e,i){"use strict";
/*!
 * packets.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(11),s=i(335),n=i(337),o=i(338),a=i(175),h=i(339),c=i(340),u=i(176),l=i(341),f=i(342),d=i(343),p=i(344),g=i(345),m=i(346),w=i(347),y=i(348),b=i(349),v=i(350),k=i(351),S=i(352),x=i(353),E=i(354);e.parsePacket=function(t,e){switch(t.cmd){case r.ENV:return s.fromRaw(e);case r.EVENT:return n.fromRaw(e);case r.LOG:return o.fromRaw(e);case r.ERROR:return a.fromRaw(e);case r.ERRORRESULT:return h.fromRaw(e);case r.CHECK:return c.fromRaw(e);case r.CHECKRESULT:return u.fromRaw(e);case r.SIGN:return l.fromRaw(e);case r.SIGNRESULT:return f.fromRaw(e);case r.CHECKINPUT:return d.fromRaw(e);case r.CHECKINPUTRESULT:return p.fromRaw(e);case r.SIGNINPUT:return g.fromRaw(e);case r.SIGNINPUTRESULT:return m.fromRaw(e);case r.ECVERIFY:return w.fromRaw(e);case r.ECVERIFYRESULT:return y.fromRaw(e);case r.ECSIGN:return b.fromRaw(e);case r.ECSIGNRESULT:return v.fromRaw(e);case r.MINE:return k.fromRaw(e);case r.MINERESULT:return S.fromRaw(e);case r.SCRYPT:return x.fromRaw(e);case r.SCRYPTRESULT:return E.fromRaw(e);default:throw new Error("Unknown packet.")}},e.types=r,e.EnvPacket=s,e.EventPacket=n,e.LogPacket=o,e.ErrorPacket=a,e.ErrorResultPacket=h,e.CheckPacket=c,e.CheckResultPacket=u,e.SignPacket=l,e.SignResultPacket=f,e.CheckInputPacket=d,e.CheckInputResultPacket=p,e.SignInputPacket=g,e.SignInputResultPacket=m,e.ECVerifyPacket=w,e.ECVerifyResultPacket=y,e.ECSignPacket=b,e.ECSignResultPacket=v,e.MinePacket=k,e.MineResultPacket=S,e.ScryptPacket=x,e.ScryptResultPacket=E},function(t,e,i){(function(t){function i(t,e){for(var i=0,r=t.length-1;r>=0;r--){var s=t[r];"."===s?t.splice(r,1):".."===s?(t.splice(r,1),i++):i&&(t.splice(r,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(t){return r.exec(t).slice(1)};function n(t,e){if(t.filter)return t.filter(e);for(var i=[],r=0;r<t.length;r++)e(t[r],r,t)&&i.push(t[r]);return i}e.resolve=function(){for(var e="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var o=s>=0?arguments[s]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,r="/"===o.charAt(0))}return e=i(n(e.split("/"),function(t){return!!t}),!r).join("/"),(r?"/":"")+e||"."},e.normalize=function(t){var r=e.isAbsolute(t),s="/"===o(t,-1);return(t=i(n(t.split("/"),function(t){return!!t}),!r).join("/"))||r||(t="."),t&&s&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(n(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,i){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=e.resolve(t).substr(1),i=e.resolve(i).substr(1);for(var s=r(t.split("/")),n=r(i.split("/")),o=Math.min(s.length,n.length),a=o,h=0;h<o;h++)if(s[h]!==n[h]){a=h;break}var c=[];for(h=a;h<s.length;h++)c.push("..");return(c=c.concat(n.slice(a))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=s(t),i=e[0],r=e[1];return i||r?(r&&(r=r.substr(0,r.length-1)),i+r):"."},e.basename=function(t,e){var i=s(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},e.extname=function(t){return s(t)[3]};var o="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return e<0&&(e=t.length+e),t.substr(e,i)}}).call(this,i(23))},function(t,e,i){var r=e;r.utils=i(32),r.common=i(55),r.sha=i(223),r.ripemd=i(227),r.hmac=i(228),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160},function(t,e,i){"use strict";var r=e;r.base=i(236),r.short=i(237),r.mont=i(238),r.edwards=i(239)},function(t,e,i){"use strict";(function(e){
/*!
 * stack.js - stack object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(27),n=i(57);function o(t){if(!(this instanceof o))return new o(t);this.items=t||[]}Object.defineProperty(o.prototype,"length",{get(){return this.items.length},set(t){return this.items.length=t,this.items.length}}),o.prototype[Symbol.iterator]=function(){return this.items[Symbol.iterator]()},o.prototype.values=function(){return this.items.values()},o.prototype.entries=function(){return this.items.entries()},o.prototype.inspect=function(){return`<Stack: ${this.toString()}>`},o.prototype.toString=function(){const t=[];for(const e of this.items)t.push(e.toString("hex"));return t.join(" ")},o.prototype.toASM=function(t){const e=[];for(const i of this.items)e.push(s.toASM(i,t));return e.join(" ")},o.prototype.clone=function(){return new o(this.items.slice())},o.prototype.clear=function(){return this.items.length=0,this},o.prototype.get=function(t){return t<0&&(t+=this.items.length),t<0||t>=this.items.length?null:this.items[t]},o.prototype.pop=function(){return this.items.pop()||null},o.prototype.shift=function(){return this.items.shift()||null},o.prototype.remove=function(t){if(t<0&&(t+=this.items.length),t<0||t>=this.items.length)return null;const e=this.items.splice(t,1);return 0===e.length?null:e[0]},o.prototype.set=function(t,i){return t<0&&(t+=this.items.length),r(e.isBuffer(i)),r(t>=0&&t<=this.items.length),this.items[t]=i,this},o.prototype.push=function(t){return r(e.isBuffer(t)),this.items.push(t),this},o.prototype.unshift=function(t){return r(e.isBuffer(t)),this.items.unshift(t),this},o.prototype.insert=function(t,i){return t<0&&(t+=this.items.length),r(e.isBuffer(i)),r(t>=0&&t<=this.items.length),this.items.splice(t,0,i),this},o.prototype.erase=function(t,e){t<0&&(t=this.items.length+t),e<0&&(e=this.items.length+e),this.items.splice(t,e-t)},o.prototype.swap=function(t,e){t<0&&(t=this.items.length+t),e<0&&(e=this.items.length+e);const i=this.items[t],r=this.items[e];this.items[t]=r,this.items[e]=i},o.prototype.getData=function(t){return this.get(t)},o.prototype.popData=function(){return this.pop()},o.prototype.shiftData=function(){return this.shift()},o.prototype.removeData=function(t){return this.remove(t)},o.prototype.setData=function(t,e){return this.set(t,e)},o.prototype.pushData=function(t){return this.push(t)},o.prototype.unshiftData=function(t){return this.unshift(t)},o.prototype.insertData=function(t,e){return this.insert(t,e)},o.prototype.getLength=function(t){const e=this.get(t);return e?e.length:-1},o.prototype.getString=function(t,e){const i=this.get(t);return i?o.toString(i,e):null},o.prototype.popString=function(t){const e=this.pop();return e?o.toString(e,t):null},o.prototype.shiftString=function(t){const e=this.shift();return e?o.toString(e,t):null},o.prototype.removeString=function(t,e){const i=this.remove(t);return i?o.toString(i,e):null},o.prototype.setString=function(t,e,i){return this.set(t,o.fromString(e,i))},o.prototype.pushString=function(t,e){return this.push(o.fromString(t,e))},o.prototype.unshiftString=function(t,e){return this.unshift(o.fromString(t,e))},o.prototype.insertString=function(t,e,i){return this.insert(t,o.fromString(e,i))},o.prototype.getNum=function(t,e,i){const r=this.get(t);return r?o.toNum(r,e,i):null},o.prototype.popNum=function(t,e){const i=this.pop();return i?o.toNum(i,t,e):null},o.prototype.shiftNum=function(t,e){const i=this.shift();return i?o.toNum(i,t,e):null},o.prototype.removeNum=function(t,e,i){const r=this.remove(t);return r?o.toNum(r,e,i):null},o.prototype.setNum=function(t,e){return this.set(t,o.fromNum(e))},o.prototype.pushNum=function(t){return this.push(o.fromNum(t))},o.prototype.unshiftNum=function(t){return this.unshift(o.fromNum(t))},o.prototype.insertNum=function(t,e){return this.insert(t,o.fromNum(e))},o.prototype.getInt=function(t,e,i){const r=this.get(t);return r?o.toInt(r,e,i):-1},o.prototype.popInt=function(t,e){const i=this.pop();return i?o.toInt(i,t,e):-1},o.prototype.shiftInt=function(t,e){const i=this.shift();return i?o.toInt(i,t,e):-1},o.prototype.removeInt=function(t,e,i){const r=this.remove(t);return r?o.toInt(r,e,i):-1},o.prototype.setInt=function(t,e){return this.set(t,o.fromInt(e))},o.prototype.pushInt=function(t){return this.push(o.fromInt(t))},o.prototype.unshiftInt=function(t){return this.unshift(o.fromInt(t))},o.prototype.insertInt=function(t,e){return this.insert(t,o.fromInt(e))},o.prototype.getBool=function(t){const e=this.get(t);return!!e&&o.toBool(e)},o.prototype.popBool=function(){const t=this.pop();return!!t&&o.toBool(t)},o.prototype.shiftBool=function(){const t=this.shift();return!!t&&o.toBool(t)},o.prototype.removeBool=function(t){const e=this.remove(t);return!!e&&o.toBool(e)},o.prototype.setBool=function(t,e){return this.set(t,o.fromBool(e))},o.prototype.pushBool=function(t){return this.push(o.fromBool(t))},o.prototype.unshiftBool=function(t){return this.unshift(o.fromBool(t))},o.prototype.insertBool=function(t,e){return this.insert(t,o.fromBool(e))},o.isStack=function(t){return t instanceof o},o.toString=function(t,i){return r(e.isBuffer(t)),t.toString(i||"utf8")},o.fromString=function(t,i){return r("string"==typeof t),e.from(t,i||"utf8")},o.toNum=function(t,e,i){return n.decode(t,e,i)},o.fromNum=function(t){return r(n.isScriptNum(t)),t.encode()},o.toInt=function(t,e,i){return o.toNum(t,e,i).getInt()},o.fromInt=function(t){if(r("number"==typeof t),t>=-1&&t<=16)return s.small[t+1];const e=n.fromNumber(t);return o.fromNum(e)},o.toBool=function(t){r(e.isBuffer(t));for(let e=0;e<t.length;e++)if(0!==t[e])return e!==t.length-1||128!==t[e];return!1},o.fromBool=function(t){return r("boolean"==typeof t),o.fromInt(t?1:0)},t.exports=o}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * witness.js - witness object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(3),n=i(20),o=i(27),a=i(4),h=i(2),c=i(6),u=(i(26),i(77)),l=o.types;class f extends u{constructor(t){super([]),t&&this.fromOptions(t)}fromOptions(t){return r(t,"Witness data is required."),Array.isArray(t)?this.fromArray(t):t.items?this.fromArray(t.items):this}static fromOptions(t){return(new f).fromOptions(t)}toArray(){return this.items.slice()}fromArray(t){return r(Array.isArray(t)),this.items=t,this}static fromArray(t){return(new f).fromArray(t)}toItems(){return this.items.slice()}fromItems(t){return r(Array.isArray(t)),this.items=t,this}static fromItems(t){return(new f).fromItems(t)}toStack(){return new u(this.toArray())}fromStack(t){return this.fromArray(t.items)}static fromStack(t){return(new f).fromStack(t)}inspect(){return`<Witness: ${this.toString()}>`}clone(){return(new f).inject(this)}inject(t){return this.items=t.items.slice(),this}compile(){return this}getInputType(){return this.isPubkeyhashInput()?l.WITNESSPUBKEYHASH:this.isScripthashInput()?l.WITNESSSCRIPTHASH:l.NONSTANDARD}isPubkeyInput(){return!1}getPubkeyInput(){return null}isPubkeyhashInput(){return 2===this.items.length&&o.isSignatureEncoding(this.items[0])&&o.isKeyEncoding(this.items[1])}getPubkeyhashInput(){return this.isPubkeyhashInput()?[this.items[0],this.items[1]]:[null,null]}isMultisigInput(){return!1}getMultisigInput(){return null}isScripthashInput(){return this.items.length>0&&!this.isPubkeyhashInput()}getScripthashInput(){return this.isScripthashInput()?this.items[this.items.length-1]:null}isUnknownInput(){return this.getInputType()===l.NONSTANDARD}test(t){for(const e of this.items)if(0!==e.length&&t.test(e))return!0;return!1}getRedeem(){if(0===this.items.length)return null;const t=this.items[this.items.length-1];return t?n.fromRaw(t):null}indexOf(t){return s.indexOf(this.items,t)}getSize(){let t=0;for(const e of this.items)t+=a.sizeVarBytes(e);return t}getVarSize(){return a.sizeVarint(this.items.length)+this.getSize()}toWriter(t){t.writeVarint(this.items.length);for(const e of this.items)t.writeVarBytes(e);return t}toRaw(){const t=this.getVarSize();return this.toWriter(new c(t)).render()}toJSON(){return this.toRaw().toString("hex")}fromJSON(t){return r("string"==typeof t,"Witness must be a string."),this.fromRaw(e.from(t,"hex"))}static fromJSON(t){return(new f).fromJSON(t)}fromReader(t){const e=t.readVarint();for(let i=0;i<e;i++)this.items.push(t.readVarBytes());return this}fromRaw(t){return this.fromReader(new h(t))}static fromReader(t){return(new f).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new f).fromRaw(t)}fromString(t){if(!Array.isArray(t)){if(r("string"==typeof t),0===(t=t.trim()).length)return this;t=t.split(/\s+/)}for(const i of t)this.items.push(e.from(i,"hex"));return this}static fromString(t){return(new f).fromString(t)}static isWitness(t){return t instanceof f}}t.exports=f}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * bloom.js - bloom filter for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(108),n=i(2),o=i(6),a=i(4),h=s.sum32,c=s.mul32,u=e.alloc(0),l=.48045301391820144,f=.6931471805599453;class d{constructor(t,e,i,r){this.filter=u,this.size=0,this.n=0,this.tweak=0,this.update=d.flags.NONE,null!=t&&this.fromOptions(t,e,i,r)}fromOptions(t,i,s,n){r("number"==typeof t,"`size` must be a number."),r(t>0,"`size` must be greater than zero."),r(Number.isSafeInteger(t),"`size` must be an integer."),t-=t%8;const o=e.allocUnsafe(t/8);return o.fill(0),null!=s&&-1!==s||(s=4294967296*Math.random()>>>0),null!=n&&-1!==n||(n=d.flags.NONE),"string"==typeof n&&(n=d.flags[n.toUpperCase()],r(null!=n,"Unknown update flag.")),r(t>0,"`size` must be greater than zero."),r(i>0,"`n` must be greater than zero."),r(Number.isSafeInteger(i),"`n` must be an integer."),r("number"==typeof s,"`tweak` must be a number."),r(Number.isSafeInteger(s),"`tweak` must be an integer."),r(d.flagsByVal[n],"Unknown update flag."),this.filter=o,this.size=t,this.n=i,this.tweak=s,this.update=n,this}static fromOptions(t,e,i,r){return(new d).fromOptions(t,e,i,r)}hash(t,e){return s(t,h(c(e,4221880213),this.tweak))%this.size}reset(){this.filter.fill(0)}add(t,i){"string"==typeof t&&(t=e.from(t,i));for(let e=0;e<this.n;e++){const i=this.hash(t,e);this.filter[i>>>3]|=1<<(7&i)}}test(t,i){"string"==typeof t&&(t=e.from(t,i));for(let e=0;e<this.n;e++){const i=this.hash(t,e);if(0==(this.filter[i>>>3]&1<<(7&i)))return!1}return!0}added(t,i){let r=!1;"string"==typeof t&&(t=e.from(t,i));for(let e=0;e<this.n;e++){const i=this.hash(t,e);r||0!=(this.filter[i>>>3]&1<<(7&i))||(r=!0),this.filter[i>>>3]|=1<<(7&i)}return r}static fromRate(t,e,i){r("number"==typeof t,"`items` must be a number."),r(t>0,"`items` must be greater than zero."),r(Number.isSafeInteger(t),"`items` must be an integer."),r("number"==typeof e,"`rate` must be a number."),r(e>=0&&e<=1,"`rate` must be between 0.0 and 1.0.");const s=-1/l*t*Math.log(e)|0,n=Math.max(8,s);-1!==i&&r(n<=8*d.MAX_BLOOM_FILTER_SIZE,"Bloom filter size violates policy limits!");const o=Math.max(1,n/t*f|0);return-1!==i&&r(o<=d.MAX_HASH_FUNCS,"Bloom filter size violates policy limits!"),new d(n,o,-1,i)}isWithinConstraints(){return!(this.size>8*d.MAX_BLOOM_FILTER_SIZE||this.n>d.MAX_HASH_FUNCS)}getSize(){return a.sizeVarBytes(this.filter)+13}toWriter(t){return t.writeVarBytes(this.filter),t.writeU32(this.n),t.writeU32(this.tweak),t.writeU32(this.size),t.writeU8(this.update),t}toRaw(){const t=this.getSize();return this.toWriter(new o(t)).render()}fromReader(t){return this.filter=t.readVarBytes(),this.n=t.readU32(),this.tweak=t.readU32(),this.size=t.readU32(),this.update=t.readU8(),r(null!=d.flagsByVal[this.update],"Unknown update flag."),this}fromRaw(t){return this.fromReader(new n(t))}static fromReader(t){return(new d).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new d).fromRaw(t)}}d.MAX_BLOOM_FILTER_SIZE=36e3,d.MAX_HASH_FUNCS=50,d.flags={NONE:0,ALL:1,PUBKEY_ONLY:2},d.flagsByVal={0:"NONE",1:"ALL",2:"PUBKEY_ONLY"},t.exports=d}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,i,r,s){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var n,o,a=arguments.length;switch(a){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,i)});case 3:return e.nextTick(function(){t.call(null,i,r)});case 4:return e.nextTick(function(){t.call(null,i,r,s)});default:for(n=new Array(a-1),o=0;o<n.length;)n[o++]=arguments[o];return e.nextTick(function(){t.apply(null,n)})}}}:t.exports=e}).call(this,i(23))},function(t,e,i){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,s=Function.prototype.apply;function n(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new n(s.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new n(s.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},i(256),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i(12))},function(t,e,i){"use strict";
/*!
 * netaddress.js - network address object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(60),n=i(16),o=i(3),a=i(48),h=i(6),c=i(2);function u(t){if(!(this instanceof u))return new u(t);this.host="0.0.0.0",this.port=0,this.services=0,this.time=0,this.hostname="0.0.0.0:0",this.raw=a.ZERO_IP,t&&this.fromOptions(t)}u.DEFAULT_SERVICES=0|s.services.NETWORK|s.services.WITNESS|s.services.BLOOM,u.prototype.fromOptions=function(t){return r("string"==typeof t.host),r("number"==typeof t.port),this.raw=a.toBuffer(t.host),this.host=a.toString(this.raw),this.port=t.port,t.services&&(r("number"==typeof t.services),this.services=t.services),t.time&&(r("number"==typeof t.time),this.time=t.time),this.hostname=a.toHostname(this.host,this.port),this},u.fromOptions=function(t){return(new u).fromOptions(t)},u.prototype.hasServices=function(t){return(this.services&t)===t},u.isIPv4=function(){return a.isIPv4(this.raw)},u.isIPv6=function(){return a.isIPv6(this.raw)},u.prototype.isNull=function(){return a.isNull(this.raw)},u.prototype.isLocal=function(){return a.isLocal(this.raw)},u.prototype.isValid=function(){return a.isValid(this.raw)},u.prototype.isRoutable=function(){return a.isRoutable(this.raw)},u.prototype.isOnion=function(){return a.isOnion(this.raw)},u.prototype.equal=function(t){return 0===this.compare(t)},u.prototype.compare=function(t){const e=this.raw.compare(t.raw);return 0!==e?e:this.port-t.port},u.prototype.getReachability=function(t){return a.getReachability(this.raw,t.raw)},u.prototype.setNull=function(){this.raw=a.ZERO_IP,this.host="0.0.0.0",this.hostname=a.toHostname(this.host,this.port)},u.prototype.setHost=function(t){this.raw=a.toBuffer(t),this.host=a.toString(this.raw),this.hostname=a.toHostname(this.host,this.port)},u.prototype.setPort=function(t){r(t>=0&&t<=65535),this.port=t,this.hostname=a.toHostname(this.host,t)},u.prototype.fromHost=function(t,e,i){return i=n.get(i),r(e>=0&&e<=65535),this.raw=a.toBuffer(t),this.host=a.toString(this.raw),this.port=e,this.services=u.DEFAULT_SERVICES,this.time=i.now(),this.hostname=a.toHostname(this.host,this.port),this},u.fromHost=function(t,e,i){return(new u).fromHost(t,e,i)},u.prototype.fromHostname=function(t,e){e=n.get(e);const i=a.fromHostname(t,e.port);return this.fromHost(i.host,i.port,e)},u.fromHostname=function(t,e){return(new u).fromHostname(t,e)},u.prototype.fromSocket=function(t,e){const i=t.remoteAddress,s=t.remotePort;return r("string"==typeof i),r("number"==typeof s),this.fromHost(a.normalize(i),s,e)},u.fromSocket=function(t,e){return(new u).fromSocket(t,e)},u.prototype.fromReader=function(t,e){return this.time=e?t.readU32():0,this.services=t.readU32(),t.readU32(),this.raw=t.readBytes(16),this.host=a.toString(this.raw),this.port=t.readU16BE(),this.hostname=a.toHostname(this.host,this.port),this},u.prototype.fromRaw=function(t,e){return this.fromReader(new c(t),e)},u.fromReader=function(t,e){return(new u).fromReader(t,e)},u.fromRaw=function(t,e){return(new u).fromRaw(t,e)},u.prototype.toWriter=function(t,e){return e&&t.writeU32(this.time),t.writeU32(this.services),t.writeU32(0),t.writeBytes(this.raw),t.writeU16BE(this.port),t},u.prototype.getSize=function(t){return 26+(t?4:0)},u.prototype.toRaw=function(t){const e=this.getSize(t);return this.toWriter(new h(e),t).render()},u.prototype.toJSON=function(){return{host:this.host,port:this.port,services:this.services,time:this.time}},u.prototype.fromJSON=function(t){return r(o.isU16(t.port)),r(o.isU32(t.services)),r(o.isU32(t.time)),this.raw=a.toBuffer(t.host),this.host=t.host,this.port=t.port,this.services=t.services,this.time=t.time,this.hostname=a.toHostname(this.host,this.port),this},u.fromJSON=function(t){return(new u).fromJSON(t)},u.prototype.inspect=function(){return"<NetAddress:"+` hostname=${this.hostname}`+` services=${this.services.toString(2)}`+` date=${o.date(this.time)}`+">"},t.exports=u},function(t,e,i){t.exports=s;var r=i(24).EventEmitter;function s(){r.call(this)}i(5)(s,r),s.Readable=i(89),s.Writable=i(278),s.Duplex=i(279),s.Transform=i(280),s.PassThrough=i(281),s.Stream=s,s.prototype.pipe=function(t,e){var i=this;function s(e){t.writable&&!1===t.write(e)&&i.pause&&i.pause()}function n(){i.readable&&i.resume&&i.resume()}i.on("data",s),t.on("drain",n),t._isStdio||e&&!1===e.end||(i.on("end",a),i.on("close",h));var o=!1;function a(){o||(o=!0,t.end())}function h(){o||(o=!0,"function"==typeof t.destroy&&t.destroy())}function c(t){if(u(),0===r.listenerCount(this,"error"))throw t}function u(){i.removeListener("data",s),t.removeListener("drain",n),i.removeListener("end",a),i.removeListener("close",h),i.removeListener("error",c),t.removeListener("error",c),i.removeListener("end",u),i.removeListener("close",u),t.removeListener("close",u)}return i.on("error",c),t.on("error",c),i.on("end",u),i.on("close",u),t.on("close",u),t.emit("pipe",i),t}},function(t,e,i){var r=i(7).Buffer;function s(t){r.isBuffer(t)||(t=r.from(t));for(var e=t.length/4|0,i=new Array(e),s=0;s<e;s++)i[s]=t.readUInt32BE(4*s);return i}function n(t){for(;0<t.length;t++)t[0]=0}function o(t,e,i,r,s){for(var n,o,a,h,c=i[0],u=i[1],l=i[2],f=i[3],d=t[0]^e[0],p=t[1]^e[1],g=t[2]^e[2],m=t[3]^e[3],w=4,y=1;y<s;y++)n=c[d>>>24]^u[p>>>16&255]^l[g>>>8&255]^f[255&m]^e[w++],o=c[p>>>24]^u[g>>>16&255]^l[m>>>8&255]^f[255&d]^e[w++],a=c[g>>>24]^u[m>>>16&255]^l[d>>>8&255]^f[255&p]^e[w++],h=c[m>>>24]^u[d>>>16&255]^l[p>>>8&255]^f[255&g]^e[w++],d=n,p=o,g=a,m=h;return n=(r[d>>>24]<<24|r[p>>>16&255]<<16|r[g>>>8&255]<<8|r[255&m])^e[w++],o=(r[p>>>24]<<24|r[g>>>16&255]<<16|r[m>>>8&255]<<8|r[255&d])^e[w++],a=(r[g>>>24]<<24|r[m>>>16&255]<<16|r[d>>>8&255]<<8|r[255&p])^e[w++],h=(r[m>>>24]<<24|r[d>>>16&255]<<16|r[p>>>8&255]<<8|r[255&g])^e[w++],[n>>>=0,o>>>=0,a>>>=0,h>>>=0]}var a=[0,1,2,4,8,16,32,64,128,27,54],h=function(){for(var t=new Array(256),e=0;e<256;e++)t[e]=e<128?e<<1:e<<1^283;for(var i=[],r=[],s=[[],[],[],[]],n=[[],[],[],[]],o=0,a=0,h=0;h<256;++h){var c=a^a<<1^a<<2^a<<3^a<<4;c=c>>>8^255&c^99,i[o]=c,r[c]=o;var u=t[o],l=t[u],f=t[l],d=257*t[c]^16843008*c;s[0][o]=d<<24|d>>>8,s[1][o]=d<<16|d>>>16,s[2][o]=d<<8|d>>>24,s[3][o]=d,d=16843009*f^65537*l^257*u^16843008*o,n[0][c]=d<<24|d>>>8,n[1][c]=d<<16|d>>>16,n[2][c]=d<<8|d>>>24,n[3][c]=d,0===o?o=a=1:(o=u^t[t[t[f^u]]],a^=t[t[a]])}return{SBOX:i,INV_SBOX:r,SUB_MIX:s,INV_SUB_MIX:n}}();function c(t){this._key=s(t),this._reset()}c.blockSize=16,c.keySize=32,c.prototype.blockSize=c.blockSize,c.prototype.keySize=c.keySize,c.prototype._reset=function(){for(var t=this._key,e=t.length,i=e+6,r=4*(i+1),s=[],n=0;n<e;n++)s[n]=t[n];for(n=e;n<r;n++){var o=s[n-1];n%e==0?(o=o<<8|o>>>24,o=h.SBOX[o>>>24]<<24|h.SBOX[o>>>16&255]<<16|h.SBOX[o>>>8&255]<<8|h.SBOX[255&o],o^=a[n/e|0]<<24):e>6&&n%e==4&&(o=h.SBOX[o>>>24]<<24|h.SBOX[o>>>16&255]<<16|h.SBOX[o>>>8&255]<<8|h.SBOX[255&o]),s[n]=s[n-e]^o}for(var c=[],u=0;u<r;u++){var l=r-u,f=s[l-(u%4?0:4)];c[u]=u<4||l<=4?f:h.INV_SUB_MIX[0][h.SBOX[f>>>24]]^h.INV_SUB_MIX[1][h.SBOX[f>>>16&255]]^h.INV_SUB_MIX[2][h.SBOX[f>>>8&255]]^h.INV_SUB_MIX[3][h.SBOX[255&f]]}this._nRounds=i,this._keySchedule=s,this._invKeySchedule=c},c.prototype.encryptBlockRaw=function(t){return o(t=s(t),this._keySchedule,h.SUB_MIX,h.SBOX,this._nRounds)},c.prototype.encryptBlock=function(t){var e=this.encryptBlockRaw(t),i=r.allocUnsafe(16);return i.writeUInt32BE(e[0],0),i.writeUInt32BE(e[1],4),i.writeUInt32BE(e[2],8),i.writeUInt32BE(e[3],12),i},c.prototype.decryptBlock=function(t){var e=(t=s(t))[1];t[1]=t[3],t[3]=e;var i=o(t,this._invKeySchedule,h.INV_SUB_MIX,h.INV_SBOX,this._nRounds),n=r.allocUnsafe(16);return n.writeUInt32BE(i[0],0),n.writeUInt32BE(i[3],4),n.writeUInt32BE(i[2],8),n.writeUInt32BE(i[1],12),n},c.prototype.scrub=function(){n(this._keySchedule),n(this._invKeySchedule),n(this._key)},t.exports.AES=c},function(t,e,i){var r=i(7).Buffer,s=i(305);t.exports=function(t,e,i,n){if(r.isBuffer(t)||(t=r.from(t,"binary")),e&&(r.isBuffer(e)||(e=r.from(e,"binary")),8!==e.length))throw new RangeError("salt should be Buffer with 8 byte length");for(var o=i/8,a=r.alloc(o),h=r.alloc(n||0),c=r.alloc(0);o>0||n>0;){var u=new s;u.update(c),u.update(t),e&&u.update(e),c=u.digest();var l=0;if(o>0){var f=a.length-o;l=Math.min(o,c.length),c.copy(a,f,0,l),o-=l}if(l<c.length&&n>0){var d=h.length-n,p=Math.min(n,c.length-l);c.copy(h,d,l,l+p),n-=p}}return c.fill(0),{key:a,iv:h}}},function(t,e,i){(function(e){var r=i(314),s=i(325),n=i(326),o=i(103),a=i(153);function h(t){var i;"object"!=typeof t||e.isBuffer(t)||(i=t.passphrase,t=t.key),"string"==typeof t&&(t=new e(t));var h,c,u=n(t,i),l=u.tag,f=u.data;switch(l){case"CERTIFICATE":c=r.certificate.decode(f,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(c||(c=r.PublicKey.decode(f,"der")),h=c.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return r.RSAPublicKey.decode(c.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return c.subjectPrivateKey=c.subjectPublicKey,{type:"ec",data:c};case"1.2.840.10040.4.1":return c.algorithm.params.pub_key=r.DSAparam.decode(c.subjectPublicKey.data,"der"),{type:"dsa",data:c.algorithm.params};default:throw new Error("unknown key id "+h)}throw new Error("unknown key type "+l);case"ENCRYPTED PRIVATE KEY":f=function(t,i){var r=t.algorithm.decrypt.kde.kdeparams.salt,n=parseInt(t.algorithm.decrypt.kde.kdeparams.iters.toString(),10),h=s[t.algorithm.decrypt.cipher.algo.join(".")],c=t.algorithm.decrypt.cipher.iv,u=t.subjectPrivateKey,l=parseInt(h.split("-")[1],10)/8,f=a.pbkdf2Sync(i,r,n,l),d=o.createDecipheriv(h,f,c),p=[];return p.push(d.update(u)),p.push(d.final()),e.concat(p)}(f=r.EncryptedPrivateKey.decode(f,"der"),i);case"PRIVATE KEY":switch(h=(c=r.PrivateKey.decode(f,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return r.RSAPrivateKey.decode(c.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:c.algorithm.curve,privateKey:r.ECPrivateKey.decode(c.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return c.algorithm.params.priv_key=r.DSAparam.decode(c.subjectPrivateKey,"der"),{type:"dsa",params:c.algorithm.params};default:throw new Error("unknown key id "+h)}throw new Error("unknown key type "+l);case"RSA PUBLIC KEY":return r.RSAPublicKey.decode(f,"der");case"RSA PRIVATE KEY":return r.RSAPrivateKey.decode(f,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:r.DSAPrivateKey.decode(f,"der")};case"EC PRIVATE KEY":return{curve:(f=r.ECPrivateKey.decode(f,"der")).parameters.value,privateKey:f.privateKey};default:throw new Error("unknown key type "+l)}}t.exports=h,h.signature=r.signature}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * int64.js - int64s for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */t.exports=i(222)},function(t,e,i){"use strict";
/*!
 * coinentry.js - coin entry object for gamegold
 */const r=i(1),s=i(41),n=i(28),o=i(2),a=i(6),h=i(4),c=i(192),u=(i(17),1),l=(1<<32-u>>>0)-1;class f{constructor(){this.version=1,this.height=-1,this.coinbase=!1,this.output=new n,this.spent=!1,this.raw=null}toOutput(){return this.output}toCoin(t){const e=new s;return e.version=this.version,e.height=this.height,e.coinbase=this.coinbase,e.script=this.output.script,e.value=this.output.value,e.hash=t.hash,e.index=t.index,e}fromOutput(t){return this.output=t,this}static fromOutput(t){return(new f).fromOutput(t)}fromCoin(t){return this.version=t.version,this.height=t.height,this.coinbase=t.coinbase,this.output.script=t.script,this.output.value=t.value,this}static fromCoin(t){return(new f).fromCoin(t)}fromTX(t,e,i){return r("number"==typeof e),r("number"==typeof i),r(e>=0&&e<t.outputs.length),this.version=t.version,this.height=i,this.coinbase=t.isCoinbase(),this.output=t.outputs[e],this}static fromTX(t,e,i){return(new f).fromTX(t,e,i)}getSize(){if(this.raw)return this.raw.length;let t=0;return t+=h.sizeVarint(this.version),(t+=4)+c.size(this.output)}toWriter(t){if(this.raw)return t.writeBytes(this.raw),t;let e=this.height,i=0;return this.coinbase&&(i|=1),-1===e&&(e=l),i|=e<<u,t.writeVarint(this.version),i>>>=0,t.writeU32(i),c.pack(this.output,t),t}toRaw(){if(this.raw)return this.raw;const t=this.getSize(),e=new a(t);return this.toWriter(e),this.raw=e.render(),this.raw}fromReader(t){const e=t.readVarint(),i=t.readU32();let r=i>>>u;return r===l&&(r=-1),this.version=e,this.coinbase=0!=(1&i),this.height=r,c.unpack(this.output,t),this}static fromReader(t){return(new f).fromReader(t)}fromRaw(t){return this.fromReader(new o(t)),this.raw=t,this}static fromRaw(t){return(new f).fromRaw(t)}}t.exports=f},function(t,e,i){(e=t.exports=i(139)).Stream=e,e.Readable=e,e.Writable=i(97),e.Duplex=i(42),e.Transform=i(142),e.PassThrough=i(258)},function(t,e,i){"use strict";var r=i(7).Buffer,s=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===s||!s(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=h,this.end=c,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=u,this.end=l,e=3;break;default:return this.write=f,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function o(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:-1}function a(t){var e=this.lastTotal-this.lastNeed,i=function(t,e,i){if(128!=(192&e[0]))return t.lastNeed=0,"�".repeat(i);if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�".repeat(i+1);if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�".repeat(i+2)}}(this,t,e);return void 0!==i?i:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function h(t,e){if((t.length-e)%2==0){var i=t.toString("utf16le",e);if(i){var r=i.charCodeAt(i.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function u(t,e){var i=(t.length-e)%3;return 0===i?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function l(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function d(t){return t&&t.length?this.write(t):""}e.StringDecoder=n,n.prototype.write=function(t){if(0===t.length)return"";var e,i;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""},n.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�".repeat(this.lastTotal-this.lastNeed):e},n.prototype.text=function(t,e){var i=function(t,e,i){var r=e.length-1;if(r<i)return 0;var s=o(e[r]);return s>=0?(s>0&&(t.lastNeed=s-1),s):--r<i?0:(s=o(e[r]))>=0?(s>0&&(t.lastNeed=s-2),s):--r<i?0:(s=o(e[r]))>=0?(s>0&&(2===s?s=0:t.lastNeed=s-3),s):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var r=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},n.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,i){const r=i(1);class s extends Error{constructor(t,e){super(),r("number"==typeof t),r("string"==typeof e),this.type="RPCError",this.message=String(e),this.code=t>>>0,Error.captureStackTrace&&Error.captureStackTrace(this,s)}}t.exports=s},function(t,e,i){"use strict";(function(t){
/*!
 * common.js - mining utils
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(10),n=i(43),o=e;o.swap32=function(t){for(let e=0;e<t.length;e+=4){const i=t.readUInt32LE(e,!0);t.writeUInt32BE(i,e,!0)}return t},o.swap32hex=function(e){const i=t.from(e,"hex");return o.swap32(i).toString("hex")},o.rcmp=function(t,e){r(t.length===e.length);for(let i=t.length-1;i>=0;i--){if(t[i]<e[i])return-1;if(t[i]>e[i])return 1}return 0},o.double256=function(t){let e,i,s=0;return r(32===t.length),s+=6.277101735386681e57*(4294967296*(e=t.readUInt32LE(28,!0))+(i=t.readUInt32LE(24,!0))),s+=3.402823669209385e38*(4294967296*(e=t.readUInt32LE(20,!0))+(i=t.readUInt32LE(16,!0))),(s+=0x10000000000000000*(4294967296*(e=t.readUInt32LE(12,!0))+(i=t.readUInt32LE(8,!0))))+1*(4294967296*(e=t.readUInt32LE(4,!0))+t.readUInt32LE(0,!0))},o.getDifficulty=function(t){const e=2.695953529101131e67,i=o.double256(t);return 0===i?e:Math.floor(e/i)},o.bits2Diff=function(t){let e=t>>>24&255,i=65535/(16777215&t);for(;e<29;)i*=256,e++;for(;e>29;)i/=256,e--;return i},o.bits2Hash=function(e){const i=s.compact2BN(e);if(i.isNeg())throw new Error("Target is negative.");if(i.isZero())throw new Error("Target is zero.");return i.toArrayLike(t,"le",32)},o.hash2Bits=function(t){const e=new n(t,"le");if(e.isZero())throw new Error("Target is zero.");return s.bn2Compact(e)}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t,i){
/*!
 * random-browser.js - randomness for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=t.crypto||t.msCrypto||{};e.randomBytes=function(t){const e=new Uint8Array(t);return r.getRandomValues(e),i.from(e.buffer)},r.getRandomValues||(e.randomBytes=function(t){const e=i.allocUnsafe(t);for(let t=0;t<e.length;t++)e[t]=Math.floor(256*Math.random());return e}),e.randomInt=function(){return e.randomBytes(4).readUInt32LE(0,!0)},e.randomRange=function(t,i){const r=e.randomInt();return Math.floor(r/4294967296*(i-t)+t)}}).call(this,i(12),i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * packets.js - packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(25),s=i(22),n=i(207);e.types=s,e.typesByVal=n,e.Packet=r,e.UnknownPacket=i(411),e.FilterLoadPacket=i(431),e.AuthProposePacket=i(373),e.VerackPacket=i(376),e.AuthReplyPacket=i(375),e.VersionPacket=i(432),e.PingPacket=i(433),e.PongPacket=i(377),e.GetAddrPacket=i(434),e.AddrPacket=i(378),e.InvPacket=i(214),e.GetDataPacket=i(435),e.NotFoundPacket=i(380),e.GetBlocksPacket=i(381),e.GetHeadersPacket=i(436),e.HeadersPacket=i(437),e.SendHeadersPacket=i(438),e.BlockPacket=i(439),e.TXPacket=i(379),e.RejectPacket=i(441),e.MempoolPacket=i(442),e.FilterAddPacket=i(443),e.FilterClearPacket=i(444),e.MerkleBlockPacket=i(213),e.FeeFilterPacket=i(445),e.SendCmpctPacket=i(446),e.CmpctBlockPacket=i(447),e.GetBlockTxnPacket=i(382),e.BlockTxnPacket=i(383),e.EncinitPacket=i(448),e.EncackPacket=i(449),e.AuthChallengePacket=i(374),e.fromRaw=function(t,i){switch(t.toUpperCase()){case n[s.VERSION]:return e.VersionPacket.fromRaw(i);case n[s.VERACK]:return e.VerackPacket.fromRaw(i);case n[s.PING]:return e.PingPacket.fromRaw(i);case n[s.PONG]:return e.PongPacket.fromRaw(i);case n[s.GETADDR]:return e.GetAddrPacket.fromRaw(i);case n[s.ADDR]:return e.AddrPacket.fromRaw(i);case n[s.INV]:return e.InvPacket.fromRaw(i);case n[s.GETDATA]:return e.GetDataPacket.fromRaw(i);case n[s.NOTFOUND]:return e.NotFoundPacket.fromRaw(i);case n[s.GETBLOCKS]:return e.GetBlocksPacket.fromRaw(i);case n[s.GETHEADERS]:return e.GetHeadersPacket.fromRaw(i);case n[s.HEADERS]:return e.HeadersPacket.fromRaw(i);case n[s.SENDHEADERS]:return e.SendHeadersPacket.fromRaw(i);case n[s.BLOCK]:return e.BlockPacket.fromRaw(i);case n[s.TX]:return e.TXPacket.fromRaw(i);case n[s.REJECT]:return e.RejectPacket.fromRaw(i);case n[s.MEMPOOL]:return e.MempoolPacket.fromRaw(i);case n[s.FILTERLOAD]:return e.FilterLoadPacket.fromRaw(i);case n[s.FILTERADD]:return e.FilterAddPacket.fromRaw(i);case n[s.FILTERCLEAR]:return e.FilterClearPacket.fromRaw(i);case n[s.MERKLEBLOCK]:return e.MerkleBlockPacket.fromRaw(i);case n[s.FEEFILTER]:return e.FeeFilterPacket.fromRaw(i);case n[s.SENDCMPCT]:return e.SendCmpctPacket.fromRaw(i);case n[s.CMPCTBLOCK]:return e.CmpctBlockPacket.fromRaw(i);case n[s.GETBLOCKTXN]:return e.GetBlockTxnPacket.fromRaw(i);case n[s.BLOCKTXN]:return e.BlockTxnPacket.fromRaw(i);case n[s.ENCINIT]:return e.EncinitPacket.fromRaw(i);case n[s.ENCACK]:return e.EncackPacket.fromRaw(i);case n[s.AUTHCHALLENGE]:return e.AuthChallengePacket.fromRaw(i);case n[s.AUTHREPLY]:return e.AuthReplyPacket.fromRaw(i);case n[s.AUTHPROPOSE]:return e.AuthProposePacket.fromRaw(i);default:return e.UnknownPacket.fromRaw(i)}}},function(t,e,i){"use strict";
/*!
 * common.js - commonly required functions for wallet.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=e;r.parseWallets=function(t){const e=t.readU32(),i=new Set;for(let r=0;r<e;r++)i.add(t.readU32());return i},r.sizeWallets=function(t){return 4+4*t.size},r.serializeWallets=function(t,e){t.writeU32(e.size);for(const i of e)t.writeU32(i);return t},r.isName=function(t){if("string"!=typeof t)return!1;if(0===t.length)return!1;if(!/^[\-\._0-9A-Za-z]+$/.test(t))return!1;switch(t[0]){case"_":case"-":case".":return!1}switch(t[t.length-1]){case"_":case"-":case".":return!1}return t.length>=1&&t.length<=40},r.sortTX=function(t){return t.sort((t,e)=>t.mtime-e.mtime)},r.sortCoins=function(t){return t.sort((t,e)=>(t=-1===t.height?2147483647:t.height)-(e=-1===e.height?2147483647:e.height))},r.sortDeps=function(t){const e=new Map;for(const i of t){const t=i.hash("hex");e.set(t,i)}const i=new Map,r=new Map,s=[];for(const[t,n]of e){r.set(t,0);let o=!1;for(const s of n.inputs){const a=s.prevout.hash;if(!e.has(a))continue;const h=r.get(t);r.set(t,h+1),o=!0,i.has(a)||i.set(a,[]),i.get(a).push(n)}o||s.push(n)}const n=[];for(const t of s){const e=t.hash("hex"),o=i.get(e);if(n.push(t),o)for(const t of o){const e=t.hash("hex");let i=r.get(e);0==--i&&s.push(t),r.set(e,i)}}return n}},function(t,e,i){"use strict";(function(t){
/*!
 * merkle.js - merkle trees for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(9);e.createTree=function(e){const i=e;let s=e.length,n=!1,o=0;if(0===s)return i.push(t.alloc(32)),[i,n];for(;s>1;){for(let t=0;t<s;t+=2){const e=Math.min(t+1,s-1),a=i[o+t],h=i[o+e];e===t+1&&e+1===s&&a.equals(h)&&(n=!0);const c=r.root256(a,h);i.push(c)}o+=s,s+=1,s>>>=1}return[i,n]},e.createRoot=function(t){const[i,r]=e.createTree(t);return[i[i.length-1],r]},e.createBranch=function(t,i){let r=i.length;const[s]=e.createTree(i),n=[];let o=0;for(;r>1;){const e=Math.min(1^t,r-1);n.push(s[o+e]),t>>>=1,o+=r,r+=1,r>>>=1}return n},e.deriveRoot=function(t,e,i){let s=t;for(const t of e)s=1&i?r.root256(t,s):r.root256(s,t),i>>>=1;return s}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e,r,s){var n=i(80);function o(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,i){var r=t.entry;for(t.entry=null;r;){var s=r.callback;e.pendingcb--,s(void 0),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=y;var a,h=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?r:n.nextTick;y.WritableState=w;var c=i(58);c.inherits=i(5);var u,l={deprecate:i(257)},f=i(140),d=i(7).Buffer,p=s.Uint8Array||function(){},g=i(141);function m(){}function w(t,e){a=a||i(42),t=t||{};var r=e instanceof a;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var s=t.highWaterMark,c=t.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=s||0===s?s:r&&(c||0===c)?c:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var l=!1===t.decodeStrings;this.decodeStrings=!l,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var i=t._writableState,r=i.sync,s=i.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(i),e)!function(t,e,i,r,s){--e.pendingcb,i?(n.nextTick(s,r),n.nextTick(E,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(s(r),t._writableState.errorEmitted=!0,t.emit("error",r),E(t,e))}(t,i,r,e,s);else{var o=S(i);o||i.corked||i.bufferProcessing||!i.bufferedRequest||k(t,i),r?h(v,t,i,o,s):v(t,i,o,s)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function y(t){if(a=a||i(42),!(u.call(y,this)||this instanceof a))return new y(t);this._writableState=new w(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),f.call(this)}function b(t,e,i,r,s,n,o){e.writelen=r,e.writecb=o,e.writing=!0,e.sync=!0,i?t._writev(s,e.onwrite):t._write(s,n,e.onwrite),e.sync=!1}function v(t,e,i,r){i||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),E(t,e)}function k(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var r=e.bufferedRequestCount,s=new Array(r),n=e.corkedRequestsFree;n.entry=i;for(var a=0,h=!0;i;)s[a]=i,i.isBuf||(h=!1),i=i.next,a+=1;s.allBuffers=h,b(t,e,!0,e.length,s,"",n.finish),e.pendingcb++,e.lastBufferedRequest=null,n.next?(e.corkedRequestsFree=n.next,n.next=null):e.corkedRequestsFree=new o(e),e.bufferedRequestCount=0}else{for(;i;){var c=i.chunk,u=i.encoding,l=i.callback;if(b(t,e,!1,e.objectMode?1:c.length,c,u,l),i=i.next,e.bufferedRequestCount--,e.writing)break}null===i&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}function S(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function x(t,e){t._final(function(i){e.pendingcb--,i&&t.emit("error",i),e.prefinished=!0,t.emit("prefinish"),E(t,e)})}function E(t,e){var i=S(e);return i&&(function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,n.nextTick(x,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),i}c.inherits(y,f),w.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(w.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(t){return!!u.call(this,t)||this===y&&t&&t._writableState instanceof w}})):u=function(t){return t instanceof this},y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},y.prototype.write=function(t,e,i){var r=this._writableState,s=!1,o=!r.objectMode&&function(t){return d.isBuffer(t)||t instanceof p}(t);return o&&!d.isBuffer(t)&&(t=function(t){return d.from(t)}(t)),"function"==typeof e&&(i=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof i&&(i=m),r.ended?function(t,e){var i=new Error("write after end");t.emit("error",i),n.nextTick(e,i)}(this,i):(o||function(t,e,i,r){var s=!0,o=!1;return null===i?o=new TypeError("May not write null values to stream"):"string"==typeof i||void 0===i||e.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),n.nextTick(r,o),s=!1),s}(this,r,t,i))&&(r.pendingcb++,s=function(t,e,i,r,s,n){if(!i){var o=function(t,e,i){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=d.from(e,i)),e}(e,r,s);r!==o&&(i=!0,s="buffer",r=o)}var a=e.objectMode?1:r.length;e.length+=a;var h=e.length<e.highWaterMark;if(h||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:s,isBuf:i,callback:n,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else b(t,e,!1,a,r,s,n);return h}(this,r,o,t,e,i)),s},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||k(this,t))},y.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},y.prototype._write=function(t,e,i){i(new Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(t,e,i){var r=this._writableState;"function"==typeof t?(i=t,t=null,e=null):"function"==typeof e&&(i=e,e=null),null!==t&&void 0!==t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,i){e.ending=!0,E(t,e),i&&(e.finished?n.nextTick(i):t.once("finish",i)),e.ended=!0,t.writable=!1}(this,r,i)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),y.prototype.destroy=g.destroy,y.prototype._undestroy=g.undestroy,y.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,i(23),i(81).setImmediate,i(12))},function(t,e,i){"use strict";
/*!
 * lru.js - LRU cache for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(1);function s(t){this.lru=t,this.ops=[]}function n(t,e,i){this.remove=t,this.key=e,this.value=i}s.prototype.set=function(t,e){this.ops.push(new n(!1,t,e))},s.prototype.remove=function(t){this.ops.push(new n(!0,t,null))},s.prototype.clear=function(){this.ops.length=0},s.prototype.commit=function(){for(const t of this.ops)t.remove?this.lru.remove(t.key):this.lru.set(t.key,t.value);this.ops.length=0},t.exports=class{constructor(t,e){this.map=new Map,this.size=0,this.items=0,this.head=null,this.tail=null,this.pending=null,r("number"==typeof t,"Capacity must be a number."),r(t>=0,"Capacity cannot be negative."),r(!e||"function"==typeof e,"Bad size callback."),this.capacity=t,this.getSize=e}_getSize(t){return this.getSize?120+Math.floor(1.375*t.key.length)+this.getSize(t.value):1}_compact(){if(this.size<=this.capacity)return;let t,e;for(t=this.head;t&&!(this.size<=this.capacity);t=e)this.size-=this._getSize(t),this.items--,this.map.delete(t.key),e=t.next,t.prev=null,t.next=null;if(!t)return this.head=null,void(this.tail=null);this.head=t,t.prev=null}reset(){let t,e;for(t=this.head;t;t=e)this.map.delete(t.key),this.items--,e=t.next,t.prev=null,t.next=null;r(!t),this.size=0,this.head=null,this.tail=null}set(t,e){if(0===this.capacity)return;t=String(t);let i=this.map.get(t);if(i)return this.size-=this._getSize(i),i.value=e,this.size+=this._getSize(i),this._removeList(i),this._appendList(i),void this._compact();i=new function(t,e){this.key=t,this.value=e,this.next=null,this.prev=null}(t,e),this.map.set(t,i),this._appendList(i),this.size+=this._getSize(i),this.items++,this._compact()}get(t){if(0===this.capacity)return null;t=String(t);const e=this.map.get(t);return e?(this._removeList(e),this._appendList(e),e.value):null}has(t){return 0!==this.capacity&&this.map.has(String(t))}remove(t){if(0===this.capacity)return!1;t=String(t);const e=this.map.get(t);return!!e&&(this.size-=this._getSize(e),this.items--,this.map.delete(t),this._removeList(e),!0)}_prependList(t){this._insertList(null,t)}_appendList(t){this._insertList(this.tail,t)}_insertList(t,e){r(!e.next),r(!e.prev),null!=t?(e.next=t.next,e.prev=t,t.next=e,t===this.tail&&(this.tail=e)):this.head?(this.head.prev=e,e.next=this.head,this.head=e):(this.head=e,this.tail=e)}_removeList(t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev||this.head),this.head||r(!this.tail),this.tail||r(!this.head),t.prev=null,t.next=null}keys(){const t=[];for(let e=this.head;e;e=e.next)e===this.head&&r(!e.prev),e.prev||r(e===this.head),e.next||r(e===this.tail),t.push(e.key);return t}values(){const t=[];for(let e=this.head;e;e=e.next)t.push(e.value);return t}toArray(){const t=[];for(let e=this.head;e;e=e.next)t.push(e);return t}batch(){return new s(this)}start(){r(!this.pending),this.pending=this.batch()}clear(){r(this.pending),this.pending.clear()}drop(){r(this.pending),this.pending=null}commit(){r(this.pending),this.pending.commit(),this.pending=null}push(t,e){r(this.pending),0!==this.capacity&&this.pending.set(t,e)}unpush(t){r(this.pending),0!==this.capacity&&this.pending.remove(t)}}},function(t,e,i){"use strict";var r=i(276);function s(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var i=1732584193,r=-271733879,s=-1732584194,n=271733878,l=0;l<t.length;l+=16){var f=i,d=r,p=s,g=n;r=c(r=c(r=c(r=c(r=h(r=h(r=h(r=h(r=a(r=a(r=a(r=a(r=o(r=o(r=o(r=o(r,s=o(s,n=o(n,i=o(i,r,s,n,t[l+0],7,-680876936),r,s,t[l+1],12,-389564586),i,r,t[l+2],17,606105819),n,i,t[l+3],22,-1044525330),s=o(s,n=o(n,i=o(i,r,s,n,t[l+4],7,-176418897),r,s,t[l+5],12,1200080426),i,r,t[l+6],17,-1473231341),n,i,t[l+7],22,-45705983),s=o(s,n=o(n,i=o(i,r,s,n,t[l+8],7,1770035416),r,s,t[l+9],12,-1958414417),i,r,t[l+10],17,-42063),n,i,t[l+11],22,-1990404162),s=o(s,n=o(n,i=o(i,r,s,n,t[l+12],7,1804603682),r,s,t[l+13],12,-40341101),i,r,t[l+14],17,-1502002290),n,i,t[l+15],22,1236535329),s=a(s,n=a(n,i=a(i,r,s,n,t[l+1],5,-165796510),r,s,t[l+6],9,-1069501632),i,r,t[l+11],14,643717713),n,i,t[l+0],20,-373897302),s=a(s,n=a(n,i=a(i,r,s,n,t[l+5],5,-701558691),r,s,t[l+10],9,38016083),i,r,t[l+15],14,-660478335),n,i,t[l+4],20,-405537848),s=a(s,n=a(n,i=a(i,r,s,n,t[l+9],5,568446438),r,s,t[l+14],9,-1019803690),i,r,t[l+3],14,-187363961),n,i,t[l+8],20,1163531501),s=a(s,n=a(n,i=a(i,r,s,n,t[l+13],5,-1444681467),r,s,t[l+2],9,-51403784),i,r,t[l+7],14,1735328473),n,i,t[l+12],20,-1926607734),s=h(s,n=h(n,i=h(i,r,s,n,t[l+5],4,-378558),r,s,t[l+8],11,-2022574463),i,r,t[l+11],16,1839030562),n,i,t[l+14],23,-35309556),s=h(s,n=h(n,i=h(i,r,s,n,t[l+1],4,-1530992060),r,s,t[l+4],11,1272893353),i,r,t[l+7],16,-155497632),n,i,t[l+10],23,-1094730640),s=h(s,n=h(n,i=h(i,r,s,n,t[l+13],4,681279174),r,s,t[l+0],11,-358537222),i,r,t[l+3],16,-722521979),n,i,t[l+6],23,76029189),s=h(s,n=h(n,i=h(i,r,s,n,t[l+9],4,-640364487),r,s,t[l+12],11,-421815835),i,r,t[l+15],16,530742520),n,i,t[l+2],23,-995338651),s=c(s,n=c(n,i=c(i,r,s,n,t[l+0],6,-198630844),r,s,t[l+7],10,1126891415),i,r,t[l+14],15,-1416354905),n,i,t[l+5],21,-57434055),s=c(s,n=c(n,i=c(i,r,s,n,t[l+12],6,1700485571),r,s,t[l+3],10,-1894986606),i,r,t[l+10],15,-1051523),n,i,t[l+1],21,-2054922799),s=c(s,n=c(n,i=c(i,r,s,n,t[l+8],6,1873313359),r,s,t[l+15],10,-30611744),i,r,t[l+6],15,-1560198380),n,i,t[l+13],21,1309151649),s=c(s,n=c(n,i=c(i,r,s,n,t[l+4],6,-145523070),r,s,t[l+11],10,-1120210379),i,r,t[l+2],15,718787259),n,i,t[l+9],21,-343485551),i=u(i,f),r=u(r,d),s=u(s,p),n=u(n,g)}return[i,r,s,n]}function n(t,e,i,r,s,n){return u(function(t,e){return t<<s|t>>>32-s}(u(u(e,t),u(r,n))),i)}function o(t,e,i,r,s,o,a){return n(e&i|~e&r,t,e,s,o,a)}function a(t,e,i,r,s,o,a){return n(e&r|i&~r,t,e,s,o,a)}function h(t,e,i,r,s,o,a){return n(e^i^r,t,e,s,o,a)}function c(t,e,i,r,s,o,a){return n(i^(e|~r),t,e,s,o,a)}function u(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}t.exports=function(t){return r(t,s)}},function(t,e,i){"use strict";(function(e){var r=i(5),s=i(277);function n(){s.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function o(t,e){return t<<e|t>>>32-e}function a(t,e,i,r,s,n,a,h){return o(t+(e^i^r)+n+a|0,h)+s|0}function h(t,e,i,r,s,n,a,h){return o(t+(e&i|~e&r)+n+a|0,h)+s|0}function c(t,e,i,r,s,n,a,h){return o(t+((e|~i)^r)+n+a|0,h)+s|0}function u(t,e,i,r,s,n,a,h){return o(t+(e&r|i&~r)+n+a|0,h)+s|0}function l(t,e,i,r,s,n,a,h){return o(t+(e^(i|~r))+n+a|0,h)+s|0}r(n,s),n.prototype._update=function(){for(var t=new Array(16),e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);var i=this._a,r=this._b,s=this._c,n=this._d,f=this._e;f=a(f,i=a(i,r,s,n,f,t[0],0,11),r,s=o(s,10),n,t[1],0,14),r=a(r=o(r,10),s=a(s,n=a(n,f,i,r,s,t[2],0,15),f,i=o(i,10),r,t[3],0,12),n,f=o(f,10),i,t[4],0,5),n=a(n=o(n,10),f=a(f,i=a(i,r,s,n,f,t[5],0,8),r,s=o(s,10),n,t[6],0,7),i,r=o(r,10),s,t[7],0,9),i=a(i=o(i,10),r=a(r,s=a(s,n,f,i,r,t[8],0,11),n,f=o(f,10),i,t[9],0,13),s,n=o(n,10),f,t[10],0,14),s=a(s=o(s,10),n=a(n,f=a(f,i,r,s,n,t[11],0,15),i,r=o(r,10),s,t[12],0,6),f,i=o(i,10),r,t[13],0,7),f=h(f=o(f,10),i=a(i,r=a(r,s,n,f,i,t[14],0,9),s,n=o(n,10),f,t[15],0,8),r,s=o(s,10),n,t[7],1518500249,7),r=h(r=o(r,10),s=h(s,n=h(n,f,i,r,s,t[4],1518500249,6),f,i=o(i,10),r,t[13],1518500249,8),n,f=o(f,10),i,t[1],1518500249,13),n=h(n=o(n,10),f=h(f,i=h(i,r,s,n,f,t[10],1518500249,11),r,s=o(s,10),n,t[6],1518500249,9),i,r=o(r,10),s,t[15],1518500249,7),i=h(i=o(i,10),r=h(r,s=h(s,n,f,i,r,t[3],1518500249,15),n,f=o(f,10),i,t[12],1518500249,7),s,n=o(n,10),f,t[0],1518500249,12),s=h(s=o(s,10),n=h(n,f=h(f,i,r,s,n,t[9],1518500249,15),i,r=o(r,10),s,t[5],1518500249,9),f,i=o(i,10),r,t[2],1518500249,11),f=h(f=o(f,10),i=h(i,r=h(r,s,n,f,i,t[14],1518500249,7),s,n=o(n,10),f,t[11],1518500249,13),r,s=o(s,10),n,t[8],1518500249,12),r=c(r=o(r,10),s=c(s,n=c(n,f,i,r,s,t[3],1859775393,11),f,i=o(i,10),r,t[10],1859775393,13),n,f=o(f,10),i,t[14],1859775393,6),n=c(n=o(n,10),f=c(f,i=c(i,r,s,n,f,t[4],1859775393,7),r,s=o(s,10),n,t[9],1859775393,14),i,r=o(r,10),s,t[15],1859775393,9),i=c(i=o(i,10),r=c(r,s=c(s,n,f,i,r,t[8],1859775393,13),n,f=o(f,10),i,t[1],1859775393,15),s,n=o(n,10),f,t[2],1859775393,14),s=c(s=o(s,10),n=c(n,f=c(f,i,r,s,n,t[7],1859775393,8),i,r=o(r,10),s,t[0],1859775393,13),f,i=o(i,10),r,t[6],1859775393,6),f=c(f=o(f,10),i=c(i,r=c(r,s,n,f,i,t[13],1859775393,5),s,n=o(n,10),f,t[11],1859775393,12),r,s=o(s,10),n,t[5],1859775393,7),r=u(r=o(r,10),s=u(s,n=c(n,f,i,r,s,t[12],1859775393,5),f,i=o(i,10),r,t[1],2400959708,11),n,f=o(f,10),i,t[9],2400959708,12),n=u(n=o(n,10),f=u(f,i=u(i,r,s,n,f,t[11],2400959708,14),r,s=o(s,10),n,t[10],2400959708,15),i,r=o(r,10),s,t[0],2400959708,14),i=u(i=o(i,10),r=u(r,s=u(s,n,f,i,r,t[8],2400959708,15),n,f=o(f,10),i,t[12],2400959708,9),s,n=o(n,10),f,t[4],2400959708,8),s=u(s=o(s,10),n=u(n,f=u(f,i,r,s,n,t[13],2400959708,9),i,r=o(r,10),s,t[3],2400959708,14),f,i=o(i,10),r,t[7],2400959708,5),f=u(f=o(f,10),i=u(i,r=u(r,s,n,f,i,t[15],2400959708,6),s,n=o(n,10),f,t[14],2400959708,8),r,s=o(s,10),n,t[5],2400959708,6),r=l(r=o(r,10),s=u(s,n=u(n,f,i,r,s,t[6],2400959708,5),f,i=o(i,10),r,t[2],2400959708,12),n,f=o(f,10),i,t[4],2840853838,9),n=l(n=o(n,10),f=l(f,i=l(i,r,s,n,f,t[0],2840853838,15),r,s=o(s,10),n,t[5],2840853838,5),i,r=o(r,10),s,t[9],2840853838,11),i=l(i=o(i,10),r=l(r,s=l(s,n,f,i,r,t[7],2840853838,6),n,f=o(f,10),i,t[12],2840853838,8),s,n=o(n,10),f,t[2],2840853838,13),s=l(s=o(s,10),n=l(n,f=l(f,i,r,s,n,t[10],2840853838,12),i,r=o(r,10),s,t[14],2840853838,5),f,i=o(i,10),r,t[1],2840853838,12),f=l(f=o(f,10),i=l(i,r=l(r,s,n,f,i,t[3],2840853838,13),s,n=o(n,10),f,t[8],2840853838,14),r,s=o(s,10),n,t[11],2840853838,11),r=l(r=o(r,10),s=l(s,n=l(n,f,i,r,s,t[6],2840853838,8),f,i=o(i,10),r,t[15],2840853838,5),n,f=o(f,10),i,t[13],2840853838,6),n=o(n,10);var d=this._a,p=this._b,g=this._c,m=this._d,w=this._e;w=l(w,d=l(d,p,g,m,w,t[5],1352829926,8),p,g=o(g,10),m,t[14],1352829926,9),p=l(p=o(p,10),g=l(g,m=l(m,w,d,p,g,t[7],1352829926,9),w,d=o(d,10),p,t[0],1352829926,11),m,w=o(w,10),d,t[9],1352829926,13),m=l(m=o(m,10),w=l(w,d=l(d,p,g,m,w,t[2],1352829926,15),p,g=o(g,10),m,t[11],1352829926,15),d,p=o(p,10),g,t[4],1352829926,5),d=l(d=o(d,10),p=l(p,g=l(g,m,w,d,p,t[13],1352829926,7),m,w=o(w,10),d,t[6],1352829926,7),g,m=o(m,10),w,t[15],1352829926,8),g=l(g=o(g,10),m=l(m,w=l(w,d,p,g,m,t[8],1352829926,11),d,p=o(p,10),g,t[1],1352829926,14),w,d=o(d,10),p,t[10],1352829926,14),w=u(w=o(w,10),d=l(d,p=l(p,g,m,w,d,t[3],1352829926,12),g,m=o(m,10),w,t[12],1352829926,6),p,g=o(g,10),m,t[6],1548603684,9),p=u(p=o(p,10),g=u(g,m=u(m,w,d,p,g,t[11],1548603684,13),w,d=o(d,10),p,t[3],1548603684,15),m,w=o(w,10),d,t[7],1548603684,7),m=u(m=o(m,10),w=u(w,d=u(d,p,g,m,w,t[0],1548603684,12),p,g=o(g,10),m,t[13],1548603684,8),d,p=o(p,10),g,t[5],1548603684,9),d=u(d=o(d,10),p=u(p,g=u(g,m,w,d,p,t[10],1548603684,11),m,w=o(w,10),d,t[14],1548603684,7),g,m=o(m,10),w,t[15],1548603684,7),g=u(g=o(g,10),m=u(m,w=u(w,d,p,g,m,t[8],1548603684,12),d,p=o(p,10),g,t[12],1548603684,7),w,d=o(d,10),p,t[4],1548603684,6),w=u(w=o(w,10),d=u(d,p=u(p,g,m,w,d,t[9],1548603684,15),g,m=o(m,10),w,t[1],1548603684,13),p,g=o(g,10),m,t[2],1548603684,11),p=c(p=o(p,10),g=c(g,m=c(m,w,d,p,g,t[15],1836072691,9),w,d=o(d,10),p,t[5],1836072691,7),m,w=o(w,10),d,t[1],1836072691,15),m=c(m=o(m,10),w=c(w,d=c(d,p,g,m,w,t[3],1836072691,11),p,g=o(g,10),m,t[7],1836072691,8),d,p=o(p,10),g,t[14],1836072691,6),d=c(d=o(d,10),p=c(p,g=c(g,m,w,d,p,t[6],1836072691,6),m,w=o(w,10),d,t[9],1836072691,14),g,m=o(m,10),w,t[11],1836072691,12),g=c(g=o(g,10),m=c(m,w=c(w,d,p,g,m,t[8],1836072691,13),d,p=o(p,10),g,t[12],1836072691,5),w,d=o(d,10),p,t[2],1836072691,14),w=c(w=o(w,10),d=c(d,p=c(p,g,m,w,d,t[10],1836072691,13),g,m=o(m,10),w,t[0],1836072691,13),p,g=o(g,10),m,t[4],1836072691,7),p=h(p=o(p,10),g=h(g,m=c(m,w,d,p,g,t[13],1836072691,5),w,d=o(d,10),p,t[8],2053994217,15),m,w=o(w,10),d,t[6],2053994217,5),m=h(m=o(m,10),w=h(w,d=h(d,p,g,m,w,t[4],2053994217,8),p,g=o(g,10),m,t[1],2053994217,11),d,p=o(p,10),g,t[3],2053994217,14),d=h(d=o(d,10),p=h(p,g=h(g,m,w,d,p,t[11],2053994217,14),m,w=o(w,10),d,t[15],2053994217,6),g,m=o(m,10),w,t[0],2053994217,14),g=h(g=o(g,10),m=h(m,w=h(w,d,p,g,m,t[5],2053994217,6),d,p=o(p,10),g,t[12],2053994217,9),w,d=o(d,10),p,t[2],2053994217,12),w=h(w=o(w,10),d=h(d,p=h(p,g,m,w,d,t[13],2053994217,9),g,m=o(m,10),w,t[9],2053994217,12),p,g=o(g,10),m,t[7],2053994217,5),p=a(p=o(p,10),g=h(g,m=h(m,w,d,p,g,t[10],2053994217,15),w,d=o(d,10),p,t[14],2053994217,8),m,w=o(w,10),d,t[12],0,8),m=a(m=o(m,10),w=a(w,d=a(d,p,g,m,w,t[15],0,5),p,g=o(g,10),m,t[10],0,12),d,p=o(p,10),g,t[4],0,9),d=a(d=o(d,10),p=a(p,g=a(g,m,w,d,p,t[1],0,12),m,w=o(w,10),d,t[5],0,5),g,m=o(m,10),w,t[8],0,14),g=a(g=o(g,10),m=a(m,w=a(w,d,p,g,m,t[7],0,6),d,p=o(p,10),g,t[6],0,8),w,d=o(d,10),p,t[2],0,13),w=a(w=o(w,10),d=a(d,p=a(p,g,m,w,d,t[13],0,6),g,m=o(m,10),w,t[14],0,5),p,g=o(g,10),m,t[0],0,15),p=a(p=o(p,10),g=a(g,m=a(m,w,d,p,g,t[3],0,13),w,d=o(d,10),p,t[9],0,11),m,w=o(w,10),d,t[11],0,11),m=o(m,10);var y=this._b+s+m|0;this._b=this._c+n+w|0,this._c=this._d+f+d|0,this._d=this._e+i+p|0,this._e=this._a+r+g|0,this._a=y},n.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=new e(20);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t.writeInt32LE(this._e,16),t},t.exports=n}).call(this,i(0).Buffer)},function(t,e,i){(e=t.exports=function(t){t=t.toLowerCase();var i=e[t];if(!i)throw new Error(t+" is not supported (we accept pull requests)");return new i}).sha=i(282),e.sha1=i(283),e.sha224=i(284),e.sha256=i(149),e.sha384=i(285),e.sha512=i(150)},function(t,e,i){"use strict";e.utils=i(291),e.Cipher=i(292),e.DES=i(293),e.CBC=i(294),e.EDE=i(295)},function(t,e,i){var r=i(297),s=i(307),n=i(159);e.createCipher=e.Cipher=r.createCipher,e.createCipheriv=e.Cipheriv=r.createCipheriv,e.createDecipher=e.Decipher=s.createDecipher,e.createDecipheriv=e.Decipheriv=s.createDecipheriv,e.listCiphers=e.getCiphers=function(){return Object.keys(n)}},function(t,e,i){var r={ECB:i(298),CBC:i(299),CFB:i(300),CFB8:i(301),CFB1:i(302),OFB:i(303),CTR:i(157),GCM:i(157)},s=i(159);for(var n in s)s[n].module=r[s[n].mode];t.exports=s},function(t,e,i){(function(e){var r=i(14),s=i(49);function n(t,i){var s=function(t){var e=o(t);return{blinder:e.toRed(r.mont(t.modulus)).redPow(new r(t.publicExponent)).fromRed(),unblinder:e.invm(t.modulus)}}(i),n=i.modulus.byteLength(),a=(r.mont(i.modulus),new r(t).mul(s.blinder).umod(i.modulus)),h=a.toRed(r.mont(i.prime1)),c=a.toRed(r.mont(i.prime2)),u=i.coefficient,l=i.prime1,f=i.prime2,d=h.redPow(i.exponent1),p=c.redPow(i.exponent2);d=d.fromRed(),p=p.fromRed();var g=d.isub(p).imul(u).umod(l);return g.imul(f),p.iadd(g),new e(p.imul(s.unblinder).umod(i.modulus).toArray(!1,n))}function o(t){for(var e=t.modulus.byteLength(),i=new r(s(e));i.cmp(t.modulus)>=0||!i.umod(t.prime1)||!i.umod(t.prime2);)i=new r(s(e));return i}t.exports=n,n.getr=o}).call(this,i(0).Buffer)},function(t,e,i){"use strict";var r=i(14),s=i(21).utils,n=s.assert;function o(t,e){if(t instanceof o)return t;this._importDER(t,e)||(n(t.r&&t.s,"Signature without r or s"),this.r=new r(t.r,16),this.s=new r(t.s,16),void 0===t.recoveryParam?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}function a(t,e){var i=t[e.place++];if(!(128&i))return i;for(var r=15&i,s=0,n=0,o=e.place;n<r;n++,o++)s<<=8,s|=t[o];return e.place=o,s}function h(t){for(var e=0,i=t.length-1;!t[e]&&!(128&t[e+1])&&e<i;)e++;return 0===e?t:t.slice(e)}function c(t,e){if(e<128)t.push(e);else{var i=1+(Math.log(e)/Math.LN2>>>3);for(t.push(128|i);--i;)t.push(e>>>(i<<3)&255);t.push(e)}}t.exports=o,o.prototype._importDER=function(t,e){t=s.toArray(t,e);var i=new function(){this.place=0};if(48!==t[i.place++])return!1;if(a(t,i)+i.place!==t.length)return!1;if(2!==t[i.place++])return!1;var n=a(t,i),o=t.slice(i.place,n+i.place);if(i.place+=n,2!==t[i.place++])return!1;var h=a(t,i);if(t.length!==h+i.place)return!1;var c=t.slice(i.place,h+i.place);return 0===o[0]&&128&o[1]&&(o=o.slice(1)),0===c[0]&&128&c[1]&&(c=c.slice(1)),this.r=new r(o),this.s=new r(c),this.recoveryParam=null,!0},o.prototype.toDER=function(t){var e=this.r.toArray(),i=this.s.toArray();for(128&e[0]&&(e=[0].concat(e)),128&i[0]&&(i=[0].concat(i)),e=h(e),i=h(i);!(i[0]||128&i[1]);)i=i.slice(1);var r=[2];c(r,e.length),(r=r.concat(e)).push(2),c(r,i.length);var n=r.concat(i),o=[48];return c(o,n.length),o=o.concat(n),s.encode(o,t)}},function(t,e,i){"use strict";(function(e){
/*!
 * opcode.js - opcode object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(57),n=i(3),o=i(27),a=i(2),h=i(6),c=o.opcodes,u=[];let l=null;class f{constructor(t,e){this.value=t||0,this.data=e||null}isMinimal(){if(!this.data)return!0;if(1===this.data.length){if(129===this.data[0])return!1;if(this.data[0]>=1&&this.data[0]<=16)return!1}return this.data.length<=75?this.value===this.data.length:this.data.length<=255?this.value===c.OP_PUSHDATA1:this.data.length<=65535?this.value===c.OP_PUSHDATA2:(r(this.value===c.OP_PUSHDATA4),!0)}isDisabled(){switch(this.value){case c.OP_CAT:case c.OP_SUBSTR:case c.OP_LEFT:case c.OP_RIGHT:case c.OP_INVERT:case c.OP_AND:case c.OP_OR:case c.OP_XOR:case c.OP_2MUL:case c.OP_2DIV:case c.OP_MUL:case c.OP_DIV:case c.OP_MOD:case c.OP_LSHIFT:case c.OP_RSHIFT:return!0}return!1}isBranch(){return this.value>=c.OP_IF&&this.value<=c.OP_ENDIF}equals(t){return r(f.isOpcode(t)),this.value===t.value&&(this.data?(r(t.data),this.data.equals(t.data)):(r(!t.data),!0))}toOp(){return this.value}toData(){return this.data}toLength(){return this.data?this.data.length:-1}toPush(){return this.value===c.OP_0?o.small[1]:this.value===c.OP_1NEGATE?o.small[0]:this.value>=c.OP_1&&this.value<=c.OP_16?o.small[this.value-80+1]:this.toData()}toString(t){const e=this.toPush();return e?e.toString(t||"utf8"):null}toSmall(){return this.value===c.OP_0?0:this.value>=c.OP_1&&this.value<=c.OP_16?this.value-80:-1}toNum(t,e){return this.value===c.OP_0?s.fromInt(0):this.value===c.OP_1NEGATE?s.fromInt(-1):this.value>=c.OP_1&&this.value<=c.OP_16?s.fromInt(this.value-80):this.data?s.decode(this.data,t,e):null}toInt(t,e){const i=this.toNum(t,e);return i?i.getInt():-1}toBool(){const t=this.toSmall();return-1!==t&&1===t}toSymbol(){if(-1===this.value)return"OP_INVALIDOPCODE";return o.opcodesByVal[this.value]||`0x${n.hex8(this.value)}`}getSize(){if(!this.data)return 1;switch(this.value){case c.OP_PUSHDATA1:return 2+this.data.length;case c.OP_PUSHDATA2:return 3+this.data.length;case c.OP_PUSHDATA4:return 5+this.data.length;default:return 1+this.data.length}}toWriter(t){if(-1===this.value)throw new Error("Cannot reserialize a parse error.");if(!this.data)return t.writeU8(this.value),t;switch(this.value){case c.OP_PUSHDATA1:t.writeU8(this.value),t.writeU8(this.data.length),t.writeBytes(this.data);break;case c.OP_PUSHDATA2:t.writeU8(this.value),t.writeU16(this.data.length),t.writeBytes(this.data);break;case c.OP_PUSHDATA4:t.writeU8(this.value),t.writeU32(this.data.length),t.writeBytes(this.data);break;default:r(this.value===this.data.length),t.writeU8(this.value),t.writeBytes(this.data)}return t}toRaw(){const t=this.getSize();return this.toWriter(new h(t)).render()}toFormat(){if(-1===this.value)return"0x01";if(this.data){if(this.data.length<=4){const t=this.toNum();if(this.equals(f.fromNum(t)))return t.toString(10)}const t=o.opcodesByVal[this.value],e=this.data.toString("hex");if(!t)return`0x${n.hex8(this.value)} 0x${e}`;let i=this.data.length.toString(16);for(;i.length%2!=0;)i="0"+i;return`${t} 0x${i} 0x${e}`}return o.opcodesByVal[this.value]||`0x${n.hex8(this.value)}`}toASM(t){return-1===this.value?"[error]":this.data?o.toASM(this.data,t):o.opcodesByVal[this.value]||"OP_UNKNOWN"}static fromOp(t){r("number"==typeof t);const e=u[t];return r(e,"Bad opcode."),e}static fromData(t){if(r(e.isBuffer(t)),1===t.length){if(129===t[0])return f.fromOp(c.OP_1NEGATE);if(t[0]>=1&&t[0]<=16)return f.fromOp(t[0]+80)}return f.fromPush(t)}static fromPush(t){if(r(e.isBuffer(t)),0===t.length)return f.fromOp(c.OP_0);if(t.length<=75)return new f(t.length,t);if(t.length<=255)return new f(c.OP_PUSHDATA1,t);if(t.length<=65535)return new f(c.OP_PUSHDATA2,t);if(t.length<=4294967295)return new f(c.OP_PUSHDATA4,t);throw new Error("Pushdata size too large.")}static fromString(t,i){r("string"==typeof t);const s=e.from(t,i||"utf8");return f.fromData(s)}static fromSmall(t){return r(n.isU8(t)&&t>=0&&t<=16),f.fromOp(0===t?0:t+80)}static fromNum(t){return r(s.isScriptNum(t)),f.fromData(t.encode())}static fromInt(t){return r(n.isInt(t)),0===t?f.fromOp(c.OP_0):-1===t?f.fromOp(c.OP_1NEGATE):t>=1&&t<=16?f.fromOp(t+80):f.fromNum(s.fromNumber(t))}static fromBool(t){return r("boolean"==typeof t),f.fromSmall(t?1:0)}static fromSymbol(t){r("string"==typeof t),r(t.length>0),n.isUpperCase(t)||(t=t.toUpperCase()),n.startsWith(t,"OP_")||(t=`OP_${t}`);const e=o.opcodes[t];if(null!=e)return f.fromOp(e);r(n.startsWith(t,"OP_0X"),"Unknown opcode."),r(7===t.length,"Unknown opcode.");const i=parseInt(t.substring(5),16);return r(n.isU8(i),"Unknown opcode."),f.fromOp(i)}static fromReader(t){const e=t.readU8(),i=u[e];if(i)return i;switch(e){case c.OP_PUSHDATA1:{if(t.left()<1)return l;const i=t.readU8();if(t.left()<i)return t.seek(t.left()),l;const r=t.readBytes(i);return new f(e,r)}case c.OP_PUSHDATA2:{if(t.left()<2)return t.seek(t.left()),l;const i=t.readU16();if(t.left()<i)return t.seek(t.left()),l;const r=t.readBytes(i);return new f(e,r)}case c.OP_PUSHDATA4:{if(t.left()<4)return t.seek(t.left()),l;const i=t.readU32();if(t.left()<i)return t.seek(t.left()),l;const r=t.readBytes(i);return new f(e,r)}default:{if(t.left()<e)return t.seek(t.left()),l;const i=t.readBytes(e);return new f(e,i)}}}static fromRaw(t){return f.fromReader(new a(t))}static isOpcode(t){return t instanceof f}}l=Object.freeze(new f(-1));for(let t=0;t<=255;t++){if(t>=1&&t<=78){u.push(null);continue}const e=new f(t);u.push(Object.freeze(e))}t.exports=f}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * murmur3.js - murmur3 hash for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(47).binding;function s(t,e){const i=t.length-t.length%4,r=3432918353,s=461845907;let h,c=e;for(let e=0;e<i;e+=4)c=o(n(c=a(c^=h=n(h=a(h=n(h=t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e],r),15),s),13),5),3864292196);switch(h=0,3&t.length){case 3:h^=t[i+2]<<16;case 2:h^=t[i+1]<<8;case 1:c^=h=n(h=a(h=n(h^=t[i+0],r),15),s)}return c^=t.length,c=n(c^=c>>>16,2246822507),c=n(c^=c>>>13,3266489909),(c^=c>>>16)<0&&(c+=4294967296),c}function n(t,e){const i=65535&t,r=65535&e;let s=i*r,n=(t>>>16)*r+(e>>>16)*i&65535,o=(n+=s>>>16)<<16|(s&=65535);return o<0&&(o+=4294967296),o}function o(t,e){let i=t+e&4294967295;return i<0&&(i+=4294967296),i}function a(t,e){return t<<e|t>>>32-e}r&&(s=r.murmur3),(e=s).murmur3=s,e.mul32=n,e.sum32=o,e.rotl32=a,t.exports=e},function(t,e,i){"use strict";(function(e){
/*!
 * ccmp.js - constant-time compare for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1);t.exports=function(t,i){if(r(e.isBuffer(t)),r(e.isBuffer(i)),0===i.length)return 0===t.length;let s=t.length^i.length;for(let e=0;e<t.length;e++)s|=t[e]^i[e%i.length];return 0===s}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * abstractblock.js - abstract block object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(1),s=i(3),n=i(9),o=i(2),a=i(6),h=i(39),c=i(4),u=i(10);t.exports=class{constructor(){this.version=1,this.prevBlock=c.NULL_HASH,this.merkleRoot=c.NULL_HASH,this.time=0,this.bits=0,this.nonce=0,this.mutable=!1,this._hash=null,this._hhash=null}parseOptions(t){return r(t,"Block data is required."),r(s.isU32(t.version)),r("string"==typeof t.prevBlock),r("string"==typeof t.merkleRoot),r(s.isU32(t.time)),r(s.isU32(t.bits)),r(s.isU32(t.nonce)),this.version=t.version,this.prevBlock=t.prevBlock,this.merkleRoot=t.merkleRoot,this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,null!=t.mutable&&(this.mutable=Boolean(t.mutable)),this}parseJSON(t){return r(t,"Block data is required."),r(s.isU32(t.version)),r("string"==typeof t.prevBlock),r("string"==typeof t.merkleRoot),r(s.isU32(t.time)),r(s.isU32(t.bits)),r(s.isU32(t.nonce)),this.version=t.version,this.prevBlock=s.revHex(t.prevBlock),this.merkleRoot=s.revHex(t.merkleRoot),this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,this}isMemory(){return!1}_refresh(){this._hash=null,this._hhash=null}refresh(){return this._refresh()}hash(t){let e=this._hash;if(e||(e=n.hash256(this.toHead()),this.mutable||(this._hash=e)),"hex"===t){let t=this._hhash;t||(t=e.toString("hex"),this.mutable||(this._hhash=t)),e=t}return e}toHead(){return this.writeHead(new a(80)).render()}fromHead(t){return this.readHead(new o(t))}writeHead(t){return t.writeU32(this.version),t.writeHash(this.prevBlock),t.writeHash(this.merkleRoot),t.writeU32(this.time),t.writeU32(this.bits),t.writeU32(this.nonce),t}readHead(t){return this.version=t.readU32(),this.prevBlock=t.readHash("hex"),this.merkleRoot=t.readHash("hex"),this.time=t.readU32(),this.bits=t.readU32(),this.nonce=t.readU32(),this}verify(){return!!this.verifyPOW()&&!!this.verifyBody()}verifyPOW(){return u.verifyPOW(this.hash(),this.bits)}verifyBody(){throw new Error("Abstract method.")}rhash(){return s.revHex(this.hash("hex"))}toInv(){return new h(h.types.BLOCK,this.hash("hex"))}}},function(t,e,i){"use strict";(function(e){
/*!
 * merkleblock.js - merkleblock object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(2),o=i(6),a=i(4),h=i(9),c=i(10),u=i(110),l=i(69),f=e.from([0]);class d extends u{constructor(t){super(),this.txs=[],this.hashes=[],this.flags=f,this.totalTX=0,this._tree=null,t&&this.fromOptions(t)}fromOptions(t){if(this.parseOptions(t),r(t,"MerkleBlock data is required."),r(Array.isArray(t.hashes)),r(e.isBuffer(t.flags)),r(s.isU32(t.totalTX)),t.hashes)for(let i of t.hashes)"string"==typeof i&&(i=e.from(i,"hex")),r(e.isBuffer(i)),this.hashes.push(i);return t.flags&&(r(e.isBuffer(t.flags)),this.flags=t.flags),null!=t.totalTX&&(r(s.isU32(t.totalTX)),this.totalTX=t.totalTX),this}static fromOptions(t){return(new d).fromOptions(t)}refresh(t){if(this._refresh(),this._tree=null,t)for(const t of this.txs)t.refresh()}hasTX(t){return-1!==this.indexOf(t)}indexOf(t){const e=this.getTree().map.get(t);return null==e?-1:e}verifyBody(){const[t]=this.checkBody();return t}checkBody(){return this.getTree().root!==this.merkleRoot?[!1,"bad-txnmrklroot",100]:[!0,"valid",0]}getTree(){if(!this._tree)try{this._tree=this.extractTree()}catch(t){this._tree=new p}return this._tree}extractTree(){const t=[],e=[],i=new Map,r=this.hashes,s=this.flags,n=this.totalTX;let o=0,u=0,l=!1,f=0;const d=t=>n+(1<<t)-1>>>t,g=(n,c)=>{if(o>=8*s.length)return l=!0,a.ZERO_HASH;const f=s[o/8|0]>>>o%8&1;if(o++,0===n||!f){if(u>=r.length)return l=!0,a.ZERO_HASH;const s=r[u++];if(0===n&&f){const r=s.toString("hex");t.push(s),e.push(c),i.set(r,c)}return s}const p=g(n-1,2*c);let m;return 2*c+1<d(n-1)?(m=g(n-1,2*c+1)).equals(p)&&(l=!0):m=p,h.root256(p,m)};if(0===n)throw new Error("Zero transactions.");if(n>c.MAX_BLOCK_SIZE/60)throw new Error("Too many transactions.");if(r.length>n)throw new Error("Too many hashes.");if(8*s.length<r.length)throw new Error("Flags too small.");for(;d(f)>1;)f++;const m=g(f,0);if(l)throw new Error("Mutated merkle tree.");if(((o+7)/8|0)!==s.length)throw new Error("Too many flag bits.");if(u!==r.length)throw new Error("Incorrect number of hashes.");return new p(m,t,e,i)}getCoinbaseHeight(){return-1}inspect(){return this.format()}format(t,e){return{hash:this.rhash(),height:null!=e?e:-1,date:s.date(this.time),version:s.hex32(this.version),prevBlock:s.revHex(this.prevBlock),merkleRoot:s.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce,totalTX:this.totalTX,hashes:this.hashes.map(t=>t.toString("hex")),flags:this.flags,map:this.getTree().map,txs:this.txs.length}}getSize(){let t=0;return t+=80,t+=4,t+=a.sizeVarint(this.hashes.length),t+=32*this.hashes.length,(t+=a.sizeVarint(this.flags.length))+this.flags.length}toWriter(t){this.writeHead(t),t.writeU32(this.totalTX),t.writeVarint(this.hashes.length);for(const e of this.hashes)t.writeHash(e);return t.writeVarBytes(this.flags),t}toRaw(){const t=this.getSize();return this.toWriter(new o(t)).render()}fromReader(t){this.readHead(t),this.totalTX=t.readU32();const e=t.readVarint();for(let i=0;i<e;i++)this.hashes.push(t.readHash());return this.flags=t.readVarBytes(),this}fromRaw(t){return this.fromReader(new n(t))}static fromReader(t){return(new d).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new d).fromRaw(t)}toJSON(){return this.getJSON()}getJSON(t,e,i){return{hash:this.rhash(),height:i,version:this.version,prevBlock:s.revHex(this.prevBlock),merkleRoot:s.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce,totalTX:this.totalTX,hashes:this.hashes.map(t=>s.revHex(t.toString("hex"))),flags:this.flags.toString("hex")}}fromJSON(t){r(t,"MerkleBlock data is required."),r(Array.isArray(t.hashes)),r("string"==typeof t.flags),r(s.isU32(t.totalTX)),this.parseJSON(t);for(let i of t.hashes)i=s.revHex(i),this.hashes.push(e.from(i,"hex"));return this.flags=e.from(t.flags,"hex"),this.totalTX=t.totalTX,this}static fromJSON(t){return(new d).fromJSON(t)}static fromBlock(t,e){const i=[];for(const r of t.txs)i.push(r.isWatched(e)?1:0);return d.fromMatches(t,i)}static fromHashes(t,i){const r=new Set;for(let t of i)e.isBuffer(t)&&(t=t.toString("hex")),r.add(t);const s=[];for(const e of t.txs){const t=e.hash("hex");s.push(r.has(t)?1:0)}return d.fromMatches(t,s)}static fromMatches(t,i){const r=[],s=[],n=[],o=[],a=t.txs.length;let c=0;const u=t=>a+(1<<t)-1>>>t,l=(t,e,i)=>{if(0===t)return i[e];const r=l(t-1,2*e,i);let s;return s=2*e+1<u(t-1)?l(t-1,2*e+1,i):r,h.root256(r,s)},f=(t,e,i,r)=>{let s=0;for(let i=e<<t;i<e+1<<t&&i<a;i++)s|=r[i];n.push(s),0!==t&&s?(f(t-1,2*e,i,r),2*e+1<u(t-1)&&f(t-1,2*e+1,i,r)):o.push(l(t,e,i))};for(let e=0;e<t.txs.length;e++){const n=t.txs[e];i[e]&&r.push(n),s.push(n.hash())}for(;u(c)>1;)c++;f(c,0,s,i);const p=e.allocUnsafe((n.length+7)/8|0);p.fill(0);for(let t=0;t<n.length;t++)p[t/8|0]|=n[t]<<t%8;const g=new d;return g._hash=t._hash,g._hhash=t._hhash,g.version=t.version,g.prevBlock=t.prevBlock,g.merkleRoot=t.merkleRoot,g.time=t.time,g.bits=t.bits,g.nonce=t.nonce,g.totalTX=a,g.hashes=o,g.flags=p,g.txs=r,g}static isMerkleBlock(t){return t instanceof d}toHeaders(){return l.fromBlock(this)}}function p(t,e,i,r){this.root=t?t.toString("hex"):a.NULL_HASH,this.matches=e||[],this.indexes=i||[],this.map=r||new Map}t.exports=d}).call(this,i(0).Buffer)},function(t,e){t.exports=class{constructor(t){this.endpoint=t}Get(t,e,i){}Post(t,e,i){}static pGetUrl(t,e){}static pPostUrl(t,e){}}},function(t,e,i){"use strict";
/*!
 * rpcbase.js - json rpc for gamegold.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(24),n=i(34),o=i(45),a=i(91),h=i(26),c=i(46),u=i(82),l=i(48);class f extends s{constructor(){super(),this.logger=o.global,this.calls=Object.create(null),this.mounts=[],this.locker=new n}async isReady(){return!0}async execute(t,e,i){"string"==typeof t&&(t={method:t}),t.params||(t.params=[]);const r=this.calls[t.method];if(r){if(this.$account=t.cid,!this.node||await this.isReady(i))return await r.call(this,t.params,e,i);throw new a(f.errors.METHOD_NOT_FOUND,`sync not ready: ${t.method}.`)}for(const r of this.mounts)if(r.calls[t.method])return await r.execute(t,e,i);throw new a(f.errors.METHOD_NOT_FOUND,`Method not found: ${t.method}.`)}async calles(t,e){let i=t,r=[],s=!0;Array.isArray(i)||(i=[i],s=!1);for(const t of i){if(!t||"object"!=typeof t){r.push({result:null,error:{type:"RPCError",message:"Invalid request.",code:f.errors.INVALID_REQUEST},id:null});continue}if(t.id&&"object"==typeof t.id){r.push({result:null,error:{type:"RPCError",message:"Invalid ID.",code:f.errors.INVALID_REQUEST},id:null});continue}if(t.id||(t.id=null),t.params||(t.params=[]),"string"!=typeof t.method){r.push({result:null,error:{type:"RPCError",message:"Method not found.",code:f.errors.METHOD_NOT_FOUND},id:t.id});continue}if(!Array.isArray(t.params)){r.push({result:null,error:{type:"RPCError",message:"Invalid params.",code:f.errors.INVALID_PARAMS},id:t.id});continue}let i;"getwork"!==t.method&&"block.template"!==t.method&&"block.best"!==t.method&&(this.logger.debug("Handling RPC call: %s.",t.method),"block.submit"!==t.method&&"getmemorypool"!==t.method&&this.logger.debug(t.params));try{i=await this.execute(t,!1,e)}catch(e){let i;switch(e.type){case"RPCError":i=e.code;break;case"ValidationError":i=f.errors.TYPE_ERROR;break;case"EncodingError":i=f.errors.DESERIALIZATION_ERROR;break;case"FundingError":i=f.errors.WALLET_INSUFFICIENT_FUNDS;break;default:i=f.errors.INTERNAL_ERROR,this.logger.error("RPC internal error."),this.logger.error(e)}r.push({result:null,error:{type:e.type,message:e.message,code:i},id:t.id});continue}void 0===i&&(i=null),r.push({result:i,error:null,id:t.id})}return s||(r=r[0]),r}add(t,e){try{r("function"==typeof e,"Handler must be a function."),Array.isArray(t)?t.map(t=>this.add(t,e)):(r(!this.calls[t],"Duplicate RPC call."),this.calls[t]=e)}catch(t){console.error(t)}}mount(t){r(t,"RPC must be an object."),r("function"==typeof t.execute,"Execute must be a method."),this.mounts.push(t)}static parseAddress(t,e){try{return h.fromString(t,e)}catch(t){throw new a(f.errors.INVALID_ADDRESS_OR_KEY,"Invalid address.")}}static parseSecret(t,e){try{return c.fromSecret(t,e)}catch(t){throw new a(f.errors.INVALID_ADDRESS_OR_KEY,"Invalid key.")}}static parseHash(t,e){return f.parseAddress(t,e).getHash("hex")}static parseNetAddress(t,e){try{return u.fromHostname(t,e)}catch(t){throw new a(f.errors.CLIENT_INVALID_IP_OR_SUBNET,"Invalid IP address or subnet.")}}static parseIP(t,e){try{return l.fromHostname(t,e.port)}catch(t){throw new a(errs.CLIENT_INVALID_IP_OR_SUBNET,"Invalid IP address or subnet.")}}}f.errors={INVALID_REQUEST:-32600,METHOD_NOT_FOUND:-32601,INVALID_PARAMS:-32602,INTERNAL_ERROR:-32603,PARSE_ERROR:-32700,MISC_ERROR:-1,FORBIDDEN_BY_SAFE_MODE:-2,TYPE_ERROR:-3,INVALID_ADDRESS_OR_KEY:-5,OUT_OF_MEMORY:-7,INVALID_PARAMETER:-8,DATABASE_ERROR:-20,DESERIALIZATION_ERROR:-22,VERIFY_ERROR:-25,VERIFY_REJECTED:-26,VERIFY_ALREADY_IN_CHAIN:-27,IN_WARMUP:-28,TRANSACTION_ERROR:-25,TRANSACTION_REJECTED:-26,TRANSACTION_ALREADY_IN_CHAIN:-27,CLIENT_NOT_CONNECTED:-9,CLIENT_IN_INITIAL_DOWNLOAD:-10,CLIENT_NODE_ALREADY_ADDED:-23,CLIENT_NODE_NOT_ADDED:-24,CLIENT_NODE_NOT_CONNECTED:-29,CLIENT_INVALID_IP_OR_SUBNET:-30,CLIENT_P2P_DISABLED:-31,WALLET_ERROR:-4,WALLET_INSUFFICIENT_FUNDS:-6,WALLET_INVALID_ACCOUNT_NAME:-11,WALLET_KEYPOOL_RAN_OUT:-12,WALLET_UNLOCK_NEEDED:-13,WALLET_PASSPHRASE_INCORRECT:-14,WALLET_WRONG_ENC_STATE:-15,WALLET_ENCRYPTION_FAILED:-16,WALLET_ALREADY_UNLOCKED:-17,PROP_MINVALUE:-1001},f.MAGIC_STRING="Gamegold Signed Message:\n",t.exports=f},function(t,e,i){"use strict";
/*!
 * pkg.js - package constants
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.version="v1.2.18",e.url="https://gitee.com/bookmanSoftware/ggserver"},function(t,e){e.endianness=function(){return"LE"},e.hostname=function(){return"undefined"!=typeof location?location.hostname:""},e.loadavg=function(){return[]},e.uptime=function(){return 0},e.freemem=function(){return Number.MAX_VALUE},e.totalmem=function(){return Number.MAX_VALUE},e.cpus=function(){return[]},e.type=function(){return"Browser"},e.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},e.networkInterfaces=e.getNetworkInterfaces=function(){return{}},e.arch=function(){return"javascript"},e.platform=function(){return"browser"},e.tmpdir=e.tmpDir=function(){return"/tmp"},e.EOL="\n",e.homedir=function(){return"/"}},function(t,e,i){"use strict";(function(e,r){
/*!
 * workerpool.js - worker processes for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const s=i(1),n=i(24),o=i(115),a=i(3),h=i(35),c=i(16),u=i(334),l=i(72),f=i(118),d=i(119),p=i(73),{contractStatus:g}=i(8);class m{constructor(t,e,i,r){this.worker=t,this.id=e,this.job=h.job(i,r),this.timer=null}start(t){!t||t<=0||(this.timer=setTimeout(()=>{this.reject(new Error("Worker timed out."))},t))}destroy(){this.reject(new Error("Job was destroyed."))}cleanup(){const t=this.job;return s(t,"Already finished."),this.job=null,null!=this.timer&&(clearTimeout(this.timer),this.timer=null),s(this.worker.pending.has(this.id)),this.worker.pending.delete(this.id),t}resolve(t){this.cleanup().resolve(t)}reject(t){this.cleanup().reject(t)}}t.exports=class extends n{constructor(t){super(),this.enabled=!1,this.size=Math.max(2,o.cpus().length),this.timeout=12e4,this.file="./gamegold-worker.js",this.children=new Map,this.uid=0,this.set(t)}set(t){t&&(null!=t.enabled&&(s("boolean"==typeof t.enabled),this.enabled=t.enabled),null!=t.size&&(s(a.isU32(t.size)),s(t.size>0),this.size=t.size),null!=t.timeout&&(s(a.isInt(t.timeout)),s(t.timeout>=-1),this.timeout=t.timeout),null!=t.file&&(s("string"==typeof t.file),this.file=t.file))}async open(){}async close(){this.destroy()}spawn(t){const e=new class extends n{constructor(t){super(),this.id=-1,this.framer=new d,this.parser=new f,this.pending=new Map,this.child=new u(t),this.init()}init(){this.child.on("data",t=>{this.parser.feed(t)}),this.child.on("exit",(t,e)=>{this.emit("exit",t,e)}),this.child.on("error",t=>{this.emit("error",t)}),this.parser.on("error",t=>{this.emit("error",t)}),this.parser.on("packet",t=>{this.emit("packet",t)}),this.listen()}listen(){this.on("exit",(t,e)=>{this.killJobs()}),this.on("error",t=>{this.killJobs()}),this.on("packet",t=>{try{t.workerHandle(this)}catch(t){this.emit("error",t)}}),this.sendEnv({GAMEGOLD_WORKER_NETWORK:c.type,GAMEGOLD_WORKER_ISTTY:r.stdout&&r.stdout.isTTY?"1":"0"})}write(t){return this.child.write(t)}send(t){return this.write(this.framer.packet(t))}sendEnv(t){return this.send(new p.EnvPacket(t))}sendEvent(...t){return this.send(new p.EventPacket(t))}destroy(){return this.child.destroy()}execute(t,e){return new Promise((i,r)=>{this._execute(t,e,i,r)})}_execute(t,e,i,r){const n=new m(this,t.id,i,r);s(!this.pending.has(t.id),"ID overflow."),this.pending.set(t.id,n),n.start(e),this.send(t)}resolveJob(t,e){const i=this.pending.get(t);if(!i)throw new Error(`Job ${t} is not in progress.`);i.resolve(e)}rejectJob(t,e){const i=this.pending.get(t);if(!i)throw new Error(`Job ${t} is not in progress.`);i.reject(e)}killJobs(){for(const t of this.pending.values())t.destroy()}}(this.file);return e.id=t,e.on("error",t=>{this.emit("error",t,e)}),e.on("exit",i=>{this.emit("exit",i,e),this.children.get(t)===e&&this.children.delete(t)}),e.on("event",t=>{this.emit("event",t,e),this.emit(...t)}),e.on("log",t=>{this.emit("log",t,e)}),this.emit("spawn",e),e}alloc(){const t=this.uid++%this.size;return this.children.has(t)||this.children.set(t,this.spawn(t)),this.children.get(t)}sendEvent(){let t=!0;for(const e of this.children.values())e.sendEvent.apply(e,arguments)||(t=!1);return t}destroy(){for(const t of this.children.values())t.destroy()}execute(t,i){return this.enabled&&u.hasSupport()?(i||(i=this.timeout),this.alloc().execute(t,i)):new Promise((i,r)=>{e(()=>{let e;try{e=l.handle(t)}catch(t){return void r(t)}i(e)})})}async check(t,e,i,r){const s=new p.CheckPacket(t,e,i,r),n=await this.execute(s,-1);if(n.error)throw n.error;return null}async sign(t,e,i,r){let s=e;Array.isArray(s)||(s=[s]);const n=new p.SignPacket(t,s,i,r),o=await this.execute(n,-1);return o.inject(t),o.total}async checkInput(t,e,i,r,s){const n=new p.CheckInputPacket(t,e,i,r,s),o=await this.execute(n,-1);if(o.error)throw o.error;return null}async signInput(t,e,i,r,s){const n=new p.SignInputPacket(t,e,i,r,s),o=await this.execute(n,-1);return o.inject(t),o.value}async ecVerify(t,e,i){const r=new p.ECVerifyPacket(t,e,i);return(await this.execute(r,-1)).value}async ecSign(t,e){const i=new p.ECSignPacket(t,e);return(await this.execute(i,-1)).sig}async mine(t,e,i,r){const s=new p.MinePacket(t,e,i,r);return(await this.execute(s,-1)).nonce}async scrypt(t,e,i,r,s,n){const o=new p.ScryptPacket(t,e,i,r,s,n);return(await this.execute(o,-1)).key}}}).call(this,i(81).setImmediate,i(23))},function(t,e,i){"use strict";(function(t,r){
/*!
 * pbkdf2.js - pbkdf2 for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const s=i(9),n=(t.crypto||t.msCrypto||{}).subtle||{};e.derive=function(t,e,i,n,o){const a=s.hash(o,r.alloc(0)).length,h=Math.ceil(n/a),c=r.allocUnsafe(n),u=r.allocUnsafe(e.length+4),l=r.allocUnsafe(a);let f=0;e.copy(u,0);for(let r=0;r<h;r++){u.writeUInt32BE(r+1,e.length,!0);let n=s.hmac(o,u,t);n.copy(l,0);for(let e=1;e<i;e++){n=s.hmac(o,n,t);for(let t=0;t<a;t++)l[t]^=n[t]}l.copy(c,f),f+=a}return c},e.deriveAsync=async function(t,i,s,o,a){if(!n.importKey||!n.deriveBits)return e.derive(t,i,s,o,a);const h={name:"PBKDF2",salt:i,iterations:s,hash:function(t){switch(t){case"sha1":return"SHA-1";case"sha256":return"SHA-256";case"sha384":return"SHA-384";case"sha512":return"SHA-512";default:throw new Error(`Algorithm not supported: ${t}.`)}}(a)},c=await n.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits"]),u=await n.deriveBits(h,c,8*o);return r.from(u)}}).call(this,i(12),i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * Parser.js - worker parser
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(24),n=i(73);t.exports=class extends s{constructor(){super(),this.waiting=9,this.header=null,this.pending=[],this.total=0}feed(t){if(t&&"number"==typeof t.length)for(this.total+=t.length,this.pending.push(t);this.total>=this.waiting;){const t=this.read(this.waiting);this.parse(t)}}read(t){if(r(this.total>=t,"Reading too much."),0===t)return e.alloc(0);const i=this.pending[0];if(i.length>t){const e=i.slice(0,t);return this.pending[0]=i.slice(t),this.total-=e.length,e}if(i.length===t){const t=this.pending.shift();return this.total-=t.length,t}const s=e.allocUnsafe(t);let n=0;for(;n<s.length;){const t=this.pending[0],e=t.copy(s,n);e===t.length?this.pending.shift():this.pending[0]=t.slice(e),n+=e}return r.strictEqual(n,s.length),this.total-=s.length,s}parse(t){let e,i=this.header;if(!i){try{i=this.parseHeader(t)}catch(t){return void this.emit("error",t)}return this.header=i,void(this.waiting=i.size+1)}this.waiting=9,this.header=null;try{e=n.parsePacket(i,t)}catch(t){return void this.emit("error",t)}10===t[t.length-1]?(e.id=i.id,this.emit("packet",e)):this.emit("error",new Error("No trailing newline."))}parseHeader(t){return new function(t,e,i){this.id=t,this.cmd=e,this.size=i}(t.readUInt32LE(0,!0),t.readUInt8(4,!0),t.readUInt32LE(5,!0))}}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * framer.js - workers framer
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(6);function s(){if(!(this instanceof s))return new s}s.prototype.packet=function(t){const e=10+t.getSize(),i=new r(e);i.writeU32(t.id),i.writeU8(t.cmd),i.seek(4),t.toWriter(i),i.writeU8(10);const s=i.render();return s.writeUInt32LE(s.length-10,5,!0),s},t.exports=s},function(t,e,i){"use strict";
/*!
 * cleanse.js - memzero for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(47).binding;let s=0;t.exports=function(t){let e=s;for(let i=0;i<t.length;i++)t[i]=255&e,e+=i;s=e>>>0},r&&(e.cleanse=r.cleanse)},function(t,e,i){"use strict";
/*!
 * layout-browser.js - walletdb and txdb layout for browser.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(3).pad32,n=e;n.walletdb={binary:!1,p:function(t){return r("string"==typeof t),"p"+t},V:"V",CV:"CV",version:function(t){return s(t)},equalVersion:function(t,e){return t.toString()==s(e)},pp:function(t){return r("string"==typeof t),t.slice(1)},P:function(t,e){return r("string"==typeof e),"p"+s(t)+e},Pp:function(t){return r("string"==typeof t),t.slice(11)},r:function(t,e,i){return r("string"==typeof i),"r"+s(t)+s(e)+i},rr:function(t){return r("string"==typeof t),t.slice(21)},w:function(t){return"w"+s(t)},ww:function(t){return r("string"==typeof t),parseInt(t.slice(1),10)},l:function(t){return r("string"==typeof t),"l"+t},ll:function(t){return r("string"==typeof t),t.slice(1)},a:function(t,e){return"a"+s(t)+s(e)},i:function(t,e){return r("number"==typeof t),r("string"==typeof e),"i"+s(t)+e},ii:function(t){return r("string"==typeof t),[parseInt(t.slice(1,11),10),t.slice(11)]},n:function(t,e){return"n"+s(t)+s(e)},R:"R",h:function(t){return"h"+s(t)},b:function(t){return"b"+s(t)},bb:function(t){return r("string"==typeof t),parseInt(t.slice(1),10)},g:function(t){return"g"+s(t)},gg:function(t){return r("string"==typeof t),parseInt(t.slice(1),10)},o:function(t,e){return r("string"==typeof t),"o"+t+s(e)},oo:function(t){return[t.slice(1,65),parseInt(t.slice(65),10)]}},n.txdb={binary:!1,prefix:function(t,e){return r("string"==typeof e),"t"+s(t)+e},pre:function(t){return r("string"==typeof t),parseInt(t.slice(1,11),10)},R:"R",hi:function(t,e,i){return r("string"==typeof e),t+e+s(i)},hii:function(t){return r("string"==typeof t),[(t=t.slice(12)).slice(0,64),parseInt(t.slice(64),10)]},ih:function(t,e,i){return r("string"==typeof i),t+s(e)+i},ihh:function(t){return r("string"==typeof t),t=t.slice(12),[parseInt(t.slice(0,10),10),t.slice(10)]},iih:function(t,e,i,n){return r("string"==typeof n),t+s(e)+s(i)+n},iihh:function(t){return r("string"==typeof t),t=t.slice(12),[parseInt(t.slice(0,10),10),parseInt(t.slice(10,20),10),t.slice(20)]},ihi:function(t,e,i,n){return r("string"==typeof i),t+s(e)+i+s(n)},ihii:function(t){return r("string"==typeof t),t=t.slice(12),[parseInt(t.slice(0,10),10),t.slice(10,74),parseInt(t.slice(74),10)]},ha:function(t,e){return r("string"==typeof e),t+e},haa:function(t){return r("string"==typeof t),t.slice(12)},C:function(t,e,i){return this.ihi("C",t,e,i)},Cc:function(t){return this.ihii(t)},H:function(t,e,i){return this.iih("H",t,e,i)},Hh:function(t){return this.iihh(t)},S:function(t,e){return this.hi("S",t,e)},Ss:function(t){return this.hii(t)},T:function(t,e){return this.ih("T",t,e)},Tt:function(t){return this.ihh(t)},M:function(t,e,i){return this.iih("M",t,e,i)},Mm:function(t){return this.iihh(t)},P:function(t,e){return this.ih("P",t,e)},Pp:function(t){return this.ihh(t)},b:function(t){return"b"+s(t)},bb:function(t){return r("string"==typeof t),t=t.slice(12),parseInt(t.slice(0),10)},c:function(t,e){return this.hi("c",t,e)},cc:function(t){return this.hii(t)},cp:function(t){return"cp"+t},cpp:function(t){return r("string"==typeof t),r(38===t.length),t.slice(2)},d:function(t,e){return this.hi("d",t,e)},dd:function(t){return this.hii(t)},h:function(t,e){return this.ih("h",t,e)},hh:function(t){return this.ihh(t)},m:function(t,e){return this.ih("m",t,e)},mm:function(t){return this.ihh(t)},p:function(t){return this.ha("p",t)},pp:function(t){return this.haa(t)},r:function(t){return this.ha("r",t)},s:function(t,e){return this.hi("s",t,e)},ss:function(t){return this.hii(t)},t:function(t){return this.ha("t",t)},tt:function(t){return this.haa(t)},tx:function(t){return"tx"+t},v:function(t){return"v"+t},vv:function(t){return r("string"==typeof t),r(37===t.length),t.slice(1)}}},function(t,e,i){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var s=0;s<r.length;s++)if((i=r[s])===e||i.fn===e){r.splice(s,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i)for(var r=0,s=(i=i.slice(0)).length;r<s;++r)i[r].apply(this,e);return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,i){(function(t){var r,s=i(539),n=i(422),o=i(541),a=i(542),h=i(543);t&&t.ArrayBuffer&&(r=i(544));var c="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),u="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=c||u;e.protocol=3;var f=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=s(f),p={type:"error",data:"parser error"},g=i(545);function m(t,e,i){for(var r=new Array(t.length),s=a(t.length,i),n=function(t,i,s){e(i,function(e,i){r[t]=i,s(e,r)})},o=0;o<t.length;o++)n(o,t[o],s)}e.encodePacket=function(i,r,s,n){"function"==typeof r&&(n=r,r=!1),"function"==typeof s&&(n=s,s=null);var o=void 0===i.data?void 0:i.data.buffer||i.data;if(t.ArrayBuffer&&o instanceof ArrayBuffer)return function(t,i,r){if(!i)return e.encodeBase64Packet(t,r);var s=t.data,n=new Uint8Array(s),o=new Uint8Array(1+s.byteLength);o[0]=f[t.type];for(var a=0;a<n.length;a++)o[a+1]=n[a];return r(o.buffer)}(i,r,n);if(g&&o instanceof t.Blob)return function(t,i,r){if(!i)return e.encodeBase64Packet(t,r);if(l)return function(t,i,r){if(!i)return e.encodeBase64Packet(t,r);var s=new FileReader;return s.onload=function(){t.data=s.result,e.encodePacket(t,i,!0,r)},s.readAsArrayBuffer(t.data)}(t,i,r);var s=new Uint8Array(1);return s[0]=f[t.type],r(new g([s.buffer,t.data]))}(i,r,n);if(o&&o.base64)return function(t,i){return n("b"+e.packets[t.type]+t.data.data)}(i);var a=f[i.type];return void 0!==i.data&&(a+=s?h.encode(String(i.data),{strict:!1}):String(i.data)),n(""+a)},e.encodeBase64Packet=function(i,r){var s,n="b"+e.packets[i.type];if(g&&i.data instanceof t.Blob){var o=new FileReader;return o.onload=function(){var t=o.result.split(",")[1];r(n+t)},o.readAsDataURL(i.data)}try{s=String.fromCharCode.apply(null,new Uint8Array(i.data))}catch(t){for(var a=new Uint8Array(i.data),h=new Array(a.length),c=0;c<a.length;c++)h[c]=a[c];s=String.fromCharCode.apply(null,h)}return n+=t.btoa(s),r(n)},e.decodePacket=function(t,i,r){if(void 0===t)return p;if("string"==typeof t){if("b"===t.charAt(0))return e.decodeBase64Packet(t.substr(1),i);if(r&&!1===(t=function(t){try{t=h.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return p;var s=t.charAt(0);return Number(s)==s&&d[s]?t.length>1?{type:d[s],data:t.substring(1)}:{type:d[s]}:p}s=new Uint8Array(t)[0];var n=o(t,1);return g&&"blob"===i&&(n=new g([n])),{type:d[s],data:n}},e.decodeBase64Packet=function(t,e){var i=d[t.charAt(0)];if(!r)return{type:i,data:{base64:!0,data:t.substr(1)}};var s=r.decode(t.substr(1));return"blob"===e&&g&&(s=new g([s])),{type:i,data:s}},e.encodePayload=function(t,i,r){"function"==typeof i&&(r=i,i=null);var s=n(t);return i&&s?g&&!l?e.encodePayloadAsBlob(t,r):e.encodePayloadAsArrayBuffer(t,r):t.length?void m(t,function(t,r){e.encodePacket(t,!!s&&i,!1,function(t){r(null,function(t){return t.length+":"+t}(t))})},function(t,e){return r(e.join(""))}):r("0:")},e.decodePayload=function(t,i,r){if("string"!=typeof t)return e.decodePayloadAsBinary(t,i,r);var s;if("function"==typeof i&&(r=i,i=null),""===t)return r(p,0,1);for(var n,o,a="",h=0,c=t.length;h<c;h++){var u=t.charAt(h);if(":"===u){if(""===a||a!=(n=Number(a)))return r(p,0,1);if(a!=(o=t.substr(h+1,n)).length)return r(p,0,1);if(o.length){if(s=e.decodePacket(o,i,!1),p.type===s.type&&p.data===s.data)return r(p,0,1);if(!1===r(s,h+n,c))return}h+=n,a=""}else a+=u}return""!==a?r(p,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,i){if(!t.length)return i(new ArrayBuffer(0));m(t,function(t,i){e.encodePacket(t,!0,!0,function(t){return i(null,t)})},function(t,e){var r=e.reduce(function(t,e){var i;return t+(i="string"==typeof e?e.length:e.byteLength).toString().length+i+2},0),s=new Uint8Array(r),n=0;return e.forEach(function(t){var e="string"==typeof t,i=t;if(e){for(var r=new Uint8Array(t.length),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);i=r.buffer}s[n++]=e?0:1;var a=i.byteLength.toString();for(o=0;o<a.length;o++)s[n++]=parseInt(a[o]);for(s[n++]=255,r=new Uint8Array(i),o=0;o<r.length;o++)s[n++]=r[o]}),i(s.buffer)})},e.encodePayloadAsBlob=function(t,i){m(t,function(t,i){e.encodePacket(t,!0,!0,function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var r=new Uint8Array(t.length),s=0;s<t.length;s++)r[s]=t.charCodeAt(s);t=r.buffer,e[0]=0}var n=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),o=new Uint8Array(n.length+1);for(s=0;s<n.length;s++)o[s]=parseInt(n[s]);if(o[n.length]=255,g){var a=new g([e.buffer,o.buffer,t]);i(null,a)}})},function(t,e){return i(new g(e))})},e.decodePayloadAsBinary=function(t,i,r){"function"==typeof i&&(r=i,i=null);for(var s=t,n=[];s.byteLength>0;){for(var a=new Uint8Array(s),h=0===a[0],c="",u=1;255!==a[u];u++){if(c.length>310)return r(p,0,1);c+=a[u]}s=o(s,2+c.length),c=parseInt(c);var l=o(s,0,c);if(h)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(t){var f=new Uint8Array(l);for(l="",u=0;u<f.length;u++)l+=String.fromCharCode(f[u])}n.push(l),s=o(s,c)}var d=n.length;n.forEach(function(t,s){r(e.decodePacket(t,i,!0),s,d)})}}).call(this,i(12))},function(t,e,i){"use strict";
/*!
 * path.js - path object for wallets
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(2),n=i(6),o=i(4),a=i(26);class h{constructor(t){this.keyType=h.types.HD,this.id=null,this.wid=-1,this.name=null,this.account=0,this.branch=-1,this.index=-1,this.encrypted=!1,this.data=null,this.type=a.types.PUBKEYHASH,this.version=-1,this.hash=null,t&&this.fromOptions(t)}fromOptions(t){return this.keyType=t.keyType,this.id=t.id,this.wid=t.wid,this.name=t.name,this.account=t.account,this.branch=t.branch,this.index=t.index,this.encrypted=t.encrypted,this.data=t.data,this.type=t.type,this.version=t.version,this.hash=t.hash,this}static fromOptions(t){return(new h).fromOptions(t)}clone(){const t=new h;return t.keyType=this.keyType,t.id=this.id,t.wid=this.wid,t.name=this.name,t.account=this.account,t.branch=this.branch,t.index=this.index,t.encrypted=this.encrypted,t.data=this.data,t.type=this.type,t.version=this.version,t.hash=this.hash,t}fromRaw(t){const e=new s(t);switch(this.account=e.readU32(),this.keyType=e.readU8(),this.keyType){case h.types.HD:this.branch=e.readU32(),this.index=e.readU32();break;case h.types.KEY:this.encrypted=1===e.readU8(),this.data=e.readVarBytes();break;case h.types.ADDRESS:break;default:r(!1)}return this.version=e.readI8(),this.type=e.readU8(),129!==this.type&&130!==this.type||(this.type=4),this}static fromRaw(t){return(new h).fromRaw(t)}getSize(){let t=0;switch(t+=5,this.keyType){case h.types.HD:t+=8;break;case h.types.KEY:t+=1,t+=o.sizeVarBytes(this.data)}return t+2}toRaw(){const t=this.getSize(),e=new n(t);switch(e.writeU32(this.account),e.writeU8(this.keyType),this.keyType){case h.types.HD:r(!this.data),r(-1!==this.index),e.writeU32(this.branch),e.writeU32(this.index);break;case h.types.KEY:r(this.data),r(-1===this.index),e.writeU8(this.encrypted?1:0),e.writeVarBytes(this.data);break;case h.types.ADDRESS:r(!this.data),r(-1===this.index);break;default:r(!1)}return e.writeI8(this.version),e.writeU8(this.type),e.render()}fromAddress(t,e){return this.keyType=h.types.ADDRESS,this.id=t.id,this.wid=t.wid,this.name=t.name,this.account=t.accountIndex,this.version=e.version,this.type=e.type,this.hash=e.getHash("hex"),this}static fromAddress(t,e){return(new h).fromAddress(t,e)}toPath(){return this.keyType!==h.types.HD?null:`m/${this.account}'/${this.branch}/${this.index}`}toAddress(t){return a.fromHash(this.hash,this.type,this.version,t)}toJSON(){return{name:this.name,account:this.account,change:1===this.branch,derivation:this.toPath()}}inspect(){return`<Path: ${this.id}(${this.wid})/${this.name}:${this.toPath()}>`}}h.types={HD:0,KEY:1,ADDRESS:2},t.exports=h},function(t,e,i){const r=i(1);e.NONCE_SIZE=4,e.SHARES_PER_MINUTE=8,e.ACTIVE_TIME=60,e.BAN_SCORE=1e3,e.MAX_JOBS=6,e.BAN_TIME=600,e.isJob=function(t){return"string"==typeof t&&t.length>=12&&t.length<=21},e.isSID=function(t){return"string"==typeof t&&8===t.length&&e.isHex(t)},e.isUsername=function(t){return"string"==typeof t&&t.length>0&&t.length<=100},e.isPassword=function(t){return"string"==typeof t&&t.length>0&&t.length<=255},e.isAgent=function(t){return"string"==typeof t&&t.length>0&&t.length<=255},e.isHex=function(t){return"string"==typeof t&&t.length%2==0&&/^[0-9a-f]+$/i.test(t)},e.hex32=function(t){switch(r(t>>>0===t),(t=t.toString(16)).length){case 1:return`0000000${t}`;case 2:return`000000${t}`;case 3:return`00000${t}`;case 4:return`0000${t}`;case 5:return`000${t}`;case 6:return`00${t}`;case 7:return`0${t}`;case 8:return`${t}`;default:throw new Error}}},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e,i){"use strict";
/*!
 * protoreader.js - protobufs for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(2);function n(t,e){if(!(this instanceof n))return new n(t,e);s.call(this,t,e)}Object.setPrototypeOf(n.prototype,s.prototype),n.prototype.readVarint=function(){const{size:t,value:e}=function(t,e){let i=0,s=128,n=0;for(;128&s;){if(e>=t.length){i=0;break}switch(s=t[e++],n){case 0:case 1:case 2:case 3:i+=(127&s)<<7*n;break;case 4:i+=(127&s)*(1<<7*n);break;default:i+=(127&s)*Math.pow(2,7*n)}r(++n<7,"Number exceeds 2^53-1.")}return new function(t,e){this.size=t,this.value=e}(n,i)}(this.data,this.offset);return this.offset+=t,e},n.prototype.readFieldValue=function(t,e){const i=this.readField(t,e);return i?(r(null!=i.value),i.value):-1},n.prototype.readFieldU64=function(t,e){const i=this.readField(t,e);return i?(r(0===i.type||1===i.type),i.value):-1},n.prototype.readFieldU32=function(t,e){const i=this.readField(t,e);return i?(r(0===i.type||5===i.type),i.value):-1},n.prototype.readFieldBytes=function(t,e){const i=this.readField(t,e);return i?(r(i.data),i.data):null},n.prototype.readFieldString=function(t,e,i){const s=this.readField(t,e);return s?(r(s.data),s.data.toString(i||"utf8")):null},n.prototype.nextTag=function(){if(0===this.left())return-1;const t=this.readField();return this.seek(-t.size),t.tag},n.prototype.readField=function(t,e){const i=this.offset,s=new function(t){this.tag=t>>>3,this.type=7&t,this.size=0,this.value=0,this.data=null,this.group=null}(this.readVarint());if(null!=t&&s.tag!==t)return r(e,"Non-optional field not present."),this.offset=i,null;switch(s.type){case 0:s.value=this.readVarint();break;case 1:s.value=this.readU64();break;case 2:s.data=this.readVarBytes();break;case 3:for(s.group=[];;){const t=this.readField();if(4===t.type)break;s.group.push(t)}break;case 4:r(!1,"Unexpected end group.");break;case 5:s.value=this.readU32();break;default:r(!1,"Bad wire type.")}return s.size=this.offset-i,s},t.exports=n},function(t,e,i){"use strict";var r=i(32).rotr32;function s(t,e,i){return t&e^~t&i}function n(t,e,i){return t&e^t&i^e&i}function o(t,e,i){return t^e^i}e.ft_1=function(t,e,i,r){return 0===t?s(e,i,r):1===t||3===t?o(e,i,r):2===t?n(e,i,r):void 0},e.ch32=s,e.maj32=n,e.p32=o,e.s0_256=function(t){return r(t,2)^r(t,13)^r(t,22)},e.s1_256=function(t){return r(t,6)^r(t,11)^r(t,25)},e.g0_256=function(t){return r(t,7)^r(t,18)^t>>>3},e.g1_256=function(t){return r(t,17)^r(t,19)^t>>>10}},function(t,e,i){"use strict";var r=i(32),s=i(55),n=i(128),o=i(54),a=r.sum32,h=r.sum32_4,c=r.sum32_5,u=n.ch32,l=n.maj32,f=n.s0_256,d=n.s1_256,p=n.g0_256,g=n.g1_256,m=s.BlockHash,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function y(){if(!(this instanceof y))return new y;m.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=w,this.W=new Array(64)}r.inherits(y,m),t.exports=y,y.blockSize=512,y.outSize=256,y.hmacStrength=192,y.padLength=64,y.prototype._update=function(t,e){for(var i=this.W,r=0;r<16;r++)i[r]=t[e+r];for(;r<i.length;r++)i[r]=h(g(i[r-2]),i[r-7],p(i[r-15]),i[r-16]);var s=this.h[0],n=this.h[1],m=this.h[2],w=this.h[3],y=this.h[4],b=this.h[5],v=this.h[6],k=this.h[7];for(o(this.k.length===i.length),r=0;r<i.length;r++){var S=c(k,d(y),u(y,b,v),this.k[r],i[r]),x=a(f(s),l(s,n,m));k=v,v=b,b=y,y=a(w,S),w=m,m=n,n=s,s=a(S,x)}this.h[0]=a(this.h[0],s),this.h[1]=a(this.h[1],n),this.h[2]=a(this.h[2],m),this.h[3]=a(this.h[3],w),this.h[4]=a(this.h[4],y),this.h[5]=a(this.h[5],b),this.h[6]=a(this.h[6],v),this.h[7]=a(this.h[7],k)},y.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(t,e,i){"use strict";var r=i(32),s=i(55),n=i(54),o=r.rotr64_hi,a=r.rotr64_lo,h=r.shr64_hi,c=r.shr64_lo,u=r.sum64,l=r.sum64_hi,f=r.sum64_lo,d=r.sum64_4_hi,p=r.sum64_4_lo,g=r.sum64_5_hi,m=r.sum64_5_lo,w=s.BlockHash,y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function b(){if(!(this instanceof b))return new b;w.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=y,this.W=new Array(160)}function v(t,e,i,r,s){var n=t&i^~t&s;return n<0&&(n+=4294967296),n}function k(t,e,i,r,s,n){var o=e&r^~e&n;return o<0&&(o+=4294967296),o}function S(t,e,i,r,s){var n=t&i^t&s^i&s;return n<0&&(n+=4294967296),n}function x(t,e,i,r,s,n){var o=e&r^e&n^r&n;return o<0&&(o+=4294967296),o}function E(t,e){var i=o(t,e,28)^o(e,t,2)^o(e,t,7);return i<0&&(i+=4294967296),i}function R(t,e){var i=a(t,e,28)^a(e,t,2)^a(e,t,7);return i<0&&(i+=4294967296),i}function _(t,e){var i=o(t,e,14)^o(t,e,18)^o(e,t,9);return i<0&&(i+=4294967296),i}function A(t,e){var i=a(t,e,14)^a(t,e,18)^a(e,t,9);return i<0&&(i+=4294967296),i}function I(t,e){var i=o(t,e,1)^o(t,e,8)^h(t,e,7);return i<0&&(i+=4294967296),i}function O(t,e){var i=a(t,e,1)^a(t,e,8)^c(t,e,7);return i<0&&(i+=4294967296),i}function C(t,e){var i=o(t,e,19)^o(e,t,29)^h(t,e,6);return i<0&&(i+=4294967296),i}function P(t,e){var i=a(t,e,19)^a(e,t,29)^c(t,e,6);return i<0&&(i+=4294967296),i}r.inherits(b,w),t.exports=b,b.blockSize=1024,b.outSize=512,b.hmacStrength=192,b.padLength=128,b.prototype._prepareBlock=function(t,e){for(var i=this.W,r=0;r<32;r++)i[r]=t[e+r];for(;r<i.length;r+=2){var s=C(i[r-4],i[r-3]),n=P(i[r-4],i[r-3]),o=i[r-14],a=i[r-13],h=I(i[r-30],i[r-29]),c=O(i[r-30],i[r-29]),u=i[r-32],l=i[r-31];i[r]=d(s,n,o,a,h,c,u,l),i[r+1]=p(s,n,o,a,h,c,u,l)}},b.prototype._update=function(t,e){this._prepareBlock(t,e);var i=this.W,r=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],h=this.h[4],c=this.h[5],d=this.h[6],p=this.h[7],w=this.h[8],y=this.h[9],b=this.h[10],I=this.h[11],O=this.h[12],C=this.h[13],P=this.h[14],B=this.h[15];n(this.k.length===i.length);for(var T=0;T<i.length;T+=2){var N=P,M=B,U=_(w,y),H=A(w,y),L=v(w,0,b,0,O),D=k(0,y,0,I,0,C),F=this.k[T],z=this.k[T+1],V=i[T],j=i[T+1],K=g(N,M,U,H,L,D,F,z,V,j),q=m(N,M,U,H,L,D,F,z,V,j);N=E(r,s),M=R(r,s),U=S(r,0,o,0,h),H=x(0,s,0,a,0,c);var W=l(N,M,U,H),X=f(N,M,U,H);P=O,B=C,O=b,C=I,b=w,I=y,w=l(d,p,K,q),y=f(p,p,K,q),d=h,p=c,h=o,c=a,o=r,a=s,r=l(K,q,W,X),s=f(K,q,W,X)}u(this.h,0,r,s),u(this.h,2,o,a),u(this.h,4,h,c),u(this.h,6,d,p),u(this.h,8,w,y),u(this.h,10,b,I),u(this.h,12,O,C),u(this.h,14,P,B)},b.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(t,e,i){"use strict";(function(e){
/*!
 * protowriter.js - protobufs for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(13);function n(){if(!(this instanceof n))return new n;s.call(this)}function o(t){r(Number.isSafeInteger(t),"Number exceeds 2^53-1.");let e=0,i=0;do{r(i<7);let s=127&t;t-=t%128,0!=(t/=128)&&(s|=128),e*=256,e+=s,i++}while(t>0);return e}Object.setPrototypeOf(n.prototype,s.prototype),n.prototype.writeVarint=function(t){const i=function(t){r(Number.isSafeInteger(t),"Number exceeds 2^53-1.");let e=0;do{t-=t%128,t/=128,e++}while(t>0);return e}(t);switch(i){case 6:{const e=o(t);this.writeU32BE(e/65536|0),this.writeU16BE(65535&e);break}case 5:{const e=o(t);this.writeU32BE(e/256|0),this.writeU8(255&e);break}case 4:{const e=o(t);this.writeU32BE(e);break}case 3:{const e=o(t);this.writeU16BE(e>>8),this.writeU8(255&e);break}case 2:{const e=o(t);this.writeU16BE(e);break}case 1:{const e=o(t);this.writeU8(e);break}default:{const s=e.allocUnsafe(i);!function(t,e,i){r(Number.isSafeInteger(e),"Number exceeds 2^53-1.");do{r(i<t.length);let s=127&e;e-=e%128,0!=(e/=128)&&(s|=128),t[i]=s,i++}while(e>0)}(s,t,0),this.writeBytes(s);break}}},n.prototype.writeFieldVarint=function(t,e){const i=t<<3|0;this.writeVarint(i),this.writeVarint(e)},n.prototype.writeFieldU64=function(t,e){r(Number.isSafeInteger(e)),this.writeFieldVarint(t,e)},n.prototype.writeFieldU32=function(t,e){r(e<=4294967295),this.writeFieldVarint(t,e)},n.prototype.writeFieldBytes=function(t,e){const i=t<<3|2;this.writeVarint(i),this.writeVarint(e.length),this.writeBytes(e)},n.prototype.writeFieldString=function(t,i,r){"string"==typeof i&&(i=e.from(i,r||"utf8")),this.writeFieldBytes(t,i)},t.exports=n}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * network.js - bitcoin networks for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(43),s=i(10),n=i(232),o=e,a=s.GAMEGOLD_HEARTBEAT,h=s.GAMEGOLD_DAY;o.types=["main","testnet","regtest","simnet"];const c={type:"main",bossId:"xxxxxxxx-game-gold-boss-xxxxxxxxxxxx",tokenFix:"xxxxxxxx-game-gold-boss-tokenxxx",tokenReg:/^xxxxxxxx-game-gold-boss-tokenxxx[0-9]{4}$/i,stockFix:"x-game-gold-boss-stock-x",stockReg:/^[0-9]{10}x-game-gold-boss-stock-x[0-6]{1}[0-9]{1}$/i,seeds:[]};c.txcheckpoint=n.main,c.txchecktime={1:3e5},c.magic=3652501241,c.port=7333,c.wsport=7555,c.checkpointMap={},c.lastCheckpoint=47e4,c.halvingInterval=21e4,c.pow={limit:new r("00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff","hex"),chainwork:new r("00000000000000000000000000000000000000000074093f7ecede98cadd3a32","hex"),targetTimespan:h,targetSpacing:a,retargetInterval:h/a,targetReset:!1,noRetargeting:!1},c.pow.bits=s.bn2Compact(c.pow.limit),c.genesis={version:1,hash:"",prevBlock:"0000000000000000000000000000000000000000000000000000000000000000",merkleRoot:"",time:1546272e3,bits:c.pow.bits,nonce:2083236893,height:0,addresses:["tb1qpmzc83qca4snn62ee0eul8rqtzrp5a5q0f96rs","tb1qdrdct4dlhh6wdulddy96h9lxgs9fekaffhyxz5","tb1qfzuryrd7yc322xn2vpwl634frjmumfzps2le79","tb1qf7gk4xghheqeu3tqsxsqsndzgmu3wgsv4l6727","tb1qv5h0tm6tlhv4w4aawvddatuwxxcetafthp8d4l","tb1q0d6xxc5d9dg0ar7nryl8x5a6ftwgqacxt36cjh","tb1q5qrcudjcrgar99mg8qmmhgumzjq9kuzjnrd5x2","tb1qkr9n3wl2ehmpe0twf70u7fjw0hjw42xqyxrp32","tb1q6gzd0lqv43earmg2tp9w6sxagguqggfaw2395t","tb1qam5trfwtq6g38gf26sa7qm0f5szdd9hyluwq56","tb1q76a4aq3p7d35tu93ndhg6e86nuax36jkm89my2"]},c.block={pruneAfterHeight:1e3,keepBlocks:288,maxTipAge:86400,slowHeight:325e3},c.minerWindow=c.pow.retargetInterval,c.activationThreshold=.95*c.minerWindow|0,c.deployments={csv:{name:"csv",bit:0,startTime:1462060800,timeout:1493596800,threshold:-1,window:-1,required:!1,force:!0},testdummy:{name:"testdummy",bit:28,startTime:1199145601,timeout:1230767999,threshold:-1,window:-1,required:!1,force:!0}},c.deploys=[c.deployments.csv,c.deployments.testdummy],c.keyPrefix={privkey:128,xpubkey:76067358,xprivkey:76066276,xpubkey58:"xpub",xprivkey58:"xprv",coinType:0},c.addressPrefix={pubkeyhash:0,scripthash:5,witnesspubkeyhash:6,witnessscripthash:10,bech32:"bc"},c.requireStandard=!0,c.rpcPort=7332,c.minRelay=1e3,c.feeRate=1e5,c.maxFeeRate=4e5,c.selfConnect=!1,c.requestMempool=!1;const u={type:"testnet",bossId:"xxxxxxxx-game-gold-boss-xxxxxxxxxxxx",tokenFix:"xxxxxxxx-game-gold-boss-tokenxxx",tokenReg:/^xxxxxxxx-game-gold-boss-tokenxxx[0-9]{4}$/i,stockFix:"x-game-gold-boss-stock-x",stockReg:/^[0-9]{10}x-game-gold-boss-stock-x[0-6]{1}[0-9]{1}$/i,seeds:[]};u.txcheckpoint=n.testnet,u.txchecktime={1:1e4},u.magic=118034699,u.port=17333,u.wsport=17555,u.checkpointMap={},u.lastCheckpoint=Object.keys(u.checkpointMap).reduce((t,e)=>parseInt(e),0),u.halvingInterval=21e4,u.pow={limit:new r("000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff","hex"),chainwork:new r("0000000000000000000000000000000000000000000000000000000000000002","hex"),targetTimespan:h,targetSpacing:a,retargetInterval:h/a,targetReset:!1,noRetargeting:!1},u.pow.bits=s.bn2Compact(u.pow.limit),u.genesis={version:2,hash:"",prevBlock:"0000000000000000000000000000000000000000000000000000000000000000",merkleRoot:"",time:1296688602,bits:u.pow.bits,nonce:20181226,height:0,addresses:["tb1qvpvz9l49d7gk5czqfrz0tstfvc30vyc99yy3xr","tb1qvg3aq6drvkx2fs80jsheu0rfkgd64tkzvd8428","tb1qwzsvr2wxdrqqg3js6lm8c725th8m0mkr2veyrk","tb1q0y6qasunfz56pe2hwwkxjnp48vfxgfue3yv3lr","tb1q0g8mqaj2gedm32eq604fvg0rqpfnt4kv8mas0t","tb1qjwk74kr3e6658n70xvkg9rdp5yncv6ttfy5qcu","tb1qjhqahwjg8zwtec8svuv2zy3vnducg66qrr75ls","tb1q526mqkwfchy277g3cjrjyy36tqh65knnplvcve","tb1qeyj96xjlryyaqdtux9lrkelegldx74s2jrju5s","tb1qu7av4evfqnptm68lp7lfxa0v5j4alqe6wx22gn","tb1q7tqpys84h6p998fnu6kkapt9c4dqe5254cxxxg"]},u.block={pruneAfterHeight:1e3,keepBlocks:288,maxTipAge:86400,slowHeight:95e4},u.minerWindow=u.pow.retargetInterval,u.activationThreshold=.75*u.minerWindow|0,u.deployments={csv:{name:"csv",bit:0,startTime:1456790400,timeout:1493596800,threshold:-1,window:-1,required:!1,force:!0},testdummy:{name:"testdummy",bit:28,startTime:1199145601,timeout:1230767999,threshold:-1,window:-1,required:!1,force:!0}},u.deploys=[u.deployments.csv,u.deployments.testdummy],u.keyPrefix={privkey:239,xpubkey:70617039,xprivkey:70615956,xpubkey58:"tpub",xprivkey58:"tprv",coinType:1},u.addressPrefix={pubkeyhash:111,scripthash:196,witnesspubkeyhash:3,witnessscripthash:40,bech32:"tb"},u.requireStandard=!1,u.rpcPort=17332,u.minRelay=1e3,u.feeRate=2e4,u.maxFeeRate=6e4,u.selfConnect=!1,u.requestMempool=!1;const l={type:"regtest",bossId:"xxxxxxxx-game-gold-boss-xxxxxxxxxxxx",tokenFix:"xxxxxxxx-game-gold-boss-tokenxxx",tokenReg:/^xxxxxxxx-game-gold-boss-tokenxxx[0-9]{4}$/i,stockFix:"x-game-gold-boss-stock-x",stockReg:/^[0-9]{10}x-game-gold-boss-stock-x[0-6]{1}[0-9]{1}$/i,seeds:["127.0.0.1"]};l.txcheckpoint=n.regtest,l.txchecktime={1:3e5},l.magic=3669344250,l.port=48444,l.wsport=48555,l.checkpointMap={},l.lastCheckpoint=0,l.halvingInterval=150,l.pow={limit:new r("7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff","hex"),chainwork:new r("0000000000000000000000000000000000000000000000000000000000000002","hex"),targetTimespan:h,targetSpacing:a,retargetInterval:h/a,targetReset:!0,noRetargeting:!0},l.pow.bits=s.bn2Compact(l.pow.limit),l.genesis={version:1,hash:"",prevBlock:"0000000000000000000000000000000000000000000000000000000000000000",merkleRoot:"",time:1296688602,bits:l.pow.bits,nonce:2,height:0,addresses:["tb1qpmzc83qca4snn62ee0eul8rqtzrp5a5q0f96rs","tb1qfzuryrd7yc322xn2vpwl634frjmumfzps2le79","tb1qf7gk4xghheqeu3tqsxsqsndzgmu3wgsv4l6727","tb1qv5h0tm6tlhv4w4aawvddatuwxxcetafthp8d4l","tb1qdrdct4dlhh6wdulddy96h9lxgs9fekaffhyxz5","tb1q0d6xxc5d9dg0ar7nryl8x5a6ftwgqacxt36cjh","tb1q5qrcudjcrgar99mg8qmmhgumzjq9kuzjnrd5x2","tb1qkr9n3wl2ehmpe0twf70u7fjw0hjw42xqyxrp32","tb1q6gzd0lqv43earmg2tp9w6sxagguqggfaw2395t","tb1qam5trfwtq6g38gf26sa7qm0f5szdd9hyluwq56","tb1q76a4aq3p7d35tu93ndhg6e86nuax36jkm89my2"]},l.block={pruneAfterHeight:1e3,keepBlocks:1e4,maxTipAge:4294967295,slowHeight:0},l.minerWindow=l.pow.retargetInterval/14|0,l.activationThreshold=.75*l.minerWindow|0,l.deployments={csv:{name:"csv",bit:0,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!1,force:!0},testdummy:{name:"testdummy",bit:28,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!1,force:!0}},l.deploys=[l.deployments.csv,l.deployments.testdummy],l.keyPrefix={privkey:90,xpubkey:3937729029,xprivkey:3937666247,xpubkey58:"rpub",xprivkey58:"rprv",coinType:1},l.addressPrefix={pubkeyhash:60,scripthash:38,witnesspubkeyhash:122,witnessscripthash:20,bech32:"rb"},l.requireStandard=!1,l.rpcPort=47332,l.minRelay=1e3,l.feeRate=2e4,l.maxFeeRate=6e4,l.selfConnect=!0,l.requestMempool=!0;const f={type:"simnet",bossId:"xxxxxxxx-game-gold-boss-xxxxxxxxxxxx",tokenFix:"xxxxxxxx-game-gold-boss-tokenxxx",tokenReg:/^xxxxxxxx-game-gold-boss-tokenxxx[0-9]{4}$/i,stockFix:"x-game-gold-boss-stock-x",stockReg:/^[0-9]{10}x-game-gold-boss-stock-x[0-6]{1}[0-9]{1}$/i,seeds:["127.0.0.1"]};f.txcheckpoint=n.simnet,f.txchecktime={1:3e5},f.magic=303307798,f.port=18555,f.wsport=19555,f.checkpointMap={},f.lastCheckpoint=0,f.halvingInterval=21e4,f.pow={limit:new r("7fffff0000000000000000000000000000000000000000000000000000000000","hex"),chainwork:new r("0000000000000000000000000000000000000000000000000000000000000002","hex"),targetTimespan:h,targetSpacing:a,retargetInterval:h/a,targetReset:!0,noRetargeting:!1},f.pow.bits=s.bn2Compact(f.pow.limit),f.genesis={version:1,hash:"",prevBlock:"0000000000000000000000000000000000000000000000000000000000000000",merkleRoot:"",time:1401292357,bits:f.pow.bits,nonce:2,height:0,addresses:["tb1qpmzc83qca4snn62ee0eul8rqtzrp5a5q0f96rs","tb1qfzuryrd7yc322xn2vpwl634frjmumfzps2le79","tb1qf7gk4xghheqeu3tqsxsqsndzgmu3wgsv4l6727","tb1qv5h0tm6tlhv4w4aawvddatuwxxcetafthp8d4l","tb1qdrdct4dlhh6wdulddy96h9lxgs9fekaffhyxz5","tb1q0d6xxc5d9dg0ar7nryl8x5a6ftwgqacxt36cjh","tb1q5qrcudjcrgar99mg8qmmhgumzjq9kuzjnrd5x2","tb1qkr9n3wl2ehmpe0twf70u7fjw0hjw42xqyxrp32","tb1q6gzd0lqv43earmg2tp9w6sxagguqggfaw2395t","tb1qam5trfwtq6g38gf26sa7qm0f5szdd9hyluwq56","tb1q76a4aq3p7d35tu93ndhg6e86nuax36jkm89my2"]},f.block={pruneAfterHeight:1e3,keepBlocks:1e4,maxTipAge:4294967295,slowHeight:0},f.minerWindow=f.pow.retargetInterval/14|0,f.activationThreshold=.75*f.minerWindow|0,f.deployments={csv:{name:"csv",bit:0,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!1,force:!0},testdummy:{name:"testdummy",bit:28,startTime:1199145601,timeout:1230767999,threshold:-1,window:-1,required:!1,force:!0}},f.deploys=[f.deployments.csv,f.deployments.testdummy],f.keyPrefix={privkey:100,xpubkey:69254458,xprivkey:69253376,xpubkey58:"spub",xprivkey58:"sprv",coinType:115},f.addressPrefix={pubkeyhash:63,scripthash:123,witnesspubkeyhash:25,witnessscripthash:40,bech32:"sc"},f.requireStandard=!1,f.rpcPort=17556,f.minRelay=1e3,f.feeRate=2e4,f.maxFeeRate=6e4,f.selfConnect=!1,f.requestMempool=!1,o.main=c,o.testnet=u,o.regtest=l,o.simnet=f},function(t,e,i){"use strict";
/*!
 * timedata.js - time management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(24),s=i(3);function n(t){if(!(this instanceof n))return new n(t);r.call(this),null==t&&(t=200),this.samples=[],this.known=new Map,this.limit=t,this.offset=0,this.checked=!1}function o(t,e){return t-e}Object.setPrototypeOf(n.prototype,r.prototype),n.prototype.add=function(t,e){if(this.samples.length>=this.limit)return;if(this.known.has(t))return;const i=e-s.now();if(this.known.set(t,i),s.binaryInsert(this.samples,i,o),this.emit("sample",i,this.samples.length),this.samples.length>=5&&this.samples.length%2==1){let t=this.samples[this.samples.length>>>1];if(Math.abs(t)>=4200){if(!this.checked){let t=!1;for(const e of this.samples)if(0!==e&&Math.abs(e)<300){t=!0;break}t||(this.checked=!0,this.emit("mismatch"))}t=0}this.offset=t,this.emit("offset",this.offset)}},n.prototype.now=function(){return s.now()+this.offset},n.prototype.adjust=function(t){return t+this.offset},n.prototype.local=function(t){return t-this.offset},n.prototype.ms=function(){return s.ms()+1e3*this.offset},t.exports=n},function(t,e,i){"use strict";(function(e){
/*!
 * program.js - program object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(27),o=n.types;t.exports=class{constructor(t,i){r(s.isU8(t)),r(t>=0&&t<=16),r(e.isBuffer(i)),r(i.length>=2&&i.length<=40),this.version=t,this.data=i}getType(){return 0===this.version?20===this.data.length?o.WITNESSPUBKEYHASH:32===this.data.length?o.WITNESSSCRIPTHASH:o.WITNESSMALFORMED:1===this.version?32===this.data.length?o.WITNESSMASTHASH:o.WITNESSMALFORMED:o.NONSTANDARD}isUnknown(){const t=this.getType();return t===o.WITNESSMALFORMED||t===o.NONSTANDARD}isMalformed(){return this.getType()===o.WITNESSMALFORMED}inspect(){const t=this.data.toString("hex"),e=n.typesByVal[this.getType()].toLowerCase();return`<Program: version=${this.version} data=${t} type=${e}>`}}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";var r=e;function s(t){return 1===t.length?"0"+t:t}function n(t){for(var e="",i=0;i<t.length;i++)e+=s(t[i].toString(16));return e}r.toArray=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var i=[];if("string"!=typeof t){for(var r=0;r<t.length;r++)i[r]=0|t[r];return i}if("hex"===e)for((t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t),r=0;r<t.length;r+=2)i.push(parseInt(t[r]+t[r+1],16));else for(r=0;r<t.length;r++){var s=t.charCodeAt(r),n=s>>8,o=255&s;n?i.push(n,o):i.push(o)}return i},r.zero2=s,r.toHex=n,r.encode=function(t,e){return"hex"===e?n(t):t}},function(t,e,i){var r;function s(t){this.rand=t}if(t.exports=function(t){return r||(r=new s(null)),r.generate(t)},t.exports.Rand=s,s.prototype.generate=function(t){return this._rand(t)},s.prototype._rand=function(t){if(this.rand.getBytes)return this.rand.getBytes(t);for(var e=new Uint8Array(t),i=0;i<e.length;i++)e[i]=this.rand.getByte();return e},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?s.prototype._rand=function(t){var e=new Uint8Array(t);return self.crypto.getRandomValues(e),e}:self.msCrypto&&self.msCrypto.getRandomValues?s.prototype._rand=function(t){var e=new Uint8Array(t);return self.msCrypto.getRandomValues(e),e}:"object"==typeof window&&(s.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var n=i(235);if("function"!=typeof n.randomBytes)throw new Error("Not supported");s.prototype._rand=function(t){return n.randomBytes(t)}}catch(t){}},function(t,e,i){"use strict";
/*!
 * undocoins.js - undocoins object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(1),s=i(2),n=i(6),o=i(88);function a(){if(!(this instanceof a))return new a;this.items=[]}a.prototype.push=function(t){return this.items.push(t)},a.prototype.getSize=function(){let t=0;t+=4;for(const e of this.items)t+=e.getSize();return t},a.prototype.toRaw=function(){const t=this.getSize(),e=new n(t);e.writeU32(this.items.length);for(const t of this.items)t.toWriter(e);return e.render()},a.prototype.fromRaw=function(t){const e=new s(t),i=e.readU32();for(let t=0;t<i;t++)this.items.push(o.fromReader(e));return this},a.fromRaw=function(t){return(new a).fromRaw(t)},a.prototype.isEmpty=function(){return 0===this.items.length},a.prototype.commit=function(){const t=this.toRaw();return this.items.length=0,t},a.prototype.apply=function(t,e){const i=this.items.pop();r(i),t.addEntry(e,i)},t.exports=a},function(t,e,i){"use strict";const r=i(1),s=i(392),n=i(393);function o(t){const e=o.getBackend(t),i=e.backend,r=e.location;return new s(i,r,t)}o.getName=function(t){let e,i;switch(t||(t="memory"),t){case"ldb":case"leveldb":case"leveldown":e="leveldown",i="ldb";break;case"rdb":case"rocksdb":case"rocksdown":e="rocksdown",i="rdb";break;case"mdb":case"lmdb":e="lmdb",i="mdb";break;case"mem":case"memory":case"rbt":e="memory",i="mem";break;default:e=t,i="db"}return[e,i]},o.getBackend=function(t){const[e,i]=o.getName(t.db),s=n.get(e);let a=t.location;return"string"!=typeof a&&(r("memory"===e,"Location required."),a="memory"),{backend:s,location:`${a}.${i}`}},t.exports=o},function(t,e,i){"use strict";(function(e,r){var s=i(80);t.exports=b;var n,o=i(126);b.ReadableState=y,i(24).EventEmitter;var a=function(t,e){return t.listeners(e).length},h=i(140),c=i(7).Buffer,u=e.Uint8Array||function(){},l=i(58);l.inherits=i(5);var f=i(253),d=void 0;d=f&&f.debuglog?f.debuglog("stream"):function(){};var p,g=i(254),m=i(141);l.inherits(b,h);var w=["error","close","destroy","pause","resume"];function y(t,e){n=n||i(42),t=t||{};var r=e instanceof n;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var s=t.highWaterMark,o=t.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=s||0===s?s:r&&(o||0===o)?o:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(p||(p=i(90).StringDecoder),this.decoder=new p(t.encoding),this.encoding=t.encoding)}function b(t){if(n=n||i(42),!(this instanceof b))return new b(t);this._readableState=new y(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),h.call(this)}function v(t,e,i,r,s){var n,o=t._readableState;return null===e?(o.reading=!1,function(t,e){if(!e.ended){if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,E(t)}}(t,o)):(s||(n=function(t,e){var i;return function(t){return c.isBuffer(t)||t instanceof u}(e)||"string"==typeof e||void 0===e||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i}(o,e)),n?t.emit("error",n):o.objectMode||e&&e.length>0?("string"==typeof e||o.objectMode||Object.getPrototypeOf(e)===c.prototype||(e=function(t){return c.from(t)}(e)),r?o.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):k(t,o,e,!0):o.ended?t.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!i?(e=o.decoder.write(e),o.objectMode||0!==e.length?k(t,o,e,!1):_(t,o)):k(t,o,e,!1))):r||(o.reading=!1)),function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(o)}function k(t,e,i,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",i),t.read(0)):(e.length+=e.objectMode?1:i.length,r?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&E(t)),_(t,e)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),b.prototype.destroy=m.destroy,b.prototype._undestroy=m.undestroy,b.prototype._destroy=function(t,e){this.push(null),e(t)},b.prototype.push=function(t,e){var i,r=this._readableState;return r.objectMode?i=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=c.from(t,e),e=""),i=!0),v(this,t,e,!1,i)},b.prototype.unshift=function(t){return v(this,t,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(t){return p||(p=i(90).StringDecoder),this._readableState.decoder=new p(t),this._readableState.encoding=t,this};var S=8388608;function x(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=S?t=S:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function E(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(d("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?s.nextTick(R,t):R(t))}function R(t){d("emit readable"),t.emit("readable"),C(t)}function _(t,e){e.readingMore||(e.readingMore=!0,s.nextTick(A,t,e))}function A(t,e){for(var i=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(d("maybeReadMore read 0"),t.read(0),i!==e.length);)i=e.length;e.readingMore=!1}function I(t){d("readable nexttick read 0"),t.read(0)}function O(t,e){e.reading||(d("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),C(t),e.flowing&&!e.reading&&t.read(0)}function C(t){var e=t._readableState;for(d("flow",e.flowing);e.flowing&&null!==t.read(););}function P(t,e){return 0===e.length?null:(e.objectMode?i=e.buffer.shift():!t||t>=e.length?(i=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):i=function(t,e,i){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():i?function(t,e){var i=e.head,r=1,s=i.data;for(t-=s.length;i=i.next;){var n=i.data,o=t>n.length?n.length:t;if(o===n.length?s+=n:s+=n.slice(0,t),0==(t-=o)){o===n.length?(++r,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=n.slice(o));break}++r}return e.length-=r,s}(t,e):function(t,e){var i=c.allocUnsafe(t),r=e.head,s=1;for(r.data.copy(i),t-=r.data.length;r=r.next;){var n=r.data,o=t>n.length?n.length:t;if(n.copy(i,i.length-t,0,o),0==(t-=o)){o===n.length?(++s,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=n.slice(o));break}++s}return e.length-=s,i}(t,e),r}(t,e.buffer,e.decoder),i);var i}function B(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,s.nextTick(T,e,t))}function T(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function N(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1}b.prototype.read=function(t){d("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return d("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?B(this):E(this),null;if(0===(t=x(t,e))&&e.ended)return 0===e.length&&B(this),null;var r,s=e.needReadable;return d("need readable",s),(0===e.length||e.length-t<e.highWaterMark)&&d("length less than watermark",s=!0),e.ended||e.reading?d("reading or ended",s=!1):s&&(d("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=x(i,e))),null===(r=t>0?P(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&B(this)),null!==r&&this.emit("data",r),r},b.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(t,e){var i=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t)}n.pipesCount+=1,d("pipe count=%d opts=%j",n.pipesCount,e);var h=e&&!1===e.end||t===r.stdout||t===r.stderr?y:c;function c(){d("onend"),t.end()}n.endEmitted?s.nextTick(h):i.once("end",h),t.on("unpipe",function e(r,s){d("onunpipe"),r===i&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,d("cleanup"),t.removeListener("close",m),t.removeListener("finish",w),t.removeListener("drain",u),t.removeListener("error",g),t.removeListener("unpipe",e),i.removeListener("end",c),i.removeListener("end",y),i.removeListener("data",p),l=!0,!n.awaitDrain||t._writableState&&!t._writableState.needDrain||u())});var u=function(t){return function(){var e=t._readableState;d("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&a(t,"data")&&(e.flowing=!0,C(t))}}(i);t.on("drain",u);var l=!1,f=!1;function p(e){d("ondata"),f=!1,!1!==t.write(e)||f||((1===n.pipesCount&&n.pipes===t||n.pipesCount>1&&-1!==N(n.pipes,t))&&!l&&(d("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,f=!0),i.pause())}function g(e){d("onerror",e),y(),t.removeListener("error",g),0===a(t,"error")&&t.emit("error",e)}function m(){t.removeListener("finish",w),y()}function w(){d("onfinish"),t.removeListener("close",m),y()}function y(){d("unpipe"),i.unpipe(t)}return i.on("data",p),function(t,e,i){if("function"==typeof t.prependListener)return t.prependListener(e,i);t._events&&t._events[e]?o(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]:t.on(e,i)}(t,"error",g),t.once("close",m),t.once("finish",w),t.emit("pipe",i),n.flowing||(d("pipe resume"),i.resume()),t},b.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i),this);if(!t){var r=e.pipes,s=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var n=0;n<s;n++)r[n].emit("unpipe",this,i);return this}var o=N(e.pipes,t);return-1===o?this:(e.pipes.splice(o,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i),this)},b.prototype.on=function(t,e){var i=h.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&E(this):s.nextTick(I,this))}return i},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var t=this._readableState;return t.flowing||(d("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,s.nextTick(O,t,e))}(this,t)),this},b.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(t){var e=this,i=this._readableState,r=!1;for(var s in t.on("end",function(){if(d("wrapped end"),i.decoder&&!i.ended){var t=i.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(s){d("wrapped data"),i.decoder&&(s=i.decoder.write(s)),(!i.objectMode||null!==s&&void 0!==s)&&(i.objectMode||s&&s.length)&&(e.push(s)||(r=!0,t.pause()))}),t)void 0===this[s]&&"function"==typeof t[s]&&(this[s]=function(e){return function(){return t[e].apply(t,arguments)}}(s));for(var n=0;n<w.length;n++)t.on(w[n],this.emit.bind(this,w[n]));return this._read=function(e){d("wrapped _read",e),r&&(r=!1,t.resume())},this},b._fromList=P}).call(this,i(12),i(23))},function(t,e,i){t.exports=i(24).EventEmitter},function(t,e,i){"use strict";var r=i(80);function s(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var i=this,n=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return n||o?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(s,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(r.nextTick(s,i,t),i._writableState&&(i._writableState.errorEmitted=!0)):e&&e(t)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,i){"use strict";t.exports=n;var r=i(42),s=i(58);function n(t){if(!(this instanceof n))return new n(t);r.call(this,t),this._transformState={afterTransform:function(t,e){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,null!=e&&this.push(e),r(t);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",o)}function o(){var t=this;"function"==typeof this._flush?this._flush(function(e,i){a(t,e,i)}):a(this,null,null)}function a(t,e,i){if(e)return t.emit("error",e);if(null!=i&&t.push(i),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}s.inherits=i(5),s.inherits(n,r),n.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},n.prototype._transform=function(t,e,i){throw new Error("_transform() is not implemented")},n.prototype._write=function(t,e,i){var r=this._transformState;if(r.writecb=i,r.writechunk=t,r.writeencoding=e,!r.transforming){var s=this._readableState;(r.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}},n.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},n.prototype._destroy=function(t,e){var i=this;r.prototype._destroy.call(this,t,function(t){e(t),i.emit("close")})}},function(t,e,i){"use strict";(function(e){
/*!
 * layout-browser.js - chaindb layout for browser.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(3),n=s.pad8,o=s.pad32,a={binary:!1,C:function(t,e,i){return 64===(t=h(t)).length?"X"+t+h(e)+o(i):(r(40===t.length),"C"+t+h(e)+o(i))},Cc:function(t){let e,i;return r("string"==typeof t),139===t.length?(e=t.slice(65,129),i=parseInt(t.slice(129),10)):115===t.length?(e=t.slice(41,105),i=parseInt(t.slice(105),10)):r(!1),[e,i]},CP:function(t){return"CP"+t},CPc:function(t){return r("string"==typeof t),r(38===t.length),t.slice(2)},CV:"CV",H:function(t){return"H"+o(t)},HL:"HL",R:"R",T:function(t,e){return 64===(t=h(t)).length?"W"+t+h(e):(r(40===t.length),"T"+t+h(e))},Tt:function(t){return r("string"==typeof t),129===t.length?t.slice(64):(r(105===t.length),t.slice(41))},version:function(t){return o(t)},O:"O",V:"V",VP:function(t){return"VP"+t},VPc:function(t){return r("string"==typeof t),r(38===t.length),t.slice(2,38)},b:function(t){return"b"+h(t)},c:function(t,e){return"c"+h(t)+o(e)},e:function(t){return"e"+h(t)},h:function(t){return"h"+h(t)},n:function(t){return"n"+h(t)},o:function(t,e){return r("string"==typeof t),r("string"==typeof e),"o"+t+e},oo:function(t){return[t.slice(1,37),t.slice(38,73)]},p:function(t){return"p"+h(t)},pp:function(t){return r("string"==typeof t),r(65===t.length),t.slice(1,65)},t:function(t){return"t"+h(t)},th:function(t,e){return r("number"==typeof t),"th"+o(t)+h(e)},thh:function(t){return r("string"==typeof t),r(44===t.length),{time:parseInt(t.slice(2,12),10),hash:t.slice(12)}},tx:function(t){return"tx"+t},u:function(t){return"u"+h(t)},v:function(t,e){return"v"+n(t)+h(e)},vv:function(t){return r("string"==typeof t),r(36===t.length),[parseInt(t.slice(1,4),10),t.slice(4,36)]},equalVersion:function(t,e){return t.toString()==o(e)},s2b:function(t){return e.from(t,"utf8")},b2s:t=>(r(e.isBuffer(t)),t.toString("utf8"))};function h(t){return e.isBuffer(t)&&(t=t.toString("hex")),r("string"==typeof t),t}t.exports=a}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * chainentry.js - chainentry object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(43),n=i(10),o=i(3),a=i(9),h=i(4),c=i(2),u=i(6),l=i(69),f=i(39),d=new s(0);class p{constructor(t){this.hash=h.NULL_HASH,this.version=1,this.prevBlock=h.NULL_HASH,this.merkleRoot=h.NULL_HASH,this.time=0,this.bits=0,this.nonce=0,this.height=0,this.chainwork=d,t&&this.fromOptions(t)}fromOptions(t){return r(t,"Block data is required."),r("string"==typeof t.hash),r(o.isU32(t.version)),r("string"==typeof t.prevBlock),r("string"==typeof t.merkleRoot),r(o.isU32(t.time)),r(o.isU32(t.bits)),r(o.isU32(t.nonce)),r(o.isU32(t.height)),r(!t.chainwork||s.isBN(t.chainwork)),this.hash=t.hash,this.version=t.version,this.prevBlock=t.prevBlock,this.merkleRoot=t.merkleRoot,this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,this.height=t.height,this.chainwork=t.chainwork||d,this}static fromOptions(t,e){return(new p).fromOptions(t,e)}getProof(){const t=n.compact2BN(this.bits);return t.isNeg()||t.isZero()?new s(0):p.MAX_CHAINWORK.div(t.iaddn(1))}getChainwork(t){const e=this.getProof();return t?e.iadd(t.chainwork):e}isGenesis(){return 0===this.height}hasUnknown(t){const e=n.VERSION_TOP_MASK,i=n.VERSION_TOP_BITS;return(this.version&e)>>>0===i&&0!=(this.version&t.unknownBits)}hasBit(t){return n.hasBit(this.version,t)}rhash(){return o.revHex(this.hash)}fromBlock(t,e){return this.hash=t.hash("hex"),this.version=t.version,this.prevBlock=t.prevBlock,this.merkleRoot=t.merkleRoot,this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,this.height=e?e.height+1:0,this.chainwork=this.getChainwork(e),this}static fromBlock(t,e){return(new p).fromBlock(t,e)}toRaw(){const t=new u(116);return t.writeU32(this.version),t.writeHash(this.prevBlock),t.writeHash(this.merkleRoot),t.writeU32(this.time),t.writeU32(this.bits),t.writeU32(this.nonce),t.writeU32(this.height),t.writeBytes(this.chainwork.toArrayLike(e,"le",32)),t.render()}fromRaw(t){const e=new c(t,!0),i=a.hash256(e.readBytes(80));return e.seek(-80),this.hash=i.toString("hex"),this.version=e.readU32(),this.prevBlock=e.readHash("hex"),this.merkleRoot=e.readHash("hex"),this.time=e.readU32(),this.bits=e.readU32(),this.nonce=e.readU32(),this.height=e.readU32(),this.chainwork=new s(e.readBytes(32),"le"),this}static fromRaw(t){return(new p).fromRaw(t)}toJSON(){return{hash:o.revHex(this.hash),version:this.version,prevBlock:o.revHex(this.prevBlock),merkleRoot:o.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce,height:this.height,chainwork:this.chainwork.toString("hex",64)}}fromJSON(t){return r(t,"Block data is required."),r("string"==typeof t.hash),r(o.isU32(t.version)),r("string"==typeof t.prevBlock),r("string"==typeof t.merkleRoot),r(o.isU32(t.time)),r(o.isU32(t.bits)),r(o.isU32(t.nonce)),r("string"==typeof t.chainwork),this.hash=o.revHex(t.hash),this.version=t.version,this.prevBlock=o.revHex(t.prevBlock),this.merkleRoot=o.revHex(t.merkleRoot),this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,this.height=t.height,this.chainwork=new s(t.chainwork,"hex"),this}static fromJSON(t){return(new p).fromJSON(t)}toHeaders(){return l.fromEntry(this)}toInv(){return new f(f.types.BLOCK,this.hash)}inspect(){const t=this.toJSON();return t.version=o.hex32(t.version),t}static isChainEntry(t){return t instanceof p}}p.MAX_CHAINWORK=new s(1).ushln(256),t.exports=p}).call(this,i(0).Buffer)},function(t,e,i){const r=i(70);t.exports=class extends r{constructor(){super()}addItem(t){this.set(t.cid,t)}delItem(t){this.delete(t.cid)}}},function(t,e,i){"use strict";(function(t){
/*!
 * base32.js - base32 for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const i="abcdefghijklmnopqrstuvwxyz234567",r=[0,6,4,3,1],s={};for(let t=0;t<i.length;t++)s[i[t]]=t;e.encode=function(t){let e="",s=0,n=0;for(let r=0;r<t.length;r++){const o=t[r];switch(s){case 0:e+=i[o>>>3],n=(7&o)<<2,s=1;break;case 1:e+=i[n|o>>>6],e+=i[o>>>1&31],n=(1&o)<<4,s=2;break;case 2:e+=i[n|o>>>4],n=(15&o)<<1,s=3;break;case 3:e+=i[n|o>>>7],e+=i[o>>>2&31],n=(3&o)<<3,s=4;break;case 4:e+=i[n|o>>>5],e+=i[31&o],s=0}}if(s>0){e+=i[n];for(let t=0;t<r[s];t++)e+="="}return e},e.decode=function(e){const i=t.allocUnsafe(5*e.length/8|0);let r,n=0,o=0,a=0;for(r=0;r<e.length;r++){const t=s[e[r]];if(null==t)break;switch(n){case 0:o=t,n=1;break;case 1:i[a++]=o<<3|t>>>2,o=3&t,n=2;break;case 2:o=o<<5|t,n=3;break;case 3:i[a++]=o<<1|t>>>4,o=15&t,n=4;break;case 4:i[a++]=o<<4|t>>>1,o=1&t,n=5;break;case 5:o=o<<5|t,n=6;break;case 6:i[a++]=o<<2|t>>>3,o=7&t,n=7;break;case 7:i[a++]=o<<5|t,n=0}}switch(n){case 0:break;case 1:case 3:case 6:throw new Error("Invalid base32 string.");case 2:if(o>0)throw new Error("Invalid padding.");if("======"!==e.slice(r,r+6))throw new Error("Invalid base32 character.");if(null!=s[e[r+6]])throw new Error("Invalid padding.");break;case 4:if(o>0)throw new Error("Invalid padding.");if("===="!==e.slice(r,r+4))throw new Error("Invalid base32 character.");if(null!=s[e[r+4]])throw new Error("Invalid padding.");break;case 5:if(o>0)throw new Error("Invalid padding.");if("==="!==e.slice(r,r+3))throw new Error("Invalid base32 character.");if(null!=s[e[r+3]])throw new Error("Invalid padding.");break;case 7:if(o>0)throw new Error("Invalid padding.");if("="!==e[r])throw new Error("Invalid base32 character.");if(null!=s[e[r+1]])throw new Error("Invalid padding.")}return i.slice(0,a)}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * mempool.js - mempool for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(10),s=i(3),n=i(112),{operatorType:o}=i(8),{contractStatus:a}=i(8);t.exports=class{constructor(t,e,i,r){this.checkpoint=t,this.data=i,this.mode=e,this.options=r,this.id=`${i.type}.${i.addr}`}async execute(t){if(this.getEnvHeight()>this.data.period)return t.confirmContract(this.data,a.Expired,this.options.env,this.options.tidCreator),!0;if(this.checkpoint.getCheck(this.data.type)){try{let e=this.checkpoint.getCheck(this.data.type);for(let t of e){let e=s.sprintf(t.url,this.data.addr,r.contractConfirmation),i=await n.pGetUrl(e);if(!t.verify(i,this.data,r.contractConfirmation))return!1}return t.confirmContract(this.data,a.Confirmed,this.options.env,this.options.tidCreator),!0}catch(t){}return!1}return t.confirmContract(this.data,a.Expired,this.options.env,this.options.tidCreator),!0}getEnvHeight(){const t=this.options.env;switch(this.mode){case o.Mem:return t.chain.height;case o.Wallet:return t.state.height;case o.Db:return t.height}return 0}}},function(t,e,i){"use strict";e.randomBytes=e.rng=e.pseudoRandomBytes=e.prng=i(49),e.createHash=e.Hash=i(61),e.createHmac=e.Hmac=i(151);var r=i(287),s=Object.keys(r),n=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(s);e.getHashes=function(){return n};var o=i(153);e.pbkdf2=o.pbkdf2,e.pbkdf2Sync=o.pbkdf2Sync;var a=i(289);e.Cipher=a.Cipher,e.createCipher=a.createCipher,e.Cipheriv=a.Cipheriv,e.createCipheriv=a.createCipheriv,e.Decipher=a.Decipher,e.createDecipher=a.createDecipher,e.Decipheriv=a.Decipheriv,e.createDecipheriv=a.createDecipheriv,e.getCiphers=a.getCiphers,e.listCiphers=a.listCiphers;var h=i(309);e.DiffieHellmanGroup=h.DiffieHellmanGroup,e.createDiffieHellmanGroup=h.createDiffieHellmanGroup,e.getDiffieHellman=h.getDiffieHellman,e.createDiffieHellman=h.createDiffieHellman,e.DiffieHellman=h.DiffieHellman;var c=i(312);e.createSign=c.createSign,e.Sign=c.Sign,e.createVerify=c.createVerify,e.Verify=c.Verify,e.createECDH=i(328);var u=i(329);e.publicEncrypt=u.publicEncrypt,e.privateEncrypt=u.privateEncrypt,e.publicDecrypt=u.publicDecrypt,e.privateDecrypt=u.privateDecrypt;var l=i(332);e.randomFill=l.randomFill,e.randomFillSync=l.randomFillSync,e.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))},e.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},function(t,e,i){var r=i(5),s=i(50),n=i(7).Buffer,o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function h(){this.init(),this._w=a,s.call(this,64,56)}function c(t,e,i){return i^t&(e^i)}function u(t,e,i){return t&e|i&(t|e)}function l(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function f(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function d(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}function p(t){return(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10}r(h,s),h.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},h.prototype._update=function(t){for(var e=this._w,i=0|this._a,r=0|this._b,s=0|this._c,n=0|this._d,a=0|this._e,h=0|this._f,g=0|this._g,m=0|this._h,w=0;w<16;++w)e[w]=t.readInt32BE(4*w);for(;w<64;++w)e[w]=p(e[w-2])+e[w-7]+d(e[w-15])+e[w-16]|0;for(var y=0;y<64;++y){var b=m+f(a)+c(a,h,g)+o[y]+e[y]|0,v=l(i)+u(i,r,s)|0;m=g,g=h,h=a,a=n+b|0,n=s,s=r,r=i,i=b+v|0}this._a=i+this._a|0,this._b=r+this._b|0,this._c=s+this._c|0,this._d=n+this._d|0,this._e=a+this._e|0,this._f=h+this._f|0,this._g=g+this._g|0,this._h=m+this._h|0},h.prototype._hash=function(){var t=n.allocUnsafe(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},t.exports=h},function(t,e,i){var r=i(5),s=i(50),n=i(7).Buffer,o=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function h(){this.init(),this._w=a,s.call(this,128,112)}function c(t,e,i){return i^t&(e^i)}function u(t,e,i){return t&e|i&(t|e)}function l(t,e){return(t>>>28|e<<4)^(e>>>2|t<<30)^(e>>>7|t<<25)}function f(t,e){return(t>>>14|e<<18)^(t>>>18|e<<14)^(e>>>9|t<<23)}function d(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^t>>>7}function p(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)}function g(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^t>>>6}function m(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^(t>>>6|e<<26)}function w(t,e){return t>>>0<e>>>0?1:0}r(h,s),h.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},h.prototype._update=function(t){for(var e=this._w,i=0|this._ah,r=0|this._bh,s=0|this._ch,n=0|this._dh,a=0|this._eh,h=0|this._fh,y=0|this._gh,b=0|this._hh,v=0|this._al,k=0|this._bl,S=0|this._cl,x=0|this._dl,E=0|this._el,R=0|this._fl,_=0|this._gl,A=0|this._hl,I=0;I<32;I+=2)e[I]=t.readInt32BE(4*I),e[I+1]=t.readInt32BE(4*I+4);for(;I<160;I+=2){var O=e[I-30],C=e[I-30+1],P=d(O,C),B=p(C,O),T=g(O=e[I-4],C=e[I-4+1]),N=m(C,O),M=e[I-14],U=e[I-14+1],H=e[I-32],L=e[I-32+1],D=B+U|0,F=P+M+w(D,B)|0;F=(F=F+T+w(D=D+N|0,N)|0)+H+w(D=D+L|0,L)|0,e[I]=F,e[I+1]=D}for(var z=0;z<160;z+=2){F=e[z],D=e[z+1];var V=u(i,r,s),j=u(v,k,S),K=l(i,v),q=l(v,i),W=f(a,E),X=f(E,a),Y=o[z],G=o[z+1],$=c(a,h,y),J=c(E,R,_),Z=A+X|0,Q=b+W+w(Z,A)|0;Q=(Q=(Q=Q+$+w(Z=Z+J|0,J)|0)+Y+w(Z=Z+G|0,G)|0)+F+w(Z=Z+D|0,D)|0;var tt=q+j|0,et=K+V+w(tt,q)|0;b=y,A=_,y=h,_=R,h=a,R=E,a=n+Q+w(E=x+Z|0,x)|0,n=s,x=S,s=r,S=k,r=i,k=v,i=Q+et+w(v=Z+tt|0,Z)|0}this._al=this._al+v|0,this._bl=this._bl+k|0,this._cl=this._cl+S|0,this._dl=this._dl+x|0,this._el=this._el+E|0,this._fl=this._fl+R|0,this._gl=this._gl+_|0,this._hl=this._hl+A|0,this._ah=this._ah+i+w(this._al,v)|0,this._bh=this._bh+r+w(this._bl,k)|0,this._ch=this._ch+s+w(this._cl,S)|0,this._dh=this._dh+n+w(this._dl,x)|0,this._eh=this._eh+a+w(this._el,E)|0,this._fh=this._fh+h+w(this._fl,R)|0,this._gh=this._gh+y+w(this._gl,_)|0,this._hh=this._hh+b+w(this._hl,A)|0},h.prototype._hash=function(){var t=n.allocUnsafe(64);function e(e,i,r){t.writeInt32BE(e,r),t.writeInt32BE(i,r+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),t},t.exports=h},function(t,e,i){"use strict";var r=i(5),s=i(286),n=i(38),o=i(7).Buffer,a=i(99),h=i(100),c=i(101),u=o.alloc(128);function l(t,e){n.call(this,"digest"),"string"==typeof e&&(e=o.from(e));var i="sha512"===t||"sha384"===t?128:64;this._alg=t,this._key=e,e.length>i?e=("rmd160"===t?new h:c(t)).update(e).digest():e.length<i&&(e=o.concat([e,u],i));for(var r=this._ipad=o.allocUnsafe(i),s=this._opad=o.allocUnsafe(i),a=0;a<i;a++)r[a]=54^e[a],s[a]=92^e[a];this._hash="rmd160"===t?new h:c(t),this._hash.update(r)}r(l,n),l.prototype._update=function(t){this._hash.update(t)},l.prototype._final=function(){var t=this._hash.digest();return("rmd160"===this._alg?new h:c(this._alg)).update(this._opad).update(t).digest()},t.exports=function(t,e){return"rmd160"===(t=t.toLowerCase())||"ripemd160"===t?new l("rmd160",e):"md5"===t?new s(a,e):new l(t,e)}},function(t){t.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},function(t,e,i){e.pbkdf2=i(288),e.pbkdf2Sync=i(156)},function(t,e,i){(function(e){var i=Math.pow(2,30)-1;function r(t,i){if("string"!=typeof t&&!e.isBuffer(t))throw new TypeError(i+" must be a buffer or string")}t.exports=function(t,e,s,n){if(r(t,"Password"),r(e,"Salt"),"number"!=typeof s)throw new TypeError("Iterations not a number");if(s<0)throw new TypeError("Bad iterations");if("number"!=typeof n)throw new TypeError("Key length not a number");if(n<0||n>i||n!=n)throw new TypeError("Bad key length")}}).call(this,i(0).Buffer)},function(t,e,i){(function(e){var i;i=e.browser?"utf-8":parseInt(e.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary",t.exports=i}).call(this,i(23))},function(t,e,i){var r=i(99),s=i(100),n=i(101),o=i(154),a=i(155),h=i(7).Buffer,c=h.alloc(128),u={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function l(t,e,i){var o=function(t){return"rmd160"===t||"ripemd160"===t?s:"md5"===t?r:function(e){return n(t).update(e).digest()}}(t),a="sha512"===t||"sha384"===t?128:64;e.length>a?e=o(e):e.length<a&&(e=h.concat([e,c],a));for(var l=h.allocUnsafe(a+u[t]),f=h.allocUnsafe(a+u[t]),d=0;d<a;d++)l[d]=54^e[d],f[d]=92^e[d];var p=h.allocUnsafe(a+i+4);l.copy(p,0,0,a),this.ipad1=p,this.ipad2=l,this.opad=f,this.alg=t,this.blocksize=a,this.hash=o,this.size=u[t]}l.prototype.run=function(t,e){return t.copy(e,this.blocksize),this.hash(e).copy(this.opad,this.blocksize),this.hash(this.opad)},t.exports=function(t,e,i,r,s){o(t,e,i,r),h.isBuffer(t)||(t=h.from(t,a)),h.isBuffer(e)||(e=h.from(e,a));var n=new l(s=s||"sha1",t,e.length),c=h.allocUnsafe(r),f=h.allocUnsafe(e.length+4);e.copy(f,0,0,e.length);for(var d=0,p=u[s],g=Math.ceil(r/p),m=1;m<=g;m++){f.writeUInt32BE(m,e.length);for(var w=n.run(f,n.ipad1),y=w,b=1;b<i;b++){y=n.run(y,n.ipad2);for(var v=0;v<p;v++)w[v]^=y[v]}w.copy(c,d),d+=p}return c}},function(t,e,i){var r=i(62),s=i(7).Buffer,n=i(158);function o(t){var e=t._cipher.encryptBlockRaw(t._prev);return n(t._prev),e}e.encrypt=function(t,e){var i=Math.ceil(e.length/16),n=t._cache.length;t._cache=s.concat([t._cache,s.allocUnsafe(16*i)]);for(var a=0;a<i;a++){var h=o(t),c=n+16*a;t._cache.writeUInt32BE(h[0],c+0),t._cache.writeUInt32BE(h[1],c+4),t._cache.writeUInt32BE(h[2],c+8),t._cache.writeUInt32BE(h[3],c+12)}var u=t._cache.slice(0,e.length);return t._cache=t._cache.slice(e.length),r(e,u)}},function(t,e){t.exports=function(t){for(var e,i=t.length;i--;){if(255!==(e=t.readUInt8(i))){e++,t.writeUInt8(e,i);break}t.writeUInt8(0,i)}}},function(t){t.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},function(t,e,i){var r=i(84),s=i(7).Buffer,n=i(38),o=i(5),a=i(304),h=i(62),c=i(158);function u(t,e,i,o){n.call(this);var h=s.alloc(4,0);this._cipher=new r.AES(e);var u=this._cipher.encryptBlock(h);this._ghash=new a(u),i=function(t,e,i){if(12===e.length)return t._finID=s.concat([e,s.from([0,0,0,1])]),s.concat([e,s.from([0,0,0,2])]);var r=new a(i),n=e.length,o=n%16;r.update(e),o&&(o=16-o,r.update(s.alloc(o,0))),r.update(s.alloc(8,0));var h=8*n,u=s.alloc(8);u.writeUIntBE(h,0,8),r.update(u),t._finID=r.state;var l=s.from(t._finID);return c(l),l}(this,i,u),this._prev=s.from(i),this._cache=s.allocUnsafe(0),this._secCache=s.allocUnsafe(0),this._decrypt=o,this._alen=0,this._len=0,this._mode=t,this._authTag=null,this._called=!1}o(u,n),u.prototype._update=function(t){if(!this._called&&this._alen){var e=16-this._alen%16;e<16&&(e=s.alloc(e,0),this._ghash.update(e))}this._called=!0;var i=this._mode.encrypt(this,t);return this._decrypt?this._ghash.update(t):this._ghash.update(i),this._len+=t.length,i},u.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var t=h(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(t,e){var i=0;t.length!==e.length&&i++;for(var r=Math.min(t.length,e.length),s=0;s<r;++s)i+=t[s]^e[s];return i}(t,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=t,this._cipher.scrub()},u.prototype.getAuthTag=function(){if(this._decrypt||!s.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},u.prototype.setAuthTag=function(t){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=t},u.prototype.setAAD=function(t){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(t),this._alen+=t.length},t.exports=u},function(t,e,i){var r=i(84),s=i(7).Buffer,n=i(38);function o(t,e,i,o){n.call(this),this._cipher=new r.AES(e),this._prev=s.from(i),this._cache=s.allocUnsafe(0),this._secCache=s.allocUnsafe(0),this._decrypt=o,this._mode=t}i(5)(o,n),o.prototype._update=function(t){return this._mode.encrypt(this,t,this._decrypt)},o.prototype._final=function(){this._cipher.scrub()},t.exports=o},function(t,e,i){var r=i(49);t.exports=w,w.simpleSieve=g,w.fermatTest=m;var s=i(14),n=new s(24),o=new(i(163)),a=new s(1),h=new s(2),c=new s(5),u=(new s(16),new s(8),new s(10)),l=new s(3),f=(new s(7),new s(11)),d=new s(4),p=(new s(12),null);function g(t){for(var e=function(){if(null!==p)return p;var t=[];t[0]=2;for(var e=1,i=3;i<1048576;i+=2){for(var r=Math.ceil(Math.sqrt(i)),s=0;s<e&&t[s]<=r&&i%t[s]!=0;s++);e!==s&&t[s]<=r||(t[e++]=i)}return p=t,t}(),i=0;i<e.length;i++)if(0===t.modn(e[i]))return 0===t.cmpn(e[i]);return!0}function m(t){var e=s.mont(t);return 0===h.toRed(e).redPow(t.subn(1)).fromRed().cmpn(1)}function w(t,e){if(t<16)return new s(2===e||5===e?[140,123]:[140,39]);var i,p;for(e=new s(e);;){for(i=new s(r(Math.ceil(t/8)));i.bitLength()>t;)i.ishrn(1);if(i.isEven()&&i.iadd(a),i.testn(1)||i.iadd(h),e.cmp(h)){if(!e.cmp(c))for(;i.mod(u).cmp(l);)i.iadd(d)}else for(;i.mod(n).cmp(f);)i.iadd(d);if(g(p=i.shrn(1))&&g(i)&&m(p)&&m(i)&&o.test(p)&&o.test(i))return i}}},function(t,e,i){var r=i(14),s=i(136);function n(t){this.rand=t||new s.Rand}t.exports=n,n.create=function(t){return new n(t)},n.prototype._randbelow=function(t){var e=t.bitLength(),i=Math.ceil(e/8);do{var s=new r(this.rand.generate(i))}while(s.cmp(t)>=0);return s},n.prototype._randrange=function(t,e){var i=e.sub(t);return t.add(this._randbelow(i))},n.prototype.test=function(t,e,i){var s=t.bitLength(),n=r.mont(t),o=new r(1).toRed(n);e||(e=Math.max(1,s/48|0));for(var a=t.subn(1),h=0;!a.testn(h);h++);for(var c=t.shrn(h),u=a.toRed(n);e>0;e--){var l=this._randrange(new r(2),a);i&&i(l);var f=l.toRed(n).redPow(c);if(0!==f.cmp(o)&&0!==f.cmp(u)){for(var d=1;d<h;d++){if(0===(f=f.redSqr()).cmp(o))return!1;if(0===f.cmp(u))break}if(d===h)return!1}}return!0},n.prototype.getDivisor=function(t,e){var i=t.bitLength(),s=r.mont(t),n=new r(1).toRed(s);e||(e=Math.max(1,i/48|0));for(var o=t.subn(1),a=0;!o.testn(a);a++);for(var h=t.shrn(a),c=o.toRed(s);e>0;e--){var u=this._randrange(new r(2),o),l=t.gcd(u);if(0!==l.cmpn(1))return l;var f=u.toRed(s).redPow(h);if(0!==f.cmp(n)&&0!==f.cmp(c)){for(var d=1;d<a;d++){if(0===(f=f.redSqr()).cmp(n))return f.fromRed().subn(1).gcd(t);if(0===f.cmp(c))break}if(d===a)return(f=f.redSqr()).fromRed().subn(1).gcd(t)}}return!1}},function(t,e){var i=[].indexOf;t.exports=function(t,e){if(i)return t.indexOf(e);for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}},function(t,e,i){var r=i(5),s=i(64).Reporter,n=i(0).Buffer;function o(t,e){s.call(this,e),n.isBuffer(t)?(this.base=t,this.offset=0,this.length=t.length):this.error("Input not Buffer")}function a(t,e){if(Array.isArray(t))this.length=0,this.value=t.map(function(t){return t instanceof a||(t=new a(t,e)),this.length+=t.length,t},this);else if("number"==typeof t){if(!(0<=t&&t<=255))return e.error("non-byte EncoderBuffer value");this.value=t,this.length=1}else if("string"==typeof t)this.value=t,this.length=n.byteLength(t);else{if(!n.isBuffer(t))return e.error("Unsupported type: "+typeof t);this.value=t,this.length=t.length}}r(o,s),e.DecoderBuffer=o,o.prototype.save=function(){return{offset:this.offset,reporter:s.prototype.save.call(this)}},o.prototype.restore=function(t){var e=new o(this.base);return e.offset=t.offset,e.length=this.offset,this.offset=t.offset,s.prototype.restore.call(this,t.reporter),e},o.prototype.isEmpty=function(){return this.offset===this.length},o.prototype.readUInt8=function(t){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(t||"DecoderBuffer overrun")},o.prototype.skip=function(t,e){if(!(this.offset+t<=this.length))return this.error(e||"DecoderBuffer overrun");var i=new o(this.base);return i._reporterState=this._reporterState,i.offset=this.offset,i.length=this.offset+t,this.offset+=t,i},o.prototype.raw=function(t){return this.base.slice(t?t.offset:this.offset,this.length)},e.EncoderBuffer=a,a.prototype.join=function(t,e){return t||(t=new n(this.length)),e||(e=0),0===this.length?t:(Array.isArray(this.value)?this.value.forEach(function(i){i.join(t,e),e+=i.length}):("number"==typeof this.value?t[e]=this.value:"string"==typeof this.value?t.write(this.value,e):n.isBuffer(this.value)&&this.value.copy(t,e),e+=this.length),t)}},function(t,e,i){var r=e;r._reverse=function(t){var e={};return Object.keys(t).forEach(function(i){(0|i)==i&&(i|=0);var r=t[i];e[r]=i}),e},r.der=i(319)},function(t,e,i){var r=i(5),s=i(63),n=s.base,o=s.bignum,a=s.constants.der;function h(t){this.enc="der",this.name=t.name,this.entity=t,this.tree=new c,this.tree._init(t.body)}function c(t){n.Node.call(this,"der",t)}function u(t,e){var i=t.readUInt8(e);if(t.isError(i))return i;var r=a.tagClass[i>>6],s=0==(32&i);if(31==(31&i)){var n=i;for(i=0;128==(128&n);){if(n=t.readUInt8(e),t.isError(n))return n;i<<=7,i|=127&n}}else i&=31;return{cls:r,primitive:s,tag:i,tagStr:a.tag[i]}}function l(t,e,i){var r=t.readUInt8(i);if(t.isError(r))return r;if(!e&&128===r)return null;if(0==(128&r))return r;var s=127&r;if(s>4)return t.error("length octect is too long");r=0;for(var n=0;n<s;n++){r<<=8;var o=t.readUInt8(i);if(t.isError(o))return o;r|=o}return r}t.exports=h,h.prototype.decode=function(t,e){return t instanceof n.DecoderBuffer||(t=new n.DecoderBuffer(t,e)),this.tree._decode(t,e)},r(c,n.Node),c.prototype._peekTag=function(t,e,i){if(t.isEmpty())return!1;var r=t.save(),s=u(t,'Failed to peek tag: "'+e+'"');return t.isError(s)?s:(t.restore(r),s.tag===e||s.tagStr===e||s.tagStr+"of"===e||i)},c.prototype._decodeTag=function(t,e,i){var r=u(t,'Failed to decode tag of "'+e+'"');if(t.isError(r))return r;var s=l(t,r.primitive,'Failed to get length of "'+e+'"');if(t.isError(s))return s;if(!i&&r.tag!==e&&r.tagStr!==e&&r.tagStr+"of"!==e)return t.error('Failed to match tag: "'+e+'"');if(r.primitive||null!==s)return t.skip(s,'Failed to match body of: "'+e+'"');var n=t.save(),o=this._skipUntilEnd(t,'Failed to skip indefinite length body: "'+this.tag+'"');return t.isError(o)?o:(s=t.offset-n.offset,t.restore(n),t.skip(s,'Failed to match body of: "'+e+'"'))},c.prototype._skipUntilEnd=function(t,e){for(;;){var i=u(t,e);if(t.isError(i))return i;var r,s=l(t,i.primitive,e);if(t.isError(s))return s;if(r=i.primitive||null!==s?t.skip(s):this._skipUntilEnd(t,e),t.isError(r))return r;if("end"===i.tagStr)break}},c.prototype._decodeList=function(t,e,i,r){for(var s=[];!t.isEmpty();){var n=this._peekTag(t,"end");if(t.isError(n))return n;var o=i.decode(t,"der",r);if(t.isError(o)&&n)break;s.push(o)}return s},c.prototype._decodeStr=function(t,e){if("bitstr"===e){var i=t.readUInt8();return t.isError(i)?i:{unused:i,data:t.raw()}}if("bmpstr"===e){var r=t.raw();if(r.length%2==1)return t.error("Decoding of string type: bmpstr length mismatch");for(var s="",n=0;n<r.length/2;n++)s+=String.fromCharCode(r.readUInt16BE(2*n));return s}if("numstr"===e){var o=t.raw().toString("ascii");return this._isNumstr(o)?o:t.error("Decoding of string type: numstr unsupported characters")}if("octstr"===e)return t.raw();if("objDesc"===e)return t.raw();if("printstr"===e){var a=t.raw().toString("ascii");return this._isPrintstr(a)?a:t.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(e)?t.raw().toString():t.error("Decoding of string type: "+e+" unsupported")},c.prototype._decodeObjid=function(t,e,i){for(var r,s=[],n=0;!t.isEmpty();){var o=t.readUInt8();n<<=7,n|=127&o,0==(128&o)&&(s.push(n),n=0)}128&o&&s.push(n);var a=s[0]/40|0,h=s[0]%40;if(r=i?s:[a,h].concat(s.slice(1)),e){var c=e[r.join(" ")];void 0===c&&(c=e[r.join(".")]),void 0!==c&&(r=c)}return r},c.prototype._decodeTime=function(t,e){var i=t.raw().toString();if("gentime"===e)var r=0|i.slice(0,4),s=0|i.slice(4,6),n=0|i.slice(6,8),o=0|i.slice(8,10),a=0|i.slice(10,12),h=0|i.slice(12,14);else{if("utctime"!==e)return t.error("Decoding "+e+" time is not supported yet");r=0|i.slice(0,2),s=0|i.slice(2,4),n=0|i.slice(4,6),o=0|i.slice(6,8),a=0|i.slice(8,10),h=0|i.slice(10,12),r=r<70?2e3+r:1900+r}return Date.UTC(r,s-1,n,o,a,h,0)},c.prototype._decodeNull=function(t){return null},c.prototype._decodeBool=function(t){var e=t.readUInt8();return t.isError(e)?e:0!==e},c.prototype._decodeInt=function(t,e){var i=t.raw(),r=new o(i);return e&&(r=e[r.toString(10)]||r),r},c.prototype._use=function(t,e){return"function"==typeof t&&(t=t(e)),t._getDecoder("der").tree}},function(t,e,i){var r=i(5),s=i(0).Buffer,n=i(63),o=n.base,a=n.constants.der;function h(t){this.enc="der",this.name=t.name,this.entity=t,this.tree=new c,this.tree._init(t.body)}function c(t){o.Node.call(this,"der",t)}function u(t){return t<10?"0"+t:t}t.exports=h,h.prototype.encode=function(t,e){return this.tree._encode(t,e).join()},r(c,o.Node),c.prototype._encodeComposite=function(t,e,i,r){var n,o=function(t,e,i,r){var s;if("seqof"===t?t="seq":"setof"===t&&(t="set"),a.tagByName.hasOwnProperty(t))s=a.tagByName[t];else{if("number"!=typeof t||(0|t)!==t)return r.error("Unknown tag: "+t);s=t}return s>=31?r.error("Multi-octet tag encoding unsupported"):(e||(s|=32),s|a.tagClassByName[i||"universal"]<<6)}(t,e,i,this.reporter);if(r.length<128)return(n=new s(2))[0]=o,n[1]=r.length,this._createEncoderBuffer([n,r]);for(var h=1,c=r.length;c>=256;c>>=8)h++;(n=new s(2+h))[0]=o,n[1]=128|h,c=1+h;for(var u=r.length;u>0;c--,u>>=8)n[c]=255&u;return this._createEncoderBuffer([n,r])},c.prototype._encodeStr=function(t,e){if("bitstr"===e)return this._createEncoderBuffer([0|t.unused,t.data]);if("bmpstr"===e){for(var i=new s(2*t.length),r=0;r<t.length;r++)i.writeUInt16BE(t.charCodeAt(r),2*r);return this._createEncoderBuffer(i)}return"numstr"===e?this._isNumstr(t)?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===e?this._isPrintstr(t)?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(e)?this._createEncoderBuffer(t):"objDesc"===e?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: "+e+" unsupported")},c.prototype._encodeObjid=function(t,e,i){if("string"==typeof t){if(!e)return this.reporter.error("string objid given, but no values map found");if(!e.hasOwnProperty(t))return this.reporter.error("objid not found in values map");t=e[t].split(/[\s\.]+/g);for(var r=0;r<t.length;r++)t[r]|=0}else if(Array.isArray(t))for(t=t.slice(),r=0;r<t.length;r++)t[r]|=0;if(!Array.isArray(t))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(t));if(!i){if(t[1]>=40)return this.reporter.error("Second objid identifier OOB");t.splice(0,2,40*t[0]+t[1])}var n=0;for(r=0;r<t.length;r++){var o=t[r];for(n++;o>=128;o>>=7)n++}var a=new s(n),h=a.length-1;for(r=t.length-1;r>=0;r--)for(o=t[r],a[h--]=127&o;(o>>=7)>0;)a[h--]=128|127&o;return this._createEncoderBuffer(a)},c.prototype._encodeTime=function(t,e){var i,r=new Date(t);return"gentime"===e?i=[u(r.getFullYear()),u(r.getUTCMonth()+1),u(r.getUTCDate()),u(r.getUTCHours()),u(r.getUTCMinutes()),u(r.getUTCSeconds()),"Z"].join(""):"utctime"===e?i=[u(r.getFullYear()%100),u(r.getUTCMonth()+1),u(r.getUTCDate()),u(r.getUTCHours()),u(r.getUTCMinutes()),u(r.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+e+" time is not supported yet"),this._encodeStr(i,"octstr")},c.prototype._encodeNull=function(){return this._createEncoderBuffer("")},c.prototype._encodeInt=function(t,e){if("string"==typeof t){if(!e)return this.reporter.error("String int or enum given, but no values map");if(!e.hasOwnProperty(t))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(t));t=e[t]}if("number"!=typeof t&&!s.isBuffer(t)){var i=t.toArray();!t.sign&&128&i[0]&&i.unshift(0),t=new s(i)}if(s.isBuffer(t)){var r=t.length;0===t.length&&r++;var n=new s(r);return t.copy(n),0===t.length&&(n[0]=0),this._createEncoderBuffer(n)}if(t<128)return this._createEncoderBuffer(t);if(t<256)return this._createEncoderBuffer([0,t]);r=1;for(var o=t;o>=256;o>>=8)r++;for(o=(n=new Array(r)).length-1;o>=0;o--)n[o]=255&t,t>>=8;return 128&n[0]&&n.unshift(0),this._createEncoderBuffer(new s(n))},c.prototype._encodeBool=function(t){return this._createEncoderBuffer(t?255:0)},c.prototype._use=function(t,e){return"function"==typeof t&&(t=t(e)),t._getEncoder("der").tree},c.prototype._skipDefault=function(t,e,i){var r,s=this._baseState;if(null===s.default)return!1;var n=t.join();if(void 0===s.defaultBuffer&&(s.defaultBuffer=this._encodeValue(s.default,e,i).join()),n.length!==s.defaultBuffer.length)return!1;for(r=0;r<n.length;r++)if(n[r]!==s.defaultBuffer[r])return!1;return!0}},function(t){t.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},function(t,e,i){(function(e){var r=i(61);function s(t){var i=new e(4);return i.writeUInt32BE(t,0),i}t.exports=function(t,i){for(var n,o=new e(""),a=0;o.length<i;)n=s(a++),o=e.concat([o,r("sha1").update(t).update(n).digest()]);return o.slice(0,i)}}).call(this,i(0).Buffer)},function(t,e){t.exports=function(t,e){for(var i=t.length,r=-1;++r<i;)t[r]^=e[r];return t}},function(t,e,i){(function(e){var r=i(14);t.exports=function(t,i){return new e(t.toRed(r.mont(i.modulus)).redPow(new r(i.publicExponent)).fromRed().toArray())}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t){
/*!
 * scrypt.js - scrypt for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 *
 * Ported from:
 * https://github.com/Tarsnap/scrypt/blob/master/lib/crypto/crypto_scrypt-ref.c
 *
 * Copyright 2009 Colin Percival
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */
const r=i(35),s=i(117),n=i(47).binding;function o(e,i,r,n,o,a){if(n*o>=1<<30)throw new Error("EFBIG");if(0!=(r&r-1)||0===r)throw new Error("EINVAL");if(r>4294967295)throw new Error("EINVAL");const h=t.allocUnsafe(256*n),c=t.allocUnsafe(128*n*r),u=s.derive(e,i,1,128*o*n,"sha256");for(let t=0;t<o;t++)f(u,128*t*n,n,r,c,h);return s.derive(e,u,1,a,"sha256")}async function a(e,i,r,n,o,a){if(n*o>=1<<30)throw new Error("EFBIG");if(0!=(r&r-1)||0===r)throw new Error("EINVAL");if(r>4294967295)throw new Error("EINVAL");const h=t.allocUnsafe(256*n),c=t.allocUnsafe(128*n*r),u=await s.deriveAsync(e,i,1,128*o*n,"sha256");for(let t=0;t<o;t++)await d(u,128*t*n,n,r,c,h);return await s.deriveAsync(e,u,1,a,"sha256")}function h(t){const e=new Uint32Array(16),i=new Uint32Array(16);for(let i=0;i<16;i++)e[i]=t.readUInt32LE(4*i,!0);for(let t=0;t<16;t++)i[t]=e[t];for(let t=0;t<8;t+=2)i[4]^=c(i[0]+i[12],7),i[8]^=c(i[4]+i[0],9),i[12]^=c(i[8]+i[4],13),i[0]^=c(i[12]+i[8],18),i[9]^=c(i[5]+i[1],7),i[13]^=c(i[9]+i[5],9),i[1]^=c(i[13]+i[9],13),i[5]^=c(i[1]+i[13],18),i[14]^=c(i[10]+i[6],7),i[2]^=c(i[14]+i[10],9),i[6]^=c(i[2]+i[14],13),i[10]^=c(i[6]+i[2],18),i[3]^=c(i[15]+i[11],7),i[7]^=c(i[3]+i[15],9),i[11]^=c(i[7]+i[3],13),i[15]^=c(i[11]+i[7],18),i[1]^=c(i[0]+i[3],7),i[2]^=c(i[1]+i[0],9),i[3]^=c(i[2]+i[1],13),i[0]^=c(i[3]+i[2],18),i[6]^=c(i[5]+i[4],7),i[7]^=c(i[6]+i[5],9),i[4]^=c(i[7]+i[6],13),i[5]^=c(i[4]+i[7],18),i[11]^=c(i[10]+i[9],7),i[8]^=c(i[11]+i[10],9),i[9]^=c(i[8]+i[11],13),i[10]^=c(i[9]+i[8],18),i[12]^=c(i[15]+i[14],7),i[13]^=c(i[12]+i[15],9),i[14]^=c(i[13]+i[12],13),i[15]^=c(i[14]+i[13],18);for(let t=0;t<16;t++)e[t]+=i[t];for(let i=0;i<16;i++)t.writeUInt32LE(e[i],4*i,!0)}function c(t,e){return t<<e|t>>>32-e}function u(e,i,r,s){const n=t.allocUnsafe(64);p(n,e,0,64*(2*s-1),64);for(let t=0;t<2*s;t++)g(n,e,0,64*t,64),h(n),p(i,n,r+64*t,0,64);for(let t=0;t<s;t++)p(e,i,64*t,r+2*t*64,64);for(let t=0;t<s;t++)p(e,i,64*(t+s),r+64*(2*t+1),64)}function l(t,e){return t.readUInt32LE(64*(2*e-1),!0)}function f(t,e,i,r,s,n){const o=n,a=n;p(o,t,0,e,128*i);for(let t=0;t<r;t++)p(s,o,t*(128*i),0,128*i),u(o,a,128*i,i);for(let t=0;t<r;t++)g(o,s,0,(l(o,i)&r-1)*(128*i),128*i),u(o,a,128*i,i);p(t,o,e,0,128*i)}async function d(t,e,i,s,n,o){const a=o,h=o;p(a,t,0,e,128*i);for(let t=0;t<s;t++)p(n,a,t*(128*i),0,128*i),u(a,h,128*i,i),await r.wait();for(let t=0;t<s;t++)g(a,n,0,(l(a,i)&s-1)*(128*i),128*i),u(a,h,128*i,i),await r.wait();p(t,a,e,0,128*i)}function p(t,e,i,r,s){e.copy(t,i,r,r+s)}function g(t,e,i,r,s){for(let n=0;n<s;n++)t[i+n]^=e[r+n]}n&&(o=n.scrypt),n&&(a=n.scryptAsync),e.derive=o,e.deriveAsync=a}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * mine.js - mining function for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */i(1);const r=i(9),s=i(92);t.exports=function(t,e,i,n){let o=i;for(t.writeUInt32LE(o,76,!0);o<=n;){if(s.rcmp(r.hash256(t),e)<=0)return o;o++,t.writeUInt32LE(o,76,!0)}return-1}},function(t,e,i){"use strict";
/*!
 * ErrorPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(15),o=i(11);class a extends n{constructor(t){super(),this.error=t||new Error,this.cmd=o.ERROR}getSize(){const t=this.error;let e=0;switch(e+=s.sizeVarString(h(t.message),"utf8"),e+=s.sizeVarString(h(t.stack),"utf8"),e+=s.sizeVarString(h(t.type),"utf8"),typeof t.code){case"number":e+=1,e+=4;break;case"string":e+=1,e+=s.sizeVarString(t.code,"utf8");break;default:e+=1}return e}toWriter(t){const e=this.error;switch(t.writeVarString(h(e.message),"utf8"),t.writeVarString(h(e.stack),"utf8"),t.writeVarString(h(e.type),"utf8"),typeof e.code){case"number":t.writeU8(2),t.writeI32(e.code);break;case"string":t.writeU8(1),t.writeVarString(e.code,"utf8");break;default:t.writeU8(0)}return t}fromRaw(t){const e=new r(t,!0),i=this.error;switch(i.message=e.readVarString("utf8"),i.stack=e.readVarString("utf8"),i.type=e.readVarString("utf8"),e.readU8()){case 2:i.code=e.readI32();break;case 1:i.code=e.readVarString("utf8");break;default:i.code=null}return this}static fromRaw(t){return(new a).fromRaw(t)}workerHandle(t){t.emit("error",this.error)}masterHandle(t){t.emit("error",this.error)}}function h(t){return"string"!=typeof t?"":t}t.exports=a},function(t,e,i){"use strict";
/*!
 * CheckResultPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(67),o=i(15),a=i(11);class h extends o{constructor(t){super(),this.error=t||null,this.cmd=a.CHECKRESULT}getSize(){const t=this.error;let e=0;return t?(e+=1,e+=s.sizeVarString(c(t.message),"utf8"),e+=s.sizeVarString(c(t.stack),"utf8"),e+=s.sizeVarString(c(t.code),"utf8"),e+=1,e+=4):e+=1}toWriter(t){const e=this.error;return e?(t.writeU8(1),t.writeVarString(c(e.message),"utf8"),t.writeVarString(c(e.stack),"utf8"),t.writeVarString(c(e.code),"utf8"),t.writeU8(-1===e.op?255:e.op),t.writeU32(-1===e.ip?4294967295:e.ip),t):(t.writeU8(0),t)}fromRaw(t){const e=new r(t,!0);if(0===e.readU8())return this;const i=new n("");return i.message=e.readVarString("utf8"),i.stack=e.readVarString("utf8"),i.code=e.readVarString("utf8"),i.op=e.readU8(),i.ip=e.readU32(),255===i.op&&(i.op=-1),4294967295===i.ip&&(i.ip=-1),this.error=i,this}static fromRaw(t){return(new h).fromRaw(t)}}function c(t){return"string"!=typeof t?"":t}t.exports=h},function(t,e,i){"use strict";
/*!
 * chain.js - blockchain management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(1),s=i(59),n=i(190),o=i(65),a=i(10),h=i(3),c=i(34),u=i(98),l=i(144),f=i(44),d=i(20),{VerifyError:p}=i(36),g=i(35),m=i(487),w=i(488),{OperType:y,contractStatus:b,operatorType:v}=i(8),k=(i(52),o.thresholdStates),S=i(53),x=i(147);i(41);class E extends s{constructor(t){super(),this.options=new m(t),this.node=this.options.node,this.network=this.options.network,this.logger=this.options.logger.context("chain"),this.workers=this.options.workers,this.db=new n(this.options),this.locker=new c(!0),this.invalid=new u(100),this.state=new w,this.tip=new l,this.height=-1,this.synced=!1,this.orphanMap=new Map,this.orphanPrev=new Map}async _open(){this.logger.info("Chain is loading."),this.options.checkpoints&&this.logger.info("Checkpoints are enabled."),this.options.coinCache&&this.logger.info("Coin cache is enabled.");let t=await this.db.open();this.node&&"function"==typeof this.node.emit&&this.node.emit("plugin open",{type:this.db.eid,result:t});const e=await this.db.getTip();r(e),this.tip=e,this.height=e.height,this.logger.info("Chain Height: %d",e.height),this.logger.memory();const i=await this.getDeploymentState();this.setDeploymentState(i),this.logger.memory(),this.emit("tip",e),this.maybeSync();let s=await this.db.getCps();for(let t of s){let e=await this.getTX(t.current.hash);if(e){let i=await S.FactoryOfContract(v.DbInit,e,{env:this.db,finder:this.getTX.bind(this)});await i.HandleOutput(t.current.index)}}let n=await this.db.getContracts();for(let t of n)t&&(await S.addTransContract(v.DbInit,t),t.transStatus==b.Promised&&S.autoTaskMgr.addTask(new x(this.network.txcheckpoint,v.Db,t,{env:this}),this.network.txchecktime[t.type]))}_close(){return this.db.close()}async verifyContext(t,e,i){const r=await this.verify(t,e,i);return this.options.spv?[new f,r]:this.isHistorical(e)?[await this.updateInputs(t,e),r]:[await this.verifyInputs(t,e,r),r]}async verifyBlock(t){const e=await this.locker.lock();try{return await this._verifyBlock(t)}finally{e()}}async _verifyBlock(t){const e=o.flags.DEFAULT_FLAGS&~o.flags.VERIFY_POW;return await this.verifyContext(t,this.tip,e)}isMainHash(t){return this.db.isMainHash(t)}isMainChain(t){return this.db.isMainChain(t)}getAncestor(t,e){return this.db.getAncestor(t,e)}getPrevious(t){return this.db.getPrevious(t)}getPrevCache(t){return this.db.getPrevCache(t)}getNext(t){return this.db.getNext(t)}getNextEntry(t){return this.db.getNextEntry(t)}async getMedianTime(t,e){let i=E.MEDIAN_TIMESPAN;const r=[];null!=e&&(r.push(e),i-=1);let s=t;for(let t=0;t<i&&s;t++){r.push(s.time),s=this.getPrevCache(s)||await this.getPrevious(s)}return r.sort(R),r[r.length>>>1]}async getPid(t){const e=t.txs[0];let i=S.parseContract(e);if(i&&i.data){let e=await this.getCoin(i.data.hash,i.data.index);if(e)try{return e.getReturnData().pid}catch(t){}}return null}async getMedianBlockNum(t,e){let i=0,r=t;for(let t=0;t<a.MEDIAN_BLOCK&&r&&!r.isGenesis();t++){let t=await this.getBlock(r.hash);if(!t)break;await this.getPid(t)===e&&i++,r=this.getPrevCache(r)||await this.getPrevious(r)}return i}isHistorical(t){return!!(this.options.checkpoints&&t.height+1<=this.network.lastCheckpoint)}async verify(t,e,i){if(r("number"==typeof i),t.prevBlock!==e.hash)throw new p(t,"invalid","bad-prevblk",0);const s=t.hash("hex");if(!this.verifyCheckpoint(e,s))throw new p(t,"checkpoint","checkpoint mismatch",100);if(this.isHistorical(e)){if(this.options.spv)return this.state;if(!t.hasWitness()&&!t.getCommitmentHash())return new w;i&=~o.flags.VERIFY_BODY}if(i&o.flags.VERIFY_BODY){const[e,i,r]=t.checkBody();if(!e)throw new p(t,"invalid",i,r,!0)}const{target:n}=await this.getTarget(t.time,e);if(t.bits!==n)throw new p(t,"invalid","bad-diffbits",100);if(this.options.spv)return this.state;const h=await this.getMedianTime(e);if(t.time<=h)throw new p(t,"invalid","time-too-old",0);if(t.time>this.network.now()+7200)throw new p(t,"invalid","time-too-new",0,!0);const c=e.height+1;if(t.version<2)throw new p(t,"obsolete","bad-version",0);if(t.version<3)throw new p(t,"obsolete","bad-version",0);if(t.version<4)throw new p(t,"obsolete","bad-version",0);const u=await this.getDeployments(t.time,e),l=u.hasMTP()?h:t.time;let f=t.getCoinbaseHeight();for(let i=0;i<t.txs.length;i++){const s=t.txs[i];if(c%100!=0){let n=this.node.getTXFromAll?this.node.getTXFromAll.bind(this.node):()=>{},o=await S.FactoryOfContract(v.Db,s,{env:this.db,block:t,prev:e,coinbaseHeight:f,finder:n});if(0==i){if(this.unittest)continue;if(!o||!o.data)throw new p(t,"invalid","null coinbase data",100);r.strictEqual(o.data.oper,y.coinbase)}if(!await o.verify())throw new p(t,"invalid","bad-contract-verify",100)}else{let e=a.getEpoch(c),i=t.txs[0].outputs[0].getAddress();const r=await this.node.getCoinsByAddress(i);if(!r||0==r.length)throw new p(t,"invalid","bad-coinbase coin values",100);if(a.getRealValues(r)<e.value)throw new p(t,"invalid","bad-coinbase coin values",100)}if(!s.isFinal(c,l))throw new p(t,"invalid","bad-txns-nonfinal",10)}if(t.getCoinbaseHeight()!==c)throw new p(t,"invalid","bad-cb-height",100);let d=null;if(u.hasWitness()&&(d=t.getCommitmentHash())){if(!t.getWitnessNonce())throw new p(t,"invalid","bad-witness-nonce-size",100,!0);if(!d.equals(t.createCommitmentHash()))throw new p(t,"invalid","bad-witness-merkle-match",100,!0)}if(!d&&t.hasWitness())throw new p(t,"invalid","unexpected-witness",100,!0);if(t.getWeight()>a.MAX_BLOCK_WEIGHT)throw new p(t,"invalid","bad-blk-weight",100);return u}async getDeployments(t,e){this.network.deployments,e.height;const i=new w;return i.flags|=d.flags.VERIFY_P2SH,i.flags|=d.flags.VERIFY_DERSIG,i.flags|=d.flags.VERIFY_CHECKLOCKTIMEVERIFY,i.flags|=d.flags.VERIFY_CHECKSEQUENCEVERIFY,i.lockFlags|=o.lockFlags.VERIFY_SEQUENCE,i.lockFlags|=o.lockFlags.MEDIAN_TIME_PAST,i.flags|=d.flags.VERIFY_WITNESS,i.flags|=d.flags.VERIFY_NULLDUMMY,i}setDeploymentState(t){this.options.checkpoints&&this.height<this.network.lastCheckpoint?this.state=t:(!this.state.hasP2SH()&&t.hasP2SH()&&this.logger.warning("P2SH has been activated."),!this.state.hasBIP66()&&t.hasBIP66()&&this.logger.warning("BIP66 has been activated."),!this.state.hasCSV()&&t.hasCSV()&&this.logger.warning("CSV has been activated."),!this.state.hasWitness()&&t.hasWitness()&&this.logger.warning("Segwit has been activated."),this.state=t)}async updateInputs(t,e){const i=new f,s=e.height+1,n=t.txs[0];i.addTX(n,s);for(let e=1;e<t.txs.length;e++){const n=t.txs[e];r(await i.spendInputs(this.db,n),"BUG: Spent inputs in historical data!"),i.addTX(n,s)}return i}async verifyInputs(t,e,i){const r=new f,s=e.height+1,n=this.network.halvingInterval;let o=0,h=0;for(let n=0;n<t.txs.length;n++){const c=t.txs[n];if(n>0&&!await r.spendInputs(this.db,c))throw new p(t,"invalid","bad-txns-inputs-missingorspent",100);if(n>0&&c.version>=2&&!await this.verifyLocks(e,c,r,i.lockFlags))throw new p(t,"invalid","bad-txns-nonfinal",100);if((o+=c.getSigopsCost(r,i.flags))>a.MAX_BLOCK_SIGOPS_COST)throw new p(t,"invalid","bad-blk-sigops",100);if(n>0){const[e,i,n]=c.checkInputs(r,s);if(-1===e)throw new p(t,"invalid",i,n);if((h+=e)>a.MAX_MONEY)throw new p(t,"invalid","bad-cb-amount",100)}r.addTX(c,s)}if(h+=a.getReward(s,n),t.getClaimed()>h)throw new p(t,"invalid","bad-cb-amount",100);const c=[];for(let n=1;n<t.txs.length;n++){const o=t.txs[n];let a=null,h=this.node.getTXFromAll?this.node.getTXFromAll.bind(this.node):()=>{},u=await S.FactoryOfContract(v.Db,o,{env:this.db,block:t,prev:e,coinbaseHeight:s,finder:h});if(u.data&&u.data.oper==y.contractExecute){const t=S.transactionList.get(`${u.data.type}.${u.data.addr}`);t&&(a=t.transStatus)}c.push(o.verifyAsync(r,i.flags,a,this.workers))}if(!await g.every(c))throw new p(t,"invalid","mandatory-script-verify-flag-failed",100);return r}async findFork(t,e){for(;t.hash!==e.hash;){for(;e.height>t.height;)if(!(e=await this.getPrevious(e)))throw new Error("No previous entry for new tip.");if(t.hash===e.hash)return t;if(!(t=await this.getPrevious(t)))throw new Error("No previous entry for old tip.")}return t}async reorganize(t){const e=this.tip,i=await this.findFork(e,t);r(i,"No free space or data corruption.");const s=[];let n=e;for(;n.hash!==i.hash;)s.push(n),n=await this.getPrevious(n),r(n);const o=[];for(n=t;n.hash!==i.hash;)o.push(n),n=await this.getPrevious(n),r(n);for(let t=0;t<s.length;t++){const e=s[t];await this.disconnect(e)}for(let t=o.length-1;t>=1;t--){const e=o[t];await this.reconnect(e)}this.logger.warning("Chain reorganization: old=%s(%d) new=%s(%d)",e.rhash(),e.height,t.rhash(),t.height),await this.fire("chain.reorganize",e,t)}async reorganizeSPV(t){const e=this.tip,i=await this.findFork(e,t);r(i,"No free space or data corruption.");const s=[];let n=e;for(;n.hash!==i.hash;)s.push(n),n=await this.getPrevious(n),r(n);await this._reset(i.hash,!0);for(const t of s){const e=t.toHeaders(),i=new f;await this.fire("chain.disconnect",t,e,i)}this.logger.warning("SPV reorganization: old=%s(%d) new=%s(%d)",e.rhash(),e.height,t.rhash(),t.height),this.logger.warning("Chain replay from height %d necessary.",i.height),await this.fire("chain.reorganize",e,t)}async disconnect(t){let e=await this.getBlock(t.hash);if(!e){if(!this.options.spv)throw new Error("Block not found.");e=t.toHeaders()}const i=await this.getPrevious(t),s=await this.db.disconnect(t,e);r(i),this.tip=i,this.height=i.height,this.emit("tip",i),await this.fire("chain.disconnect",t,e,s)}async reconnect(t){const e=o.flags.VERIFY_NONE;let i=await this.getBlock(t.hash);if(!i){if(!this.options.spv)throw new Error("Block not found.");i=t.toHeaders()}const s=await this.getPrevious(t);let n,a;r(s);try{[n,a]=await this.verifyContext(i,s,e)}catch(e){throw"VerifyError"===e.type&&(e.malleated||this.setInvalid(t.hash),this.logger.warning("Tried to reconnect invalid block: %s (%d).",t.rhash(),t.height)),e}await this.db.reconnect(t,i,n),this.tip=t,this.height=t.height,this.setDeploymentState(a),await this.fire("chain.connect",t,i,n),this.emit("tip",t),this.emit("reconnect",t,i)}async setBestChain(t,e,i,r){if(t.prevBlock!==this.tip.hash){if(this.logger.warning("WARNING: Reorganizing chain."),this.options.spv)return void await this.reorganizeSPV(t);await this.reorganize(t)}let s,n;t.hasUnknown(this.network)&&this.logger.warning("Unknown version bits in block %d: %s.",t.height,h.hex32(t.version));try{[s,n]=await this.verifyContext(e,i,r)}catch(e){throw"VerifyError"===e.type&&(e.malleated||this.setInvalid(t.hash),this.logger.warning("Tried to connect invalid block: %s (%d).",t.rhash(),t.height)),e}await this.db.save(t,e,s),this.tip=t,this.height=t.height,this.setDeploymentState(n),this.emit("tip",t),this.emit("block",e,t),await this.fire("chain.connect",t,e,s)}async saveAlternate(t,e,i,r){try{await this.verify(e,i,r)}catch(e){throw"VerifyError"===e.type&&(e.malleated||this.setInvalid(t.hash),this.logger.warning("Invalid block on alternate chain: %s (%d).",t.rhash(),t.height)),e}t.hasUnknown(this.network)&&this.logger.warning("Unknown version bits in block %d: %s.",t.height,h.hex32(t.version)),await this.db.save(t,e),this.logger.warning("Heads up: Competing chain at height %d: tip-height=%d competitor-height=%d tip-hash=%s competitor-hash=%s tip-chainwork=%s competitor-chainwork=%s chainwork-diff=%s",t.height,this.tip.height,t.height,this.tip.rhash(),t.rhash(),this.tip.chainwork.toString(),t.chainwork.toString(),this.tip.chainwork.sub(t.chainwork).toString()),this.emit("competitor",e,t)}async reset(t){const e=await this.locker.lock();try{return await this._reset(t,!1)}finally{e()}}async _reset(t,e){const i=await this.db.reset(t);this.tip=i,this.height=i.height,this.synced=!1;const r=await this.getDeploymentState();this.setDeploymentState(r),this.emit("tip",i),e||await this.fire("chain.reset",i),this.purgeOrphans(),this.maybeSync()}async replay(t){const e=await this.locker.lock();try{return await this._replay(t,!0)}finally{e()}}async _replay(t,e){const i=await this.getEntry(t);if(!i)throw new Error("Block not found.");if(!await this.isMainChain(i))throw new Error("Cannot reset on alternate chain.");i.isGenesis()?await this._reset(i.hash,e):await this._reset(i.prevBlock,e)}async invalidate(t){const e=await this.locker.lock();try{return await this._invalidate(t)}finally{e()}}async _invalidate(t){await this._replay(t,!1),this.setInvalid(t)}async prune(){const t=await this.locker.lock();try{return await this.db.prune()}finally{t()}}async scan(t,e,i){const r=await this.locker.lock();try{return await this.db.scan(t,e,i)}finally{r()}}async add(t,e,i){const r=await this.locker.lock();try{return await this._add(t,e,i)}finally{r()}}async _add(t,e,i){const r=t.hash("hex");if(null==e&&(e=o.flags.DEFAULT_FLAGS),null==i&&(i=-1),r===this.network.genesis.hash)throw this.logger.debug("Saw genesis block: %s.",t.rhash()),new p(t,"duplicate","duplicate",0);if(this.hasPending(r))throw this.logger.debug("Already have pending block: %s.",t.rhash()),new p(t,"duplicate","duplicate",0);if(this.hasOrphan(r))throw this.logger.debug("Already have orphan block: %s.",t.rhash()),new p(t,"duplicate","duplicate",0);if(this.hasInvalid(t))throw this.logger.debug("Invalid ancestors for block: %s.",t.rhash()),new p(t,"duplicate","duplicate",100);if(e&o.flags.VERIFY_POW&&!t.verifyPOW())throw new p(t,"invalid","high-hash",50);if(await this.hasEntry(r))throw this.logger.debug("Already have block: %s.",t.rhash()),new p(t,"duplicate","duplicate",0);const s=await this.getEntry(t.prevBlock);if(!s)return this.storeOrphan(t,e,i),null;const n=await this.connect(s,t,e);return this.hasNextOrphan(r)&&await this.handleOrphans(n),n}async connect(t,e,i){const s=h.hrtime();if(r(e.prevBlock===t.hash),e.isMemory())try{e=e.toBlock()}catch(t){throw this.logger.error(t),new p(e,"malformed","error parsing message",10,!0)}const n=l.fromBlock(e,t);return n.chainwork.lte(this.tip.chainwork)?await this.saveAlternate(n,e,t,i):await this.setBestChain(n,e,t,i),this.logStatus(s,e,n),this.maybeSync(),n}async handleOrphans(t){let e=this.resolveOrphan(t.hash);for(;e;){const{block:i,flags:r,id:s}=e;try{t=await this.connect(t,i,r)}catch(t){if("VerifyError"===t.type){this.logger.warning("Could not resolve orphan block %s: %s.",i.rhash(),t.message),this.emit("orphan.bad",t,s);break}throw t}this.logger.debug("Orphan block was resolved: %s (%d).",i.rhash(),t.height),this.emit("resolved",i,t),e=this.resolveOrphan(t.hash)}}isSlow(){return!this.options.spv&&(!!this.synced||1===this.height||this.height%20==0||this.height>=this.network.block.slowHeight)}logStatus(t,e,i){if(!this.isSlow())return;this.logger.memory();const r=h.hrtime(t);this.logger.info("Block %s (%d) added to chain (size=%d txs=%d time=%d).",i.rhash(),i.height,e.getSize(),e.txs.length,r),this.db.coinCache.capacity>0&&this.logger.debug("Coin Cache: size=%dmb, items=%d.",h.mb(this.db.coinCache.size),this.db.coinCache.items)}verifyCheckpoint(t,e){if(!this.options.checkpoints)return!0;const i=t.height+1,r=this.network.checkpointMap[i];return!r||(e===r?(this.logger.debug("Hit checkpoint block %s (%d).",h.revHex(e),i),this.emit("checkpoint",e,i),!0):(this.logger.warning("Checkpoint mismatch at height %d: expected=%s received=%s",i,h.revHex(r),h.revHex(e)),this.purgeOrphans(),!1))}storeOrphan(t,e,i){const s=t.getCoinbaseHeight(),n=this.orphanPrev.get(t.prevBlock);n&&(r(n.block.hash("hex")!==t.hash("hex")),r(n.block.prevBlock===t.prevBlock),this.logger.warning("Removing forked orphan block: %s (%d).",n.block.rhash(),s),this.removeOrphan(n)),this.limitOrphans(),this.addOrphan(new function(t,e,i){this.block=t,this.flags=e,this.id=i,this.time=h.now()}(t,e,i)),this.logger.debug("Storing orphan block: %s (%d).",t.rhash(),s),this.emit("orphan",t)}addOrphan(t){const e=t.block,i=e.hash("hex");return r(!this.orphanMap.has(i)),r(!this.orphanPrev.has(e.prevBlock)),r(this.orphanMap.size>=0),this.orphanMap.set(i,t),this.orphanPrev.set(e.prevBlock,t),t}removeOrphan(t){const e=t.block,i=e.hash("hex");return r(this.orphanMap.has(i)),r(this.orphanPrev.has(e.prevBlock)),r(this.orphanMap.size>0),this.orphanMap.delete(i),this.orphanPrev.delete(e.prevBlock),t}hasNextOrphan(t){return this.orphanPrev.has(t)}resolveOrphan(t){const e=this.orphanPrev.get(t);return e?this.removeOrphan(e):null}purgeOrphans(){const t=this.orphanMap.size;0!==t&&(this.orphanMap.clear(),this.orphanPrev.clear(),this.logger.debug("Purged %d orphans.",t))}limitOrphans(){const t=h.now();let e=null;for(const i of this.orphanMap.values())t<i.time+3600?(!e||i.time<e.time)&&(e=i):this.removeOrphan(i);this.orphanMap.size<this.options.maxOrphans||e&&this.removeOrphan(e)}hasInvalid(t){const e=t.hash("hex");return!!this.invalid.has(e)||!!this.invalid.has(t.prevBlock)&&(this.setInvalid(e),!0)}setInvalid(t){this.invalid.set(t,!0)}removeInvalid(t){this.invalid.remove(t)}async has(t){return!!this.hasOrphan(t)||!!this.locker.has(t)||!!this.invalid.has(t)||await this.hasEntry(t)}getEntry(t){return this.db.getEntry(t)}getEntryByHeight(t){return this.db.getEntryByHeight(t)}getEntryByHash(t){return this.db.getEntryByHash(t)}getHash(t){return this.db.getHash(t)}getHeight(t){return this.db.getHeight(t)}hasEntry(t){return this.db.hasEntry(t)}getNextHash(t){return this.db.getNextHash(t)}hasCoins(t){return this.db.hasCoins(t)}getTips(){return this.db.getTips()}readCoin(t){return this.db.readCoin(t)}getCoin(t,e){return this.db.getCoin(t,e)}getBlock(t){return this.db.getBlock(t)}getRawBlock(t){return this.db.getRawBlock(t)}getBlockView(t){return this.db.getBlockView(t)}getMeta(t){return this.db.getMeta(t)}async getTX(t){return await this.db.getTX(t)}hasTX(t){return this.db.hasTX(t)}getCoinsByAddress(t){return this.db.getCoinsByAddress(t)}getHashesByAddress(t,e="both"){return this.db.getHashesByAddress(t,e)}getTXByAddress(t){return this.db.getTXByAddress(t)}getMetaByAddress(t){return this.db.getMetaByAddress(t)}getOrphan(t){return this.orphanMap.get(t)||null}hasOrphan(t){return this.orphanMap.has(t)}hasPending(t){return this.locker.hasPending(t)}getCoinView(t){return this.db.getCoinView(t)}async getSpentView(t){const e=await this.locker.lock();try{return await this.db.getSpentView(t)}finally{e()}}isFull(){return this.synced}maybeSync(){this.synced||this.options.checkpoints&&this.height<this.network.lastCheckpoint||this.tip.time<h.now()-this.network.block.maxTipAge||this.hasChainwork()&&(this.synced=!0,g.timeout(1e3).then(()=>{this.emit("chain.full")}))}hasChainwork(){return this.tip.chainwork.gte(this.network.pow.chainwork)}getProgress(){const t=this.network.genesis.time,e=this.tip.time-t,i=h.now()-t-2400;return Math.min(1,e/i)}async getLocator(t){const e=await this.locker.lock();try{return await this._getLocator(t)}finally{e()}}async _getLocator(t){null==t&&(t=this.tip.hash),r("string"==typeof t);let e=await this.getEntry(t);const i=[];e||(e=this.tip,t=this.tip.hash);let s=await this.isMainChain(e),n=e.hash,o=e.height,a=1;for(i.push(n);o>0;){if((o-=a)<0&&(o=0),i.length>10&&(a*=2),s)n=await this.getHash(o),r(n);else{const t=await this.getAncestor(e,o);r(t),s=await this.isMainChain(t),n=t.hash}i.push(n)}return i}getOrphanRoot(t){let e=null;for(r(t);;){const i=this.orphanMap.get(t);if(!i)break;e=t,t=i.block.prevBlock}return e}getProofTime(t,e){const i=this.network.pow;let r,s;return t.chainwork.gt(e.chainwork)?(s=t.chainwork.sub(e.chainwork),r=1):(s=e.chainwork.sub(t.chainwork),r=-1),(s=(s=s.imuln(i.targetSpacing)).div(this.tip.getProof())).bitLength()>53?r*Number.MAX_SAFE_INTEGER:r*s.toNumber()}async getTarget(t,e){const i=this.network.pow;if(!e)return r(t===this.network.genesis.time),{target:i.bits};if((e.height+1)%i.retargetInterval!=0){if(i.targetReset){if(t>e.time+2*i.targetSpacing)return{target:i.bits};for(;0!==e.height&&e.height%i.retargetInterval!=0&&e.bits===i.bits;){e=this.getPrevCache(e)||await this.getPrevious(e),r(e)}}return{target:e.bits}}const s=e.height-(i.retargetInterval-1);r(s>=0);const n=await this.getAncestor(e,s);return r(n),this.retarget(e,n)}retarget(t,e){const i=this.network.pow;let r=a.getEpoch(t.height),s={target:t.bits,amount:r.amount,period:r.period};if(!i.noRetargeting){const r=i.targetTimespan,n=a.compact2BN(t.bits);let o=t.time-e.time;o<r/4|0&&(o=r/4|0),o>4*r&&(o=4*r),n.imuln(o),n.idivn(r),n.gt(i.limit)?s.target=i.bits:s.target=a.bn2Compact(n)}return s}async findLocator(t){for(const e of t)if(await this.isMainHash(e))return e;return this.network.genesis.hash}async isActive(t,e){return await this.getState(t,e)===k.ACTIVE}async getState(t,e){const i=e.bit;let s=this.network.minerWindow,n=this.network.activationThreshold;if(-1!==e.threshold&&(n=e.threshold),-1!==e.window&&(s=e.window),(t.height+1)%s!=0){const e=t.height-(t.height+1)%s;if(!(t=await this.getAncestor(t,e)))return k.DEFINED;r(t.height===e),r((t.height+1)%s==0)}let o=t,a=k.DEFINED;const h=[];for(;o;){const t=this.db.stateCache.get(i,o);if(-1!==t){a=t;break}if(await this.getMedianTime(o)<e.startTime){a=k.DEFINED,this.db.stateCache.set(i,o,a);break}h.push(o);const r=o.height-s;o=await this.getAncestor(o,r)}for(;h.length;){const t=h.pop();switch(a){case k.DEFINED:{const i=await this.getMedianTime(t);if(i>=e.timeout){a=k.FAILED;break}if(i>=e.startTime){a=k.STARTED;break}break}case k.STARTED:{if(await this.getMedianTime(t)>=e.timeout){a=k.FAILED;break}let o=t,h=0;for(let t=0;t<s;t++){if(o.hasBit(i)&&h++,h>=n){a=k.LOCKED_IN;break}o=await this.getPrevious(o),r(o)}break}case k.LOCKED_IN:a=k.ACTIVE;break;case k.FAILED:case k.ACTIVE:break;default:r(!1,"Bad state.")}this.db.stateCache.set(i,t,a)}return a}async computeBlockVersion(t){let e=0;for(const i of this.network.deploys){const r=await this.getState(t,i);r!==k.LOCKED_IN&&r!==k.STARTED||(e|=1<<i.bit)}return(e|=a.VERSION_TOP_BITS)>>>0}async getDeploymentState(){const t=await this.getPrevious(this.tip);return t?this.options.spv?this.state:await this.getDeployments(this.tip.time,t):(r(this.tip.isGenesis()),this.state)}async verifyFinal(t,e,i){const r=t.height+1;if(e.locktime<a.LOCKTIME_THRESHOLD)return e.isFinal(r,-1);if(i&o.lockFlags.MEDIAN_TIME_PAST){const i=await this.getMedianTime(t);return e.isFinal(r,i)}return e.isFinal(r,this.network.now())}async getLocks(t,e,i,s){const n=a.SEQUENCE_GRANULARITY,h=a.SEQUENCE_DISABLE_FLAG,c=a.SEQUENCE_TYPE_FLAG,u=a.SEQUENCE_MASK;if(!(s&o.lockFlags.VERIFY_SEQUENCE))return[-1,-1];if(e.isCoinbase()||e.version<2)return[-1,-1];let l=-1,f=-1;for(const{prevout:s,sequence:o}of e.inputs){if(o&h)continue;let e=i.getHeight(s);if(-1===e&&(e=this.height+1),!(o&c)){e+=(o&u)-1,l=Math.max(l,e);continue}e=Math.max(e-1,0);const a=await this.getAncestor(t,e);r(a,"Database is corrupt.");let d=await this.getMedianTime(a);d+=((o&u)<<n)-1,f=Math.max(f,d)}return[l,f]}async verifyLocks(t,e,i,r){const[s,n]=await this.getLocks(t,e,i,r);return!(-1!==s&&s>=t.height+1)&&!(-1!==n&&n>=await this.getMedianTime(t))}}function R(t,e){return t-e}E.MEDIAN_TIMESPAN=11,t.exports=E},function(t,e,i){"use strict";(function(e){
/*!
 * private.js - hd private keys for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(9),o=i(120),a=i(93),h=i(30),c=i(16),u=i(6),l=i(2),f=i(56),d=i(4),p=i(201),g=i(358),m=i(405),w=e.from("Bitcoin seed","ascii");function y(t){if(!(this instanceof y))return new y(t);this.network=c.primary,this.depth=0,this.parentFingerPrint=0,this.childIndex=0,this.chainCode=d.ZERO_HASH,this.privateKey=d.ZERO_HASH,this.publicKey=d.ZERO_KEY,this.fingerPrint=-1,this._xprivkey=null,this._hdPublicKey=null,t&&this.fromOptions(t)}y.prototype.getHMAC=async function(t,i){let r=this.deriveAccount(44,0).derive(0).derive(t);(i=i||{id:"primary"}).cid=t,i.pubkey=r.publicKey.toString("hex"),i.time=s.now()/3600|0;let o=n.hash256(e.from(s.stringify(i))),a=h.sign(o,r.privateKey).toString("hex");return{token:i.pubkey,random:a}},y.prototype.fromOptions=function(t){return r(t,"No options for HD private key."),r(s.isU8(t.depth)),r(s.isU32(t.parentFingerPrint)),r(s.isU32(t.childIndex)),r(e.isBuffer(t.chainCode)),r(e.isBuffer(t.privateKey)),t.network&&(this.network=c.get(t.network)),this.depth=t.depth,this.parentFingerPrint=t.parentFingerPrint,this.childIndex=t.childIndex,this.chainCode=t.chainCode,this.privateKey=t.privateKey,this.publicKey=h.publicKeyCreate(t.privateKey,!0),this},y.fromOptions=function(t){return(new y).fromOptions(t)},y.prototype.toPublic=function(){let t=this._hdPublicKey;return t||((t=new m).network=this.network,t.depth=this.depth,t.parentFingerPrint=this.parentFingerPrint,t.childIndex=this.childIndex,t.chainCode=this.chainCode,t.publicKey=this.publicKey,this._hdPublicKey=t),t},y.prototype.xprivkey=function(){return this._xprivkey||(this._xprivkey=this.toBase58()),this._xprivkey},y.prototype.xpubkey=function(){return this.toPublic().xpubkey()},y.prototype.destroy=function(t){this.depth=0,this.childIndex=0,this.parentFingerPrint=0,o(this.chainCode),o(this.privateKey),o(this.publicKey),this.fingerPrint=-1,this._hdPublicKey&&(t&&this._hdPublicKey.destroy(),this._hdPublicKey=null),this._xprivkey=null},y.prototype.derive=function(t,e){if(r("number"==typeof t),t>>>0!==t)throw new Error("Index out of range.");if(this.depth>=255)throw new Error("Depth too high.");e&&(t|=p.HARDENED,t>>>=0);const i=this.getID(t),s=p.cache.get(i);if(s)return s;const o=u.pool(37);t&p.HARDENED?(o.writeU8(0),o.writeBytes(this.privateKey),o.writeU32BE(t)):(o.writeBytes(this.publicKey),o.writeU32BE(t));const a=o.render(),c=n.hmac("sha512",a,this.chainCode),l=c.slice(0,32),f=c.slice(32,64);let d;try{d=h.privateKeyTweakAdd(this.privateKey,l)}catch(e){return this.derive(t+1)}if(-1===this.fingerPrint){const t=n.hash160(this.publicKey);this.fingerPrint=t.readUInt32BE(0,!0)}const g=new y;return g.network=this.network,g.depth=this.depth+1,g.parentFingerPrint=this.fingerPrint,g.childIndex=t,g.chainCode=f,g.privateKey=d,g.publicKey=h.publicKeyCreate(d,!0),p.cache.set(i,g),g},y.prototype.getID=function(t){return this.network.keyPrefix.xprivkey58+this.publicKey.toString("hex")+t},y.prototype.deriveAccount=function(t,e){return r(s.isU32(t),"Purpose must be a number."),r(s.isU32(e),"Account index must be a number."),r(this.isMaster(),"Cannot derive account index."),this.derive(t,!0).derive(this.network.keyPrefix.coinType,!0).derive(e,!0)},y.prototype.isMaster=function(){return p.isMaster(this)},y.prototype.isAccount=function(t){return p.isAccount(this,t)},y.isBase58=function(t,e){if("string"!=typeof t)return!1;if(t.length<4)return!1;const i=t.substring(0,4);try{return c.fromPrivate58(i,e),!0}catch(t){return!1}},y.isRaw=function(t,i){if(!e.isBuffer(t))return!1;if(t.length<4)return!1;const r=t.readUInt32BE(0,!0);try{return c.fromPrivate(r,i),!0}catch(t){return!1}},y.isValidPath=function(t){try{return p.parsePath(t,!0),!0}catch(t){return!1}},y.prototype.derivePath=function(t){const e=p.parsePath(t,!0);let i=this;for(const t of e)i=i.derive(t);return i},y.prototype.equals=function(t){return r(y.isHDPrivateKey(t)),this.network===t.network&&this.depth===t.depth&&this.parentFingerPrint===t.parentFingerPrint&&this.childIndex===t.childIndex&&this.chainCode.equals(t.chainCode)&&this.privateKey.equals(t.privateKey)},y.prototype.compare=function(t){r(y.isHDPrivateKey(t));let e=this.depth-t.depth;return 0!==e?e:0!=(e=this.parentFingerPrint-t.parentFingerPrint)?e:0!=(e=this.childIndex-t.childIndex)?e:0!==(e=this.chainCode.compare(t.chainCode))?e:0!==(e=this.privateKey.compare(t.privateKey))?e:0},y.prototype.fromSeed=function(t,i){if(r(e.isBuffer(t)),8*t.length<p.MIN_ENTROPY||8*t.length>p.MAX_ENTROPY)throw new Error("Entropy not in range.");const s=n.hmac("sha512",t,w),o=s.slice(0,32),a=s.slice(32,64);if(!h.privateKeyVerify(o))throw new Error("Master private key is invalid.");return this.network=c.get(i),this.depth=0,this.parentFingerPrint=0,this.childIndex=0,this.chainCode=a,this.privateKey=o,this.publicKey=h.publicKeyCreate(o,!0),this},y.fromSeed=function(t,e){return(new y).fromSeed(t,e)},y.prototype.fromMnemonic=function(t,e){return r(t instanceof g),this.fromSeed(t.toSeed(),e)},y.fromMnemonic=function(t,e){return(new y).fromMnemonic(t,e)},y.prototype.fromPhrase=function(t,e){const i=g.fromPhrase(t);return this.fromMnemonic(i,e),this},y.fromPhrase=function(t,e){return(new y).fromPhrase(t,e)},y.prototype.fromKey=function(t,i,s){return r(e.isBuffer(t)&&32===t.length),r(e.isBuffer(i)&&32===i.length),this.network=c.get(s),this.depth=0,this.parentFingerPrint=0,this.childIndex=0,this.chainCode=i,this.privateKey=t,this.publicKey=h.publicKeyCreate(t,!0),this},y.fromKey=function(t,e,i){return(new y).fromKey(t,e,i)},y.generate=function(t){const e=h.generatePrivateKey(),i=a.randomBytes(32);return y.fromKey(e,i,t)},y.prototype.fromBase58=function(t,e){return r("string"==typeof t),this._xprivkey=t,this.fromRaw(f.decode(t),e)},y.prototype.fromReader=function(t,e){const i=t.readU32BE();return this.network=c.fromPrivate(i,e),this.depth=t.readU8(),this.parentFingerPrint=t.readU32BE(),this.childIndex=t.readU32BE(),this.chainCode=t.readBytes(32),r(0===t.readU8()),this.privateKey=t.readBytes(32),this.publicKey=h.publicKeyCreate(this.privateKey,!0),t.verifyChecksum(),this},y.prototype.fromRaw=function(t,e){return this.fromReader(new l(t),e)},y.prototype.toBase58=function(t){return f.encode(this.toRaw(t))},y.prototype.getSize=function(){return 82},y.prototype.toWriter=function(t,e){return e||(e=this.network),e=c.get(e),t.writeU32BE(e.keyPrefix.xprivkey),t.writeU8(this.depth),t.writeU32BE(this.parentFingerPrint),t.writeU32BE(this.childIndex),t.writeBytes(this.chainCode),t.writeU8(0),t.writeBytes(this.privateKey),t.writeChecksum(),t},y.prototype.toRaw=function(t){return this.toWriter(new u(82),t).render()},y.fromBase58=function(t,e){return(new y).fromBase58(t,e)},y.fromReader=function(t,e){return(new y).fromReader(t,e)},y.fromRaw=function(t,e){return(new y).fromRaw(t,e)},y.prototype.toJSON=function(){return{xprivkey:this.xprivkey()}},y.prototype.fromJSON=function(t,e){return r(t.xprivkey,"Could not handle key JSON."),this.fromBase58(t.xprivkey,e),this},y.fromJSON=function(t,e){return(new y).fromJSON(t,e)},y.isHDPrivateKey=function(t){return t instanceof y},t.exports=y}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * validator.js - validator for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3);class n extends Error{constructor(t,e){super(),this.type="ValidationError",this.message=`${function(t){return Array.isArray(t)&&(t=t[0]),"number"==typeof t?`Param #${t}`:t}(t)} must be a ${e}.`,Error.captureStackTrace&&Error.captureStackTrace(this,n)}}t.exports=class{constructor(t){this.data=[],t&&this.init(t)}init(t){r(t&&"object"==typeof t),Array.isArray(t)||(t=[t]),this.data=t.map(t=>Array.isArray(t)?t.map(t=>t&&t.constructor==String?t.replace(/\'/g,'"'):t):t&&t.constructor==String?t.replace(/\'/g,'"'):t)}has(t){r("string"==typeof t||"number"==typeof t,"Key must be a string or number.");for(const e of this.data)if(null!=e[t])return!0;return!1}get(t,e){if(void 0===e&&(e=null),Array.isArray(t)){const i=t;for(const t of i){const e=this.get(t);if(null!==e)return e}return e}r("string"==typeof t||"number"==typeof t,"Key must be a string or number.");for(const e of this.data){if(!e||"object"!=typeof e)throw new n("data","object");const i=e[t];if(null!=i)return i}return e}typeOf(t){const e=this.get(t);return null==e?"null":typeof e}str(t,e){let i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("number"==typeof i&&(i=String(i)),"string"!=typeof i)throw new n(t,"number");return i}int(t,e){let i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if("number"!=typeof i)throw new n(t,"int");if(!Number.isSafeInteger(i))throw new n(t,"int");return i}if(!/^\-?\d+$/.test(i))throw new n(t,"int");if(i=parseInt(i,10),!Number.isSafeInteger(i))throw new n(t,"int");return i}uint(t,e){const i=this.int(t);if(void 0===e&&(e=null),null===i)return e;if(i<0)throw new n(t,"uint");return i}float(t,e){let i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if("number"!=typeof i)throw new n(t,"float");if(!isFinite(i))throw new n(t,"float");return i}if(!/^\-?\d*(?:\.\d*)?$/.test(i))throw new n(t,"float");if(!/\d/.test(i))throw new n(t,"float");if(i=parseFloat(i),!isFinite(i))throw new n(t,"float");return i}ufloat(t,e){const i=this.float(t);if(void 0===e&&(e=null),null===i)return e;if(i<0)throw new n(t,"positive float");return i}fixed(t,e,i){const r=this.float(t);if(void 0===i&&(i=null),null===r)return i;try{return s.fromFloat(r,e||0)}catch(e){throw new n(t,"fixed number")}}ufixed(t,e,i){const r=this.fixed(t,e);if(void 0===i&&(i=null),null===r)return i;if(r<0)throw new n(t,"positive fixed number");return r}i8(t,e){const i=this.int(t);if(void 0===e&&(e=null),null===i)return e;if(i<-128||i>127)throw new n(t,"i8");return i}i16(t,e){const i=this.int(t);if(void 0===e&&(e=null),null===i)return e;if(i<-32768||i>32767)throw new n(t,"i16");return i}i32(t,e){const i=this.int(t);if(void 0===e&&(e=null),null===i)return e;if((0|i)!==i)throw new n(t,"int32");return i}i64(t,e){return this.int(t,e)}u8(t,e){const i=this.uint(t);if(void 0===e&&(e=null),null===i)return e;if((255&i)!==i)throw new n(t,"uint8");return i}u16(t,e){const i=this.uint(t);if(void 0===e&&(e=null),null===i)return e;if((65535&i)!==i)throw new n(t,"uint16");return i}u32(t,e){const i=this.uint(t);if(void 0===e&&(e=null),null===i)return e;if(i>>>0!==i)throw new n(t,"uint32");return i}u64(t,e){return this.uint(t,e)}hash(t,i){const r=this.get(t);if(void 0===i&&(i=null),null===r)return i;if("string"!=typeof r){if(!e.isBuffer(r))throw new n(t,"hash");if(32!==r.length)throw new n(t,"hash");return r.toString("hex")}if(64!==r.length)throw new n(t,"hex string");if(!/^[0-9a-f]+$/i.test(r))throw new n(t,"hex string");let s="";for(let t=0;t<r.length;t+=2)s=r.slice(t,t+2)+s;return s}numhash(t,e){return"string"===this.typeOf(t)?this.hash(t,e):this.uint(t,e)}bool(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("number"==typeof i){if(1===i)return!0;if(0===i)return!1}if("string"!=typeof i){if("boolean"!=typeof i)throw new n(t,"boolean");return i}if("true"===i||"1"===i)return!0;if("false"===i||"0"===i)return!1;throw new n(t,"boolean")}buf(t,i,r){const s=this.get(t);if(r||(r="hex"),void 0===i&&(i=null),null===s)return i;if("string"!=typeof s){if(!e.isBuffer(s))throw new n(t,"buffer");return s}const o=e.from(s,r);if(o.length!==e.byteLength(s,r))throw new n(t,`${r} string`);return o}array(t,e){let i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if(!Array.isArray(i))throw new n(t,"list/array");return i}try{let e=JSON.parse(i);if(Array.isArray(e))return e}catch(t){console.log(t)}const r=i.trim().split(/\s*,\s*/),s=[];for(const t of r)0!==t.length&&s.push(t);return s}obj(t,e){let i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if(i.constructor==String)try{i=JSON.parse(i)}catch(e){throw new n(t,"object")}if("object"!=typeof i)throw new n(t,"object");return i}func(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("function"!=typeof i)throw new n(t,"function");return i}}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * node.js - node object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(59),n=i(3),o=i(16),a=i(45),h=i(116),c=i(30),u=i(361),l=i(508),f=i(4),d=i(148),p=i(112),{hashInt:g,stringify:m}=i(3),w=i(178),y=(i(177),i(407));t.exports=class extends s{constructor(t){super(),this.spv=!1,this.config=new u("gamegold"),this.config.inject(t),this.config.load(t),this.conn_s2local=null,t.config&&this.config.open("gamegold.conf"),this.network=o.get(this.config.network),this.startTime=-1,this.bound=[],this.plugins=Object.create(null),this.stack=[],this.logger=null,this.workers=null,this.chain=null,this.fees=null,this.mempool=null,this.pool=null,this.miner=null,this.http=null,this.conn_s2local=new l(this),this.hmacSalt=this.config.buf("hmac-salt")||f.DefaultChainCode,this.devMode=this.config.bool("dev-mode")||!1,this.hmacConnection=this.config.array("hmac-connection")||[],this.acl=new y(this.config),this.init()}async removeTX(t){return Promise.resolve()}async getTXFromAll(t){let e=null;if(this.chain&&(e=await this.chain.getTX(t)),e||this.mempool&&(e=await this.mempool.getTX(t)),!e){const i=this.require("walletdb");i&&(e=await i.getTXFromDb(t))}return e}initOptions(){let t=new a;const e=this.config;e.has("logger")&&(t=e.obj("logger")),t.set({filename:e.bool("log-file")?e.location("debug.log"):null,level:e.str("log-level"),console:e.bool("log-console"),shrink:e.bool("log-shrink")}),this.logger=t.context("node"),this.workers=new h({enabled:e.bool("workers"),size:e.uint("workers-size"),timeout:e.uint("workers-timeout"),file:e.str("worker-file")})}init(){this.initOptions(),this.on("error",()=>{}),this.workers.on("spawn",t=>{this.logger.info("Spawning worker process: %d.",t.id)}),this.workers.on("exit",(t,e)=>{this.logger.warning("Worker %d exited: %s.",e.id,t)}),this.workers.on("log",(t,e)=>{this.logger.debug("Worker %d says:",e.id),this.logger.debug(t)}),this.workers.on("error",(t,e)=>{e?this.logger.error("Worker %d error: %s",e.id,t.message):this.emit("error",t)}),this.hook("preopen",()=>this.handlePreopen()),this.hook("preclose",()=>this.handlePreclose()),this.hook("open",()=>this.handleOpen()),this.hook("close",()=>this.handleClose()),this.on("contract.order.add",t=>{let e=this.getCpItem(t.cid);e&&(t.confirm=0,this.notifyCp(t,e))}),this.on("contract.order.remove",t=>{}),this.on("contract.order.confirm",t=>{let e=this.getCpItem(t.cid);e&&this.notifyCp(t,e)}),this.on("contract.order.unconfirm",t=>{let e=this.getCpItem(t.cid);e&&this.notifyCp(t,e)})}async notifyCp(t,e){if(-1!=this.hmacConnection.indexOf(t.cid)){let{token:i}=await w.fromKey(f.ONE_HASH,this.hmacSalt).getHMAC(g(t.cid.toString())),r=d.createHmac("sha256",m(t)).update(i).digest("hex"),s=e.url;0!=s.indexOf("http://")&&0!=s.indexOf("https://")&&(s=`http://${s}`),new p(`${s}/${this.network.type}`).Post("order/confirm",{data:t,sig:r},(t,e)=>{})}}ensure(){return this.config.ensure()}async relay(t){return Promise.resolve()}location(t){return this.config.location(t)}async handlePreopen(){await this.logger.open(),await this.workers.open(),this.bind(this.network.time,"offset",t=>{this.logger.info("Time offset: %d (%d minutes).",t,t/60|0)}),this.bind(this.network.time,"sample",(t,e)=>{this.logger.debug("Added time data: samples=%d, offset=%d (%d minutes).",e,t,t/60|0)}),this.bind(this.network.time,"mismatch",()=>{this.logger.warning("Adjusted time mismatch!"),this.logger.warning("Please make sure your system clock is correct!")})}async handleOpen(){this.startTime=n.now(),c.binding||(this.logger.warning("Warning: secp256k1-node was not built."),this.logger.warning("Verification will be slow.")),this.workers.enabled||(this.logger.warning("Warning: worker pool is disabled."),this.logger.warning("Verification will be slow."))}async handlePreclose(){}async handleClose(){for(const[t,e,i]of this.bound)t.removeListener(e,i);this.bound.length=0,this.startTime=-1,await this.workers.close(),await this.logger.close()}bind(t,e,i){this.bound.push([t,e,i]),t.on(e,i)}error(t){this.logger.error(t),this.emit("error",t)}uptime(){return-1===this.startTime?0:n.now()-this.startTime}use(t){r(t,"Plugin must be an object."),r("function"==typeof t.init,"`init` must be a function."),r(!this.loaded,"Cannot add plugin after node is loaded.");const e=t.init(this,this.conn_s2local);if(r(!e.open||"function"==typeof e.open,"`open` must be a function."),r(!e.close||"function"==typeof e.close,"`close` must be a function."),t.id){switch(r("string"==typeof t.id,"`id` must be a string."),t.id){case"chain":case"fees":case"mempool":case"miner":case"pool":case"rpc":case"http":r(!1,`${t.id} is already added.`)}r(!this.plugins[t.id],`${t.id} is already added.`),this.plugins[t.id]=e}return this.stack.push(e),"function"==typeof e.on&&e.on("error",t=>this.error(t)),e}has(t){return null!=this.plugins[t]}get(t){switch(r("string"==typeof t,"Plugin name must be a string."),t){case"chain":return r(this.chain,"chain is not loaded."),this.chain;case"fees":return r(this.fees,"fees is not loaded."),this.fees;case"mempool":return r(this.mempool,"mempool is not loaded."),this.mempool;case"miner":return r(this.miner,"miner is not loaded."),this.miner;case"pool":return r(this.pool,"pool is not loaded."),this.pool;case"rpc":return r(this.rpc,"rpc is not loaded."),this.rpc;case"http":return r(this.http,"http is not loaded."),this.http}return this.plugins[t]||null}require(t){const e=this.get(t);return r(e,`${t} is not loaded.`),e}loadPlugins(){const t=this.config.array("plugins",[]),e=this.config.func("loader");for(let i of t)"string"==typeof i&&(r(e,"Must pass a loader function."),i=e(i)),this.use(i)}async $remoteCall(t,e,i){const r=this.require("walletdb");return r?await r.jsonp.execute(t.name,e,i):null}async $localCall(t,e,i){return await t.callback(this,e,i)}async openPlugins(){for(const t of this.stack)t.open&&await t.open()}async closePlugins(){for(const t of this.stack)t.close&&await t.close()}async readHostList(){return await this.chain.db.readHostList()}writeHostList(t){return this.chain.db.writeHostList(t)}}},function(t,e){t.exports=class{constructor(t){this._subscriptions={},this.prefix=t||""}subscribe(t,e){this._subscriptions[t]||(this._subscriptions[t]=[]),this._subscriptions[t].push(e),console.log(e.remoteAddress,"subscribe:",this.prefix+"/"+t,"total:",this._subscriptions[t].length)}unsubscribe(t,e){if(this._subscriptions[t]){var i=this._subscriptions[t].indexOf(e);i>-1&&this._subscriptions[t].splice(i,1),console.log(e.remoteAddress,"unsubscribe:",this.prefix+"/"+t,"total:",this._subscriptions[t].length)}}broadcast(t,e){if(this._subscriptions[t])for(var i=0;i<this._subscriptions[t].length;i++)this._subscriptions[t][i].emit(`${this.prefix}/${t}`,e)}}},function(t,e,i){"use strict";
/*!
 * mempoolentry.js - mempool entry object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(33),s=i(3),n=i(20),o=i(2),a=i(6),h=i(17);i(44);class c{constructor(t){this.tx=null,this.height=-1,this.size=0,this.sigops=0,this.priority=0,this.fee=0,this.deltaFee=0,this.time=0,this.value=0,this.coinbase=!1,this.dependencies=!1,this.descFee=0,this.descSize=0,t&&this.fromOptions(t)}fromOptions(t){return this.tx=t.tx,this.height=t.height,this.size=t.size,this.sigops=t.sigops,this.priority=t.priority,this.fee=t.fee,this.deltaFee=t.deltaFee,this.time=t.time,this.value=t.value,this.coinbase=t.coinbase,this.dependencies=t.dependencies,this.descFee=t.descFee,this.descSize=t.descSize,this}static fromOptions(t){return(new c).fromOptions(t)}fromTX(t,e,i){const r=n.flags.STANDARD_VERIFY_FLAGS,o=t.getChainValue(e),a=t.getSigopsCost(e,r),h=t.getSigopsSize(a),c=t.getPriority(e,i,h),u=t.getFee(e);let l=!1,f=!1;for(const{prevout:i}of t.inputs)e.isCoinbase(i)&&(f=!0),-1===e.getHeight(i)&&(l=!0);return this.tx=t,this.height=i,this.size=h,this.sigops=a,this.priority=c,this.fee=u,this.deltaFee=u,this.time=s.now(),this.value=o,this.coinbase=f,this.dependencies=l,this.descFee=u,this.descSize=h,this}static fromTX(t,e,i){return(new c).fromTX(t,e,i)}hash(t){return this.tx.hash(t)}txid(){return this.tx.txid()}getPriority(t){const e=(t-this.height)*this.value/this.size;return Math.max(0,this.priority+Math.floor(e))}getFee(){return this.fee}getDeltaFee(){return this.deltaFee}getRate(){return r.getRate(this.size,this.fee)}getDeltaRate(){return r.getRate(this.size,this.deltaFee)}getDescRate(){return r.getRate(this.descSize,this.descFee)}memUsage(){const t=this.tx;let e=0;e+=176,e+=48,e+=48,e+=208,e+=80,e+=88,e+=80,e+=80,e+=48,e+=32;for(const i of t.inputs){e+=120,e+=104,e+=88,e+=40,e+=80,e+=32,e+=40*i.script.code.length;for(const t of i.script.code)t.data&&(e+=80);e+=96,e+=32,e+=80*i.witness.items.length}e+=32;for(const i of t.outputs){e+=104,e+=40,e+=80,e+=32,e+=40*i.script.code.length;for(const t of i.script.code)t.data&&(e+=80)}return e}isFree(t){return this.getPriority(t)>r.FREE_THRESHOLD}getSize(){return this.tx.getSize()+42}toRaw(){const t=new a(this.getSize());return t.writeBytes(this.tx.toRaw()),t.writeU32(this.height),t.writeU32(this.size),t.writeU32(this.sigops),t.writeDouble(this.priority),t.writeU64(this.fee),t.writeU32(this.time),t.writeU64(this.value),t.writeU8(this.coinbase?1:0),t.writeU8(this.dependencies?1:0),t.render()}fromRaw(t){const e=new o(t);return this.tx=h.fromReader(e),this.height=e.readU32(),this.size=e.readU32(),this.sigops=e.readU32(),this.priority=e.readDouble(),this.fee=e.readU64(),this.time=e.readU32(),this.value=e.readU64(),this.coinbase=1===e.readU8(),this.dependencies=1===e.readU8(),this.deltaFee=this.fee,this.descFee=this.fee,this.descSize=this.size,this}static fromRaw(t){return(new c).fromRaw(t)}}t.exports=c},function(t,e,i){"use strict";
/*!
 * dns.js - dns backend for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.resolve=function(t,e){return new Promise((t,e)=>{e(new Error("DNS not supported."))})},e.lookup=function(t,e){return new Promise((t,e)=>{e(new Error("DNS not supported."))})}},function(t,e,i){"use strict";(function(t){
/*!
 * bip152.js - compact block object for gamegold
 * related: TXRequest.js TXResponse.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(2),o=i(6),a=i(4),h=i(10),c=i(9),u=i(357).siphash256,l=i(110),f=i(17),d=i(69),p=i(52),g=i(414);i(368);class m extends l{constructor(t){super(),this.keyNonce=null,this.ids=[],this.ptx=[],this.available=[],this.idMap=new Map,this.count=0,this.sipKey=null,this.totalTX=0,this.now=0,t&&this.fromOptions(t)}fromOptions(e){return this.parseOptions(e),r(t.isBuffer(e.keyNonce)),r(Array.isArray(e.ids)),r(Array.isArray(e.ptx)),this.keyNonce=e.keyNonce,this.ids=e.ids,this.ptx=e.ptx,e.available&&(this.available=e.available),e.idMap&&(this.idMap=e.idMap),e.count&&(this.count=e.count),null!=e.totalTX&&(this.totalTX=e.totalTX),this.sipKey=this.getKey(),this}static fromOptions(t){return(new m).fromOptions(t)}verifyBody(){return!0}fromRaw(t){const e=new n(t);this.readHead(e),this.keyNonce=e.readBytes(8),this.sipKey=this.getKey();const i=e.readVarint();this.totalTX+=i;for(let t=0;t<i;t++){const t=e.readU32(),i=e.readU16();this.ids.push(4294967296*i+t)}const s=e.readVarint();this.totalTX+=s;for(let t=0;t<s;t++){const t=e.readVarint();r(t<=65535),r(t<this.totalTX);const i=f.fromReader(e);this.ptx.push([t,i])}return this}static fromRaw(e,i){return"string"==typeof e&&(e=t.from(e,i)),(new m).fromRaw(e)}toRaw(){return this.frameRaw(!0)}toNormal(){return this.frameRaw(!1)}toWriter(t){return this.writeRaw(t,!0)}toNormalWriter(t){return this.writeRaw(t,!1)}frameRaw(t){const e=this.getSize(t);return this.writeRaw(new o(e),t).render()}getSize(t){let e=0;e+=80,e+=8,e+=a.sizeVarint(this.ids.length),e+=6*this.ids.length,e+=a.sizeVarint(this.ptx.length);for(const[i,r]of this.ptx)e+=a.sizeVarint(i),e+=t?r.getSize():r.getBaseSize();return e}writeRaw(t,e){this.writeHead(t),t.writeBytes(this.keyNonce),t.writeVarint(this.ids.length);for(const e of this.ids){const i=e%4294967296,s=(e-i)/4294967296;r(s<=65535),t.writeU32(i),t.writeU16(s)}t.writeVarint(this.ptx.length);for(const[i,r]of this.ptx)t.writeVarint(i),e?r.toWriter(t):r.toNormalWriter(t);return t}toRequest(){return g.fromCompact(this)}fillMempool(t,e){if(this.count===this.totalTX)return!0;const i=new Set;for(const{tx:r}of e.map.values()){let e=r.hash();t&&(e=r.witnessHash());const s=this.sid(e),n=this.idMap.get(s);if(null!=n)if(i.has(n))this.available[n]=null,this.count--;else if(this.available[n]=r,i.add(n),this.count++,this.count===this.totalTX)return!0}return!1}fillMissing(t){let e=0;for(let i=0;i<this.available.length;i++)if(!this.available[i]){if(e>=t.txs.length)return!1;this.available[i]=t.txs[e++]}return e===t.txs.length}sid(e){"string"==typeof e&&(e=t.from(e,"hex"));const[i,r]=u(e,this.sipKey);return 4294967296*(65535&i)+(r>>>0)}hasIndex(t){return null!=this.available[t]}getKey(){const e=t.concat([this.toHead(),this.keyNonce]);return c.sha256(e).slice(0,16)}init(){if(0===this.totalTX)throw new Error("Empty vectors.");if(this.totalTX>h.MAX_BLOCK_SIZE/10)throw new Error("Compact block too big.");if(this.totalTX>(h.MAX_BLOCK_SIZE-81)/60)throw new Error("Compact block too big.");for(let t=0;t<this.totalTX;t++)this.available.push(null);let t=-1,e=0;for(let e=0;e<this.ptx.length;e++){const[i,s]=this.ptx[e];r((t+=i+1)<=65535),r(t<=this.ids.length+e),this.available[t]=s,this.count++}for(let t=0;t<this.ids.length;t++){const i=this.ids[t];for(;this.available[t+e];)e++;if(this.idMap.has(i))return!1;this.idMap.set(i,t+e)}return!0}toBlock(){const t=new p;t.version=this.version,t.prevBlock=this.prevBlock,t.merkleRoot=this.merkleRoot,t.time=this.time,t.bits=this.bits,t.nonce=this.nonce,t._hash=this._hash,t._hhash=this._hhash;for(const e of this.available)r(e,"Compact block is not full."),t.txs.push(e);return t}fromBlock(t,e,i){this.version=t.version,this.prevBlock=t.prevBlock,this.merkleRoot=t.merkleRoot,this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,this.totalTX=t.txs.length,this._hash=t._hash,this._hhash=t._hhash,i||(i=s.nonce()),this.keyNonce=i,this.sipKey=this.getKey();for(let i=1;i<t.txs.length;i++){const r=t.txs[i];let s=r.hash();e&&(s=r.witnessHash());const n=this.sid(s);this.ids.push(n)}return this.ptx.push([0,t.txs[0]]),this}static fromBlock(t,e,i){return(new m).fromBlock(t,e,i)}toHeaders(){return d.fromBlock(this)}}e.CompactBlock=m}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * tcp-cordova.js - 微端节点的通讯端封装
 */const r=i(1),s=i(529),n=i(24),o=e;o.createSocket=function(t,e,i){return r(i),s.connect(`http://${e}:${i.wsport}`,t,e)},o.createServer=function(){const t=new n;return t.listen=async function(e,i){t.emit("listening")},t.close=async function(){},t.address=function(){return{address:"127.0.0.1",port:0}},t.maxConnections=void 0,t}},function(t,e,i){"use strict";
/*!
 * list.js - double linked list for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1);function s(){if(!(this instanceof s))return new s;this.head=null,this.tail=null,this.size=0}i(552),s.prototype.reset=function(){let t,e;for(t=this.head;t;t=e)e=t.next,t.prev=null,t.next=null;r(!t),this.head=null,this.tail=null,this.size=0},s.prototype.shift=function(){const t=this.head;return t?(this.remove(t),t):null},s.prototype.unshift=function(t){return this.insert(null,t)},s.prototype.push=function(t){return this.insert(this.tail,t)},s.prototype.pop=function(){const t=this.tail;return t?(this.remove(t),t):null},s.prototype.insert=function(t,e){return!(e.prev||e.next||e===this.head||(r(!e.prev),r(!e.next),null==t?(this.head?(this.head.prev=e,e.next=this.head,this.head=e):(this.head=e,this.tail=e),this.size++,0):(e.next=t.next,e.prev=t,t.next=e,t===this.tail&&(this.tail=e),this.size++,0)))},s.prototype.remove=function(t){return!(!t.prev&&!t.next&&t!==this.head||(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev||this.head),this.head||r(!this.tail),this.tail||r(!this.head),t.prev=null,t.next=null,this.size--,0))},s.prototype.replace=function(t,e){t.prev&&(t.prev.next=e),t.next&&(t.next.prev=e),e.prev=t.prev,e.next=t.next,t.next=null,t.prev=null,this.head===t&&(this.head=e),this.tail===t&&(this.tail=e)},s.prototype.slice=function(t){const e=[];let i,r;for(null==t&&(t=-1),i=this.head;i&&(r=i.next,i.prev=null,i.next=null,this.size--,e.push(i),e.length!==t);i=r);return r?(this.head=r,r.prev=null):(this.head=null,this.tail=null),e},s.prototype.toArray=function(){const t=[];for(let e=this.head;e;e=e.next)t.push(e);return t},t.exports=s},function(t,e,i){"use strict";(function(e){
/*!
 * BlockMeta.js - walletdb records
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(3),s=i(4),n=i(2),o=i(6);class a{constructor(t,e,i){this.hash=t||s.NULL_HASH,this.height=null!=e?e:-1,this.time=i||0}clone(){return new a(this.hash,this.height,this.time)}toHash(){return e.from(this.hash,"hex")}fromEntry(t){return this.hash=t.hash,this.height=t.height,this.time=t.time,this}fromJSON(t){return this.hash=r.revHex(t.hash),this.height=t.height,this.time=t.time,this}fromRaw(t){const e=new n(t);return this.hash=e.readHash("hex"),this.height=e.readU32(),this.time=e.readU32(),this}static fromEntry(t){return(new a).fromEntry(t)}static fromJSON(t){return(new a).fromJSON(t)}static fromRaw(t){return(new a).fromRaw(t)}toRaw(){const t=new o(42);return t.writeHash(this.hash),t.writeU32(this.height),t.writeU32(this.time),t.render()}toJSON(){return{hash:r.revHex(this.hash),height:this.height,time:this.time}}}t.exports=a}).call(this,i(0).Buffer)},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){"use strict";(function(t){
/*!
 * bech32.js - bech32 for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 *
 * Parts of this software are based on "bech32".
 * https://github.com/sipa/bech32
 *
 * Copyright (c) 2017 Pieter Wuille
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
const r=i(47).binding,s=t.allocUnsafe(65),n="qpzry9x8gf2tvdw0s3jn54khce6mua7l",o=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,15,-1,10,17,21,20,26,30,7,5,-1,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1];function a(t){const e=t>>>25;return(33554431&t)<<5^996825010&-(e>>0&1)^642813549&-(e>>1&1)^513874426&-(e>>2&1)^1027748829&-(e>>3&1)^705979059&-(e>>4&1)}function h(t,e){let i,r=1;for(i=0;i<t.length;i++){const e=t.charCodeAt(i);if(e>>5==0)throw new Error("Invalid bech32 character.");r=a(r)^e>>5}if(i+7+e.length>90)throw new Error("Invalid bech32 data length.");r=a(r);let s="";for(let e=0;e<t.length;e++){const i=t.charCodeAt(e);r=a(r)^31&i,s+=t[e]}s+="1";for(let t=0;t<e.length;t++){const i=e[t];if(i>>5!=0)throw new Error("Invalid bech32 value.");r=a(r)^i,s+=n[i]}for(let t=0;t<6;t++)r=a(r);r^=1;for(let t=0;t<6;t++)s+=n[r>>>5*(5-t)&31];return s}function c(e){let i=0;if(e.length<8||e.length>90)throw new Error("Invalid bech32 string length.");for(;i<e.length&&"1"!==e[e.length-1-i];)i++;const r=e.length-(1+i);if(r<1||i<6)throw new Error("Invalid bech32 data length.");i-=6;const s=t.allocUnsafe(i);let n,h=1,c=!1,u=!1,l="";for(let t=0;t<r;t++){let i=e.charCodeAt(t);if(i<33||i>126)throw new Error("Invalid bech32 character.");i>=97&&i<=122?c=!0:i>=65&&i<=90&&(u=!0,i=i-65+97),l+=String.fromCharCode(i),h=a(h)^i>>5}for(h=a(h),n=0;n<r;n++)h=a(h)^31&e.charCodeAt(n);for(n++;n<e.length;){const t=e.charCodeAt(n),i=128&t?-1:o[t];if(t>=97&&t<=122?c=!0:t>=65&&t<=90&&(u=!0),-1===i)throw new Error("Invalid bech32 character.");h=a(h)^i,n+6<e.length&&(s[n-(1+r)]=i),n++}if(c&&u)throw new Error("Invalid bech32 casing.");if(1!==h)throw new Error("Invalid bech32 checksum.");return[l,s.slice(0,i)]}function u(t,e,i,r,s,n){const o=(1<<r)-1;let a=0,h=0,c=0;-1!==s&&(e[c++]=s);for(let s=n;s<t.length;s++){const n=t[s];if(n>>i!=0)throw new Error("Invalid bech32 bits.");for(a=a<<i|n,h+=i;h>=r;)h-=r,e[c++]=a>>>h&o}if(-1!==s)h>0&&(e[c++]=a<<r-h&o);else if(h>=i||a<<r-h&o)throw new Error("Invalid bech32 bits.");return e.slice(0,c)}function l(t,e,i){const r=s;if(e<0||e>16)throw new Error("Invalid bech32 version.");if(i.length<2||i.length>40)throw new Error("Invalid bech32 data length.");return h(t,u(i,r,8,5,e,0))}function f(t){const[e,i]=c(t);if(0===i.length||i.length>65)throw new Error("Invalid bech32 data length.");if(i[0]>16)throw new Error("Invalid bech32 version.");const r=i[0],s=u(i,i,5,8,-1,1);if(s.length<2||s.length>40)throw new Error("Invalid bech32 data length.");return new function(t,e,i){this.hrp=t,this.version=e,this.hash=i}(e,r,s)}r&&(l=r.toBech32),r&&(f=r.fromBech32),e.deserialize=c,e.serialize=h,e.convert=u,e.encode=l,e.decode=f}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * chaindb.js - blockchain data management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(3),n=i(2),o=i(6),a=i(31),h=i(4),c=i(16),u=i(44),l=i(137),f=i(138),d=i(143),p=i(98),g=i(52),m=i(37),w=i(26),y=i(144),b=i(193),v=i(88),k=i(486),S=i(194),x=h.U8,E=h.U32,{OrderData:R,operatorType:_,OperType:A}=i(8),I=i(59),O=i(53),C=i(17),P=i(51),B=i(68),T=i(28),N=i(9),M=i(96),U=i(10);class H extends I{constructor(t){super(),this.eid="chaindb",this.options=t,this.node=t.node,this.network=t.network,this.logger=t.logger.context("chaindb"),this.db=f(this.options),this.stateCache=new F(this.network),this.state=new D,this.pending=null,this.current=null,this.coinCache=new p(this.options.coinCache,V),this.cacheHash=new p(this.options.entryCache),this.cacheHeight=new p(this.options.entryCache)}createGenesisCoinbase(t,i){const r=new C,s=new B;s.script.pushInt(0),s.script.pushData(h.ZERO_HASH160);let n=e.allocUnsafe(4);n.writeUInt32LE(0,0,!0),s.script.pushData(n),s.script.pushData(h.ZERO_U64),s.script.compile(),s.witness.push(h.ZERO_HASH),s.witness.compile(),r.inputs.push(s);const o=new T;o.script.createScript(h.ZERO_HASH160),o.value=U.ORIGINAL,r.outputs.push(o);const a=h.ZERO_HASH,c=[];c.push(h.ZERO_HASH);const[u,l]=M.createRoot(c);let f=N.root256(u,a);const d=new T;return d.script.fromCommitment(f),r.outputs.push(d),s.script.setData(1,i),s.script.compile(),o.script.fromAddress(t.addresses[0]),r}dummyInput(){return B.fromOutpoint(new m(h.NULL_HASH,0))}createGenesisBlock(t){if(!t.addresses||t.addresses.length<11)throw new Error("addresses length expect 11.");let i=t.flags;i||(i=e.from("of the user, by the user, and for the user. 群有群治群享","ascii"));const r=this.createGenesisCoinbase(t,i);let n=this.network.bossId;const o=new P;o.addInput(this.dummyInput()),o.cpRegister(t.addresses[0],U.COIN,{cid:n,oper:A.cpRegister,name:"BOSS",url:"920.cc",ip:"*"});let[a,c]=o.commit();const u=new P;u.addInput(this.dummyInput());for(let e=0;e<10;e++)for(let i=0;i<100;i++){let r={oper:A.propCreate,pid:`${this.network.tokenFix}${s.sprintf("%04d",100*e+i+1)}`,oid:`${this.network.tokenFix}${s.sprintf("%04d",100*e+i+1)}`,cid:n,gold:U.COIN};u.propCreate(t.addresses[e+1],r)}let[l,f]=u.commit();const d=new P;for(let e=0;e<10;e++)for(let i=0;i<100;i++){let r=d.addTX(l,100*e+i),o=T.fromScript(t.addresses[e+1],U.COIN,{oper:A.propExchange,pid:`${this.network.tokenFix}${s.sprintf("%04d",100*e+i+1)}`,oid:`${this.network.tokenFix}${s.sprintf("%04d",100*e+i+1)}`,cid:n,prev:{hash:r.prevout.hash,index:r.prevout.index}});d.outputs.push(o)}let[p,m]=d.commit();const w=new g({version:t.version,prevBlock:h.NULL_HASH,merkleRoot:r.hash("hex"),time:t.time,bits:t.bits,nonce:t.nonce,height:0});return w.txs.push(r),w.txs.push(a),w.txs.push(l),w.txs.push(p),w.refresh(!0),w.merkleRoot=w.createMerkleRoot("hex"),w}async open(){this.logger.info("Opening ChainDB..."),await this.db.open();let t=await this.db.checkVersion(d,3);const e=await this.getState();return e?(await this.verifyFlags(e),await this.verifyDeployments(),this.stateCache=await this.getStateCache(),this.state=e,this.logger.info("ChainDB successfully loaded.")):(await this.saveFlags(),await this.saveDeployments(),await this.saveGenesis(),this.logger.info("ChainDB successfully initialized.")),this.logger.info("Chain State: hash=%s tx=%d coin=%d value=%s.",this.state.rhash(),this.state.tx,this.state.coin,a.btc(this.state.value)),t}close(){return this.db.close()}start(){return r(!this.current),r(!this.pending),this.current=this.db.batch(),this.pending=this.state.clone(),this.coinCache.start(),this.cacheHash.start(),this.cacheHeight.start(),this.current}put(t,e){r(this.current),this.current.put(t,e)}del(t){r(this.current),this.current.del(t)}batch(){return r(this.current),this.current}drop(){const t=this.current;r(this.current),r(this.pending),this.current=null,this.pending=null,this.coinCache.drop(),this.cacheHash.drop(),this.cacheHeight.drop(),this.stateCache.drop(),t.clear()}async commit(){r(this.current),r(this.pending);try{await this.current.write()}catch(t){throw this.current=null,this.pending=null,this.coinCache.drop(),this.cacheHash.drop(),this.cacheHeight.drop(),t}this.pending.committed&&(this.state=this.pending),this.current=null,this.pending=null,this.coinCache.commit(),this.cacheHash.commit(),this.cacheHeight.commit(),this.stateCache.commit()}hasCache(t){return"number"==typeof t?this.cacheHeight.has(t):(r("string"==typeof t),this.cacheHash.has(t))}getCache(t){return"number"==typeof t?this.cacheHeight.get(t):(r("string"==typeof t),this.cacheHash.get(t))}async getHeight(t){if("number"==typeof t)return t;if(r("string"==typeof t),t===h.NULL_HASH)return-1;const e=this.cacheHash.get(t);if(e)return e.height;const i=await this.db.get(d.h(t));return i?i.readUInt32LE(0,!0):-1}async getHash(t){if("string"==typeof t)return t;if(r("number"==typeof t),t<0)return null;const e=this.cacheHeight.get(t);if(e)return e.hash;const i=await this.db.get(d.H(t));return i?i.toString("hex"):null}async getEntryByHeight(t){if(r("number"==typeof t),t<0)return null;const e=this.cacheHeight.get(t);if(e)return e;const i=await this.db.get(d.H(t));if(!i)return null;const s=i.toString("hex"),n=this.state,o=await this.getEntryByHash(s);return o?(this.state===n&&this.cacheHeight.set(o.height,o),o):null}async getEntryByHash(t){if(r("string"==typeof t),t===h.NULL_HASH)return null;const e=this.cacheHash.get(t);if(e)return e;const i=await this.db.get(d.e(t));if(!i)return null;const s=y.fromRaw(i);return this.cacheHash.set(s.hash,s),s}getEntry(t){return"number"==typeof t?this.getEntryByHeight(t):this.getEntryByHash(t)}async hasEntry(t){return-1!==await this.getHeight(t)}async getAncestor(t,e){if(e<0)return null;if(r(e>=0),r(e<=t.height),await this.isMainChain(t))return await this.getEntryByHeight(e);for(;t.height!==e;){t=this.getPrevCache(t)||await this.getPrevious(t),r(t)}return t}getPrevious(t){return this.getEntryByHash(t.prevBlock)}getPrevCache(t){return this.cacheHash.get(t.prevBlock)||null}async getNext(t){const e=await this.getNextHash(t.hash);return e?await this.getEntryByHash(e):null}async getNextEntry(t){const e=await this.getEntryByHeight(t.height+1);return e?e.prevBlock!==t.hash?null:e:null}getTip(){return this.getEntryByHash(this.state.tip)}async getState(){const t=await this.db.get(d.R);return t?D.fromRaw(t):null}async saveGenesis(){const t=this.createGenesisBlock({version:this.network.genesis.version,time:this.network.genesis.time,bits:this.network.genesis.bits,nonce:this.network.genesis.nonce,addresses:this.network.genesis.addresses});this.network.genesis.hash=t.hash("hex"),this.network.genesis.merkleRoot=t.merkleRoot;const e=y.fromBlock(t);this.logger.info("Writing genesis block to ChainDB.");const i=new u;for(let e=0;e<t.txs.length;e++)i.addTX(t.txs[e],e);await this.save(e,t,i)}async getFlags(){const t=await this.db.get(d.O);return t?L.fromRaw(t):null}async verifyFlags(t){const e=this.options,i=await this.getFlags();let r=!1,s=!1;if(!i)throw new Error("No flags found.");if(e.network!==i.network)throw new Error("Network mismatch for chain.");if(e.spv&&!i.spv)throw new Error("Cannot retroactively enable SPV.");if(!e.spv&&i.spv)throw new Error("Cannot retroactively disable SPV.");if(!i.witness){if(!e.forceFlags)throw new Error("Cannot retroactively enable witness.");r=!0}if(e.prune&&!i.prune){if(!e.forceFlags)throw new Error("Cannot retroactively prune.");s=!0}if(!e.prune&&i.prune)throw new Error("Cannot retroactively unprune.");if(e.indexTX&&!i.indexTX)throw new Error("Cannot retroactively enable TX indexing.");if(!e.indexTX&&i.indexTX)throw new Error("Cannot retroactively disable TX indexing.");if(e.indexAddress&&!i.indexAddress)throw new Error("Cannot retroactively enable address indexing.");if(!e.indexAddress&&i.indexAddress)throw new Error("Cannot retroactively disable address indexing.");r&&(await this.logger.info("Rewriting chain flags."),await this.saveFlags()),s&&(await this.logger.info("Retroactively pruning chain."),await this.prune(t.tip))}async getStateCache(){const t=new F(this.network),e=await this.db.range({gte:d.v(0,h.ZERO_HASH),lte:d.v(255,h.MAX_HASH),values:!0});for(const i of e){const[e,r]=d.vv(i.key),s=i.value[0];t.insert(e,r,s)}return t}saveDeployments(){const t=this.db.batch();return this.writeDeployments(t),t.write()}async batchPut(t,e){const i=this.db.batch();i.put(t,e),await i.write()}async batchDel(t){const e=this.db.batch();e.del(t),await e.write()}writeDeployments(t){const e=new o(1+17*this.network.deploys.length);e.writeU8(this.network.deploys.length);for(const t of this.network.deploys)e.writeU8(t.bit),e.writeU32(t.startTime),e.writeU32(t.timeout),e.writeI32(t.threshold),e.writeI32(t.window);t.put(d.V,e.render())}async checkDeployments(){const t=await this.db.get(d.V);r(t,"No deployment table found.");const e=new n(t),i=e.readU8(),s=[];for(let t=0;t<i;t++){const t=e.readU8(),i=e.readU32(),r=e.readU32(),n=e.readI32(),o=e.readI32(),a=this.network.byBit(t);a&&i===a.startTime&&r===a.timeout&&n===a.threshold&&o===a.window||s.push(t)}return s}async verifyDeployments(){let t;try{t=await this.checkDeployments()}catch(e){if("EncodingError"!==e.type)throw e;t=[];for(let e=0;e<32;e++)t.push(e)}if(0===t.length)return!0;const e=this.db.batch();for(const i of t)this.logger.warning("Versionbit deployment params modified."),this.logger.warning("Invalidating cache for bit %d.",i),await this.invalidateCache(i,e);return this.writeDeployments(e),await e.write(),!1}async invalidateCache(t,e){const i=await this.db.keys({gte:d.v(t,h.ZERO_HASH),lte:d.v(t,h.MAX_HASH)});for(const t of i)e.del(t)}async prune(){const t=this.options,e=this.network.block.keepBlocks,i=this.network.block.pruneAfterHeight;if((await this.getFlags()).prune)throw new Error("Chain is already pruned.");const s=await this.getHeight(this.state.tip);if(s<=i+e)return!1;const n=i+1,o=s-e,a=this.db.batch();for(let t=n;t<=o;t++){const e=await this.getHash(t);if(!e)throw new Error(`Cannot find hash for ${t}.`);a.del(d.b(e)),a.del(d.u(e))}try{t.prune=!0;const i=L.fromOptions(t);r(i.prune),a.put(d.O,i.toRaw()),await a.write()}catch(e){throw t.prune=!1,e}return await this.db.compactRange(),!0}async getNextHash(t){const e=await this.db.get(d.n(t));return e?e.toString("hex"):null}async isMainHash(t){if(r("string"==typeof t),t===h.NULL_HASH)return!1;if(t===this.network.genesis.hash)return!0;if(t===this.state.tip)return!0;const e=this.cacheHash.get(t);if(e){const i=this.cacheHeight.get(e.height);if(i)return i.hash===t}return!!await this.getNextHash(t)}async isMainChain(t){if(t.isGenesis())return!0;if(t.hash===this.state.tip)return!0;const e=this.getCache(t.height);return e?t.hash===e.hash:!!await this.getNextHash(t.hash)}getEntries(){return this.db.values({gte:d.e(h.ZERO_HASH),lte:d.e(h.MAX_HASH),parse:t=>y.fromRaw(t)})}getTimestampHashes(t,e){return this.db.keys({gte:d.th(e,h.ZERO_HASH),lte:d.th(t,h.MAX_HASH),parse:d.thh})}getCps(){return this.db.values({gte:d.CP(h.ZERO_CID,"hex"),lte:d.CP(h.MAX_CID,"hex"),parse:t=>k.fromRaw(t)})}getContracts(){return this.db.values({gte:d.tx(h.NULL_HASH),lte:d.tx(h.HIGH_HASH),parse:t=>s.parseJson(t.toString())})}async setCp(t){let e=this.db.batch();e.put(d.CP(t.cid),new k(t).toRaw()),await e.write()}async delCp(t){let e=this.db.batch();e.del(d.CP(t)),await e.write()}async delVp(t){let e=this.db.batch();e.del(d.VP(t)),await e.write()}async setVp(t){let e=this.db.batch();e.put(d.VP(t.pid),new S(t).toRaw()),await e.write()}async hasVp(t){return!("string"!=typeof t||36!=t.length||!await this.db.get(d.VP(t)))}async getVp(t){r("string"==typeof t&&36==t.length);const e=await this.db.get(d.VP(t));return e?S.fromRaw(e):null}async getVpp(t){r("string"==typeof t&&36==t.length);const e=await this.db.get(d.VPP(t));return e?S.fromRaw(e):null}async setVpp(t){let e=this.db.batch();e.put(d.VPP(t.pid),new S(t).toRaw()),await e.write()}async delVpp(t){let e=this.db.batch();e.del(d.VPP(t)),await e.write()}async addOrder(t){await this.batchPut(d.o(t.cid,t.sn),t.toExtend())}async arrangeOrder(t){let e=[],i=await this.db.values({gte:d.o(t,h.ZERO_OID),lte:d.o(t,h.MAX_OID),parse:R.fromExtend}),r=[];for(let t of i)e.push(t);return r.length>0&&this.delOrder(r),e}async getAddressesFromOrder(t){let e=await this.node.rpc.execute({method:"cp.byClass",params:[t.cls,1,1e4]});e=e.list.map(t=>t.cid);let i=null;for(let t of e)i=i?i.concat(await this.arrangeOrder(t)):await this.arrangeOrder(t);i=i.reduce((e,i)=>(i.addr&&i.height>0&&(!t.time||600*(this.node.chain.height-i.height)<t.time)&&(e[i.addr]?i.sum&&(e[i.addr].sum+=i.sum):(e[i.addr]=i,e[i.addr].sum=e[i.addr].sum||0)),e),{});let r={list:[],pageNum:1,pageCur:1};(i=(i=t.amount?Object.values(i).filter(e=>e.sum>=t.amount):Object.values(i)).map(t=>({addr:t.addr,sum:t.sum}))).length%t.pageSize==0?r.pageNum=i.length/t.pageSize|0:r.pageNum=1+(i.length/t.pageSize|0),r.pageCur=Math.max(1,Math.min(r.pageNum,t.page));for(let e=t.pageSize*(r.pageCur-1);e<t.pageSize*r.pageCur&&i[e];e++)r.list.push(i[e]);return r}async getOrder(t,e){r(t),r(e),e=Array.isArray(e)?1==e.length?s.sprintf("%0-36s",e[0]):e.map(t=>s.sprintf("%0-36s",t)):s.sprintf("%0-36s",e);let i=[];if(Array.isArray(e)){let r=await this.arrangeOrder(t);for(let t of r)-1!=e.indexOf(t.sn)&&i.push(t)}else{let r=await this.db.get(d.o(t,e));if(r){let t=R.fromExtend(r);t.height>0?t.confirm=this.node.chain.height-t.height+1:t.confirm=0,i.push(t)}}return i}async delOrder(t,e){const i=this.db.batch();Array.isArray(e)?e.map(e=>{i.del(d.o(t,e))}):i.del(d.o(t,e)),await i.write()}getTips(){return this.db.keys({gte:d.p(h.ZERO_HASH),lte:d.p(h.MAX_HASH),parse:d.pp})}async readCoin(t){if(this.options.spv)return null;const{hash:e,index:i}=t,r=t.toKey(),s=this.state,n=this.coinCache.get(r);if(n)return v.fromRaw(n);const o=await this.db.get(d.c(e,i));return o?(s===this.state&&this.coinCache.set(r,o),v.fromRaw(o)):null}async getCoin(t,e){const i=new m(t,e),r=await this.readCoin(i);return r?r.toCoin(i):null}async hasCoins(t){for(let e=0;e<t.outputs.length;e++){const i=d.c(t.hash(),e);if(await this.db.has(i))return!0}return!1}async getCoinView(t){const e=new u;for(const{prevout:i}of t.inputs){const t=await this.readCoin(i);t&&e.addEntry(i,t)}return e}async getSpentView(t){const e=await this.getCoinView(t);for(const{prevout:i}of t.inputs){if(e.hasEntry(i))continue;const{hash:t,index:r}=i,s=await this.getMeta(t);if(!s)continue;const{tx:n,height:o}=s;r<n.outputs.length&&e.addIndex(n,r,o)}return e}async getUndoCoins(t){const e=await this.db.get(d.u(t));return e?l.fromRaw(e):new l}async getBlock(t){const e=await this.getRawBlock(t);return e?g.fromRaw(e):null}async getRawBlock(t){if(this.options.spv)return null;const e=await this.getHash(t);return e?await this.db.get(d.b(e)):null}async getBlockView(t){const e=new u,i=await this.getUndoCoins(t.hash());if(i.isEmpty())return e;for(let r=t.txs.length-1;r>0;r--){const s=t.txs[r];for(let t=s.inputs.length-1;t>=0;t--){const r=s.inputs[t];i.apply(e,r.prevout)}}return r(i.isEmpty(),"Undo coins data inconsistency."),e}async getMeta(t){if(!this.options.indexTX)return null;const e=await this.db.get(d.t(t));return e?b.fromRaw(e):null}async getTX(t){const e=await this.getMeta(t);return e?e.tx:null}async hasTX(t){return!!this.options.indexTX&&await this.db.has(d.t(t))}async getCoinsByAddress(t){if(!this.options.indexAddress)return[];Array.isArray(t)||(t=[t]);const e=[];for(const i of t){const t=w.getHash(i),s=await this.db.keys({gte:d.C(t,h.ZERO_HASH,0),lte:d.C(t,h.MAX_HASH,4294967295),parse:d.Cc});for(const[t,i]of s){const s=await this.getCoin(t,i);r(s),e.push(s)}}return e}async getHashesByAddress(t,e="both"){if(Array.isArray(t)||(t=[t]),!this.options.indexTX||!this.options.indexAddress)return[];const i=Object.create(null);for(const r of t){const t=w.getHash(r);let s,n;"input"==e?(s=d.TI(t,h.ZERO_HASH),n=d.TI(t,h.MAX_HASH)):"output"==e?(s=d.TO(t,h.ZERO_HASH),n=d.TO(t,h.MAX_HASH)):(s=d.T(t,h.ZERO_HASH),n=d.T(t,h.MAX_HASH)),await this.db.keys({gte:s,lte:n,parse:t=>{const e=d.Tt(t);i[e]=!0}})}return Object.keys(i)}async getTXByAddress(t){const e=await this.getMetaByAddress(t),i=[];for(const t of e)i.push(t.tx);return i}async getMetaByAddress(t){if(!this.options.indexTX||!this.options.indexAddress)return[];Array.isArray(t)||(t=[t]);const e=await this.getHashesByAddress(t),i=[];for(const t of e){const e=await this.getMeta(t);r(e),i.push(e)}return i}async scan(t,e,i){null==t&&(t=this.network.genesis.hash),"number"==typeof t?this.logger.info("Scanning from height %d.",t):this.logger.info("Scanning from block %s.",s.revHex(t));let r=await this.getEntry(t);if(!r)return;if(!await this.isMainChain(r))throw new Error("Cannot rescan an alternate chain.");let n=0;for(;r;){const t=await this.getBlock(r.hash),s=[];if(n++,t){this.logger.info("Scanning block %s (%d).",r.rhash(),r.height);for(let i=0;i<t.txs.length;i++){const r=t.txs[i];let n=!1;for(let t=0;t<r.outputs.length;t++){const i=r.outputs[t].getHash();if(i&&e&&e.test(i)){const i=m.fromTX(r,t);e.add(i.toRaw()),n=!0}}if(e&&!n){if(0!==i)for(const{prevout:t}of r.inputs)if(!e||e.test(t.toRaw())){s.push(r);break}}else s.push(r)}await i(r,s),r=await this.getNext(r)}else{if(!this.options.spv&&!this.options.prune)throw new Error("Block not found.");await i(r,s),r=await this.getNext(r)}}this.logger.info("Finished scanning %d blocks.",n)}async save(t,e,i){this.start();try{await this._save(t,e,i)}catch(t){throw this.drop(),t}await this.commit()}async _save(t,e,i){const r=e.hash();this.put(d.h(r),E(t.height)),this.put(d.th(e.time,r),null),this.put(d.e(r),t.toRaw()),this.cacheHash.push(t.hash,t),this.del(d.p(t.prevBlock)),this.put(d.p(r),null),this.saveUpdates(),i?(t.isGenesis()||this.put(d.n(t.prevBlock),r),this.put(d.H(t.height),r),this.cacheHeight.push(t.height,t),await this.saveBlock(t,e,i),this.put(d.R,this.pending.commit(r))):await this.saveBlock(t,e)}async reconnect(t,e,i){this.start();try{await this._reconnect(t,e,i)}catch(t){throw this.drop(),t}await this.commit()}async _reconnect(t,e,i){const s=e.hash();r(!t.isGenesis()),this.put(d.n(t.prevBlock),s),this.put(d.H(t.height),s),this.cacheHeight.push(t.height,t),this.cacheHash.push(t.hash,t),this.saveUpdates(),await this.connectBlock(t,e,i),this.put(d.R,this.pending.commit(s))}async disconnect(t,e){let i;this.start();try{i=await this._disconnect(t,e)}catch(t){throw this.drop(),t}return await this.commit(),i}async _disconnect(t,e){this.del(d.n(t.prevBlock)),this.del(d.H(t.height)),this.cacheHeight.unpush(t.height),this.saveUpdates();const i=await this.disconnectBlock(t,e);return this.put(d.R,this.pending.commit(t.prevBlock)),i}saveUpdates(){const t=this.stateCache.updates;if(0!==t.length){this.logger.info("Saving %d state cache updates.",t.length);for(const e of t){const{bit:t,hash:i}=e;this.put(d.v(t,i),e.toRaw())}}}async reset(t){const e=await this.getEntry(t);if(!e)throw new Error("Block not found.");if(!await this.isMainChain(e))throw new Error("Cannot reset on alternate chain.");if(this.options.prune)throw new Error("Cannot reset when pruned.");await this.removeChains();let i=await this.getTip();for(r(i),this.logger.debug("Resetting main chain to: %s",e.rhash());;){if(this.start(),i.hash===e.hash){this.put(d.R,this.pending.commit(i.hash)),await this.commit();break}r(!i.isGenesis()),this.del(d.p(i.hash)),this.put(d.p(i.prevBlock),null),this.del(d.H(i.height)),this.del(d.h(i.hash)),this.del(d.th(i.time,i.hash)),this.del(d.e(i.hash)),this.del(d.n(i.prevBlock));try{await this.removeBlock(i)}catch(t){throw this.drop(),t}this.put(d.R,this.pending.commit(i.prevBlock)),await this.commit(),this.cacheHeight.remove(i.height),this.cacheHash.remove(i.hash),i=await this.getPrevious(i),r(i)}return i}async removeChains(){const t=await this.getTips();this.start();try{for(const e of t)await this._removeChain(e)}catch(t){throw this.drop(),t}await this.commit()}async _removeChain(t){let e=await this.getEntryByHash(t);if(!e)throw new Error("Alternate chain tip not found.");for(this.logger.debug("Removing alternate chain: %s.",e.rhash());!await this.isMainChain(e);)r(!e.isGenesis()),this.del(d.p(e.hash)),this.del(d.h(e.hash)),this.del(d.th(e.time,e.hash)),this.del(d.e(e.hash)),this.del(d.b(e.hash)),this.cacheHash.unpush(e.hash),e=await this.getPrevious(e),r(e)}async saveBlock(t,e,i){const r=e.hash();this.options.spv||(this.put(d.b(r),e.toRaw()),i&&await this.connectBlock(t,e,i))}async removeBlock(t){if(this.options.spv)return new u;const e=await this.getBlock(t.hash);if(!e)throw new Error("Block not found.");return this.del(d.b(e.hash())),await this.disconnectBlock(t,e)}saveView(t){for(const[e,i]of t.map)for(const[t,r]of i.outputs){if(r.spent){this.del(d.c(e,t)),this.coinCache.unpush(e+t);continue}const i=r.toRaw();this.del(d.s(e,t)),this.put(d.c(e,t),i),this.coinCache.push(e+t,i)}}async getSpender(t,e){const i=await this.db.get(d.s(t,e));return i?C.DecodeSpenderValue(i):null}async connectBlock(t,e,i){if(this.options.spv)return;const r=e.hash("hex");this.pending.connect(e);for(let s=0;s<e.txs.length;s++){const n=e.txs[s];let o=n.hash("hex");if(!t.isGenesis()&&s>0)for(let t=0;t<n.inputs.length;t++){const s=n.inputs[t].prevout;let a=i.getOutput(s);this.pending.spend(a),this.put(d.s(s.hash,s.index),C.EncodeSpenderValue(o,t,e.height,r))}for(const t of n.outputs)t.script.isUnspendable()||this.pending.add(t);let a=e?e.getCoinbaseHeight():0,h=this.node.getTXFromAll?this.node.getTXFromAll.bind(this.node):()=>{},c=await O.FactoryOfContract(_.Db,n,{env:this,coinbaseHeight:a,finder:h,tidCreator:d.tx});await c.execute(),this.indexTX(n,i,t,s)}this.saveView(i),i.undo.isEmpty()||this.put(d.u(r),i.undo.commit()),await this.pruneBlock(t)}async disconnectBlock(t,e){const i=new u;if(this.options.spv)return i;const s=e.hash(),n=await this.getUndoCoins(s);this.pending.disconnect(e);for(let r=e.txs.length-1;r>=0;r--){const s=e.txs[r];if(r>0)for(let t=s.inputs.length-1;t>=0;t--){const{prevout:e}=s.inputs[t];n.apply(i,e),this.pending.add(i.getOutput(e))}i.removeTX(s,t.height);for(let t=s.outputs.length-1;t>=0;t--){const e=s.outputs[t];e.script.isUnspendable()||this.pending.spend(e)}await this.unindexTX(s,i)}return r(n.isEmpty(),"Undo coins data inconsistency."),this.saveView(i),this.del(d.u(s)),i}async pruneBlock(t){if(this.options.spv)return;if(!this.options.prune)return;const e=t.height-this.network.block.keepBlocks;if(e<=this.network.block.pruneAfterHeight)return;const i=await this.getHash(e);i&&(this.del(d.b(i)),this.del(d.u(i)))}saveFlags(){const t=L.fromOptions(this.options),e=this.db.batch();return e.put(d.O,t.toRaw()),e.write()}indexTX(t,e,i,r){const s=t.hash();if(this.options.indexTX){const n=b.fromTX(t,i,r);if(this.put(d.t(s),n.toRaw()),this.options.indexAddress){for(const e of t.getHashes())this.put(d.T(e,s),null);for(const e of t.getOutputHashes())this.put(d.TO(e,s),null);for(const i of t.getInputHashes(e))this.put(d.TI(i,s),null)}}if(this.options.indexAddress){if(!i.isGenesis()&&!t.isCoinbase())for(const{prevout:i}of t.inputs){const t=e.getOutput(i).getHash();t&&this.del(d.C(t,i.hash,i.index))}for(let e=0;e<t.outputs.length;e++){const i=t.outputs[e].getHash();i&&this.put(d.C(i,s,e),null)}}}async unindexTX(t,e){const i=t.hash();let r=this.node.getTXFromAll?this.node.getTXFromAll:()=>{},s=await O.FactoryOfContract(_.Db,t,{env:this,finder:r.bind(this.node),tidCreator:d.tx});if(await s.cancel(),this.options.indexTX&&(this.del(d.t(i)),this.options.indexAddress)){const r=t.getHashes(e);for(let t of r)this.del(d.T(t,i)),this.del(d.TI(t,i)),this.del(d.TO(t,i))}if(this.options.indexAddress){if(!t.isCoinbase())for(const{prevout:i}of t.inputs){const t=e.getOutput(i).getHash();t&&this.put(d.C(t,i.hash,i.index),null)}for(let e=0;e<t.outputs.length;e++){const r=t.outputs[e].getHash();r&&this.del(d.C(r,i,e))}}}async readHostList(){return await this.db.get(d.HL)}async writeHostList(t){const e=this.db.batch();return e.put(d.HL,t),await e.write()}}function L(t){if(!(this instanceof L))return new L(t);this.network=c.primary,this.spv=!1,this.witness=!0,this.prune=!1,this.indexTX=!1,this.indexAddress=!1,t&&this.fromOptions(t)}H.layout=d,L.prototype.fromOptions=function(t){return this.network=c.get(t.network),null!=t.spv&&(r("boolean"==typeof t.spv),this.spv=t.spv),null!=t.prune&&(r("boolean"==typeof t.prune),this.prune=t.prune),null!=t.indexTX&&(r("boolean"==typeof t.indexTX),this.indexTX=t.indexTX),null!=t.indexAddress&&(r("boolean"==typeof t.indexAddress),this.indexAddress=t.indexAddress),this},L.fromOptions=function(t){return(new L).fromOptions(t)},L.prototype.toRaw=function(){const t=new o(12);let e=0;return this.spv&&(e|=1),this.witness&&(e|=2),this.prune&&(e|=4),this.indexTX&&(e|=8),this.indexAddress&&(e|=16),t.writeU32(this.network.magic),t.writeU32(e),t.writeU32(0),t.render()},L.prototype.fromRaw=function(t){const e=new n(t);this.network=c.fromMagic(e.readU32());const i=e.readU32();return this.spv=0!=(1&i),this.witness=0!=(2&i),this.prune=0!=(4&i),this.indexTX=0!=(8&i),this.indexAddress=0!=(16&i),this},L.fromRaw=function(t){return(new L).fromRaw(t)};class D{constructor(){this.tip=h.NULL_HASH,this.tx=0,this.coin=0,this.value=0,this.committed=!1}rhash(){return s.revHex(this.tip)}clone(){const t=new D;return t.tip=this.tip,t.tx=this.tx,t.coin=this.coin,t.value=this.value,t}connect(t){this.tx+=t.txs.length}disconnect(t){this.tx-=t.txs.length}add(t){this.coin++,this.value+=t.value}spend(t){this.coin--,this.value-=t.value}commit(t){return"string"!=typeof t&&(t=t.toString("hex")),this.tip=t,this.committed=!0,this.toRaw()}toRaw(){const t=new o(56);return t.writeHash(this.tip),t.writeU64(this.tx),t.writeU64(this.coin),t.writeU64(this.value),t.render()}static fromRaw(t){const e=new D,i=new n(t);return e.tip=i.readHash("hex"),e.tx=i.readU64(),e.coin=i.readU64(),e.value=i.readU64(),e}}function F(t){this.network=t,this.bits=[],this.updates=[],this._init()}function z(t,e,i){this.bit=t,this.hash=e,this.state=i}function V(t){return t.length+80}F.prototype._init=function(){for(let t=0;t<32;t++)this.bits.push(null);for(const{bit:t}of this.network.deploys)r(!this.bits[t]),this.bits[t]=new Map},F.prototype.set=function(t,e,i){const s=this.bits[t];r(s),s.get(e.hash)!==i&&(s.set(e.hash,i),this.updates.push(new z(t,e.hash,i)))},F.prototype.get=function(t,e){const i=this.bits[t];r(i);const s=i.get(e.hash);return null==s?-1:s},F.prototype.commit=function(){this.updates.length=0},F.prototype.drop=function(){for(const{bit:t,hash:e}of this.updates){const i=this.bits[t];r(i),i.delete(e)}this.updates.length=0},F.prototype.insert=function(t,e,i){const s=this.bits[t];r(s),s.set(e,i)},z.prototype.toRaw=function(){return x(this.state)},t.exports=H}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * coins.js - coins object
 */const r=i(1),s=i(88);class n{constructor(){this.outputs=new Map}clone(){let t=new n;for(let[e,i]of this.outputs)t.outputs.set(e,s.fromRaw(i.toRaw()));return t}add(t,e){return r(t>>>0===t),r(e),this.outputs.set(t,e),e}addOutput(t,e){return this.add(t,s.fromOutput(e))}addCoin(t){return this.add(t.index,s.fromCoin(t))}has(t){return this.outputs.has(t)}isUnspent(t){const e=this.outputs.get(t);return!(!e||e.spent)}get(t){return this.outputs.get(t)||null}getOutput(t){const e=this.outputs.get(t);return e?e.output:null}getCoin(t){const e=this.outputs.get(t.index);return e?e.toCoin(t):null}spend(t){const e=this.get(t);return!e||e.spent?null:(e.spent=!0,e)}remove(t){const e=this.get(t);return e?(this.outputs.delete(t),e):null}isEmpty(){return 0===this.outputs.size}fromTX(t,e){r("number"==typeof e);for(let i=0;i<t.outputs.length;i++){if(t.outputs[i].script.isUnspendable())continue;const r=s.fromTX(t,i,e);this.outputs.set(i,r)}return this}static fromTX(t,e){return(new n).fromTX(t,e)}}t.exports=n},function(t,e,i){"use strict";(function(t){
/*!
 * compress.js - coin compressor for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(30),n=i(4),o=i(10),a=i(20),h=6,c=t.alloc(0);function u(t){if(0===t.length)return!1;switch(t[0]){case 2:case 3:return 33===t.length;case 4:return 65===t.length&&s.publicKeyVerify(t);default:return!1}}e.pack=function(t,e){return e.writeVarint(t.value),function(t,e){const i=t.getPubkeyhash(!0);if(i)return e.writeU8(0),e.writeBytes(i),e;const n=t.getScripthash();if(n)return e.writeU8(1),e.writeBytes(n),e;const o=t.getPubkey(!0);if(o&&u(o)){const t=function(t){let e;switch(t[0]){case 2:case 3:e=t;break;case 4:(e=s.publicKeyConvert(t,!0))[0]=4|1&t[64];break;default:throw new Error("Bad point format.")}return r(33===e.length),e}(o);return e.writeBytes(t),e}e.writeVarint(t.raw.length+h),e.writeBytes(t.raw)}(t.script,e),e},e.unpack=function(t,e){return t.value=e.readVarint(),function(t,e){switch(e.readU8()){case 0:{const i=e.readBytes(20,!0);t.createScript(i);break}case 1:{const i=e.readBytes(20,!0);t.createScript(i,a.types.SCRIPTHASH);break}case 2:case 3:case 4:case 5:{e.offset-=1;const i=function(t){const e=t[0];switch(r(33===t.length),e){case 2:case 3:return t;case 4:t[0]=2;break;case 5:t[0]=3;break;default:throw new Error("Bad point format.")}const i=s.publicKeyConvert(t,!1);return t[0]=e,i}(e.readBytes(33,!0));t.createScript(i,a.types.PUBKEY);break}default:{e.offset-=1;const i=e.readVarint()-h;if(i>o.MAX_SCRIPT_SIZE)t.createScript(c,a.types.NULLDATA),e.seek(i);else{const r=e.readBytes(i);t.fromRaw(r)}break}}}(t.script,e),t},e.size=function(t){let e=0;return(e+=n.sizeVarint(t.value))+function(t){if(t.isPubkeyhash(!0))return 21;if(t.isScripthash())return 21;const e=t.getPubkey(!0);if(e&&u(e))return 33;let i=0;return(i+=n.sizeVarint(t.raw.length+h))+t.raw.length}(t.script)}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * txmeta.js - extended transaction object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(17),o=i(6),a=i(2);function h(t){if(!(this instanceof h))return new h(t);this.tx=new n,this.mtime=s.now(),this.height=-1,this.block=null,this.time=0,this.index=-1,t&&this.fromOptions(t)}h.prototype.fromOptions=function(t){return t.tx&&(r(t.tx instanceof n),this.tx=t.tx),null!=t.mtime&&(r(s.isU32(t.mtime)),this.mtime=t.mtime),null!=t.height&&(r(s.isInt(t.height)),this.height=t.height),void 0!==t.block&&(r(null===t.block||"string"==typeof t.block),this.block=t.block),null!=t.time&&(r(s.isU32(t.time)),this.time=t.time),null!=t.index&&(r(s.isInt(t.index)),this.index=t.index),this},h.fromOptions=function(t){return(new h).fromOptions(t)},h.prototype.fromTX=function(t,e,i){return this.tx=t,e&&(this.height=e.height,this.block=e.hash,this.time=e.time,this.index=i),this},h.fromTX=function(t,e,i){return(new h).fromTX(t,e,i)},h.prototype.inspect=function(){return this.format()},h.prototype.format=function(t){const e=this.tx.format(t,null,this.index);return e.mtime=this.mtime,e.height=this.height,e.block=this.block?s.revHex(this.block):null,e.time=this.time,e},h.prototype.toJSON=function(){return this.getJSON()},h.prototype.getJSON=function(t,e,i){const r=this.tx.getJSON(t,e,null,this.index);return r.mtime=this.mtime,r.height=this.height,r.block=this.block?s.revHex(this.block):null,r.time=this.time,r.confirmations=0,null!=i&&(r.confirmations=i-this.height+1),r},h.prototype.fromJSON=function(t){return this.tx.fromJSON(t),r(s.isU32(t.mtime)),r(s.isInt(t.height)),r(!t.block||"string"==typeof t.block),r(s.isU32(t.time)),r(s.isInt(t.index)),this.mtime=t.mtime,this.height=t.height,this.block=s.revHex(t.block),this.index=t.index,this},h.fromJSON=function(t){return(new h).fromJSON(JSON)},h.prototype.getSize=function(){let t=0;return t+=this.tx.getSize(),t+=4,this.block?(t+=1,t+=32,t+=12):t+=1,t},h.prototype.toRaw=function(){const t=this.getSize(),e=new o(t);return this.tx.toWriter(e),e.writeU32(this.mtime),this.block?(e.writeU8(1),e.writeHash(this.block),e.writeU32(this.height),e.writeU32(this.time),e.writeU32(this.index)):e.writeU8(0),e.render()},h.prototype.fromRaw=function(t){const e=new a(t);return this.tx.fromReader(e),this.mtime=e.readU32(),1===e.readU8()&&(this.block=e.readHash("hex"),this.height=e.readU32(),this.time=e.readU32(),this.index=e.readU32(),2147483647===this.index&&(this.index=-1)),this},h.fromRaw=function(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new h).fromRaw(t)},h.isTXMeta=function(t){return t instanceof h},t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){const r=i(6),s=i(2),n=i(4);class o{constructor(t){t=t||[],this.pid=t.pid,this.cid=t.cid||"",this.gold=t.gold,this.current=t.current,this.height=t.height,this.raw=null}getSize(){if(this.raw)return this.raw.length;let t=0;return t+=n.sizeVarString(this.pid,"utf8"),t+=n.sizeVarString(this.cid||"","utf8"),t+=4,t+=n.sizeVarString(this.current.hash,"utf8"),t+=4,(t+=n.sizeVarString(this.current.address,"utf8"))+4}toWriter(t){return t.writeVarString(this.pid,"utf8"),t.writeVarString(this.cid,"utf8"),t.writeU32(this.gold),this.current||(this.current={hash:"",index:0,address:""}),t.writeVarString(this.current.hash,"utf8"),t.writeU32(this.current.index),t.writeVarString(this.current.address,"utf8"),t.writeU32(this.height),t}toRaw(){const t=this.getSize();return this.toWriter(new r(t)).render()}fromReader(t){return this.pid=t.readVarString("utf8"),this.cid=t.readVarString("utf8"),this.gold=t.readU32(),this.current={},this.current.hash=t.readVarString("utf8"),this.current.index=t.readU32(),this.current.address=t.readVarString("utf8"),this.height=t.readU32(),this}fromRaw(t){return this.fromReader(new s(t))}static fromReader(t){return(new o).fromReader(t)}static fromRaw(t){return(new o).fromRaw(t)}}t.exports=o},function(t,e,i){var r,s,n=i(261),o=i(262),a=0,h=0;t.exports=function(t,e,i){var c=e&&i||0,u=e||[],l=(t=t||{}).node||r,f=void 0!==t.clockseq?t.clockseq:s;if(null==l||null==f){var d=n();null==l&&(l=r=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==f&&(f=s=16383&(d[6]<<8|d[7]))}var p=void 0!==t.msecs?t.msecs:(new Date).getTime(),g=void 0!==t.nsecs?t.nsecs:h+1,m=p-a+(g-h)/1e4;if(m<0&&void 0===t.clockseq&&(f=f+1&16383),(m<0||p>a)&&void 0===t.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=p,h=g,s=f;var w=(1e4*(268435455&(p+=122192928e5))+g)%4294967296;u[c++]=w>>>24&255,u[c++]=w>>>16&255,u[c++]=w>>>8&255,u[c++]=255&w;var y=p/4294967296*1e4&268435455;u[c++]=y>>>8&255,u[c++]=255&y,u[c++]=y>>>24&15|16,u[c++]=y>>>16&255,u[c++]=f>>>8|128,u[c++]=255&f;for(var b=0;b<6;++b)u[c+b]=l[b];return e||o(u)}},function(t,e,i){(function(e){const r=i(148),s=i(21).ec("secp256k1");function n(t,e){return r.createHash(t).update(e).digest()}function o(t){return n("sha256",t)}e.allocUnsafe(65);const a=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,15,-1,10,17,21,20,26,30,7,5,-1,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1];function h(t){const e=t>>>25;return(33554431&t)<<5^996825010&-(e>>0&1)^642813549&-(e>>1&1)^513874426&-(e>>2&1)^1027748829&-(e>>3&1)^705979059&-(e>>4&1)}t.exports=function(t){try{let i=e.from(t.data.pubkey,"hex");if(!s.keyPair({pub:i}).validate())return!1;let r=e.from(function(t,e){let i="";return Object.keys(t).sort().map(e=>{i+=e+t[e]}),i}(t.data));if(s.verify(o(o(r)),e.from(t.sig,"hex"),i)&&function(t){const[i,r]=function(t){let i=0;if(t.length<8||t.length>90)throw new Error("Invalid bech32 string length.");for(;i<t.length&&"1"!==t[t.length-1-i];)i++;const r=t.length-(1+i);if(r<1||i<6)throw new Error("Invalid bech32 data length.");i-=6;const s=e.allocUnsafe(i);let n,o=1,c=!1,u=!1,l="";for(let e=0;e<r;e++){let i=t.charCodeAt(e);if(i<33||i>126)throw new Error("Invalid bech32 character.");i>=97&&i<=122?c=!0:i>=65&&i<=90&&(u=!0,i=i-65+97),l+=String.fromCharCode(i),o=h(o)^i>>5}for(o=h(o),n=0;n<r;n++)o=h(o)^31&t.charCodeAt(n);for(n++;n<t.length;){const e=t.charCodeAt(n),i=128&e?-1:a[e];if(e>=97&&e<=122?c=!0:e>=65&&e<=90&&(u=!0),-1===i)throw new Error("Invalid bech32 character.");o=h(o)^i,n+6<t.length&&(s[n-(1+r)]=i),n++}if(c&&u)throw new Error("Invalid bech32 casing.");if(1!==o)throw new Error("Invalid bech32 checksum.");return[l,s.slice(0,i)]}(t);if(0===r.length||r.length>65)throw new Error("Invalid bech32 data length.");if(r[0]>16)throw new Error("Invalid bech32 version.");const s=r[0],n=function(t,e,i,r,s,n){const o=(1<<r)-1;let a=0,h=0,c=0;-1!==s&&(e[c++]=s);for(let s=n;s<t.length;s++){const n=t[s];if(n>>i!=0)throw new Error("Invalid bech32 bits.");for(a=a<<i|n,h+=i;h>=r;)h-=r,e[c++]=a>>>h&o}if(-1!==s)h>0&&(e[c++]=a<<r-h&o);else if(h>=i||a<<r-h&o)throw new Error("Invalid bech32 bits.");return e.slice(0,c)}(r,r,5,8,-1,1);if(n.length<2||n.length>40)throw new Error("Invalid bech32 data length.");return new function(t,e,i){this.hrp=t,this.version=e,this.hash=i}(i,s,n)}(t.data.addr).hash.toString("hex")==function(t){return function(t){return n("ripemd160",t)}(o(t))}(i).toString("hex"))return!0}catch(t){}return!1}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * CoinSelector.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(1),s=i(3),n=(i(17),i(28)),o=(i(41),i(26)),a=i(4),h=i(10),c=i(33),u=(i(31),i(333));class l{constructor(t,e){this.tx=t.clone(),this.coins=[],this.outputValue=0,this.index=0,this.chosen=[],this.change=0,this.fee=l.MIN_FEE,this.selection="value",this.subtractFee=!1,this.subtractIndex=null,this.height=-1,this.depth=-1,this.hardFee=-1,this.rate=l.FEE_RATE,this.maxFee=-1,this.round=!1,this.changeAddress=null,this.estimate=null,e&&this.fromOptions(e)}fromOptions(t){if(t.selection&&(r("string"==typeof t.selection),this.selection=t.selection),null!=t.subtractFee&&(r("boolean"==typeof t.subtractFee),this.subtractFee=t.subtractFee),null!=t.subtractIndex){let e=null;if("number"==typeof t.subtractIndex?e=[t.subtractIndex]:(r(Array.isArray(t.subtractIndex)),e=t.subtractIndex),e.length>0){const t=new Set;for(const i of e)r(s.isU32(i)),r(i<this.tx.outputs.length),t.add(i);this.subtractIndex=t,this.subtractFee=!0}}if(null!=t.height&&(r(s.isInt(t.height)),r(t.height>=-1),this.height=t.height),null!=t.confirmations&&(r(s.isInt(t.confirmations)),r(t.confirmations>=-1),this.depth=t.confirmations),null!=t.depth&&(r(s.isInt(t.depth)),r(t.depth>=-1),this.depth=t.depth),null!=t.hardFee&&(r(s.isInt(t.hardFee)),r(t.hardFee>=-1),this.hardFee=t.hardFee),null!=t.rate&&(r(s.isU64(t.rate)),this.rate=t.rate),null!=t.maxFee&&(r(s.isInt(t.maxFee)),r(t.maxFee>=-1),this.maxFee=t.maxFee),null!=t.round&&(r("boolean"==typeof t.round),this.round=t.round),t.changeAddress){const e=t.changeAddress;"string"==typeof e?this.changeAddress=o.fromString(e):(r(e instanceof o),this.changeAddress=e)}return t.estimate&&(r("function"==typeof t.estimate),this.estimate=t.estimate),this.allowPreInput=t.allowPreInput||!1,this}init(t){switch(this.coins=t.slice(),this.outputValue=this.tx.getOutputValue(),this.index=0,this.chosen=[],this.change=0,this.fee=l.MIN_FEE,this.allowPreInput||(this.tx.inputs.length=0),this.selection){case"all":case"random":this.coins.sort(d);break;case"age":this.coins.sort(p);break;case"value":this.coins.sort(f);break;default:throw new u(`Bad selection type: ${this.selection}.`)}}total(){return this.subtractFee?this.outputValue:this.outputValue+this.fee}isFull(){return this.tx.getInputValue()>=this.total()}isSpendable(t){return-1===this.height||(t.coinbase?-1!==t.height&&!(this.height+1<t.height+h.COINBASE_MATURITY):-1===this.depth||!(t.getDepth(this.height)<this.depth||t.isColored))}getFee(t){if(this.round){const e=c.getRoundFee(t,this.rate);return Math.min(e,l.MAX_FEE)}const e=c.getMinFee(t,this.rate);return Math.min(e,l.MAX_FEE)}fund(){if(!this.isFull())for(;this.index<this.coins.length;){const t=this.coins[this.index++];if(this.isSpendable(t)&&(this.tx.addCoin(t),this.chosen.push(t),"all"!==this.selection&&this.isFull()))break}}async select(t){if(this.init(t),-1!==this.hardFee?this.selectHard():await this.selectEstimate(),!this.isFull())throw new u("Not enough funds.",this.tx.getInputValue(),this.total());return this.change=this.tx.getInputValue()-this.total(),this}async selectEstimate(){this.fee=l.MIN_FEE,this.fund();const t=new n;this.changeAddress?t.script.fromAddress(this.changeAddress):t.script.createScript(a.ZERO_HASH160),this.tx.outputs.push(t);do{const t=await this.tx.estimateSize(this.estimate);if(this.fee=this.getFee(t),this.maxFee>0&&this.fee>this.maxFee)throw new u("Fee is too high.");this.isFull()||this.fund()}while(!this.isFull()&&this.index<this.coins.length)}selectHard(){this.fee=Math.min(this.hardFee,l.MAX_FEE),this.fund()}}function f(t,e){return-1===t.height&&-1!==e.height?1:-1!==t.height&&-1===e.height?-1:e.value-t.value}function d(t,e){return Math.random()>.5?1:-1}function p(t,e){return(t=-1===t.height?2147483647:t.height)-(-1===e.height?2147483647:e.height)}l.FEE_RATE=1e4,l.MIN_FEE=1e4,l.MAX_FEE=h.COIN/10,t.exports=l},function(t,e,i){"use strict";
/*!
 * master.js - master process for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(1),s=i(24),n=i(3),o=i(16),a=(i(72),i(118)),h=i(119),c=i(73),u=i(336);function l(){if(!(this instanceof l))return new l;s.call(this),this.parent=new u,this.framer=new h,this.parser=new a,this.listening=!1,this.color=!1,this.init()}Object.setPrototypeOf(l.prototype,s.prototype),l.prototype.init=function(){this.parent.on("data",t=>{this.parser.feed(t)}),this.parent.on("error",t=>{this.emit("error",t)}),this.parent.on("exception",t=>{this.send(new c.ErrorPacket(t)),setTimeout(()=>this.destroy(),1e3)}),this.parser.on("error",t=>{this.emit("error",t)}),this.parser.on("packet",t=>{this.emit("packet",t)})},l.prototype.setEnv=function(t){this.color="1"===t.GAMEGOLD_WORKER_ISTTY,this.set(t.GAMEGOLD_WORKER_NETWORK)},l.prototype.set=function(t){return o.set(t)},l.prototype.write=function(t){return this.parent.write(t)},l.prototype.send=function(t){return this.write(this.framer.packet(t))},l.prototype.sendEvent=function(...t){return this.send(new c.EventPacket(t))},l.prototype.destroy=function(){return this.parent.destroy()},l.prototype.log=function(...t){const e=n.format(t,this.color);this.send(new c.LogPacket(e))},l.prototype.listen=function(){r(!this.listening,"Already listening."),this.listening=!0,this.on("error",t=>{this.send(new c.ErrorPacket(t))}),this.on("packet",t=>{try{t.masterHandle(this)}catch(t){this.emit("error",t)}})},t.exports=l},function(t,e,i){"use strict";(function(t){
/*!
 * aes.js - aes128/192/256 for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=e,n=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],o=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],a=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],h=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],c=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],u=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],l=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],f=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],d=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],p=[16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,452984832,905969664];function g(e,i){if(!(this instanceof g))return new g(e,i);switch(this.rounds=null,this.userKey=e,this.bits=i,this.bits){case 128:this.rounds=10;break;case 192:this.rounds=12;break;case 256:this.rounds=14;break;default:throw new Error("Bad key size.")}r(t.isBuffer(e)),r(e.length===this.bits/8),this.decryptKey=null,this.encryptKey=null}function m(t,e,i,s){if(!(this instanceof m))return new m(t,e,s);r("ecb"===s||"cbc"===s,"Unknown mode."),this.key=new g(t,i),this.mode=s,this.prev=e,this.waiting=null}function w(t,e,i,s){if(!(this instanceof w))return new w(t,e,s);r("ecb"===s||"cbc"===s,"Unknown mode."),this.key=new g(t,i),this.mode=s,this.prev=e,this.waiting=null,this.lastBlock=null}function y(e,i){const r=t.allocUnsafe(e.length);for(let t=0;t<e.length;t++)r[t]=e[t]^i[t];return r}function b(t,e){return t[e+0]<<24^t[e+1]<<16^t[e+2]<<8^t[e+3]}function v(t,e,i){t[i+0]=e>>>24&255,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}function k(e,i){const r=t.allocUnsafe(e.length+i.length);return e.copy(r,0),i.copy(r,e.length),r}g.prototype.destroy=function(){if(r(this.userKey,"Already destroyed."),this.userKey=null,this.decryptKey){for(let t=0;t<this.decryptKey.length;t++)this.decryptKey[t]=0;this.decryptKey=null}if(this.encryptKey){for(let t=0;t<this.encryptKey.length;t++)this.encryptKey[t]=0;this.encryptKey=null}},g.prototype.getEncryptKey=function(){if(r(this.userKey,"Cannot use key once it is destroyed."),this.encryptKey)return this.encryptKey;const t=new Uint32Array(60);let e=0,i=0;if(t[e+0]=b(this.userKey,0),t[e+1]=b(this.userKey,4),t[e+2]=b(this.userKey,8),t[e+3]=b(this.userKey,12),this.encryptKey=t,128===this.bits)for(;;){const r=t[e+3];if(t[e+4]=t[e+0]^4278190080&a[r>>>16&255]^16711680&h[r>>>8&255]^65280&n[r>>>0&255]^255&o[r>>>24&255]^p[i],t[e+5]=t[e+1]^t[e+4],t[e+6]=t[e+2]^t[e+5],t[e+7]=t[e+3]^t[e+6],10==++i)return t;e+=4}if(t[e+4]=b(this.userKey,16),t[e+5]=b(this.userKey,20),192===this.bits)for(;;){const r=t[e+5];if(t[e+6]=t[e+0]^4278190080&a[r>>>16&255]^16711680&h[r>>>8&255]^65280&n[r>>>0&255]^255&o[r>>>24&255]^p[i],t[e+7]=t[e+1]^t[e+6],t[e+8]=t[e+2]^t[e+7],t[e+9]=t[e+3]^t[e+8],8==++i)return t;t[e+10]=t[e+4]^t[e+9],t[e+11]=t[e+5]^t[e+10],e+=6}if(t[e+6]=b(this.userKey,24),t[e+7]=b(this.userKey,28),256===this.bits)for(;;){let r=t[e+7];if(t[e+8]=t[e+0]^4278190080&a[r>>>16&255]^16711680&h[r>>>8&255]^65280&n[r>>>0&255]^255&o[r>>>24&255]^p[i],t[e+9]=t[e+1]^t[e+8],t[e+10]=t[e+2]^t[e+9],t[e+11]=t[e+3]^t[e+10],7==++i)return t;r=t[e+11],t[e+12]=t[e+4]^4278190080&a[r>>>24&255]^16711680&h[r>>>16&255]^65280&n[r>>>8&255]^255&o[r>>>0&255],t[e+13]=t[e+5]^t[e+12],t[e+14]=t[e+6]^t[e+13],t[e+15]=t[e+7]^t[e+14],e+=8}return t},g.prototype.getDecryptKey=function(){if(r(this.userKey,"Cannot use key once it is destroyed."),this.decryptKey)return this.decryptKey;const t=this.getEncryptKey(),e=new Uint32Array(60);let i=0;for(let i=0;i<t.length;i++)e[i]=t[i];this.decryptKey=e;for(let t=0,r=4*this.rounds;t<r;t+=4,r-=4){let s=e[i+t+0];e[i+t+0]=e[i+r+0],e[i+r+0]=s,s=e[i+t+1],e[i+t+1]=e[i+r+1],e[i+r+1]=s,s=e[i+t+2],e[i+t+2]=e[i+r+2],e[i+r+2]=s,s=e[i+t+3],e[i+t+3]=e[i+r+3],e[i+r+3]=s}for(let t=1;t<this.rounds;t++)e[(i+=4)+0]=c[255&o[e[i+0]>>>24&255]]^u[255&o[e[i+0]>>>16&255]]^l[255&o[e[i+0]>>>8&255]]^f[255&o[e[i+0]>>>0&255]],e[i+1]=c[255&o[e[i+1]>>>24&255]]^u[255&o[e[i+1]>>>16&255]]^l[255&o[e[i+1]>>>8&255]]^f[255&o[e[i+1]>>>0&255]],e[i+2]=c[255&o[e[i+2]>>>24&255]]^u[255&o[e[i+2]>>>16&255]]^l[255&o[e[i+2]>>>8&255]]^f[255&o[e[i+2]>>>0&255]],e[i+3]=c[255&o[e[i+3]>>>24&255]]^u[255&o[e[i+3]>>>16&255]]^l[255&o[e[i+3]>>>8&255]]^f[255&o[e[i+3]>>>0&255]];return e},g.prototype.encryptBlock=function(e){r(this.userKey,"Cannot use key once it is destroyed.");const i=this.getEncryptKey();let s,c,u,l,f=0,d=b(e,0)^i[0],p=b(e,4)^i[1],g=b(e,8)^i[2],m=b(e,12)^i[3],w=this.rounds>>>1;for(;s=n[d>>>24&255]^o[p>>>16&255]^a[g>>>8&255]^h[m>>>0&255]^i[f+4],c=n[p>>>24&255]^o[g>>>16&255]^a[m>>>8&255]^h[d>>>0&255]^i[f+5],u=n[g>>>24&255]^o[m>>>16&255]^a[d>>>8&255]^h[p>>>0&255]^i[f+6],l=n[m>>>24&255]^o[d>>>16&255]^a[p>>>8&255]^h[g>>>0&255]^i[f+7],f+=8,0!=--w;)d=n[s>>>24&255]^o[c>>>16&255]^a[u>>>8&255]^h[l>>>0&255]^i[f+0],p=n[c>>>24&255]^o[u>>>16&255]^a[l>>>8&255]^h[s>>>0&255]^i[f+1],g=n[u>>>24&255]^o[l>>>16&255]^a[s>>>8&255]^h[c>>>0&255]^i[f+2],m=n[l>>>24&255]^o[s>>>16&255]^a[c>>>8&255]^h[u>>>0&255]^i[f+3];d=4278190080&a[s>>>24&255]^16711680&h[c>>>16&255]^65280&n[u>>>8&255]^255&o[l>>>0&255]^i[f+0],p=4278190080&a[c>>>24&255]^16711680&h[u>>>16&255]^65280&n[l>>>8&255]^255&o[s>>>0&255]^i[f+1],g=4278190080&a[u>>>24&255]^16711680&h[l>>>16&255]^65280&n[s>>>8&255]^255&o[c>>>0&255]^i[f+2],m=4278190080&a[l>>>24&255]^16711680&h[s>>>16&255]^65280&n[c>>>8&255]^255&o[u>>>0&255]^i[f+3];const y=t.allocUnsafe(16);return v(y,d,0),v(y,p,4),v(y,g,8),v(y,m,12),y},g.prototype.decryptBlock=function(e){r(this.userKey,"Cannot use AESKey once it is destroyed.");const i=this.getDecryptKey();let s,n,o,a,h=0,p=b(e,0)^i[h+0],g=b(e,4)^i[h+1],m=b(e,8)^i[h+2],w=b(e,12)^i[h+3],y=this.rounds>>>1;for(;s=c[p>>>24&255]^u[w>>>16&255]^l[m>>>8&255]^f[g>>>0&255]^i[h+4],n=c[g>>>24&255]^u[p>>>16&255]^l[w>>>8&255]^f[m>>>0&255]^i[h+5],o=c[m>>>24&255]^u[g>>>16&255]^l[p>>>8&255]^f[w>>>0&255]^i[h+6],a=c[w>>>24&255]^u[m>>>16&255]^l[g>>>8&255]^f[p>>>0&255]^i[h+7],h+=8,0!=--y;)p=c[s>>>24&255]^u[a>>>16&255]^l[o>>>8&255]^f[n>>>0&255]^i[h+0],g=c[n>>>24&255]^u[s>>>16&255]^l[a>>>8&255]^f[o>>>0&255]^i[h+1],m=c[o>>>24&255]^u[n>>>16&255]^l[s>>>8&255]^f[a>>>0&255]^i[h+2],w=c[a>>>24&255]^u[o>>>16&255]^l[n>>>8&255]^f[s>>>0&255]^i[h+3];p=d[s>>>24&255]<<24^d[a>>>16&255]<<16^d[o>>>8&255]<<8^d[n>>>0&255]<<0^i[h+0],g=d[n>>>24&255]<<24^d[s>>>16&255]<<16^d[a>>>8&255]<<8^d[o>>>0&255]<<0^i[h+1],m=d[o>>>24&255]<<24^d[n>>>16&255]<<16^d[s>>>8&255]<<8^d[a>>>0&255]<<0^i[h+2],w=d[a>>>24&255]<<24^d[o>>>16&255]<<16^d[n>>>8&255]<<8^d[s>>>0&255]<<0^i[h+3];const k=t.allocUnsafe(16);return v(k,p,0),v(k,g,4),v(k,m,8),v(k,w,12),k},m.prototype.update=function(e){const i=[];this.waiting&&(e=k(this.waiting,e),this.waiting=null);const r=e.length%16,s=e.length-r;for(let t=0;t<s;t+=16){let r=e.slice(t,t+16);"cbc"===this.mode&&(r=y(r,this.prev)),this.prev=this.key.encryptBlock(r),i.push(this.prev)}return r>0&&(this.waiting=e.slice(s)),t.concat(i)},m.prototype.final=function(){let e;if(this.waiting){const i=16-this.waiting.length,r=t.allocUnsafe(i);r.fill(i),e=k(this.waiting,r)}else(e=t.allocUnsafe(16)).fill(16);return"cbc"===this.mode&&(e=y(e,this.prev)),e=this.key.encryptBlock(e),this.key.destroy(),e},w.prototype.update=function(e){const i=[];this.waiting&&(e=k(this.waiting,e),this.waiting=null);const r=e.length%16,s=e.length-r;for(let t=0;t<s;t+=16){const r=this.prev;this.prev=e.slice(t,t+16);let s=this.key.decryptBlock(this.prev);"cbc"===this.mode&&(s=y(s,r)),i.push(s)}return r>0&&(this.waiting=e.slice(s)),this.lastBlock&&(i.unshift(this.lastBlock),this.lastBlock=null),this.lastBlock=i.pop(),t.concat(i)},w.prototype.final=function(){this.key.destroy(),r(!this.waiting,"Bad decrypt (trailing bytes)."),r(this.lastBlock,"Bad decrypt (no data).");let e=this.lastBlock,i=16;const s=e[i-1];if(0===s||s>i)throw new Error("Bad decrypt (padding).");for(let t=0;t<s;t++)if(e[--i]!==s)throw new Error("Bad decrypt (padding).");return 16===s?t.alloc(0):e=e.slice(0,-s)},s.encrypt=function(t,e,i,r,s){const n=new m(e,i,r,s);return k(n.update(t),n.final())},s.decrypt=function(t,e,i,r,s){const n=new w(e,i,r,s);return k(n.update(t),n.final())},s.encipher=function(e,i,n){return r(t.isBuffer(e)),r(32===i.length),r(16===n.length),s.encrypt(e,i,n,256,"cbc")},s.decipher=function(e,i,n){return r(t.isBuffer(e)),r(32===i.length),r(16===n.length),s.decrypt(e,i,n,256,"cbc")}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * hd.js - hd keys for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(201),n=i(358),o=i(178),a=i(405),h=i(402),c=e;c.fromBase58=function(t,e){return o.isBase58(t)?o.fromBase58(t,e):a.fromBase58(t,e)},c.generate=function(t){return o.generate(t)},c.fromSeed=function(t,e){return o.fromSeed(t,e)},c.fromMnemonic=function(t,e){return o.fromMnemonic(t,e)},c.fromJSON=function(t,e){return t.xprivkey?o.fromJSON(t,e):a.fromJSON(t,e)},c.fromRaw=function(t,e){return o.isRaw(t,e)?o.fromRaw(t,e):a.fromRaw(t,e)},c.from=function(t,e){if(r(t,"Options required."),c.isHD(t))return t;if(c.isBase58(t,e))return c.fromBase58(t,e);if(c.isRaw(t,e))return c.fromRaw(t,e);if(t&&"object"==typeof t)return c.fromMnemonic(t,e);throw new Error("Cannot create HD key from bad options.")},c.isBase58=function(t,e){return o.isBase58(t,e)||a.isBase58(t,e)},c.isRaw=function(t,e){return o.isRaw(t,e)||a.isRaw(t,e)},c.isHD=function(t){return o.isHDPrivateKey(t)||a.isHDPublicKey(t)},c.isPrivate=function(t){return o.isHDPrivateKey(t)},c.isPublic=function(t){return a.isHDPublicKey(t)},c.common=s,c.HD=c,c.Mnemonic=n,c.PrivateKey=o,c.PublicKey=a,c.wordlist=h},function(t,e,i){"use strict";
/*!
 * common.js - common functions for hd
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(98),n=e;n.HARDENED=2147483648,n.MIN_ENTROPY=128,n.MAX_ENTROPY=512,n.cache=new s(500),n.parsePath=function(t,e){r("string"==typeof t),r("boolean"==typeof e),r(t.length>=1),r(t.length<=3062);const i=t.split("/"),s=i[0];if("m"!==s&&"M"!==s&&"m'"!==s&&"M'"!==s)throw new Error("Invalid path root.");const o=[];for(let t=1;t<i.length;t++){let r=i[t];const s="'"===r[r.length-1];if(s&&(r=r.slice(0,-1)),r.length>10)throw new Error("Path index too large.");if(!/^\d+$/.test(r))throw new Error("Path index is non-numeric.");let a=parseInt(r,10);if(a>>>0!==a)throw new Error("Path index out of range.");if(s&&(a|=n.HARDENED,a>>>=0),!e&&a&n.HARDENED)throw new Error("Path index cannot be hardened.");o.push(a)}return o},n.isMaster=function(t){return 0===t.depth&&0===t.childIndex&&0===t.parentFingerPrint},n.isAccount=function(t,e){if(null!=e){const i=(n.HARDENED|e)>>>0;if(t.childIndex!==i)return!1}return 3===t.depth&&0!=(t.childIndex&n.HARDENED)}},function(t,e,i){
/*!
 * event.js - Intelligent RPC function for gamegold.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
let r=[];[i(512),i(513),i(514),i(515),i(516)].map(t=>{e[t.prefix]=t,r=r.concat(t.getPublishEvents())}),e.eventList=r,e.broadcast=function(t,i){let r=t.split("/");r&&r.length>=2&&e[r[0]]&&e[r[0]].broadcast(r[1],i)}},function(t,e,i){"use strict";
/*!
 * fees.js - fee estimation for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 * Ported from:
 * https://github.com/bitcoin/bitcoin/blob/master/src/policy/fees.cpp
 */const r=i(1),s=i(3),n=i(10),o=i(33),a=i(2),h=i(6),c=i(4),u=i(45),l=i(518),f=(i(182),15),d=.998,p=.95,g=.5,m=1,w=.2,y=10,b=1e6,v=n.MAX_MONEY,k=10,S=1e16,x=1e9*n.MAX_MONEY,E=1.1,R=2;class _{constructor(t){this.logger=u.global,this.minTrackedFee=y,this.minTrackedPri=k,this.feeStats=new l("FeeRate"),this.priStats=new l("Priority"),this.feeUnlikely=0,this.feeLikely=v,this.priUnlikely=0,this.priLikely=x,this.map=new Map,this.bestHeight=0,o.MIN_RELAY>=y&&(this.minTrackedFee=o.MIN_RELAY),o.FREE_THRESHOLD>=k&&(this.minTrackedPri=o.FREE_THRESHOLD),t&&(r("object"==typeof t),this.logger=t.context("fees"),this.feeStats.logger=this.logger,this.priStats.logger=this.logger)}init(){const t=this.minTrackedFee,e=this.minTrackedPri,i=[];for(let e=t;e<=b;e*=E)i.push(e);i.push(v);const r=[];for(let t=e;t<=S;t*=R)r.push(t);r.push(x),this.feeStats.init(i,f,d),this.priStats.init(r,f,d)}reset(){this.feeUnlikely=0,this.feeLikely=v,this.priUnlikely=0,this.priLikely=x,this.map.clear(),this.bestHeight=0,this.init()}removeTX(t){const e=this.map.get(t);e?(this.feeStats.removeTX(e.blockHeight,this.bestHeight,e.bucketIndex),this.map.delete(t)):this.logger.spam("Mempool tx %s not found.",s.revHex(t))}isFeePoint(t,e){return e<this.minTrackedPri&&t>=this.minTrackedFee||e<this.priUnlikely&&t>this.feeLikely}isPriPoint(t,e){return t<this.minTrackedFee&&e>=this.minTrackedPri||t<this.feeUnlikely&&e>this.priLikely}processTX(t,e){const i=t.height,r=t.hash("hex");if(this.map.has(r))return void this.logger.debug("Mempool tx %s already tracked.",t.txid());if(i<this.bestHeight)return;if(!e)return;if(t.dependencies)return;const s=t.getFee(),n=t.getRate(),o=t.getPriority(i);if(this.logger.spam("Processing mempool tx %s.",t.txid()),0===s||this.isPriPoint(n,o)){const t=new A;t.blockHeight=i,t.bucketIndex=this.priStats.addTX(i,o),this.map.set(r,t)}else if(this.isFeePoint(n,o)){const t=new A;t.blockHeight=i,t.bucketIndex=this.feeStats.addTX(i,n),this.map.set(r,t)}else this.logger.spam("Not adding tx %s.",t.txid())}processBlockTX(t,e){if(e.dependencies)return;const i=t-e.height;if(i<=0)return void this.logger.debug("Block tx %s had negative blocks to confirm (%d, %d).",e.txid(),t,e.height);const r=e.getFee(),s=e.getRate(),n=e.getPriority(t);0===r||this.isPriPoint(s,n)?this.priStats.record(i,n):this.isFeePoint(s,n)&&this.feeStats.record(i,s)}processBlock(t,e,i){if(!(t<=this.bestHeight)&&(this.bestHeight=t,0!==e.length&&i)){this.logger.debug("Recalculating dynamic cutoffs."),this.feeLikely=this.feeStats.estimateMedian(2,m,p,!0,t),-1===this.feeLikely&&(this.feeLikely=v),this.feeUnlikely=this.feeStats.estimateMedian(10,m,g,!1,t),-1===this.feeUnlikely&&(this.feeUnlikely=0),this.priLikely=this.priStats.estimateMedian(2,w,p,!0,t),-1===this.priLikely&&(this.priLikely=x),this.priUnlikely=this.priStats.estimateMedian(10,w,g,!1,t),-1===this.priUnlikely&&(this.priUnlikely=0),this.feeStats.clearCurrent(t),this.priStats.clearCurrent(t);for(const i of e)this.processBlockTX(t,i);this.feeStats.updateAverages(),this.priStats.updateAverages(),this.logger.debug("Done updating estimates for %d confirmed entries. New mempool map size %d.",e.length,this.map.size),this.logger.debug("New fee rate: %d.",this.estimateFee())}}estimateFee(t,e){if(t||(t=1),null==e&&(e=!0),r(s.isU32(t),"Target must be a number."),r(t<=this.feeStats.maxConfirms,"Too many confirmations for estimate."),!e){const e=this.feeStats.estimateMedian(t,m,p,!0,this.bestHeight);return e<0?0:Math.floor(e)}let i=-1;for(;i<0&&t<=this.feeStats.maxConfirms;)i=this.feeStats.estimateMedian(t++,m,p,!0,this.bestHeight);return t-=1,i<0?0:Math.floor(i)}estimatePriority(t,e){if(t||(t=1),null==e&&(e=!0),r(s.isU32(t),"Target must be a number."),r(t<=this.priStats.maxConfirms,"Too many confirmations for estimate."),!e){const e=this.priStats.estimateMedian(t,w,p,!0,this.bestHeight);return Math.floor(e)}let i=-1;for(;i<0&&t<=this.priStats.maxConfirms;)i=this.priStats.estimateMedian(t++,w,p,!0,this.bestHeight);return t-=1,i<0?0:Math.floor(i)}getSize(){let t=0;return(t+=5)+c.sizeVarlen(this.feeStats.getSize())}toRaw(){const t=this.getSize(),e=new h(t);return e.writeU8(_.VERSION),e.writeU32(this.bestHeight),e.writeVarBytes(this.feeStats.toRaw()),e.render()}fromRaw(t){const e=new a(t);if(e.readU8()!==_.VERSION)throw new Error("Bad serialization version for estimator.");return this.bestHeight=e.readU32(),this.feeStats.fromRaw(e.readVarBytes()),this}static fromRaw(t,e){return new _(e).fromRaw(t)}inject(t){return this.bestHeight=t.bestHeight,this.feeStats=t.feeStats,this}}function A(){this.blockHeight=-1,this.bucketIndex=-1}_.VERSION=0,t.exports=_},function(t,e,i){"use strict";(function(e){
/*!
 * rollingfilter.js - rolling bloom filter for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(108),n=s.sum32,o=s.mul32,a=e.alloc(0);function h(t,e){if(!(this instanceof h))return new h(t,e);this.entries=0,this.generation=1,this.n=0,this.limit=0,this.size=0,this.items=0,this.tweak=0,this.filter=a,null!=t&&this.fromRate(t,e)}function c(t,e){return new function(t,e){this.hi=t,this.lo=e}(t.readUInt32LE(e+4,!0),t.readUInt32LE(e,!0))}function u(t,e,i){t.writeUInt32LE(e.hi,i+4,!0),t.writeUInt32LE(e.lo,i,!0)}h.prototype.fromRate=function(t,i){r("number"==typeof t,"`items` must be a number."),r(t>0,"`items` must be greater than zero."),r(Number.isSafeInteger(t),"`items` must be an integer."),r("number"==typeof i,"`rate` must be a number."),r(i>=0&&i<=1,"`rate` must be between 0.0 and 1.0.");const s=Math.log(i),n=Math.max(1,Math.min(Math.round(s/Math.log(.5)),50)),o=(t+1)/2|0;let a=-1*n*(3*o)/Math.log(1-Math.exp(s/n));t=(((a=Math.ceil(a))+63)/64|0)<<1,t>>>=0,t=Math.max(1,t);const h=4294967296*Math.random()>>>0,c=e.allocUnsafe(8*t);return c.fill(0),this.n=n,this.limit=o,this.size=a,this.items=t,this.tweak=h,this.filter=c,this},h.fromRate=function(t,e){return(new h).fromRate(t,e)},h.prototype.hash=function(t,e){return s(t,n(o(e,4221880213),this.tweak))},h.prototype.reset=function(){0!==this.entries&&(this.entries=0,this.generation=1,this.filter.fill(0))},h.prototype.add=function(t,i){if("string"==typeof t&&(t=e.from(t,i)),this.entries===this.limit){this.entries=0,this.generation+=1,4===this.generation&&(this.generation=1);const t=4294967295*(1&this.generation),e=4294967295*(this.generation>>>1);for(let i=0;i<this.items;i+=2){const r=8*i,s=8*(i+1),n=c(this.filter,r),o=c(this.filter,s),a=n.hi^t|o.hi^e,h=n.lo^t|o.lo^e;n.hi&=a,n.lo&=h,o.hi&=a,o.lo&=h,n.hi=n.hi>>>0,n.lo=n.lo>>>0,o.hi=o.hi>>>0,o.lo=o.lo>>>0,u(this.filter,n,r),u(this.filter,o,s)}}this.entries+=1;for(let e=0;e<this.n;e++){const i=this.hash(t,e),r=63&i,s=(i>>>6)%this.items,n=8*(-2&s),o=8*(1|s),a=r%8,h=(r-a)/8;this.filter[n+h]&=~(1<<a),this.filter[n+h]|=(1&this.generation)<<a,this.filter[o+h]&=~(1<<a),this.filter[o+h]|=this.generation>>>1<<a}},h.prototype.test=function(t,i){if(0===this.entries)return!1;"string"==typeof t&&(t=e.from(t,i));for(let e=0;e<this.n;e++){const i=this.hash(t,e),r=63&i,s=(i>>>6)%this.items,n=8*(-2&s),o=8*(1|s),a=r%8,h=(r-a)/8;if(0==(this.filter[n+h]>>>a&1|this.filter[o+h]>>>a&1))return!1}return!0},h.prototype.added=function(t,i){return"string"==typeof t&&(t=e.from(t,i)),!this.test(t)&&(this.add(t),!0)},t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * template.js - block template object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(9),o=i(96),a=i(6),h=i(26),c=i(17),u=i(52),l=i(68),f=i(28),d=i(10),p=i(4),g=i(44),m=i(20),w=i(92),y=i(410),b=i(526),v=i(527),k=e.alloc(0),{OperType:S}=i(8),x=i(53);class E{constructor(t){this.prevBlock=p.NULL_HASH,this.version=1,this.height=0,this.time=0,this.bits=0,this.target=p.ZERO_HASH,this.locktime=0,this.mtp=0,this.flags=0,this.coinbaseFlags=k,this.witness=!1,this.address=new h,this.sigops=400,this.weight=4e3,this.interval=21e4,this.fees=0,this.tree=new b,this.commitment=p.ZERO_HASH,this.left=k,this.right=k,this.items=[],this.token=null,t&&this.fromOptions(t)}fromOptions(t){return r(t),null!=t.prevBlock&&(r("string"==typeof t.prevBlock),this.prevBlock=t.prevBlock),null!=t.version&&(r("number"==typeof t.version),this.version=t.version),null!=t.height&&(r("number"==typeof t.height),this.height=t.height),null!=t.time&&(r("number"==typeof t.time),this.time=t.time),null!=t.bits&&this.setBits(t.bits),null!=t.target&&this.setTarget(t.target),null!=t.locktime&&(r("number"==typeof t.locktime),this.locktime=t.locktime),null!=t.mtp&&(r("number"==typeof t.mtp),this.mtp=t.mtp),null!=t.flags&&(r("number"==typeof t.flags),this.flags=t.flags),null!=t.coinbaseFlags&&(r(e.isBuffer(t.coinbaseFlags)),this.coinbaseFlags=t.coinbaseFlags),null!=t.witness&&(r("boolean"==typeof t.witness),this.witness=t.witness),null!=t.address&&this.address.fromOptions(t.address),null!=t.sigops&&(r("number"==typeof t.sigops),this.sigops=t.sigops),null!=t.weight&&(r("number"==typeof t.weight),this.weight=t.weight),null!=t.interval&&(r("number"==typeof t.interval),this.interval=t.interval),null!=t.fees&&(r("number"==typeof t.fees),this.fees=t.fees),null!=t.items&&(r(Array.isArray(t.items)),this.items=t.items),this}static fromOptions(t){return(new E).fromOptions(t)}getWitnessHash(){const t=p.ZERO_HASH,e=[];e.push(p.ZERO_HASH);for(const t of this.items)e.push(t.tx.witnessHash());const[i,s]=o.createRoot(e);return r(!s),n.root256(i,t)}getWitnessScript(){return m.fromCommitment(this.commitment)}setBits(t){r("number"==typeof t),this.bits=t,this.target=w.bits2Hash(t)}setTarget(t){r(e.isBuffer(t)),this.bits=w.hash2Bits(t),this.target=t}getReward(){return d.getReward(this.height,this.interval)+this.fees}awardCP(){let t=[],e=0;for(let t of this.items)for(let i of t.tx.outputs)e+=i.value;for(let i of this.items){let r=i.tx,s=x.parseContract(r);s&&s.oper==S.payOrder&&t.push([r.outputs[1].getAddress(),r.outputs[1].value/e])}return t}createCoinbase(t,e=null){const i=d.WITNESS_SCALE_FACTOR,n=new c,o=new l;o.script.pushInt(this.height),o.script.pushData(p.ZERO_HASH160),o.script.pushData(s.nonce(4)),o.script.pushData(p.ZERO_U64),o.script.compile(),this.witness&&(o.witness.push(p.ZERO_HASH),o.witness.compile()),n.inputs.push(o);let a=new f;if(e){let t=this.getReward(),i=this.awardCP();if(i&&i.length>0)for(let[e,r]of i){let i=t*r|0;i>0&&i<=t&&(n.outputs.push(f.fromScript(e,i)),t-=i)}a=f.fromScript(e.addr,t,e)}else a.script.createScript(p.ZERO_HASH160),a.value=this.getReward();if(n.outputs.splice(0,0,a),this.witness){const e=new f;e.script.fromCommitment(t),n.outputs.push(e)}const h=o.script.get(0);r(h);const u=5-h.getSize();return r(u>=0),this.witness?e||(r.strictEqual(n.getWeight()+u*i,724),r.strictEqual(n.getBaseSize()+u,172),r.strictEqual(n.getSize()+u,208)):(r.strictEqual(n.getWeight()+u*i,500),r.strictEqual(n.getBaseSize()+u,125),r.strictEqual(n.getSize()+u,125)),o.script.setData(1,this.coinbaseFlags),o.script.compile(),e||a.script.fromAddress(this.address),n.refresh(),r(o.script.getSize()<=100,"Coinbase input script is too large!"),n}refresh(t){t&&(this.token=t);const e=this.getWitnessHash(),i=this.createCoinbase(e,this.token),r=i.toNormal();let s=0;s+=4,s+=1,s+=i.inputs[0].getSize(),s-=12;const n=r.slice(0,s);s+=8;const o=r.slice(s);this.commitment=e,this.left=n,this.right=o,this.tree=b.fromItems(this.items)}getRawCoinbase(t,e){let i=0;i+=this.left.length,i+=8,i+=this.right.length;const r=new a(i);return r.writeBytes(this.left),r.writeU32BE(t),r.writeU32BE(e),r.writeBytes(this.right),r.render()}getRoot(t,e){const i=this.getRawCoinbase(t,e),r=n.hash256(i);return this.tree.withFirst(r)}getHeader(t,e,i){const r=new a(80);return r.writeU32(this.version),r.writeHash(this.prevBlock),r.writeHash(t),r.writeU32(e),r.writeU32(this.bits),r.writeU32(i),r.render()}getProof(t,e,i,r){const s=this.getRoot(t,e),o=this.getHeader(s,i,r),a=n.hash256(o);return new v(a,s,t,e,i,r)}getCoinbase(t,e){const i=this.getRawCoinbase(t,e),r=c.fromRaw(i);if(this.witness){const t=r.inputs[0];t.witness.push(p.ZERO_HASH),t.witness.compile(),r.refresh()}return r}commit(t){const e=t.root,i=t.nonce1,r=t.nonce2,s=t.time,n=t.nonce,o=new u;o.version=this.version,o.prevBlock=this.prevBlock,o.merkleRoot=e.toString("hex"),o.time=s,o.bits=this.bits,o.nonce=n;const a=this.getCoinbase(i,r);o.txs.push(a);for(const t of this.items)o.txs.push(t.tx);return o}toCoinbase(){return this.getCoinbase(0,0)}toBlock(){const t=this.getProof(0,0,this.time,0);return this.commit(t)}getDifficulty(){return w.hash2Bits(this.target)}setAddress(t){this.address=h(t),this.refresh()}addTX(t,e){r(!t.mutable,"Cannot add mutable TX to block.");const i=y.fromTX(t,e,this),s=i.tx.getWeight(),n=i.sigops;return!(!t.isFinal(this.height,this.locktime)||this.weight+s>d.MAX_BLOCK_WEIGHT||this.sigops+n>d.MAX_BLOCK_SIGOPS_COST||!this.witness&&t.hasWitness()||(this.weight+=s,this.sigops+=n,this.fees+=i.fee,this.items.push(i),0))}pushTX(t,e){r(!t.mutable,"Cannot add mutable TX to block."),e||(e=new g);const i=y.fromTX(t,e,this),s=i.tx.getWeight(),n=i.sigops;return this.weight+=s,this.sigops+=n,this.fees+=i.fee,this.items.push(i),!0}}t.exports=E}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * bip150.js - peer auth.
 * related: AuthDB.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 * Resources:
 *   https://github.com/bitcoin/bips/blob/master/bip-0150.mediawiki
 */
const r=i(1),s=i(24),n=i(35),o=i(9),a=i(93),h=i(109),c=i(94),u=i(30),l=i(6),f=i(56),d=i(4),p=i(367);class g extends s{constructor(t,i,s,n,o){super(),r(t,"BIP150 requires BIP151."),r("string"==typeof i,"Hostname required."),r("boolean"==typeof s,"Outbound flag required."),r(n instanceof p,"Auth DB required."),r(e.isBuffer(o),"Identity key required."),this.bip151=t,this.input=t.input,this.output=t.output,this.hostname=i,this.outbound=s,this.db=n,this.privateKey=o,this.publicKey=u.publicKeyCreate(o,!0),this.peerIdentity=null,this.challengeReceived=!1,this.replyReceived=!1,this.proposeReceived=!1,this.challengeSent=!1,this.auth=!1,this.completed=!1,this.job=null,this.timeout=null,this.onAuth=null,this._init()}_init(){this.outbound&&(this.peerIdentity=this.db.getKnown(this.hostname))}isAuthed(){return this.outbound?this.challengeSent&&this.challengeReceived:this.challengeReceived&&this.replyReceived}challenge(t){const e=this.outbound?"r":"i";if(r(this.bip151.handshake,"No BIP151 handshake before challenge."),r(!this.challengeReceived,"Peer challenged twice."),this.challengeReceived=!0,t.equals(d.ZERO_HASH))throw new Error("Auth failure.");const i=this.hash(this.input.sid,e,this.publicKey);if(!h(t,i))return d.ZERO_SIG64;this.isAuthed()&&(this.auth=!0,this.emit("auth"));const s=u.sign(i,this.privateKey);return u.fromDER(s)}reply(t){const e=this.outbound?"i":"r";if(r(this.challengeSent,"Unsolicited reply."),r(!this.replyReceived,"Peer replied twice."),this.replyReceived=!0,t.equals(d.ZERO_SIG64))throw new Error("Auth failure.");if(!this.peerIdentity)return a.randomBytes(32);const i=u.toDER(t),s=this.hash(this.output.sid,e,this.peerIdentity);return u.verify(s,i,this.peerIdentity)?this.isAuthed()?(this.auth=!0,this.emit("auth"),null):(r(this.outbound,"No challenge received before reply on inbound."),this.hash(this.input.sid,"p",this.publicKey)):a.randomBytes(32)}propose(t){r(!this.outbound,"Outbound peer tried to propose."),r(!this.challengeSent,"Unsolicited propose."),r(!this.proposeReceived,"Peer proposed twice."),this.proposeReceived=!0;const e=this.findAuthorized(t);return e?(this.peerIdentity=e,this.db.addKnown(this.hostname,this.peerIdentity),this.challengeSent=!0,this.hash(this.output.sid,"r",this.peerIdentity)):d.ZERO_HASH}toChallenge(){r(this.bip151.handshake,"No BIP151 handshake before challenge."),r(this.outbound,"Cannot challenge an inbound connection."),r(this.peerIdentity,"Cannot challenge without a peer identity.");const t=this.hash(this.output.sid,"i",this.peerIdentity);return r(!this.challengeSent,"Cannot initiate challenge twice."),this.challengeSent=!0,new c.AuthChallengePacket(t)}rekey(t,i,r,s){const n=e.allocUnsafe(130);return t.copy(n,0),i.copy(n,32),r.copy(n,64),s.copy(n,97),o.hash256(n)}rekeyInput(){const t=this.input,e=this.peerIdentity,i=this.publicKey,r=this.rekey(t.sid,t.k1,e,i),s=this.rekey(t.sid,t.k2,e,i);t.rekey(r,s)}rekeyOutput(){const t=this.output,e=this.publicKey,i=this.peerIdentity,r=this.rekey(t.sid,t.k1,e,i),s=this.rekey(t.sid,t.k2,e,i);t.rekey(r,s)}hash(t,i,r){const s=e.allocUnsafe(66);return t.copy(s,0),s[32]=i.charCodeAt(0),r.copy(s,33),o.hash256(s)}findAuthorized(t){for(const e of this.db.authorized){const i=this.hash(this.output.sid,"p",e);if(h(i,t))return e}return null}destroy(){this.job&&this.reject(new Error("BIP150 stream was destroyed."))}cleanup(){const t=this.job;return r(!this.completed,"Already completed."),r(t,"No completion job."),this.completed=!0,this.job=null,null!=this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.onAuth&&(this.removeListener("auth",this.onAuth),this.onAuth=null),t}resolve(t){this.cleanup().resolve(t)}reject(t){this.cleanup().reject(t)}wait(t){return new Promise((e,i)=>{this._wait(t,e,i)})}_wait(t,e,i){r(!this.auth,"Cannot wait for init after handshake."),this.job=n.job(e,i),!this.outbound||this.peerIdentity?(this.timeout=setTimeout(()=>{this.reject(new Error("BIP150 handshake timed out."))},t),this.onAuth=this.resolve.bind(this),this.once("auth",this.onAuth)):this.reject(new Error(`No identity for ${this.hostname}.`))}getAddress(){return r(this.peerIdentity,"Cannot serialize address."),g.address(this.peerIdentity)}static address(t){const e=new l(27);return e.writeU8(15),e.writeU16BE(65281),e.writeBytes(o.hash160(t)),e.writeChecksum(),f.encode(e.render())}}t.exports=g}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * packetCmd.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(3),s=i(22);t.exports=r.reverse(s)},function(t,e,i){"use strict";(function(e){
/*!
 * bip151.js - peer-to-peer communication encryption.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 * Resources:
 *   https://github.com/bitcoin/bips/blob/master/bip-0151.mediawiki
 *   https://github.com/openssh/openssh-portable/blob/master/PROTOCOL.chacha20poly1305
 *   https://github.com/openssh/openssh-portable/blob/master/cipher-chachapoly.c
 *   https://github.com/openssh/openssh-portable/blob/master/cipher.c
 *   https://github.com/openssh/openssh-portable/blob/master/packet.c
 */
const r=i(1),s=i(24),n=i(3),o=i(35),a=i(9),h=i(355),c=i(356),u=i(398),l=i(399),f=i(30),d=i(6),p=i(2),g=i(4),m=i(94),w=e.from("bitcoinecdh","ascii"),y=e.from("BitcoinK1","ascii"),b=e.from("BitcoinK2","ascii"),v=e.from("BitcoinSessionID","ascii"),k=1073741824;class S{constructor(t){this.cipher=x.ciphers.CHACHAPOLY,this.privateKey=f.generatePrivateKey(),this.publicKey=null,this.k1=null,this.k2=null,this.sid=null,null!=t&&(r(t===x.ciphers.CHACHAPOLY,"Unknown cipher type."),this.cipher=t),this.chacha=new h,this.aead=new u,this.tag=null,this.seq=0,this.iv=e.allocUnsafe(8),this.iv.fill(0),this.processed=0,this.lastRekey=0}init(t){r(e.isBuffer(t)),this.publicKey=t;const i=f.ecdh(this.publicKey,this.privateKey),s=d.pool(33);s.writeBytes(i),s.writeU8(this.cipher);const o=s.render(),a=l.extract(o,w,"sha256");this.k1=l.expand(a,y,32,"sha256"),this.k2=l.expand(a,b,32,"sha256"),this.sid=l.expand(a,v,32,"sha256"),this.seq=0,this.update(),this.chacha.init(this.k1,this.iv),this.aead.init(this.k2,this.iv),this.lastRekey=n.now()}shouldRekey(t){const e=n.now();return this.processed+=t.length,(e>=this.lastRekey+10||this.processed>=k)&&(this.lastRekey=e,this.processed=0,!0)}rekey(t,e){r(this.sid,"Cannot rekey before initialization."),t?(this.k1=t,this.k2=e):(this.k1=a.root256(this.sid,this.k1),this.k2=a.root256(this.sid,this.k2)),r(this.k1),r(this.k2),this.chacha.init(this.k1,this.iv),this.aead.init(this.k2,this.iv)}sequence(){4294967296==++this.seq&&(this.seq=0),this.update(),this.chacha.init(null,this.iv),this.aead.init(null,this.iv)}update(){return this.iv.writeUInt32LE(this.seq,0,!0),this.iv}getPublicKey(){return f.publicKeyCreate(this.privateKey,!0)}encryptSize(t){return this.chacha.encrypt(t.slice(0,4))}decryptSize(t){return this.chacha.encrypt(t),t.readUInt32LE(0,!0)}encrypt(t){return this.aead.encrypt(t)}decrypt(t){return this.aead.chacha20.encrypt(t)}auth(t){return this.aead.auth(t)}finish(){return this.tag=this.aead.finish(),this.tag}verify(t){return c.verify(this.tag,t)}}class x extends s{constructor(t){super(),this.input=new S(t),this.output=new S(t),this.initReceived=!1,this.ackReceived=!1,this.initSent=!1,this.ackSent=!1,this.completed=!1,this.handshake=!1,this.pending=[],this.total=0,this.waiting=4,this.hasSize=!1,this.timeout=null,this.job=null,this.onShake=null,this.bip150=null}error(){const t=n.fmt.apply(n,arguments);this.emit("error",new Error(t))}isReady(){return this.initSent&&this.ackReceived&&this.initReceived&&this.ackSent}toEncinit(){return r(!this.initSent,"Cannot init twice."),this.initSent=!0,new m.EncinitPacket(this.input.getPublicKey(),this.input.cipher)}toEncack(){return r(this.output.sid,"Cannot ack before init."),r(!this.ackSent,"Cannot ack twice."),this.ackSent=!0,this.isReady()&&(r(!this.completed,"No encack after timeout."),this.handshake=!0,this.emit("handshake")),new m.EncackPacket(this.output.getPublicKey())}toRekey(){return r(this.handshake,"Cannot rekey before handshake."),new m.EncackPacket(g.ZERO_KEY)}encinit(t,e){r(e===this.output.cipher,"Cipher mismatch."),r(!this.initReceived,"Already initialized."),r(!this.completed,"No encinit after timeout."),this.initReceived=!0,this.output.init(t)}encack(t){if(r(this.initSent,"Unsolicited ACK."),t.equals(g.ZERO_KEY))return r(this.handshake,"No initialization before rekey."),this.bip150&&this.bip150.auth?void this.bip150.rekeyInput():void this.input.rekey();r(!this.ackReceived,"Already ACKed."),r(!this.completed,"No encack after timeout."),this.ackReceived=!0,this.input.init(t),this.isReady()&&(this.handshake=!0,this.emit("handshake"))}cleanup(){const t=this.job;return r(!this.completed,"Already completed."),r(t,"No completion job."),this.completed=!0,this.job=null,null!=this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.onShake&&(this.removeListener("handshake",this.onShake),this.onShake=null),t}resolve(t){this.cleanup().resolve(t)}reject(t){this.cleanup().reject(t)}wait(t){return new Promise((e,i)=>{this._wait(t,e,i)})}_wait(t,e,i){r(!this.handshake,"Cannot wait for init after handshake."),this.job=o.job(e,i),this.timeout=setTimeout(()=>{this.reject(new Error("BIP151 handshake timed out."))},t),this.onShake=this.resolve.bind(this),this.once("handshake",this.onShake)}destroy(){this.job&&this.reject(new Error("BIP151 stream was destroyed."))}maybeRekey(t){this.output.shouldRekey(t)&&(this.emit("rekey"),this.bip150&&this.bip150.auth?this.bip150.rekeyOutput():this.output.rekey())}packetSize(t,e){let i=0;return i+=4,i+=g.sizeVarString(t,"ascii"),i+=4,(i+=e.length)+16}packet(t,e){const i=this.packetSize(t,e),r=new d(i),s=i-20;r.writeU32(s),r.writeVarString(t,"ascii"),r.writeU32(e.length),r.writeBytes(e),r.seek(16);const n=r.render(),o=n.slice(4,4+s);return this.maybeRekey(n),this.output.encryptSize(n),this.output.encrypt(o),this.output.finish().copy(n,4+s),this.output.sequence(),n}feed(t){for(this.total+=t.length,this.pending.push(t);this.total>=this.waiting;){const t=this.read(this.waiting);this.parse(t)}}read(t){if(r(this.total>=t,"Reading too much."),0===t)return e.alloc(0);const i=this.pending[0];if(i.length>t){const e=i.slice(0,t);return this.pending[0]=i.slice(t),this.total-=e.length,e}if(i.length===t){const t=this.pending.shift();return this.total-=t.length,t}const s=e.allocUnsafe(t);let n=0;for(;n<s.length;){const t=this.pending[0],e=t.copy(s,n);e===t.length?this.pending.shift():this.pending[0]=t.slice(e),n+=e}return r.strictEqual(n,s.length),this.total-=s.length,s}parse(t){if(!this.hasSize){const e=this.input.decryptSize(t);return r(4===this.waiting),r(4===t.length),e<6||e>x.MAX_MESSAGE?void this.error("Bad packet size: %d.",n.mb(e)):(this.hasSize=!0,void(this.waiting=e+16))}const e=t.slice(0,this.waiting-16),i=t.slice(this.waiting-16,this.waiting);if(this.hasSize=!1,this.waiting=4,this.input.auth(e),this.input.finish(),!this.input.verify(i))return this.input.sequence(),void this.error("Bad tag: %s.",i.toString("hex"));this.input.decrypt(e),this.input.sequence();const s=new p(e);for(;s.left();){let e,i;try{e=s.readVarString("ascii"),i=s.readBytes(s.readU32())}catch(t){return void this.emit("error",t)}this.emit("packet",e,i)}}}x.ciphers={CHACHAPOLY:0},x.MAX_MESSAGE=12e6,t.exports=x}).call(this,i(0).Buffer)},function(t,e,i){(function(r){function s(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=i(531)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var i=this.useColors;if(t[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+t[0]+(i?"%c ":" ")+"+"+e.humanize(this.diff),i){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var s=0,n=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(n=++s)}),t.splice(n,0,r)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=s,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(s())}).call(this,i(23))},function(t,e){e.encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},e.decode=function(t){for(var e={},i=t.split("&"),r=0,s=i.length;r<s;r++){var n=i[r].split("=");e[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return e}},function(t,e){t.exports=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e,i){(function(r){function s(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=i(546)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var i=this.useColors;if(t[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+t[0]+(i?"%c ":" ")+"+"+e.humanize(this.diff),i){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var s=0,n=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(n=++s)}),t.splice(n,0,r)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=s,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(s())}).call(this,i(23))},function(t,e,i){"use strict";(function(e){
/*!
 * MerkleBlockPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=(i(2),i(13),i(111)),o=(i(18),i(19),i(3)),a=i(65);let h=0;class c extends r{constructor(t,e=s.MERKLEBLOCK){super(e),this.block=t||new n}getSize(){return this.block.getSize()}toWriter(t){return this.block.toWriter(t)}toRaw(){return this.block.toRaw()}fromReader(t){return this.block.fromReader(t),this}fromRaw(t){return this.block.fromRaw(t),this}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new c).fromRaw(t)}async poolHandle(t,e){const i=this.block.hash("hex"),r=await e.locker.lock(i);try{return await this._handleMerkleBlock(t,e)}finally{r()}}async _handleMerkleBlock(t,e){if(!e.syncing)return;if(!e.options.spv)return e.logger.warning("Peer sent unsolicited merkleblock (%s).",t.hostname()),void t.increaseBan(100);const i=this.block,r=i.hash("hex");if(!t.blockMap.has(r))return e.logger.warning("Peer sent an unrequested merkleblock (%s).",t.hostname()),void t.destroy();if(t.merkleBlock)return e.logger.warning("Peer sent a merkleblock prematurely (%s).",t.hostname()),void t.increaseBan(100);if(!i.verify())return e.logger.warning("Peer sent an invalid merkleblock (%s).",t.hostname()),void t.increaseBan(100);const s=i.getTree();if(0!==s.matches.length)e.logger.debug(`new merkle block, matches ${s.matches.length}, total ${h++}`),t.merkleBlock=i,t.merkleTime=o.ms(),t.merkleMatches=s.matches.length,t.merkleMap=new Set;else{const r=a.flags.VERIFY_NONE;await e._addBlock(t,i,r)}}}t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * InvPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(25),n=i(22),o=i(2),a=(i(13),i(6)),h=i(39),c=i(4);i(18),i(19);class u extends s{constructor(t,e=n.INV){super(e),this.items=t||[]}getSize(){let t=0;return(t+=c.sizeVarint(this.items.length))+36*this.items.length}toWriter(t){r(this.items.length<=5e4),t.writeVarint(this.items.length);for(const e of this.items)e.toWriter(t);return t}toRaw(){const t=this.getSize();return this.toWriter(new a(t)).render()}fromReader(t){const e=t.readVarint();r(e<=5e4,"Inv item count too high.");for(let i=0;i<e;i++)this.items.push(h.fromReader(t));return this}fromRaw(t){return this.fromReader(new o(t))}static fromReader(t){return(new u).fromRaw(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new u).fromRaw(t)}async poolHandle(t,e){const i=await e.locker.lock();try{return await this._poolHandle(t,e)}finally{i()}}async _poolHandle(t,e){const i=this.items;if(i.length>5e4)return void t.increaseBan(100);const r=[],s=[];let n=-1;for(const e of i){switch(e.type){case h.types.BLOCK:r.push(e.hash);break;case h.types.TX:s.push(e.hash);break;default:n=e.type;continue}t.invFilter.add(e.hash,"hex")}e.logger.spam("Received inv packet with %d items: blocks=%d txs=%d (%s).",i.length,r.length,s.length,t.hostname()),-1!==n&&e.logger.warning("Peer sent an unknown inv type: %d (%s).",n,t.hostname()),r.length>0&&await this.handleBlockInv(t,e,r),s.length>0&&await this.handleTXInv(t,e,s)}async handleBlockInv(t,e,i){if(r(i.length>0),!e.syncing)return;if(!t.loader||e.chain.synced){const e=i[i.length-1];t.bestHash=e}if(!e.chain.synced&&!t.loader)return;if(e.options.hasWitness()&&!t.hasWitness())return;if(e.checkpoints)return;e.logger.debug("Received %s block hashes from peer (%s).",i.length,t.hostname());const s=[];let n=null;for(let r=0;r<i.length;r++){const o=i[r];e.chain.hasOrphan(o)?(e.logger.debug("Received known orphan hash (%s).",t.hostname()),await e.resolveOrphan(t,o)):await e.hasBlock(o)?(n=o,r===i.length-1&&(e.logger.debug("Received existing hash (%s).",t.hostname()),await e.getBlocks(t,o))):s.push(o)}if(n&&e.chain.synced){const i=await e.chain.getHeight(n);-1!==i&&(t.bestHeight=i)}e.getBlock(t,s)}formatInsight(){return this.items.map(t=>t.formatInsight())}async handleTXInv(t,e,i){r(i.length>0),e.syncing&&!e.chain.synced||e.ensureTX(t,i)}}t.exports=u}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * account.js - account object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(3),s=i(1),n=i(2),o=i(6),a=i(4),h=i(124),c=i(95),u=i(20),l=i(216),f=i(200);class d{constructor(t,e){s(t,"Database is required."),this.db=t,this.network=t.network,this.wallet=null,this.receive=null,this.change=null,this.nested=null,this.wid=0,this.id=null,this.name=null,this.initialized=!1,this.witness=!0===this.db.options.witness,this.watchOnly=!1,this.type=d.types.PUBKEYHASH,this.m=1,this.n=1,this.accountIndex=0,this.receiveDepth=0,this.changeDepth=0,this.nestedDepth=0,this.lookahead=10,this.accountKey=null,this.keys=[],e&&this.fromOptions(e)}fromOptions(t){if(s(t,"Options are required."),s(r.isU32(t.wid)),s(c.isName(t.id),"Bad Wallet ID."),s(f.isHD(t.accountKey),"Account key is required."),s(r.isU32(t.accountIndex),"Account index is required."),this.wid=t.wid,this.id=t.id,null!=t.name&&(s(c.isName(t.name),"Bad account name."),this.name=t.name),null!=t.initialized&&(s("boolean"==typeof t.initialized),this.initialized=t.initialized),null!=t.witness&&(s("boolean"==typeof t.witness),this.witness=t.witness),null!=t.watchOnly&&(s("boolean"==typeof t.watchOnly),this.watchOnly=t.watchOnly),null!=t.type&&("string"==typeof t.type?(this.type=d.types[t.type.toUpperCase()],s(null!=this.type)):(s("number"==typeof t.type),this.type=t.type,s(d.typesByVal[this.type]))),null!=t.m&&(s(r.isU8(t.m)),this.m=t.m),null!=t.n&&(s(r.isU8(t.n)),this.n=t.n),null!=t.accountIndex&&(s(r.isU32(t.accountIndex)),this.accountIndex=t.accountIndex),null!=t.receiveDepth&&(s(r.isU32(t.receiveDepth)),this.receiveDepth=t.receiveDepth),null!=t.changeDepth&&(s(r.isU32(t.changeDepth)),this.changeDepth=t.changeDepth),null!=t.nestedDepth&&(s(r.isU32(t.nestedDepth)),this.nestedDepth=t.nestedDepth),null!=t.lookahead&&(s(r.isU32(t.lookahead)),s(t.lookahead>=0),s(t.lookahead<=d.MAX_LOOKAHEAD),this.lookahead=t.lookahead),this.accountKey=t.accountKey,this.n>1&&(this.type=d.types.MULTISIG),this.name||(this.name=this.accountIndex.toString(10)),this.m<1||this.m>this.n)throw new Error("m ranges between 1 and n");if(t.keys){s(Array.isArray(t.keys));for(const e of t.keys)this.pushKey(e)}return this}static fromOptions(t,e){return new d(t).fromOptions(e)}async init(){if(this.keys.length!==this.n-1)return s(!this.initialized),void this.save();s(0===this.receiveDepth),s(0===this.changeDepth),s(0===this.nestedDepth),this.initialized=!0,await this.initDepth()}open(){return!this.initialized||this.receive?Promise.resolve():(this.receive=this.deriveReceive(this.receiveDepth-1),this.change=this.deriveChange(this.changeDepth-1),this.witness&&(this.nested=this.deriveNested(this.nestedDepth-1)),Promise.resolve())}pushKey(t){if("string"==typeof t&&(t=f.PublicKey.fromBase58(t,this.network)),s(t.network===this.network,"Network mismatch for account key."),!f.isPublic(t))throw new Error("Must add HD keys to wallet.");if(!t.isAccount())throw new Error("Must add HD account keys to BIP44 wallet.");if(this.type!==d.types.MULTISIG)throw new Error("Cannot add keys to non-multisig wallet.");if(t.equals(this.accountKey))throw new Error("Cannot add own key.");if(-1===r.binaryInsert(this.keys,t,p,!0))return!1;if(this.keys.length>this.n-1)throw r.binaryRemove(this.keys,t,p),new Error("Cannot add more keys.");return!0}spliceKey(t){if("string"==typeof t&&(t=f.PublicKey.fromBase58(t,this.network)),s(t.network===this.network,"Network mismatch for account key."),!f.isPublic(t))throw new Error("Must add HD keys to wallet.");if(!t.isAccount())throw new Error("Must add HD account keys to BIP44 wallet.");if(this.type!==d.types.MULTISIG)throw new Error("Cannot remove keys from non-multisig wallet.");if(this.keys.length===this.n-1)throw new Error("Cannot remove key.");return r.binaryRemove(this.keys,t,p)}async addSharedKey(t){const e=this.pushKey(t);if(await this.hasDuplicate())throw this.spliceKey(t),new Error("Cannot add a key from another account.");return await this.init(),e}hasDuplicate(){if(this.keys.length!==this.n-1)return!1;const t=this.deriveReceive(0).getScriptHash("hex");return this.wallet.hasAddress(t)}removeSharedKey(t){return!!this.spliceKey(t)&&(this.save(),!0)}createReceive(){return this.createKey(0)}createChange(){return this.createKey(1)}createNested(){return this.createKey(2)}async createKey(t,e=0,i=null){let r,s;switch(e=(0|e)>>>0,t){case 0:e>0?(r=this.deriveReceive(e,i),await this.saveKey(r)):(r=this.deriveReceive(this.receiveDepth,i),s=this.deriveReceive(this.receiveDepth+this.lookahead,i),this.receiveDepth++,await this.saveKey(s),this.receive=r);break;case 1:e>0?(r=this.deriveChange(e,i),await this.saveKey(r)):(r=this.deriveChange(this.changeDepth,i),s=this.deriveChange(this.changeDepth+this.lookahead,i),this.changeDepth++,await this.saveKey(s),this.change=r);break;case 2:e>0?(r=this.deriveNested(e,i),await this.saveKey(r)):(r=this.deriveNested(this.nestedDepth,i),s=this.deriveNested(this.nestedDepth+this.lookahead,i),this.nestedDepth++,await this.saveKey(s),this.nested=r);break;default:throw new Error(`Bad branch: ${t}.`)}return this.save(),r}deriveReceive(t,e){return this.deriveKey(0,t,e)}deriveChange(t,e){return this.deriveKey(1,t,e)}deriveNested(t,e){if(!this.witness)throw new Error("Cannot derive nested on non-witness account.");return this.deriveKey(2,t,e)}derivePath(t,e){switch(t.keyType){case h.types.HD:return this.deriveKey(t.branch,t.index,e);case h.types.KEY:{s(this.type===d.types.PUBKEYHASH);let i=t.data;return t.encrypted&&!(i=e.decipher(i,t.hash))?null:l.fromImport(this,i)}case h.types.ADDRESS:return null;default:throw new Error("Bad key type.")}}deriveKey(t,e,i){s("number"==typeof t);const r=[];let n;n=i&&i.key&&!this.watchOnly?(n=i.key.deriveAccount(44,this.accountIndex)).derive(t).derive(e):this.accountKey.derive(t).derive(e);const o=l.fromHD(this,n,t,e);switch(this.type){case d.types.PUBKEYHASH:break;case d.types.MULTISIG:r.push(n.publicKey);for(const i of this.keys){const s=i.derive(t).derive(e);r.push(s.publicKey)}o.script=u.createScript([this.m,this.n,r],u.types.MULTISIG)}return o}save(){return this.db.saveAccount(this)}saveKey(t){return this.db.saveKey(this.wallet,t)}savePath(t){return this.db.savePath(this.wallet,t)}async initDepth(){this.receive=this.deriveReceive(0),this.receiveDepth=1,await this.saveKey(this.receive);for(let t=0;t<this.lookahead;t++){const e=this.deriveReceive(t+1);await this.saveKey(e)}this.change=this.deriveChange(0),this.changeDepth=1,await this.saveKey(this.change);for(let t=0;t<this.lookahead;t++){const e=this.deriveChange(t+1);await this.saveKey(e)}if(this.witness){this.nested=this.deriveNested(0),this.nestedDepth=1,await this.saveKey(this.nested);for(let t=0;t<this.lookahead;t++){const e=this.deriveNested(t+1);await this.saveKey(e)}}this.save()}async syncDepth(t,e,i){let r=!1,s=null;if(t>this.receiveDepth){const e=this.receiveDepth+this.lookahead;if(t<=e+1){for(let i=e;i<t+this.lookahead;i++){const t=this.deriveReceive(i);await this.saveKey(t)}this.receive=this.deriveReceive(t-1),this.receiveDepth=t,r=!0,s=this.receive}}if(e>this.changeDepth){const t=this.changeDepth+this.lookahead;if(e<=t+1){for(let i=t;i<e+this.lookahead;i++){const t=this.deriveChange(i);await this.saveKey(t)}this.change=this.deriveChange(e-1),this.changeDepth=e,r=!0}}if(this.witness&&i>this.nestedDepth){const t=this.nestedDepth+this.lookahead;if(i<=t+1){for(let e=t;e<i+this.lookahead;e++){const t=this.deriveNested(e);await this.saveKey(t)}this.nested=this.deriveNested(i-1),this.nestedDepth=i,r=!0,s=this.nested}}return r&&this.save(),s}async setLookahead(t){if(t!==this.lookahead){if(t<this.lookahead){const e=this.lookahead-t;return this.receiveDepth+=e,this.receive=this.deriveReceive(this.receiveDepth-1),this.changeDepth+=e,this.change=this.deriveChange(this.changeDepth-1),this.witness&&(this.nestedDepth+=e,this.nested=this.deriveNested(this.nestedDepth-1)),this.lookahead=t,void this.save()}{const e=this.receiveDepth+this.lookahead,i=this.receiveDepth+t;for(let t=e;t<i;t++){const e=this.deriveReceive(t);await this.saveKey(e)}}{const e=this.changeDepth+this.lookahead,i=this.changeDepth+t;for(let t=e;t<i;t++){const e=this.deriveChange(t);await this.saveKey(e)}}if(this.witness){const e=this.nestedDepth+this.lookahead,i=this.nestedDepth+t;for(let t=e;t<i;t++){const e=this.deriveNested(t);await this.saveKey(e)}}this.lookahead=t,this.save()}else this.db.logger.warning("Lookahead is not changing for: %s/%s.",this.id,this.name)}getAddress(t){return this.getReceive(t)}getReceive(t){return this.receive?this.receive.getAddress(t):null}getChange(t){return this.change?this.change.getAddress(t):null}getNested(t){return this.nested?this.nested.getAddress(t):null}inspect(){return{wid:this.wid,name:this.name,network:this.network,initialized:this.initialized,witness:this.witness,watchOnly:this.watchOnly,type:d.typesByVal[this.type].toLowerCase(),m:this.m,n:this.n,accountIndex:this.accountIndex,receiveDepth:this.receiveDepth,changeDepth:this.changeDepth,nestedDepth:this.nestedDepth,lookahead:this.lookahead,address:this.initialized?this.receive.getAddress():null,nestedAddress:this.initialized&&this.nested?this.nested.getAddress():null,accountKey:this.accountKey.toBase58(),keys:this.keys.map(t=>t.toBase58())}}toJSON(t){return{wid:t?void 0:this.wid,id:t?void 0:this.id,name:this.name,initialized:this.initialized,witness:this.witness,watchOnly:this.watchOnly,type:d.typesByVal[this.type].toLowerCase(),m:this.m,n:this.n,accountIndex:this.accountIndex,receiveDepth:this.receiveDepth,changeDepth:this.changeDepth,nestedDepth:this.nestedDepth,lookahead:this.lookahead,receiveAddress:this.receive?this.receive.getAddress("string"):null,nestedAddress:this.nested?this.nested.getAddress("string"):null,changeAddress:this.change?this.change.getAddress("string"):null,accountKey:this.accountKey.toBase58(),keys:this.keys.map(t=>t.toBase58())}}getSize(){let t=0;return t+=a.sizeVarString(this.name,"ascii"),(t+=105)+82*this.keys.length}toRaw(){const t=this.getSize(),e=new o(t);e.writeVarString(this.name,"ascii"),e.writeU8(this.initialized?1:0),e.writeU8(this.witness?1:0),e.writeU8(this.type),e.writeU8(this.m),e.writeU8(this.n),e.writeU32(this.accountIndex),e.writeU32(this.receiveDepth),e.writeU32(this.changeDepth),e.writeU32(this.nestedDepth),e.writeU8(this.lookahead),e.writeBytes(this.accountKey.toRaw()),e.writeU8(this.keys.length);for(const t of this.keys)e.writeBytes(t.toRaw());return e.render()}fromRaw(t){const e=new n(t);this.name=e.readVarString("ascii"),this.initialized=1===e.readU8(),this.witness=1===e.readU8(),this.type=e.readU8(),this.m=e.readU8(),this.n=e.readU8(),this.accountIndex=e.readU32(),this.receiveDepth=e.readU32(),this.changeDepth=e.readU32(),this.nestedDepth=e.readU32(),this.lookahead=e.readU8(),this.accountKey=f.PublicKey.fromRaw(e.readBytes(82)),s(d.typesByVal[this.type]);const i=e.readU8();for(let t=0;t<i;t++){const t=f.PublicKey.fromRaw(e.readBytes(82));this.pushKey(t)}return this}static fromRaw(t,e){return new d(t).fromRaw(e)}static isAccount(t){return t instanceof d}}function p(t,e){return t.compare(e)}d.types={PUBKEYHASH:0,MULTISIG:1},d.typesByVal={0:"pubkeyhash",1:"multisig"},d.MAX_LOOKAHEAD=40,t.exports=d},function(t,e,i){"use strict";
/*!
 * walletkey.js - walletkey object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(26),s=i(46),n=i(124);class o extends s{constructor(t,e){super(t,e),this.keyType=n.types.HD,this.id=null,this.wid=-1,this.name=null,this.account=-1,this.branch=-1,this.index=-1}static fromOptions(t){return(new o).fromOptions(t)}static fromPrivate(t,e,i){return(new o).fromPrivate(t,e,i)}static generate(t,e){return(new o).generate(t,e)}static fromPublic(t,e){return(new o).fromPublic(t,e)}static fromKey(t,e,i){return(new o).fromKey(t,e,i)}static fromScript(t,e,i,r){return(new o).fromScript(t,e,i,r)}static fromSecret(t,e){return(new o).fromSecret(t,e)}toJSON(){return{network:this.network.type,wid:this.wid,id:this.id,name:this.name,account:this.account,branch:this.branch,index:this.index,witness:this.witness,nested:this.nested,publicKey:this.publicKey.toString("hex"),script:this.script?this.script.toRaw().toString("hex"):null,program:this.witness?this.getProgram().toRaw().toString("hex"):null,type:r.typesByVal[this.getType()].toLowerCase(),address:this.getAddress("string")}}static fromJSON(t){return(new o).fromJSON(t)}static fromRaw(t){return(new o).fromRaw(t)}fromHD(t,e,i,r){return this.keyType=n.types.HD,this.id=t.id,this.wid=t.wid,this.name=t.name,this.account=t.accountIndex,this.branch=i,this.index=r,this.witness=t.witness,this.nested=2===i,e.privateKey?this.fromPrivate(e.privateKey,t.network):this.fromPublic(e.publicKey,t.network)}static fromHD(t,e,i,r){return(new o).fromHD(t,e,i,r)}fromImport(t,e){return this.keyType=n.types.KEY,this.id=t.id,this.wid=t.wid,this.name=t.name,this.account=t.accountIndex,this.witness=t.witness,this.fromRaw(e,t.network)}static fromImport(t,e){return(new o).fromImport(t,e)}fromRing(t,e){return this.keyType=n.types.KEY,this.id=t.id,this.wid=t.wid,this.name=t.name,this.account=t.accountIndex,this.witness=t.witness,this.fromOptions(e,e.network)}static fromRing(t,e){return(new o).fromRing(t,e)}toPath(){const t=new n;switch(t.id=this.id,t.wid=this.wid,t.name=this.name,t.account=this.account,this.keyType){case n.types.HD:t.branch=this.branch,t.index=this.index;break;case n.types.KEY:t.data=this.toRaw()}return t.keyType=this.keyType,t.version=this.getVersion(),t.type=this.getType(),t.hash=this.getHash("hex"),t}static isWalletKey(t){return t instanceof o}}t.exports=o},function(t,e,i){"use strict";(function(e){
/*!
 * walletdb.js - storage for wallets
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(148),s=i(1),n=(i(74),i(59)),o=i(3),a=i(34),h=i(384),c=i(98),u=i(4),l=i(109),f=i(199),d=i(124),p=i(95),g=i(218),m=i(215),w=i(138),y=i(79),b=i(37),v=(i(17),i(457)),k=i(575),S=i(576),x=i(458),E=i(187),R=i(577),_=i(385),A=u.U32,I=i(578),O=i(121),C=O.walletdb,P=i(452),B=i(145),T=i(70),N=i(460),{opcodes:M}=i(27),U=i(358),H=i(178),L=i(53),{blockFinalType:D,contractStatus:F,OperType:z,operatorType:V}=i(8),j=i(147);class K extends n{constructor(t){super(),this.eid="walletdb",this.options=new I(t),this.network=this.options.network,this.logger=this.options.logger.context("wallet"),this.workers=this.options.workers,this.client=this.options.client,this.client&&(this.client.wdb=this),this.jsonp=this.options.jsonp,this.jsonp&&(this.jsonp.wdb=this),this.feeRate=this.options.feeRate,this.db=w(this.options),this.rpc=new k(this),this.primary=null,this.state=new S,this.wallets=new Map,this.depth=0,this.rescanning=!1,this.bound=!1,this.newRecord=!0,this.readLock=new h,this.writeLock=new a,this.txLock=new a,this.widCache=new c(1e4),this.pathMapCache=new c(1e5),this.filter=new y,this.MiddleHash=new Set,this.cpList=new P,this.saleList=new B,this.NotifyList=new T,this.propMgr=new N,this._init()}_init(){let t=1e6,e=-1;this.options.spv&&(t=2e4,e=y.flags.ALL),this.filter=y.fromRate(t,.001,e)}async flushProps(t,e){(e=e||this.propMgr).clear();let i=[];for(let r of t){let t=null;if(r.script.code[0].value==M.OP_PROPCREATE?(t=r.getReturnData())&&t.oper==z.propCreate||(t=null):r.script.code[0].value==M.OP_PROPEXCHANGE?(t=r.getReturnData())&&t.oper==z.propExchange||(t=null):r.script.code[0].value==M.OP_RETURN&&((t=r.getReturnData())&&t.oper==z.propSale||(t=null)),t){i.push(t.cid);let s=r.getAddress();t.current={hash:r.hash,index:r.index,rev:o.revHex(r.hash),height:r.height,address:s.toString(this.network)},t.gold=r.value;let n=0,a=await this.client.getEntry(r.height);a&&(n=a.time),t.time=n,e.set(t.pid,t)}}await this.flushCP(i),e.forEach(t=>{t.cp=this.cpList.getRecord(t.cid)}),e.dirty=!1}async getTXFromAll(t){return await this.getTXFromDb(t)}async checkNewRecord(){let t={createIfMissing:this.db.options.createIfMissing,errorIfExists:this.db.options.errorIfExists};this.db.options.createIfMissing=!1,this.db.options.errorIfExists=!0;try{await this.db.open();let e=await this.db.checkVersion(C,6);this.newRecord="new"==e}catch(t){if(-1!=t.message.indexOf("does not exist (create_if_missing is false)"))this.newRecord=!0;else{if(-1==t.message.indexOf("exists (error_if_exists is true)"))throw t;this.newRecord=!1}}try{await this.db.close()}catch(t){}this.db.options.createIfMissing=t.createIfMissing,this.db.options.errorIfExists=t.errorIfExists}async isNewRecord(){return await this.checkNewRecord(),this.newRecord}setpassphrase(t){s("string"==typeof t),this.options.mnemonic=this.options.mnemonic||{},this.options.mnemonic.passphrase=t}setlanguage(t){s("string"==typeof t),this.options.mnemonic=this.options.mnemonic||{},this.options.mnemonic.language=t}setmnemonicByLen(t){this.options.mnemonic={bits:t}}setmnemonicByEntropy(t){this.options.mnemonic={entropy:e.from(t,"hex")}}setmnemonicByWords(t){this.options.mnemonic={phrase:t}}testmnemonic(t){try{return new U(t),{code:0}}catch(t){return{code:-1,msg:t.message}}}async getContracts(t){let e=await this.db.values({gte:O.txdb.tx(u.NULL_HASH),lte:O.txdb.tx(u.HIGH_HASH),parse:t=>o.parseJson(t.toString())});return t?e.filter(e=>e.srcact==t||e.dstact==t):e}isFull(){return this.synced||!1}async _open(){this.options.listen&&await this.logger.open(),await this.db.open();let t=await this.db.checkVersion(C,6);this.depth=await this.getDepth(),this.options.wipeNoReally&&await this.wipe(),await this.load(),this.logger.info("WalletDB loaded (depth=%d, height=%d, start=%d).",this.depth,this.state.height,this.state.startHeight);const e=await this.ensure({id:"primary",witness:!0,mnemonic:this.options.mnemonic});await e.ensureAccount({name:"game",witness:!0}),this.logger.info("Loaded primary wallet (id=%s, wid=%d, address=%s)",e.id,e.wid,e.getAddress()),this.primary=e,0==this.state.height&&await this.rescan(0);let i=await this.db.values({gte:O.txdb.v(u.ZERO_CID,"hex"),lte:O.txdb.v(u.MAX_CID,"hex"),parse:t=>o.parseJson(t.toString())});for(let t of i)t.period<this.state.height?await this.delSaleOrder(t.pid,!0):await this.addSaleOrder(t,!1);let r=await this.getContracts();for(let t of r)t&&(t.period<this.state.height&&t.transStatus==F.CreatedOnMem?await L.delTransContract(t,this,O.txdb.tx):(L.addTransContract(V.WalletInit,t),t.transStatus==F.Promised&&L.autoTaskMgr.addTask(new j(this.network.txcheckpoint,V.Wallet,t,{env:this,tidCreator:O.txdb.tx}),this.network.txchecktime[t.type])));let s=await this.db.values({gte:O.txdb.cp(u.ZERO_CID,"hex"),lte:O.txdb.cp(u.MAX_CID,"hex"),parse:t=>o.parseJson(t.toString())}),n=[];for(let t of s)t.status==P.status.Expired?(await this.batchDel(O.txdb.cp(t.cid)),n.push(t.cid)):this.addCpItem(t);return n.length>0&&await this.flushCP(n,!0),this.http&&this.options.listen&&await this.http.open(),t}async _close(){await this.disconnect(),this.http&&this.options.listen&&await this.http.close();for(const t of this.wallets.values())await t.destroy();await this.db.close(),this.options.listen&&await this.logger.close()}async destroy(){await this.db.destroy(),this.widCache.reset(),this.pathMapCache.reset()}async load(){let t=null;const e=await this.txLock.lock();try{await this.connect(),await this.init(),await this.watch(),await this.sync(),t=await this.resend()}finally{e()}if(t)for(let e of Object.keys(t))if(e)for(const i of t[e])this.send(i)}bind(){this.client&&(this.bound||(this.bound=!0,this.client.on("error",t=>{this.emit("error",t)}),this.client.on("block.connect",async(t,e)=>{try{await this.addBlock(t,e)}catch(t){this.emit("error",t)}}),this.client.on("block.disconnect",async t=>{try{await this.removeBlock(t)}catch(t){this.emit("error",t)}}),this.client.on("chain.full",()=>{this.synced=!0}),this.client.hook("block.rescan",async(t,e)=>{try{await this.rescanBlock(t,e)}catch(t){this.emit("error",t)}}),this.client.on("tx",async t=>{try{await this.addTX(t)}catch(t){this.emit("error",t)}}),this.client.on("entry.remove",async t=>{try{let e=t.tx.hash("hex"),i=await this.getWalletsByTX(t.tx);if(i)for(const r of i){const i=await this.get(r);s(i),await i.remove(e);let n=await L.FactoryOfContract(V.Wallet,t.tx,{env:this,finder:this.getTXFromDb.bind(this),tidCreator:O.txdb.tx});if(n&&n.data)switch(n.data.oper){case z.propSale:await this.delSaleOrder(n.pid,!0);break;case z.contractCreate:case z.contractPromise:await L.delTransContract(n.data,this,O.txdb.tx)}}}catch(t){this.emit("error",t)}}),this.client.on("chain.reset",async t=>{try{await this.resetChain(t)}catch(t){this.emit("error",t)}}),this.jsonp&&this.jsonp.on("error",t=>{this.emit("error",t)})))}async connect(){this.client&&(this.bind(),await this.client.open(),this.jsonp&&this.jsonp.open(),await this.setFilter())}async disconnect(){this.client&&await this.client._close(),this.jsonp&&await this.jsonp._close()}async init(){const t=await this.getState(),e=this.options.startHeight;if(t)this.state=t;else{let t;if(this.client){if(null!=e){if(!(t=await this.client.getEntry(e)))throw new Error("WDB: Could not find start block.")}else t=await this.client.getTip();t=E.fromEntry(t)}else t=E.fromEntry(this.network.genesis);this.logger.info("Initializing WalletDB chain state at %s (%d).",o.revHex(t.hash),t.height),await this.resetState(t,!1)}}async flushCP(t,e=!1){this.client&&(t=t||[],e||(t=this.cpList.filter(t),e=e||t.length>0),e&&await this.client.execute("cp.flush",[t]),this.cpList.dirty=!1)}async watch(){let t=this.db.iterator({gte:C.p(u.NULL_HASH),lte:C.p(u.HIGH_HASH)}),e=0,i=0;for(;;){const i=await t.next();if(!i)break;try{const r=C.pp(i.key);this.filter.add(r,"hex")}catch(e){throw await t.end(),e}e++}for(t=this.db.iterator({gte:C.o(u.NULL_HASH,0),lte:C.o(u.HIGH_HASH,4294967295)});;){const r=await t.next();if(!r)break;try{const[i,s]=C.oo(r.key),n=new b(i,s).toRaw();this.filter.add(n)}catch(e){throw await t.end(),e}i++}this.logger.info("Filter: Added %d hashes to WalletDB filter.",e),this.logger.info("Filter: Added %d outpoints to WalletDB filter.",i),await this.setFilter()}async sync(){if(!this.client)return;let t,e=this.state.height;for(;e>=0;){const i=await this.getBlock(e);if(!i)break;if(t=await this.client.getEntry(i.hash))break;e--}t||(e=this.state.startHeight,(t=await this.client.getEntry(this.state.startHash))||(e=0)),await this.scan(e)}async scan(t){if(!this.client)return;null==t&&(t=this.state.startHeight),s(o.isU32(t),"WDB: Must pass in a height."),await this.rollback(t),this.logger.info("WalletDB is scanning %d blocks.",this.state.height-t+1);const e=await this.getTip();try{this.rescanning=!0,await this.client.rescan(e.hash)}finally{this.rescanning=!1}}async rescan(t){const e=await this.txLock.lock();try{return await this.scan(t)}finally{e()}}async send(t){this.client?await this.client.send(t):this.emit("send",t)}async getTXFromDb(t){for(const e of this.wallets.values()){let i=await e.getTX(t);if(i)return i.tx}return null}async removeTX(t){this.client?await this.client.removeTX(t):this.emit("remove",t)}async estimateFee(t){if(this.feeRate>0)return this.feeRate;if(!this.client)return this.network.feeRate;const e=await this.client.estimateFee(t);return e<this.network.feeRate?this.network.feeRate:e>this.network.maxFeeRate?this.network.maxFeeRate:e}setFilter(){return this.client?this.client.setFilter(this.filter):(this.emit("filter.set",this.filter),Promise.resolve())}addFilter(t){return this.client?this.client.addFilter(t):(this.emit("filter.add",t),Promise.resolve())}resetFilter(){return this.client?this.client.resetFilter():(this.emit("filter.reset"),Promise.resolve())}backup(t){return this.db.backup(t)}async wipe(){this.logger.warning("Wiping WalletDB TXDB..."),this.logger.warning("I hope you know what you're doing.");const t=this.db.iterator({gte:e.from([0]),lte:e.from([255])}),i=this.db.batch();let r=0;for(;;){const e=await t.next();if(!e)break;try{switch(e.key[0]){case 98:case 99:case 101:case 116:case 111:case 104:case 82:i.del(e.key),r++}}catch(e){throw await t.end(),e}}this.logger.warning("Wiped %d txdb records.",r),await i.write()}async getDepth(){const t=this.db.iterator({gte:C.w(0),lte:C.w(4294967295),reverse:!0,limit:1}),e=await t.next();return e?(await t.end(),C.ww(e.key)+1):1}start(t){return s(!t.current,"WDB: Batch already started."),t.current=this.db.batch(),t.accountCache.start(),t.pathCache.start(),t.current}drop(t){const e=this.batch(t);t.current=null,t.accountCache.drop(),t.pathCache.drop(),e.clear()}clear(t){const e=this.batch(t);t.accountCache.clear(),t.pathCache.clear(),e.clear()}batch(t){return s(t.current,"WDB: Batch does not exist."),t.current}async commit(t){const e=this.batch(t);try{await e.write()}catch(t){throw this.drop(),t}t.current=null,t.accountCache.commit(),t.pathCache.commit()}testFilter(t){return this.filter.test(t,"hex")}addHash(t){return this.filter.add(t,"hex"),this.addFilter(t)}addOutpoint(t,e){const i=new b(t,e);this.filter.add(i.toRaw())}dump(){return this.db.dump()}register(t){s(!this.wallets.has(t.wid)),this.wallets.set(t.wid,t)}unregister(t){s(this.wallets.has(t.wid)),this.wallets.delete(t.wid)}async getWalletID(t){if(!t)return null;if("number"==typeof t)return t;const e=this.widCache.get(t);if(e)return e;const i=await this.db.get(C.l(t));if(!i)return null;const r=i.readUInt32LE(0,!0);return this.widCache.set(t,r),r}async get(t){const e=await this.getWalletID(t);if(!e)return null;const i=await this.readLock.lock(e);try{return await this._get(e)}finally{i()}}async _get(t){const e=this.wallets.get(t);if(e)return e;const i=await this.db.get(C.w(t));if(!i)return null;const r=g.fromRaw(this,i);return await r.open(),this.register(r),r}save(t){const e=t.wid,i=t.id,r=this.batch(t);this.widCache.set(i,e),r.put(C.w(e),t.toRaw()),r.put(C.l(i),A(e))}async rename(t,e){const i=await this.writeLock.lock();try{return await this._rename(t,e)}finally{i()}}async _rename(t,e){const i=t.id;if(!p.isName(e))throw new Error("WDB: Bad wallet ID.");if(await this.has(e))throw new Error("WDB: ID not available.");this.start(t).del(C.l(i)),t.id=e,this.save(t),await this.commit(t),this.widCache.remove(i);const r=t.pathCache.values();for(const t of r)t.id=e}renameAccount(t,e){const i=t.wallet;this.batch(i).del(C.i(t.wid,t.name)),t.name=e,this.saveAccount(t)}async auth(t,i){if("string"==typeof i){if(!o.isHex256(i))throw new Error("WDB Authentication: Invalid Token.");i=e.from(i,"hex")}const s=await H.fromKey(u.ONE_HASH,this.options.hmacSalt).getHMAC(o.hashInt(t.toString())),n=r.createHmac("sha256",s.random);let a=e.from(n.update(s.token).digest("hex"),"hex");if(!l(i,a))throw new Error("WDB Authentication: CRC Error.")}async create(t){const e=await this.writeLock.lock();t||(t={});try{return await this._create(t)}finally{e()}}async _create(t){if(await this.has(t.id))throw new Error("WDB: Wallet already exists.");"string"==typeof t.mnemonic&&(t.mnemonic={phrase:t.mnemonic}),t.mnemonic=t.mnemonic||{},!t.mnemonic.language&&this.options.mnemonic&&this.options.mnemonic.language&&(t.mnemonic.language=this.options.mnemonic.language);const e=g.fromOptions(this,t);return e.wid=this.depth++,await e.init(t),this.register(e),this.logger.info("Created wallet %s in WalletDB.",e.id),e}async has(t){return null!=await this.getWalletID(t)}async ensure(t){return await this.get(t.id)||await this.create(t)}async getAccount(t,e){const i=await this.db.get(C.a(t,e));return i?m.fromRaw(this,i):null}getAccounts(t){return this.db.values({gte:C.n(t,0),lte:C.n(t,4294967295),parse:t=>t.toString("ascii")})}async getAccountIndex(t,e){const i=await this.db.get(C.i(t,e));return i?i.readUInt32LE(0,!0):-1}async setGuider(t,e,i,r=!0){let s=o.hashInt(`${t}${e}`);!r&&await this.db.has(C.g(s))||await this.batchPut(C.g(s),i)}async getGuider(t,e){let i=o.hashInt(`${t}${e}`);const r=await this.db.get(C.g(i));return r?r.toString("ascii"):null}async getAccountName(t,e){const i=await this.db.get(C.n(t,e));return i?i.toString("ascii"):null}saveAccount(t){const i=t.wid,r=t.wallet,s=t.accountIndex,n=t.name,o=this.batch(r);o.put(C.a(i,s),t.toRaw()),o.put(C.i(i,n),A(s)),o.put(C.n(i,s),e.from(n,"ascii")),r.accountCache.push(s,t)}hasAccount(t,e){return"number"==typeof t&&"number"==typeof e&&this.db.has(C.a(t,e))}async getPathMap(t){const e=this.pathMapCache.get(t);if(e)return e;const i=await this.db.get(C.p(t));if(!i)return null;const r=R.fromRaw(t,i);return this.pathMapCache.set(t,r),r}saveKey(t,e){return this.savePath(t,e.toPath())}async savePath(t,e){const i=t.wid,r=e.hash,s=this.batch(t);await this.addHash(r);let n=await this.getPathMap(r);n||(n=new R(r)),n.add(i)&&(this.pathMapCache.set(r,n),t.pathCache.push(r,e),s.put(C.p(r),n.toRaw()),s.put(C.P(i,r),e.toRaw()),s.put(C.r(i,e.account,r),null))}async getPath(t,e){const i=await this.db.get(C.P(t,e));if(!i)return null;const r=d.fromRaw(i);return r.wid=t,r.hash=e,r}hasPath(t,e){return this.db.has(C.P(t,e))}getHashes(){return this.db.keys({gte:C.p(u.NULL_HASH),lte:C.p(u.HIGH_HASH),parse:C.pp})}getOutpoints(){return this.db.keys({gte:C.o(u.NULL_HASH,0),lte:C.o(u.HIGH_HASH,4294967295),parse:t=>{const[e,i]=C.oo(t);return new b(e,i)}})}getWalletHashes(t){return this.db.keys({gte:C.P(t,u.NULL_HASH),lte:C.P(t,u.HIGH_HASH),parse:C.Pp})}getAccountHashes(t,e){return this.db.keys({gte:C.r(t,e,u.NULL_HASH),lte:C.r(t,e,u.HIGH_HASH),parse:C.rr})}async getWalletPaths(t){const e=await this.db.range({gte:C.P(t,u.NULL_HASH),lte:C.P(t,u.HIGH_HASH)}),i=[];for(const r of e){const e=C.Pp(r.key),s=d.fromRaw(r.value);s.hash=e,s.wid=t,i.push(s)}return i}getWallets(){return this.db.keys({gte:C.l("\0"),lte:C.l("ÿ"),parse:C.ll})}async encryptKeys(t,i){const r=t.wid,n=await t.getPaths(),o=this.batch(t);for(let a of n){if(!a.data)continue;s(!a.encrypted);const n=e.from(a.hash,"hex").slice(0,16);(a=a.clone()).data=f.encipher(a.data,i,n),a.encrypted=!0,t.pathCache.push(a.hash,a),o.put(C.P(r,a.hash),a.toRaw())}}async decryptKeys(t,i){const r=t.wid,n=await t.getPaths(),o=this.batch(t);for(let a of n){if(!a.data)continue;s(a.encrypted);const n=e.from(a.hash,"hex").slice(0,16);(a=a.clone()).data=f.decipher(a.data,i,n),a.encrypted=!1,t.pathCache.push(a.hash,a),o.put(C.P(r,a.hash),a.toRaw())}}async resend(){let t={};const e=await this.db.keys({gte:C.w(0),lte:C.w(4294967295)});for(const i of e){const e=C.ww(i);let r=await this.resendPending(e);r&&Array.isArray(r)&&(t[e]=r)}return t}middleHash(){return this.MiddleHash}async resendPending(t){const e=await this.get(t),i=await this.db.keys({gte:O.txdb.prefix(t,O.txdb.p(u.NULL_HASH)),lte:O.txdb.prefix(t,O.txdb.p(u.HIGH_HASH))});if(0===i.length)return;this.logger.info("Rebroadcasting %d transactions for %d.",i.length,t);const r=[];for(const s of i){const i=O.txdb.pp(s),n=O.txdb.prefix(t,O.txdb.t(i)),o=await this.db.get(n);if(!o)continue;const a=_.fromRaw(o);if(a.tx.isCoinbase())continue;let h=await L.FactoryOfContract(V.Db,a.tx,{env:this,height:this.state.height,finder:this.getTXFromDb.bind(this),tidCreator:O.txdb.tx});if(await h.isBlockFinal()!=D.Expired)r.push(a.tx);else if(e)switch(await this.removeTX(a.tx),await e.remove(i),h.data.oper){case z.propSale:await this.delSaleOrder(h.data.pid,!0);break;case z.contractCreate:case z.contractPromise:await L.delTransContract(h.data,this,O.txdb.tx)}}let s=this.saleList.getKeys();return s.length>0&&this.client&&await this.client.execute("prop.list.market",["",1,s]),p.sortDeps(r)}async getWalletsByTX(t){const e=new Set;if(!t.isCoinbase())for(const i of t.inputs){const t=i.prevout;if(!this.testFilter(t.toRaw()))continue;const r=await this.getOutpointMap(t.hash,t.index);if(r)for(const t of r.wids)e.add(t)}const i=t.getOutputHashes("hex");for(const t of i){if(!this.testFilter(t))continue;const i=await this.getPathMap(t);if(i)for(const t of i.wids)e.add(t)}return 0===e.size?null:e}async getState(){const t=await this.db.get(C.R);return t?S.fromRaw(t):null}async resetState(t,e){const i=this.db.batch(),r=this.state.clone(),s=this.db.iterator({gte:C.h(0),lte:C.h(4294967295),values:!1});for(;;){const e=await s.next();if(!e)break;try{i.del(e.key)}catch(t){throw await s.end(),t}}r.startHeight=t.height,r.startHash=t.hash,r.height=t.height,r.marked=e,i.put(C.h(t.height),t.toHash()),i.put(C.R,r.toRaw()),await i.write(),this.state=r}async syncState(t){const e=this.db.batch(),i=this.state.clone();if(t.height<i.height){let r=i.height,s=r-t.height;s>this.options.keepBlocks&&(s=this.options.keepBlocks);for(let t=0;t<s;t++)e.del(C.h(r)),r--}else if(t.height>i.height){const r=t.height-this.options.keepBlocks;s(t.height===i.height+1,"Bad chain sync."),r>=0&&e.del(C.h(r))}i.height=t.height,e.put(C.h(t.height),t.toHash()),e.put(C.R,i.toRaw()),await e.write(),this.state=i}async maybeMark(t){this.state.marked||(this.logger.info("Marking WalletDB start block at %s (%d).",o.revHex(t.hash),t.height),await this.resetState(t,!0))}async getBlockMap(t){const e=await this.db.get(C.b(t));return e?x.fromRaw(t,e):null}writeBlockMap(t,e,i){this.batch(t).put(C.b(e),i.toRaw())}unwriteBlockMap(t,e){this.batch(t).del(C.b(e))}async getOutpointMap(t,e){const i=await this.db.get(C.o(t,e));return i?v.fromRaw(t,e,i):null}writeOutpointMap(t,e,i,r){const s=this.batch(t);this.addOutpoint(e,i),s.put(C.o(e,i),r.toRaw())}unwriteOutpointMap(t,e,i){this.batch(t).del(C.o(e,i))}async getBlock(t){const e=await this.db.get(C.h(t));if(!e)return null;const i=new E;return i.hash=e.toString("hex"),i.height=t,i}async getTip(){const t=await this.getBlock(this.state.height);if(!t)throw new Error("WDB: Tip not found!");return t}async rollback(t){if(t>this.state.height)throw new Error("WDB: Cannot rollback to the future.");if(t===this.state.height)return this.logger.debug("Rolled back to same height (%d).",t),!0;this.logger.info("Rolling back %d WalletDB blocks to height %d.",this.state.height-t,t);let e=await this.getBlock(t),i=!1;return e?(await this.revert(e.height),await this.syncState(e),!0):(e=new E,t>=this.state.startHeight?(e.height=this.state.startHeight,e.hash=this.state.startHash,i=this.state.marked,this.logger.warning("Rolling back WalletDB to start block (%d).",e.height)):(e.height=0,e.hash=this.network.genesis.hash,i=!1,this.logger.warning("Rolling back WalletDB to genesis block.")),await this.revert(e.height),await this.resetState(e,i),!1)}async revert(t){const e=this.db.iterator({gte:C.b(t+1),lte:C.b(4294967295),reverse:!0,values:!0});let i=0;for(;;){const r=await e.next();if(!r)break;try{const s=C.bb(r.key),n=x.fromRaw(s,r.value).toArray();i+=n.length;for(let t=n.length-1;t>=0;t--){const e=n[t];await this._unconfirm(e)}}catch(t){throw await e.end(),t}}this.logger.info("Rolled back %d WalletDB transactions.",i)}async addBlock(t,e){const i=await this.txLock.lock();try{return await this._addBlock(t,e)}finally{i()}}async _addBlock(t,e){const i=E.fromEntry(t);let r=0;if(i.height<this.state.height)return this.logger.warning("WalletDB is connecting low blocks (%d).",i.height),r;if(i.height===this.state.height)this.logger.warning("Already saw WalletDB block (%d).",i.height);else if(i.height!==this.state.height+1)throw new Error("WDB: Bad connection (height mismatch).");if(await this.syncState(i),this.options.checkpoints&&i.height<=this.network.lastCheckpoint)return r;for(const t of e)await this._insert(t,i)&&r++;return r>0&&this.logger.info("Connected WalletDB block %s (tx=%d).",o.revHex(i.hash),r),r}async removeBlock(t){const e=await this.txLock.lock();try{return await this._removeBlock(t)}finally{e()}}async _removeBlock(t){const e=E.fromEntry(t);if(e.height>this.state.height)return this.logger.warning("WalletDB is disconnecting high blocks (%d).",e.height),0;if(e.height!==this.state.height)throw new Error("WDB: Bad disconnection (height mismatch).");const i=await this.getBlock(e.height-1);if(!i)throw new Error("WDB: Bad disconnection (no previous block).");const r=await this.getBlockMap(e.height);if(!r)return await this.syncState(i),0;const s=r.toArray();for(let t=s.length-1;t>=0;t--){const e=s[t];await this._unconfirm(e)}return await this.syncState(i),this.logger.warning("Disconnected wallet block %s (tx=%d).",o.revHex(e.hash),r.txs.size),r.txs.size}async rescanBlock(t,e){if(this.rescanning)try{await this._addBlock(t,e)}catch(t){throw this.emit("error",t),t}else this.logger.warning("Unsolicited rescan block: %s.",t.height)}async addTX(t){const e=await this.txLock.lock();try{return await this._insert(t)}finally{e()}}async addSaleOrder(t,i=!0){if(s(t),s(t.pid),this.propMgr.dirty=!0,this.primary){const e=await this.primary.getPath(t.addr);t.owned=!!e}this.saleList.set(t.pid,t),i&&await this.batchPut(O.txdb.v(t.pid),e.from(JSON.stringify(t)))}async delSaleOrder(t,e=!1){this.propMgr.dirty=!0,e?(this.saleList.delete(t),await this.batchDel(O.txdb.v(t))):this.saleList.expired(t)}recoverSaleOrder(t){this.saleList.unexpired(t)}addNotify(t){this.NotifyList.set(t.sn,t)}delNotify(t){this.NotifyList.delete(t)}listNotify(t){return this.NotifyList.deletes([["h","<",this.state.height-6]]),this.NotifyList.paginate(50,t||1).records()}async addCpItem(t,i=!0){if(this.primary){const e=await this.primary.getPath(t.current.address);t.owned=!!e}this.cpList.addItem(t),i&&await this.batchPut(O.txdb.cp(t.cid),e.from(JSON.stringify(t)))}getCpItem(t){return this.cpList.has(t)?this.cpList.get(t):null}getCpItemByName(t){return this.cpList.getItemByName(t)}async delCpItem(t,e=!1){e?(this.cpList.delete(t),await this.batchDel(O.txdb.cp(t))):this.cpList.expired(t)}async batchPut(t,e){const i=this.db.batch();i.put(t,e),await i.write()}async batchDel(t){const e=this.db.batch();e.del(t),await e.write()}async _insert(t,e){s(!t.mutable,"WDB: Cannot add mutable TX.");let i=await L.FactoryOfContract(V.Wallet,t,{env:this,block:e,finder:this.getTXFromDb.bind(this),tidCreator:O.txdb.tx});await i.execute();const r=await this.getWalletsByTX(t);if(!r)return null;let n=!1;this.logger.info("Incoming transaction for %d wallets in WalletDB (%s).",r.size,t.txid()),e&&await this.maybeMark(e);for(const i of r){const r=await this.get(i);s(r),await r.add(t,e)&&(this.logger.info("Added transaction to wallet in WalletDB: %s (%d).",r.id,i),n=!0)}return n?r:null}async _unconfirm(t){for(const e of t.wids){const i=await this.get(e);s(i),await i.unconfirm(t.hash)}}async resetChain(t){const e=await this.txLock.lock();try{return await this._resetChain(t)}finally{e()}}async _resetChain(t){if(t.height>this.state.height)throw new Error("WDB: Bad reset height.");await this.rollback(t.height)||await this.scan()}}K.layout=C,t.exports=K}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * wallet.js - wallet object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(24),n=i(16),o=i(3),a=i(4),h=i(34),c=i(384),u=i(9),l=i(120),f=i(2),d=i(6),p=i(56),g=i(456),m=(i(385),i(124)),w=i(95),y=i(26),b=i(51),v=i(20),k=i(216),S=i(200),x=i(28),E=i(215),R=i(455),_=i(98),A=i(33),I=i(10),O=i(197),C=i(46),P=S.Mnemonic,{opcodes:B,hashType:T}=i(27),N=i(107),M=i(91),U=i(113),H=i(195),L=i(37),D=i(17),F=i(70),z=i(53),{NotifyMsg:V,OrderData:j,PropInfo:K,contractStatus:q,OperType:W,operatorType:X}=i(8),Y=i(121).txdb,{VerifyError:G}=i(36),$=i(460);class J extends s{constructor(t,e){super(),r(t,"DB required."),this.db=t,this.network=t.network,this.logger=t.logger,this.readLock=new c,this.writeLock=new h,this.fundLock=new h,this.indexCache=new _(1e4),this.accountCache=new _(1e4),this.pathCache=new _(1e5),this.current=null,this.wid=0,this.id=null,this.initialized=!1,this.watchOnly=!1,this.accountDepth=0,this.token=a.ZERO_HASH,this.tokenDepth=0,this.master=new R,this.txdb=new g(this),this.account=null,this.historyQueryAccount=null,e&&this.fromOptions(e)}fromOptions(t){let i,s,n=t.master;return n?("string"==typeof n&&(n=S.PrivateKey.fromBase58(n,this.network)),r(S.isPrivate(n),"Must create wallet with hd private key.")):(s=new P(t.mnemonic),n=S.fromMnemonic(s,this.network)),r(n.network===this.network,"Network mismatch for master key."),this.master.fromKey(n,s),null!=t.wid&&(r(o.isU32(t.wid)),this.wid=t.wid),t.id&&(r(w.isName(t.id),"Bad wallet ID."),i=t.id),null!=t.initialized&&(r("boolean"==typeof t.initialized),this.initialized=t.initialized),null!=t.watchOnly&&(r("boolean"==typeof t.watchOnly),this.watchOnly=t.watchOnly),null!=t.accountDepth&&(r(o.isU32(t.accountDepth)),this.accountDepth=t.accountDepth),t.token&&(r(e.isBuffer(t.token)),r(32===t.token.length),this.token=t.token),i||(i=this.getID()),this.id=i,this}static fromOptions(t,e){return new J(t).fromOptions(e)}async init(t){const e=t.passphrase;r(!this.initialized),this.initialized=!0,e&&await this.master.encrypt(e);const i=await this._createAccount(t,e);r(i),this.account=i,this.logger.info("Wallet initialized (%s).",this.id),await this.txdb.open()}async open(){r(this.initialized);const t=await this.getAccount(0);if(!t)throw new Error("Default account not found.");this.account=t,this.logger.info("Wallet opened (%s).",this.id),await this.txdb.open()}async destroy(){const t=await this.writeLock.lock(),e=await this.fundLock.lock();try{this.db.unregister(this),await this.master.destroy(),this.readLock.destroy(),this.writeLock.destroy(),this.fundLock.destroy()}finally{e(),t()}}async addSharedKey(t,e){const i=await this.writeLock.lock();try{return await this._addSharedKey(t,e)}finally{i()}}async _addSharedKey(t,e){e||(e=t,t=null),null==t&&(t=0);const i=await this.getAccount(t);if(!i)throw new Error("Account not found.");let r;this.start();try{r=await i.addSharedKey(e)}catch(t){throw this.drop(),t}return await this.commit(),r}async removeSharedKey(t,e){const i=await this.writeLock.lock();try{return await this._removeSharedKey(t,e)}finally{i()}}async _removeSharedKey(t,e){e||(e=t,t=null),null==t&&(t=0);const i=await this.getAccount(t);if(!i)throw new Error("Account not found.");let r;this.start();try{r=await i.removeSharedKey(e)}catch(t){throw this.drop(),t}return await this.commit(),r}async setPassphrase(t,e){t&&await this.decrypt(t),e&&await this.encrypt(e)}async encrypt(t){const e=await this.writeLock.lock();try{return await this._encrypt(t)}finally{e()}}async _encrypt(t){const e=await this.master.encrypt(t,!0);this.start();try{await this.db.encryptKeys(this,e)}catch(t){throw l(e),this.drop(),t}l(e),this.save(),await this.commit()}async decrypt(t){const e=await this.writeLock.lock();try{return await this._decrypt(t)}finally{e()}}async _decrypt(t){const e=await this.master.decrypt(t,!0);this.start();try{await this.db.decryptKeys(this,e)}catch(t){throw l(e),this.drop(),t}l(e),this.save(),await this.commit()}async rename(t){const e=await this.writeLock.lock();try{return await this.db.rename(this,t)}finally{e()}}async renameAccount(t,e){const i=await this.writeLock.lock();try{return await this._renameAccount(t,e)}finally{i()}}async _renameAccount(t,e){if(!w.isName(e))throw new Error("Bad account name.");const i=await this.getAccount(t);if(!i)throw new Error("Account not found.");if(0===i.accountIndex)throw new Error("Cannot rename default account.");if(await this.hasAccount(e))throw new Error("Account name not available.");const r=i.name;this.start(),this.db.renameAccount(i,e),await this.commit(),this.indexCache.remove(r);const s=this.pathCache.values();for(const t of s)t.account===i.accountIndex&&(t.name=e)}async lock(){const t=await this.writeLock.lock(),e=await this.fundLock.lock();try{await this.master.lock()}finally{e(),t()}}unlock(t,e){return this.master.unlock(t,e)}getID(){r(this.master.key,"Cannot derive id.");const t=this.master.key.derive(44),e=new d(37);e.writeBytes(t.publicKey),e.writeU32(this.network.magic);const i=u.hash160(e.render()),s=new d(27);return s.writeU8(3),s.writeU8(190),s.writeU8(4),s.writeBytes(i),s.writeChecksum(),p.encode(s.render())}async createAccount(t,e){const i=await this.writeLock.lock();try{return await this._createAccount(t,e)}finally{i()}}async _createAccount(t,e){let i,s=t.name;if(s||(s=this.accountDepth.toString(10)),await this.hasAccount(s))throw new Error("Account already exists.");if(await this.unlock(e),this.watchOnly&&t.accountKey){if("string"==typeof(i=t.accountKey)&&(i=S.PublicKey.fromBase58(i,this.network)),!S.isPublic(i))throw new Error("Must add HD public keys to watch only wallet.");r(i.network===this.network,"Network mismatch for watch only key.")}else r(this.master.key),i=(i=this.master.key.deriveAccount(44,this.accountDepth)).toPublic();const n={wid:this.wid,id:this.id,name:0===this.accountDepth?"default":s,witness:t.witness,watchOnly:this.watchOnly,accountKey:i,accountIndex:this.accountDepth,type:t.type,m:t.m,n:t.n,keys:t.keys};let o;this.start();try{(o=E.fromOptions(this.db,n)).wallet=this,await o.init()}catch(t){throw this.drop(),t}return this.logger.info("Created account %s/%s/%d.",o.id,o.name,o.accountIndex),this.accountDepth++,this.save(),await this.commit(),o}async ensureAccount(t,e){const i=t.name;return await this.getAccount(i)||await this.createAccount(t,e)}getAccounts(){return this.db.getAccounts(this.wid)}getAddressHashes(t){return null!=t?this.getAccountHashes(t):this.db.getWalletHashes(this.wid)}async getAccountHashes(t){const e=await this.ensureIndex(t,!0);return await this.db.getAccountHashes(this.wid,e)}async getAccount(t){if(this.account&&(0===t||"default"===t))return this.account;const e=await this.getAccountIndex(t);if(-1===e)return null;const i=await this.readLock.lock(e);try{return await this._getAccount(e)}finally{i()}}async _getAccount(t){const e=this.accountCache.get(t);if(e)return e;const i=await this.db.getAccount(this.wid,t);return i?(i.wallet=this,i.wid=this.wid,i.id=this.id,i.watchOnly=this.watchOnly,await i.open(),this.accountCache.set(t,i),i):null}async getAccountIndex(t){if(null==t)return-1;if("number"==typeof t)return t;const e=this.indexCache.get(t);if(null!=e)return e;const i=await this.db.getAccountIndex(this.wid,t);return-1===i?-1:(this.indexCache.set(t,i),i)}async getAccountName(t){if("string"==typeof t)return t;const e=this.accountCache.get(t);return e?e.name:await this.db.getAccountName(this.wid,t)}async hasAccount(t){const e=await this.getAccountIndex(t);return-1!==e&&(!!this.accountCache.has(e)||await this.db.hasAccount(this.wid,e))}createReceive(t,e=0,i=null){return this.createKey(t,0,e,i)}createChange(t){return this.createKey(t,1)}createNested(t){return this.createKey(t,2)}async createKey(t,e,i=0,r=null){const s=await this.writeLock.lock();try{return await this._createKey(t,e,i,r)}finally{s()}}async _createKey(t,e,i=0,r=null){null==e&&(e=t,t=null),t||(t=0);const s=await this.getAccount(t);if(!s)throw new Error("Account not found.");let n;this.start();try{n=await s.createKey(e,i,r)}catch(t){throw this.drop(),t}return await this.commit(),n}save(){return this.db.save(this)}start(){return this.db.start(this)}drop(){return this.db.drop(this)}clear(){return this.db.clear(this)}commit(){return this.db.commit(this)}async hasAddress(t){const e=y.getHash(t,"hex");return null!=await this.getPath(e)}async getPath(t){const e=await this.readPath(t);return e?(e.name=await this.getAccountName(e.account),r(e.name),this.pathCache.set(e.hash,e),e):null}async readPath(t){const e=y.getHash(t,"hex"),i=this.pathCache.get(e);if(i)return i;const r=await this.db.getPath(this.wid,e);return r?(r.id=this.id,r):null}async hasPath(t){const e=y.getHash(t,"hex");return!!this.pathCache.has(e)||await this.db.hasPath(this.wid,e)}async getPaths(t){if(null!=t)return await this.getAccountPaths(t);const e=await this.db.getWalletPaths(this.wid),i=[];for(const t of e)t.id=this.id,t.name=await this.getAccountName(t.account),r(t.name),this.pathCache.set(t.hash,t),i.push(t);return i}async getAccountPaths(t){const e=await this.ensureIndex(t,!0),i=await this.getAccountHashes(e),s=await this.getAccountName(t);r(s);const n=[];for(const t of i){const i=await this.readPath(t);r(i),r(i.account===e),i.name=s,this.pathCache.set(i.hash,i),n.push(i)}return n}async importKey(t,e,i){const r=await this.writeLock.lock();try{return await this._importKey(t,e,i)}finally{r()}}async _importKey(t,e,i){if(t&&"object"==typeof t&&(i=e,e=t,t=null),null==t&&(t=0),r(e.network===this.network,"Network mismatch for key."),this.watchOnly){if(e.privateKey)throw new Error("Cannot import privkey into watch-only wallet.")}else if(!e.privateKey)throw new Error("Cannot import pubkey into non watch-only wallet.");const s=e.getHash("hex");if(await this.getPath(s))throw new Error("Key already exists.");const n=await this.getAccount(t);if(!n)throw new Error("Account not found.");if(n.type!==E.types.PUBKEYHASH)throw new Error("Cannot import into non-pkh account.");await this.unlock(i);const o=k.fromRing(n,e).toPath();this.master.encrypted&&(o.data=this.master.encipher(o.data,o.hash),r(o.data),o.encrypted=!0),this.start();try{await n.savePath(o)}catch(t){throw this.drop(),t}await this.commit()}async importAddress(t,e){const i=await this.writeLock.lock();try{return await this._importAddress(t,e)}finally{i()}}async _importAddress(t,e){if(e||(e=t,t=null),null==t&&(t=0),r(e.network===this.network,"Network mismatch for address."),!this.watchOnly)throw new Error("Cannot import address into non watch-only wallet.");if(await this.getPath(e))throw new Error("Address already exists.");const i=await this.getAccount(t);if(!i)throw new Error("Account not found.");if(i.type!==E.types.PUBKEYHASH)throw new Error("Cannot import into non-pkh account.");const s=m.fromAddress(i,e);this.start();try{await i.savePath(s)}catch(t){throw this.drop(),t}await this.commit()}async fund(t,e,i){const r=await this.fundLock.lock(i);try{return await this._fund(t,e)}finally{r()}}async _fund(t,e){if(e||(e={}),!this.initialized)throw new Error("Wallet is not initialized.");if(this.watchOnly)throw new Error("Cannot fund from watch-only wallet.");let i;if(null!=e.account){if(!(i=await this.getAccount(e.account)))throw new Error("Account not found.")}else i=this.account;if(!i.initialized)throw new Error("Account is not initialized.");let s,n=e.rate;return null==n&&(n=await this.db.estimateFee(e.blocks)),e.smart?s=await this.getSmartCoins(e.account):(s=await this.getCoins(e.account),s=this.txdb.filterLocked(s)),s=this.filterProps(s),await t.fund(s,{allowPreInput:e.allowPreInput,noChange:e.noChange,selection:e.selection,round:e.round,depth:e.depth,hardFee:e.hardFee,subtractFee:e.subtractFee,subtractIndex:e.subtractIndex,changeAddress:i.change.getAddress(),height:this.db.state.height,rate:n,maxFee:e.maxFee,estimate:t=>this.estimateSize(t)}),e.noChange&&r(t.getFee()<=O.MAX_FEE,"TX exceeds MAX_FEE."),s}filterProps(t){return t||(t=[]),t.reduce((t,e)=>(e.script&&e.script.code[0].value!==B.OP_PROPCREATE&&e.script.code[0].value!==B.OP_PROPEXCHANGE&&e.script.code[0].value!==B.OP_CPREGISTER&&e.script.code[0].value!==B.OP_CPCHANGE&&e.script.code[0].value!==B.OP_PROMISE&&e.script.code[0].value!==B.OP_CONTRACTCREATE&&t.push(e),t),[])}async getAccountByAddress(t){const e=y.getHash(t,"hex"),i=await this.getPath(e);return i?await this.getAccount(i.account):null}async estimateSize(t){const e=I.WITNESS_SCALE_FACTOR,i=y.fromScript(t);if(!i)return-1;const r=await this.getAccountByAddress(i);if(!r)return-1;let s=0;if(t.isScripthash()&&r.witness)switch(r.type){case E.types.PUBKEYHASH:s+=23,s*=4;break;case E.types.MULTISIG:s+=35,s*=4}switch(r.type){case E.types.PUBKEYHASH:s+=74,s+=34;break;case E.types.MULTISIG:s+=1,s+=74*r.m,s+=3,s+=1,s+=34*r.n,s+=1,s+=1}return r.witness?s=((s+=1)+e-1)/e|0:s+=a.sizeVarint(s),s}async createTX(t,i){const s=t.outputs,n=new b;r(Array.isArray(s),"Outputs must be an array."),r(s.length>0,"No outputs available."),t.comment&&("object"==typeof t.comment&&(t.comment=JSON.stringify(t.comment)),n.outputs.push(x.fromScript(v.createScript(e.from(t.comment),v.types.NULLDATA),0)));for(const t of s){const e=new x(t),i=e.getAddress();if(e.isDust())throw new Error("Output is dust.");if(e.value>0){if(!i)throw new Error("Cannot send to unknown address.");if(i.isNull())throw new Error("Cannot send to null address.")}n.outputs.push(e)}if(await this.fund(n,t,i),!1!==t.sort&&n.sortMembers(),null!=t.locktime&&n.setLocktime(t.locktime),r(n.isSane(),"TX failed sanity check."),r(n.verifyInputs(this.db.state.height+1),"TX failed context check."),0===await this.template(n))throw new Error("Templating failed.");return n}async send(t,e){const i=await this.fundLock.lock();try{return await this._send(t,e)}finally{i()}}async _send(t,e){e&&(t.account=e);const i=await this.createTX(t,!0);return await this.sign(i),await this.sendMTX(i)}async sendMTX(t){if(!t.isSigned())throw new Error("TX could not be fully signed.");const e=t.toTX();if(e.getSigopsCost(t.view)>A.MAX_TX_SIGOPS_COST)throw new Error("TX exceeds policy sigops.");if(e.getWeight()>A.MAX_TX_WEIGHT)throw new Error("TX exceeds policy weight.");return await this.db.addTX(e),this.logger.debug("Sending wallet tx (%s): %s",this.id,e.txid()),await this.db.send(e),e}async increaseFee(t,e,i){r(o.isU32(e),"Rate must be a number.");const s=await this.getTX(t);if(!s)throw new Error("Transaction not found.");if(-1!==s.height)throw new Error("Transaction is confirmed.");const n=s.tx;if(n.isCoinbase())throw new Error("Transaction is a coinbase.");const a=await this.getSpentView(n);if(!n.hasCoins(a))throw new Error("Not all coins available.");const h=n.getFee(a);let c=n.getMinFee(null,e);if(c>O.MAX_FEE&&(c=O.MAX_FEE),h>=c)throw new Error("Fee is not increasing.");const u=b.fromTX(n);u.view=a;for(const t of u.inputs)t.script.clear(),t.witness.clear();let l;for(let t=0;t<u.outputs.length;t++){const e=u.outputs[t],i=e.getAddress();if(!i)continue;const r=await this.getPath(i);if(r&&1===r.branch){l=e,u.changeIndex=t;break}}if(!l)throw new Error("No change output.");if(l.value+=h,0!==u.getFee())throw new Error("Arithmetic error for change.");if(l.value-=c,l.value<0)throw new Error("Fee is too high.");if(l.isDust()&&(u.outputs.splice(u.changeIndex,1),u.changeIndex=-1),await this.sign(u,i),!u.isSigned())throw new Error("TX could not be fully signed.");const f=u.toTX();return this.logger.debug("Increasing fee for wallet tx (%s): %s",this.id,f.txid()),await this.db.addTX(f),await this.db.send(f),f}async resend(){const t=await this.getPending();t.length>0&&this.logger.info("Rebroadcasting %d transactions.",t.length);const e=[];for(const i of t)e.push(i.tx);const i=w.sortDeps(e);for(const t of i)await this.db.send(t);return e}async deriveInputs(t){r(t.mutable);const e=await this.getInputPaths(t),i=[];for(const t of e){const e=await this.getAccount(t.account);if(!e)continue;const r=e.derivePath(t,this.master);r&&i.push(r)}return i}async getKey(t){const e=y.getHash(t,"hex"),i=await this.getPath(e);if(!i)return null;const r=await this.getAccount(i.account);return r?r.derivePath(i,this.master):null}async getPrivateKey(t,e){const i=y.getHash(t,"hex"),r=await this.getPath(i);if(!r)return null;const s=await this.getAccount(r.account);if(!s)return null;await this.unlock(e);const n=s.derivePath(r,this.master);return n.privateKey?n:null}async getInputPaths(t){if(r(t.mutable),!t.hasCoins())throw new Error("Not all coins available.");const e=t.getInputHashes("hex"),i=[];for(const t of e){const e=await this.getPath(t);e&&i.push(e)}return i}async getOutputPaths(t){const e=[],i=t.getOutputHashes("hex");for(const t of i){const i=await this.getPath(t);i&&e.push(i)}return e}async setLookahead(t,e){const i=await this.writeLock.lock();try{return this._setLookahead(t,e)}finally{i()}}async _setLookahead(t,e){null==e&&(e=t,t=null),null==t&&(t=0);const i=await this.getAccount(t);if(!i)throw new Error("Account not found.");this.start();try{await i.setLookahead(e)}catch(t){throw this.drop(),t}await this.commit()}async syncOutputDepth(t){const e=new Map;for(const i of t.outputs){const t=i.path;t&&-1!==t.index&&(e.has(t.account)||e.set(t.account,[]),e.get(t.account).push(t))}const i=[];for(const[t,s]of e){let e=-1,n=-1,o=-1;for(const t of s)switch(t.branch){case 0:t.index>e&&(e=t.index);break;case 1:t.index>n&&(n=t.index);break;case 2:t.index>o&&(o=t.index)}e+=2,n+=2,o+=2;const a=await this.getAccount(t);r(a);const h=await a.syncDepth(e,n,o);h&&i.push(h)}return i}async getRedeem(t){"string"==typeof t&&(t=e.from(t,"hex"));const i=await this.getKey(t.toString("hex"));return i?i.getRedeem(t):null}async template(t){const e=await this.deriveInputs(t);return t.sign(e)}async getProps(t,e,i){if(e!=this.historyQueryAccount&&(this.db.propMgr.dirty=!0,this.historyQueryAccount=e),this.db.propMgr.dirty){let t=await this.getCoins(e);await this.db.flushProps(t)}return this.db.propMgr.getPropListByOid(i).paginate(10,t).records()}async getPropsCount(t,e){if(t!=this.historyQueryAccount&&(this.db.propMgr.dirty=!0,this.historyQueryAccount=t),this.db.propMgr.dirty){let e=await this.getCoins(t);await this.db.flushProps(e)}return this.db.propMgr.getPropListByOid(e).getSize()}async getPropsDetails(t,e,i){if(i!=this.historyQueryAccount&&(this.db.propMgr.dirty=!0,this.historyQueryAccount=i),this.db.propMgr.dirty){let t=await this.getCoins(i);await this.db.flushProps(t)}return[this.db.propMgr.paginate(e,t).records(),this.db.propMgr.pageCur,this.db.propMgr.pageNum]}async getProp(t){if(this.db.propMgr.dirty){let t=await this.getCoins();await this.db.flushProps(t)}return this.db.propMgr.get(t)}async orderList(t){let e=t?[t]:[],i=(await this.getHistory()).reduce((i,r)=>{let{tx:s,hash:n,height:o}=r;if(s.outputs[0].script.code[0].value==B.OP_RETURN){let r=j.fromRaw(s.outputs[0].script.code[1]);r&&r.oper==W.payOrder&&(t&&r.cid!==t||(r.hash=n,r.height=o,i[r.cid]||(i[r.cid]={}),i[r.cid][r.sn]=r,e.push(r.cid)))}return i},{});return t&&!i[t]&&(i[t]={}),await this.db.flushCP(e),Object.keys(i).map(t=>{Object.keys(i[t]).map(e=>{i[t][e].cp=this.db.getCpItem(t)})}),i}async propCreatedList(t,e){let i=new $,r=(await this.getCredits(e)).reduce((t,e)=>((e=e.coin).script&&e.script.code[0].value==B.OP_PROPCREATE&&t.push(e),t),[]);return await this.db.flushProps(r,i),i.paginate(10,t).records()}async onSaleList(t,e){let i=this;return(await this.db.saleList.predict((t,r)=>i.belongToAccount(e,r.current.address))).where([["status",F.status.Init]]).paginate(10,t).records(["oper","pid","cid","oid","current","gold","price","fixed","bid","times","period","addr","owned","status"])}async mySaleList(t,e){let i=this;return(await this.db.saleList.predict((t,r)=>i.belongToAccount(e,r.addr))).where([["status",F.status.Init]]).paginate(10,t).records(["oper","pid","cid","oid","current","gold","price","fixed","bid","times","period","addr","owned","status"])}async propCreate(t,e){let i=(await this.createReceive(e)).getAddress(),s=t.map(t=>t.cid);await this.db.flushCP(s);const n=new b;for(let e of t)this.db.getCpItem(e.cid)&&e.cid!=this.network.bossId&&(e.gold=(0|e.gold)>>>0,e.gold<I.MINPROPVALUE||(e.pid=H(),n.propCreate(i,e),e.index=n.outputs.length-1));if(n.outputs.length>0){e?await this.fund(n,{account:e}):await this.fund(n),await this.sign(n);let i=n.commit();await this.db.send(i[0]),r(i[0].verify(i[1],v.flags.STANDARD_VERIFY_FLAGS));for(let e of t)e.hash=i[0].hash("hex"),e.txid=i[0].txid();return i}return[]}async orderNotify(t,e,i,s,n,a){if(r(!!t),r(!!e),r(!!i),r(!!s),r(!!a),i=o.sprintf("%0-36s",i),(s=(0|s)>>>0)<I.MINPROPVALUE)return null;if(!this.db.getCpItem(t))return null;const h=new b;let c=new V(W.notify,H(),this.db.state.height,{type:"order",cid:t,uid:e,sn:i,sum:s,addr:a}),u=x.fromScript(v.createScript(c.toRaw(),v.types.NULLDATA),0);h.outputs.push(u),h.outputs.push(x.fromScript(a,I.COIN)),await this.fund(h,{account:n}),await this.sign(h);let l=h.commit();return r(l[0].verify(l[1],v.flags.STANDARD_VERIFY_FLAGS)),await this.db.send(l[0]),c.hash=l[0].hash("hex"),c.height=-1,c.cp=this.db.getCpItem(t),c}async sysNotify(t,e,i){r(!!t),r(!!e);const s=new b;let n=new V(W.notify,H(),this.db.state.height,{type:"msg",content:e}),o=x.fromScript(v.createScript(n.toRaw(),v.types.NULLDATA),0);s.outputs.push(o),s.outputs.push(x.fromScript(t,I.COIN)),await this.fund(s,{account:i}),await this.sign(s);let a=s.commit();return r(a[0].verify(a[1],v.flags.STANDARD_VERIFY_FLAGS)),await this.db.send(a[0]),n.hash=a[0].hash("hex"),n.height=-1,n}async payOrder(t,i,s,n,a,h){r(!!t),r(!!i),r(!!s),r(!!n),r(!!h),s=o.sprintf("%0-36s",s);let c=await this.orderList(t);if(c[t]&&c[t][s])return c[t][s];if((n=(0|n)>>>0)<I.MINPROPVALUE)return null;let u=this.db.getCpItem(t);if(!u)return null;let l=await this.db.getGuider(t,i),f=new j(t,i,s,n,h,l);const d=new b;let p=x.fromScript(v.createScript(e.from(JSON.stringify(f)),v.types.NULLDATA),0);for(d.outputs.push(p),d.outputs.push(x.fromScript(u.current.address,n)),await this.fund(d,{account:a});d.outputs.length>1;)d.outputs.pop();await this.sign(d,null,T.ZERO|T.ANYONECANPAY);let g=d.commit();return r(g[0].verify(g[1],v.flags.STANDARD_VERIFY_FLAGS)),await this.db.send(g[0]),f.hash=g[0].hash("hex"),f.height=-1,f.cp=this.db.getCpItem(f.cid),f}async cpRegister(t,e){if(r(t&&"object"==typeof t),t.cid=H(),t.oper=W.cpRegister,!await this.db.client.execute("canExecute",[{cid:t.cid,name:t.name},W.cpRegister]))throw new M(U.errors.TYPE_ERROR,"Invalid CP Register Info.");const i=new b;let s=t.addr;s||(s=(await this.createReceive(e)).getAddress()),i.cpRegister(s,I.registerFee,t);for(let e=0;e<70;e++){let r=`${o.sprintf("%010d",o.hashInt(t.cid))}${this.network.stockFix}${o.sprintf("%02d",e)}`,n={oper:W.propCreate,pid:r,oid:r,cid:t.cid,gold:I.MINPROPVALUE};i.propCreate(s,n)}e?await this.fund(i,{account:e}):await this.fund(i),await this.sign(i);let n=i.commit();return r(n[0].verify(n[1],v.flags.STANDARD_VERIFY_FLAGS)),await this.db.send(n[0]),t.txid=n[0].txid(),n}async cpChange(t,e){let{name:i,newName:s}=t;if("BOSS"==i)throw new M(U.errors.TYPE_ERROR,"BOSS can not be changed.");let n=this.db.getCpItemByName(i);if(!n||n.cid==this.network.bossId)throw new M(U.errors.TYPE_ERROR,"Invalid cp name.");let o=await this.getTX(n.current.hash);if(!o)throw new M(U.errors.TYPE_ERROR,"Do not have permission to change this info.");if(o=o.tx,!await this.belongToAccount(e,o.outputs[0].getAddress()))throw new M(U.errors.TYPE_ERROR,"Invalid account info.");if(!await this.db.client.execute("canExecute",[{name:s},W.cpChange]))throw new M(U.errors.TYPE_ERROR,"Invalid CP Change Info.");const a=b.cpChange(o,t);e?await this.fund(a,{allowPreInput:!0,account:e}):await this.fund(a,{allowPreInput:!0}),await this.sign(a);let h=a.commit();return await this.db.send(h[0]),r(h[0].verify(h[1],v.flags.STANDARD_VERIFY_FLAGS)),t.txid=h[0].txid(),h}async propExchangeList(t){let e=new b,i=[];for(let[r,s]of t){let t=null,n=0;if(t=(t=await this.getTX(r.hash)).tx,n=r.index,!t||!t.outputs||t.outputs.length<=n)continue;let o=t.outputs[n].getReturnData();if(o){if(o.cid&&o.cid==this.network.bossId&&parseInt(o.pid.match(/\d+$/i)[0])>I.getEpoch(this.db.state.height).token)continue;e.propExchange(t,n,s),o.addr=s.toString(),i.push(o)}}await this.sign(e);let s=e.commit();return await this.db.send(s[0]),r(s[0].verify(s[1],v.flags.STANDARD_VERIFY_FLAGS)),s.push(i),s}async propDonate(t,i){let r=await this.getTX(t.hash);if(!r||!r.tx)throw new M(U.errors.TYPE_ERROR,"Invalid tx info.");r=r.tx;let s=t.index;if(!r||!r.outputs||r.outputs.length<=s)throw new M(U.errors.TYPE_ERROR,"Invalid tx info.");if(!await this.belongToAccount(i,r.outputs[s].getAddress()))throw new M(U.errors.TYPE_ERROR,"Invalid tx info.");let n=r.outputs[s].getReturnData();if(!n)throw new M(U.errors.TYPE_ERROR,"Invalid tx info.");if(n.cid&&n.cid==this.network.bossId)throw new G(r,"invalid","cannt donate superToken",100);const o=new b;o.addTX(r,s),o.addOutput(v.createScript(e.from(JSON.stringify({value:r.outputs[s].value,cid:n.cid,pid:n.pid,oid:n.oid,gaddr:this.getAddress().toString(this.network)})),v.types.NULLDATA),0),await this.sign(o,null,T.NONE);let a=o.commit();return a.push(n),a}async propReceive(t,e){let i=t.inputs[0].prevout,r=t.outputs[0].getReturnData();t.outputs.pop();let s=this.getAddress().toString(this.network);if(e){let t={cid:r.cid,uid:e};r.gaddr&&(t.gaddr=r.gaddr),s=(await this.tokenCreate(t,e)).data.addr}let n=x.fromScript(s,r.value,{pid:r.pid,cid:r.cid,oid:r.oid,oper:W.propExchange,prev:{hash:i.hash,index:i.index}});return t.outputs.push(n),t.refresh(),await this.db.send(t),r.simAddr=s,[t,null,r]}async belongToAccount(t,e){if(!e)return!1;if(t){let i=await this.getAccountByAddress(e);if(!i)return!1;if(i.name!==t)return!1}return!0}async propExchange(t,e,i){let s=null,n=0;if(Array.isArray(t))s=t[0],n=t[1];else{let e=await this.getTX(t.hash);e&&(s=e.tx,n=t.index)}if(!s||!s.outputs||s.outputs.length<=n)throw new M(U.errors.TYPE_ERROR,"Invalid tx info.");if(!await this.belongToAccount(i,s.outputs[n].getAddress()))throw new M(U.errors.TYPE_ERROR,"Invalid tx info.");let o=s.outputs[n].getReturnData();if(!o)throw new M(U.errors.TYPE_ERROR,"Invalid tx info.");if(o.cid&&o.cid==this.network.bossId&&parseInt(o.pid.match(/\d+$/i)[0])>I.getEpoch(this.db.state.height).token)throw new G(s,"invalid","prop exchange unactivated",100);const a=(new b).propExchange(s,n,e);await this.sign(a);let h=a.commit();return await this.db.send(h[0]),r(h[0].verify(h[1],v.flags.STANDARD_VERIFY_FLAGS)),h.push(o),h}async propFound(t){let e=await this.getTX(t);if(r(e),!(e=e.tx))throw new M(U.errors.TYPE_ERROR,"Invalid hex string.");let i=0;e.outputs.length>=3&&(i=2);let s=e.outputs[i],n=s.getReturnData();if(!n||n.oper!==W.propExchange&&n.oper!==W.propCreate)throw new M(U.errors.TYPE_ERROR,"Invalid tx type.");if(n.cid==this.network.bossId)throw new G(block,"invalid","prop found supertoken",100);const o=new b;o.addTX(e,i);let a=s.value,h=x.fromScript(s.getAddress(),a);o.outputs.push(h),await this.sign(o);let c=o.commit();return await this.db.send(c[0]),r(c[0].verify(c[1],v.flags.STANDARD_VERIFY_FLAGS)),c.push(n),c}async propSale(t,i,s,n){let o=await this.getTX(t);if(!o)throw new M(U.errors.TYPE_ERROR,"Invalid tx info.");if(o.getDepth(this.db.state.height)<=0)throw new M(U.errors.TYPE_ERROR,"No enough confirmations.");if(!(o=o.tx))throw new M(U.errors.TYPE_ERROR,"Invalid tx info.");if(o.outputs[0].script.code[0].value==v.opcodes.OP_RETURN&&(i=2),o.outputs[i].script.code[0].value!==v.opcodes.OP_PROPEXCHANGE)throw new M(U.errors.TYPE_ERROR,"Invalid tx info.");if(!await this.belongToAccount(n,o.outputs[i].getAddress()))throw new M(U.errors.TYPE_ERROR,"Invalid tx info.");let a=await this.getCoin(t,i);if(!a||-1==a.height)throw new M(U.errors.WALLET_INSUFFICIENT_FUNDS,"Invalid coin.");if(await this.txdb.isSpent(t,i))throw new M(U.errors.WALLET_INSUFFICIENT_FUNDS,"Invalid coin.");if(s<=o.outputs[i].value)throw new M(U.errors.TYPE_ERROR,"Invalid fixed price.");let h=o.outputs[i].getReturnData();if(!h||h.oper!==W.propExchange)throw new M(U.errors.TYPE_ERROR,"Invalid tx type.");if(h.cid==this.network.bossId&&parseInt(h.pid.match(/\d+$/i)[0])>I.getEpoch(this.db.state.height).token)throw new G(o,"invalid","prop sale unactivated",100);const c=new b;let u=c.addTX(o,i),l=0|Math.max(o.outputs[i].value,s/2),f=c.getInputHashes()[0].toString("hex"),d={pid:h.pid,cid:h.cid,oid:h.oid,oper:W.propSale,period:this.db.state.height+I.PROP_SALE_PERIOD,prev:{hash:u.prevout.hash,index:u.prevout.index},price:l,fixed:s,addr:f},p=x.fromScript(v.createScript(e.from(JSON.stringify(d)),v.types.NULLDATA),0);c.outputs.push(p),await this.sign(c,null,T.SINGLE|T.ANYONECANPAY);let g=c.commit();return r(g[0].verify(g[1],v.flags.STANDARD_VERIFY_FLAGS)),await this.db.send(g[0]),g}async propBuy(t,i,r){let s=this.db.saleList.get(t);if(!s)throw new M(U.errors.INVALID_PARAMS,"Invalid Tx Hash.");const n=D.fromRaw(e.from(s.raw,"hex"));let o=(await this.createReceive(r)).getAddress(),a=z.parseContract(n);if(!a||a.oper!==W.propSale)throw new M(U.errors.TYPE_ERROR,"Invalid tx type.");let h=a.price,c=e.from(a.addr,"hex");if(i<h)throw new Error("wrong price");if(n.outputs.length>1&&i<n.outputs[1].value)throw new Error("low bid price than before");let u=b.fromTX(n,1);if(u.outputs[0].script.code[0].value!=B.OP_RETURN)throw new Error("not a sale order");await this.remove(n.hash("hex")),u.view.addOutput({hash:u.inputs[0].prevout.hash,index:u.inputs[0].prevout.index},new x({value:a.price}));let l=x.fromScript(v.createScript(c),i);u.outputs.push(l);let f={pid:a.pid,cid:a.cid,oid:a.oid,oper:W.propExchange,prev:{hash:u.inputs[0].prevout.hash,index:u.inputs[0].prevout.index}},d=x.fromScript(o,h,f);u.outputs.push(d),r?await this.fund(u,{allowPreInput:!0,account:r}):await this.fund(u,{allowPreInput:!0}),await this.sign(u,null,T.ALL,[0]);let p=u.commit();return s.owned||this.db.client.watchOutpoint((new L).fromOptions(n.inputs[0].prevout)),await this.db.send(p[0]),p}async getTXByAmount(t,e){let i=null,r=await this.getCoins(e);for(let e of r)if(!(e.height<=0)&&e.value==t){i=e;break}if(!i)return[];let s=await this.getTX(i.hash);return s?[s.tx,i.index,i.height]:[]}async contractCreate(t,i,s,n,o){if(z.queryContract(t,n)!=q.None)throw new M(U.errors.TYPE_ERROR,"Contract with the same address finded.");if(0!=parseInt(i%1e3,10))throw new M(U.errors.TYPE_ERROR,"Contract source should an integer multiple of 1000.");if(!await z.checkSum(this.network,t,n))throw new M(U.errors.TYPE_ERROR,"Create contract with an invalid Address or a Address with old transations.");let a=!1,[h,c,u]=await this.getTXByAmount(i,o);if(!h){a=!0;const t=new b;let e="";e=o?(await this.createReceive(o)).getAddress():this.getAddress(),t.outputs.push(x.fromScript(e,i)),o?await this.fund(t,{allowPreInput:!0,account:o}):await this.fund(t,{allowPreInput:!0}),await this.sign(t);let s=t.commit();r(s[0].verify(s[1],v.flags.STANDARD_VERIFY_FLAGS)),h=s[0],c=0,u=-1}const l=new b;l.addTX(h,c,u);let f="";f=o?(await this.createReceive(o)).getAddress():this.getAddress();let d=await this.getKey(f),p={oper:W.contractCreate,type:t,addr:n,src:i,dst:s,srcact:o,alice:d.getPublicKey("hex"),period:this.db.state.height+I.TRANSACTION_PERIOD},g=x.fromScript(v.createScript(e.from(JSON.stringify(p)),v.types.NULLDATA),0);l.outputs.push(g),await this.sign(l,null,T.SINGLE|T.ANYONECANPAY);let m=l.commit();return a&&await this.db.send(h),await this.db.send(m[0]),m}async contractPromise(t,i){let r=z.transactionList.get(t);if(!r||r.transStatus!=q.CreatedOnMem)throw new M(U.errors.INVALID_PARAMS,"Invalid Tx id.");const s=D.fromRaw(e.from(r.raw,"hex"));if(!s)throw new M(U.errors.TYPE_ERROR,"Invalid Tx id.");let n=z.parseContract(s);if(!n||n.oper!==W.contractCreate)throw new M(U.errors.TYPE_ERROR,"Invalid tx type.");let o=b.fromTX(s,1);if(o.outputs[0].script.code[0].value!=B.OP_RETURN)throw new Error("not a valid contract");o.view.addOutput({hash:o.inputs[0].prevout.hash,index:o.inputs[0].prevout.index},new x({value:n.src}));let a="";a=i?(await this.createReceive(i)).getAddress():this.getAddress();let h=await this.getKey(a),c={oper:W.contractPromise,prevhash:s.hash("hex"),type:n.type,addr:n.addr,dst:n.dst,srcact:n.srcact,dstact:i,bob:h.getPublicKey("hex"),period:n.period};const u=new v([N.fromSymbol("promise"),N.fromData(e.from(JSON.stringify(c))),N.fromSymbol("drop"),N.fromSymbol("greaterthan"),N.fromSymbol("if"),N.fromData(e.from(c.bob,"hex")),N.fromSymbol("else"),N.fromData(e.from(n.alice,"hex")),N.fromSymbol("endif"),N.fromSymbol("checksig")]);o.outputs.push(x.fromScript(u,n.src)),await this.remove(c.prevhash),await this.sign(o,null,T.ALL,[0]);let l=o.commit();return await this.db.send(l[0]),c.current={hash:l[0].hash("hex"),index:0},c.raw=l[0].toRaw().toString("hex"),c.transStatus=q.Promised,z.saveContract(c,this.db,Y.tx),l}async contractExecute(t,i){let s=z.transactionList.get(t);if(!s||s.transStatus!=q.Confirmed&&s.transStatus!=q.Expired)throw new M(U.errors.INVALID_PARAMS,"Invalid Tx id.");const n=D.fromRaw(e.from(s.raw,"hex"));if(!n)throw new M(U.errors.TYPE_ERROR,"Invalid Tx id.");i=i||1;let o=z.parseContract(n);if(!o||o.oper!==W.contractPromise)throw new M(U.errors.TYPE_ERROR,"Invalid tx type.");let a=n.outputs[1].getReturnData();if(!a||a.oper!==W.contractPromise)throw new M(U.errors.TYPE_ERROR,"Invalid tx type.");r.strictEqual(o.addr,a.addr),r.strictEqual(o.type,a.type),r.strictEqual(o.dst,a.dst),r.strictEqual(o.period,a.period),r.strictEqual(o.srcact,a.srcact),r.strictEqual(o.dstact,a.dstact);let h=z.queryContract(o.type,o.addr);if(h!=q.Confirmed&&h!=q.Expired)throw new M(U.errors.TYPE_ERROR,"Contract Promise not Check yet.");if(h==q.Expired&&1!=i||h==q.Confirmed&&2!=i)throw new M(U.errors.TYPE_ERROR,"Invalid Executor.");let c=o.srcact;2==i&&(c=o.dstact);let u="";u=c?(await this.createReceive(c)).getAddress():this.getAddress();let l=new b;l.addTX(n,1);let f={oper:W.contractExecute,type:o.type,addr:o.addr,master:i},d=x.fromScript(v.createScript(e.from(JSON.stringify(f)),v.types.NULLDATA),0);l.outputs.push(d);let p=x.fromScript(u,n.outputs[1].value);l.outputs.push(p);let g=1==i?await C.fromPublic(e.from(o.ori.alice,"hex")):await C.fromPublic(e.from(a.bob,"hex")),m=await this.getKey(g.getAddress());await l.signAsync(m,v.hashType.ALL,this.db.workers);let w=l.commit();return r(w[0].verify(w[1],v.flags.STANDARD_VERIFY_FLAGS,h)),await this.db.send(w[0]),w}async tokenCreate(t,e){(t=t||{}).time=!0,e=e||"game";let i=o.hashInt(`${t.cid}${t.uid}`);return await this.ensureAccount({name:e,witness:!0}),t.gaddr&&await this.db.setGuider(t.cid,t.uid,t.gaddr,!1),(await this.createReceive(e,i,this.master)).signToken(t)}async sign(t,e,i=v.hashType.ALL,r){if(this.watchOnly)throw new Error("Cannot sign from a watch-only wallet.");await this.unlock(e);const s=await this.deriveInputs(t);return await t.signAsync(s,i,this.db.workers,r)}getCoinView(t){return this.txdb.getCoinView(t)}getSpentView(t){return this.txdb.getSpentView(t)}toDetails(t){return this.txdb.toDetails(t)}getDetails(t){return this.txdb.getDetails(t)}async getCoin(t,e){return await this.txdb.getCoin(t,e)}getTX(t){return this.txdb.getTX(t)}getBlocks(){return this.txdb.getBlocks()}getBlock(t){return this.txdb.getBlock(t)}async add(t,e){const i=await this.writeLock.lock();try{return await this._add(t,e)}finally{i()}}async _add(t,e){let i,r;this.txdb.start();try{(i=await this.txdb._add(t,e))&&(r=await this.syncOutputDepth(i))}catch(t){throw this.txdb.drop(),t}return await this.txdb.commit(),r&&r.length>0&&(this.db.emit("address",this.id,r),this.emit("address",r)),i}async unconfirm(t){const e=await this.writeLock.lock();try{return await this.txdb.unconfirm(t)}finally{e()}}async remove(t){const e=await this.writeLock.lock();try{return await this.txdb.remove(t)}finally{e()}}async zap(t,e){const i=await this.writeLock.lock();try{return await this._zap(t,e)}finally{i()}}async _zap(t,e){const i=await this.ensureIndex(t);return await this.txdb.zap(i,e)}async abandon(t){const e=await this.writeLock.lock();try{return await this._abandon(t)}finally{e()}}_abandon(t){return this.txdb.abandon(t)}lockCoin(t){return this.txdb.lockCoin(t)}unlockCoin(t){return this.txdb.unlockCoin(t)}isLocked(t){return this.txdb.isLocked(t)}getLocked(){return this.txdb.getLocked()}async getHistory(t){const e=await this.ensureIndex(t);return this.txdb.getHistory(e)}async getCoins(t){const e=await this.ensureIndex(t);return await this.txdb.getCoins(e)}async getCredits(t){const e=await this.ensureIndex(t);return await this.txdb.getCredits(e)}async getSmartCoins(t){const e=await this.getCredits(t),i=[];for(const t of e){const e=t.coin;t.spent||this.txdb.isLocked(e)||(-1===e.height?t.own&&i.push(e):i.push(e))}return i}async getPending(t){const e=await this.ensureIndex(t);return await this.txdb.getPending(e)}async getBalance(t){const e=await this.ensureIndex(t);return await this.txdb.getBalance(e)}async getRange(t,e){t&&"object"==typeof t&&(e=t,t=null);const i=await this.ensureIndex(t);return await this.txdb.getRange(i,e)}async getLast(t,e){const i=await this.ensureIndex(t);return await this.txdb.getLast(i,e)}async ensureIndex(t,e){if(null==t){if(e)throw new Error("No account provided.");return null}const i=await this.getAccountIndex(t);if(-1===i)throw new Error("Account not found.");return i}getAddress(t){return this.account.getAddress(t)}getReceive(t){return this.account.getReceive(t)}getChange(t){return this.account.getChange(t)}getNested(t){return this.account.getNested(t)}inspect(){return{wid:this.wid,id:this.id,network:this.network.type,initialized:this.initialized,accountDepth:this.accountDepth,token:this.token.toString("hex"),tokenDepth:this.tokenDepth,state:this.txdb.state?this.txdb.state.toJSON(!0):null,master:this.master,account:this.account}}toJSON(t){return{network:this.network.type,wid:this.wid,id:this.id,initialized:this.initialized,watchOnly:this.watchOnly,accountDepth:this.accountDepth,token:this.token.toString("hex"),tokenDepth:this.tokenDepth,state:this.txdb.state.toJSON(!0),master:this.master.toJSON(t),account:this.account.toJSON(!0)}}getSize(){let t=0;return t+=50,(t+=a.sizeVarString(this.id,"ascii"))+a.sizeVarlen(this.master.getSize())}toRaw(){const t=this.getSize(),e=new d(t);return e.writeU32(this.network.magic),e.writeU32(this.wid),e.writeVarString(this.id,"ascii"),e.writeU8(this.initialized?1:0),e.writeU8(this.watchOnly?1:0),e.writeU32(this.accountDepth),e.writeBytes(this.token),e.writeU32(this.tokenDepth),e.writeVarBytes(this.master.toRaw()),e.render()}fromRaw(t){const e=new f(t),i=n.fromMagic(e.readU32());return this.wid=e.readU32(),this.id=e.readVarString("ascii"),this.initialized=1===e.readU8(),this.watchOnly=1===e.readU8(),this.accountDepth=e.readU32(),this.token=e.readBytes(32),this.tokenDepth=e.readU32(),this.master.fromRaw(e.readVarBytes()),r(i===this.db.network,"Wallet network mismatch."),this}static fromRaw(t,e){return new J(t).fromRaw(e)}static isWallet(t){return t instanceof J}}t.exports=J}).call(this,i(0).Buffer)},function(t,e,i){"use strict";e.byteLength=function(t){var e=c(t),i=e[0],r=e[1];return 3*(i+r)/4-r},e.toByteArray=function(t){for(var e,i=c(t),r=i[0],o=i[1],a=new n(3*(r+o)/4-o),h=0,u=o>0?r-4:r,l=0;l<u;l+=4)e=s[t.charCodeAt(l)]<<18|s[t.charCodeAt(l+1)]<<12|s[t.charCodeAt(l+2)]<<6|s[t.charCodeAt(l+3)],a[h++]=e>>16&255,a[h++]=e>>8&255,a[h++]=255&e;return 2===o&&(e=s[t.charCodeAt(l)]<<2|s[t.charCodeAt(l+1)]>>4,a[h++]=255&e),1===o&&(e=s[t.charCodeAt(l)]<<10|s[t.charCodeAt(l+1)]<<4|s[t.charCodeAt(l+2)]>>2,a[h++]=e>>8&255,a[h++]=255&e),a},e.fromByteArray=function(t){for(var e,i=t.length,s=i%3,n=[],o=0,a=i-s;o<a;o+=16383)n.push(l(t,o,o+16383>a?a:o+16383));return 1===s?(e=t[i-1],n.push(r[e>>2]+r[e<<4&63]+"==")):2===s&&(e=(t[i-2]<<8)+t[i-1],n.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),n.join("")};for(var r=[],s=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,h=o.length;a<h;++a)r[a]=o[a],s[o.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function u(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function l(t,e,i){for(var r,s=[],n=e;n<i;n+=3)r=(t[n]<<16&16711680)+(t[n+1]<<8&65280)+(255&t[n+2]),s.push(u(r));return s.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,i,r,s){var n,o,a=8*s-r-1,h=(1<<a)-1,c=h>>1,u=-7,l=i?s-1:0,f=i?-1:1,d=t[e+l];for(l+=f,n=d&(1<<-u)-1,d>>=-u,u+=a;u>0;n=256*n+t[e+l],l+=f,u-=8);for(o=n&(1<<-u)-1,n>>=-u,u+=r;u>0;o=256*o+t[e+l],l+=f,u-=8);if(0===n)n=1-c;else{if(n===h)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),n-=c}return(d?-1:1)*o*Math.pow(2,n-r)},e.write=function(t,e,i,r,s,n){var o,a,h,c=8*n-s-1,u=(1<<c)-1,l=u>>1,f=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:n-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+l>=1?f/h:f*Math.pow(2,1-l))*h>=2&&(o++,h/=2),o+l>=u?(a=0,o=u):o+l>=1?(a=(e*h-1)*Math.pow(2,s),o+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,s),o=0));s>=8;t[i+d]=255&a,d+=p,a/=256,s-=8);for(o=o<<s|a,c+=s;c>0;t[i+d]=255&o,d+=p,o/=256,c-=8);t[i+d-p]|=128*g}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e,i){"use strict";
/*!
 * int64.js - int64 object for javascript.
 * Copyright (c) 2017, Christopher Jeffrey (MIT License).
 * https://github.com/chjj/n64
 */function r(t){h(this instanceof r,"this","N64"),h(0===t||1===t,"sign","bit"),this.hi=0,this.lo=0,this.sign=t}function s(t,e){if(!(this instanceof s))return new s(t,e);r.call(this,0),this.from(t,e)}function n(t,e){if(!(this instanceof n))return new n(t,e);r.call(this,1),this.from(t,e)}function o(t){if(null==t)return 10;if("number"==typeof t)return t;switch(t){case"bin":return 2;case"oct":return 8;case"dec":return 10;case"hex":return 16}return 0}function a(t){if(Math.clz32)return 32-Math.clz32(t);let e=31;for(;e>=0&&0==(t&1<<e);e--);return e+1}function h(t,e,i){if(!t)throw new TypeError(`'${e}' must be a(n) ${i}.`)}function c(t){return"number"==typeof t&&isFinite(t)}function u(t){return Array.isArray?Array.isArray(t):"Array"==={}.toString.call(t).slice(8,-1)}function l(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}function f(t,e){return t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24}function d(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function p(t,e,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24&255}function g(t,e,i){t[i]=e>>>24&255,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}r.prototype._add=function(t,e){const i=this.hi,r=this.lo,s=r+e|0,n=r>>31,o=e>>31,a=(i+t|0)+(1&(n&o|~(s>>31)&(n^o)));return this.hi=0|a,this.lo=s,this},r.prototype.iadd=function(t){return h(r.isN64(t),"operand","int64"),this._add(t.hi,t.lo)},r.prototype.iaddn=function(t){return h(c(t),"operand","number"),this._add(t>>31&-this.sign,0|t)},r.prototype.add=function(t){return this.clone().iadd(t)},r.prototype.addn=function(t){return this.clone().iaddn(t)},r.prototype._sub=function(t,e){return t=~t,-1==(e=~e)?(e=0,t+=1,t|=0):e+=1,this._add(t,e)},r.prototype.isub=function(t){return h(r.isN64(t),"operand","int64"),this._sub(t.hi,t.lo)},r.prototype.isubn=function(t){return h(c(t),"operand","number"),this._sub(t>>31&-this.sign,0|t)},r.prototype.sub=function(t){return this.clone().isub(t)},r.prototype.subn=function(t){return this.clone().isubn(t)},r.prototype._mul=function(t,e){const i=this.hi,r=this.lo,s=65535&i,n=r>>>16,o=65535&r,a=65535&t,h=e>>>16,c=65535&e;let u=0,l=0,f=0,d=0;f+=(d+=o*c)>>>16,l+=(f+=n*c)>>>16,f&=65535,l+=(f+=o*h)>>>16,u+=(l+=s*c)>>>16,l&=65535,u+=(l+=n*h)>>>16,l&=65535,u+=(l+=o*a)>>>16,u+=(i>>>16)*c+s*h+n*a+o*(t>>>16);const p=(u&=65535)<<16|(l&=65535),g=(f&=65535)<<16|(d&=65535);return this.hi=p,this.lo=g,this},r.prototype.imul=function(t){return h(r.isN64(t),"multiplicand","int64"),this._mul(t.hi,t.lo)},r.prototype.imuln=function(t){return h(c(t),"multiplicand","number"),this._mul(t>>31&-this.sign,0|t)},r.prototype.mul=function(t){return this.clone().imul(t)},r.prototype.muln=function(t){return this.clone().imuln(t)},r.prototype.idiv=function(t){let e=this;if(h(r.isN64(t),"divisor","int64"),t.isZero())throw new Error("Cannot divide by zero.");if(e.isZero())return e;if(e.eq(t))return e.set(1);if(e.isSafe()&&t.isSafe()){const i=function(t){return t<0?-Math.floor(-t):Math.floor(t)}(e.toDouble()/t.toDouble());return e.set(i)}let i=!1;e.sign&&(e.hi<0?t.hi<0?(e=e.ineg(),t=t.neg()):(e=e.ineg(),i=!0):t.hi<0&&(t=t.neg(),i=!0));const n=e.toU64(),o=t.toU64();if(n.lt(o))return e.set(0);if(n.ushrn(1).lt(o))return e.set(i?-1:1);const a=new s,c=new s;let u=n.bitLength();for(;u--;)c.ishln(1),c.lo|=n.testn(u),c.gte(o)&&(c.isub(o),a.setn(u,1));return e.hi=a.hi,e.lo=a.lo,i&&e.ineg(),e},r.prototype.idivn=function(t){return h(c(t),"divisor","number"),this.idiv(this._small(t))},r.prototype.div=function(t){return this.clone().idiv(t)},r.prototype.divn=function(t){return this.clone().idivn(t)},r.prototype.imod=function(t){const e=this;if(h(r.isN64(t),"divisor","int64"),t.isZero())throw new Error("Cannot divide by zero.");if(e.isZero())return e;if(e.eq(t))return e.set(0);if(e.isSafe()&&t.isSafe()){const i=e.toDouble()%t.toDouble();return e.set(i)}return e.isub(e.div(t).imul(t))},r.prototype.imodn=function(t){return h(c(t),"divisor","number"),this.imod(this._small(t))},r.prototype.mod=function(t){return this.clone().imod(t)},r.prototype.modn=function(t){return this.clone().imodn(t)},r.prototype.ipow=function(t){return h(r.isN64(t),"exponent","int64"),this.ipown(t.lo)},r.prototype.ipown=function(t){if(h(c(t),"exponent","number"),this.isZero())return this;const e=this.clone(),i=this;let r=t>>>0;for(i.set(1);r>0;)1&r&&i.imul(e),r>>>=1,e.imul(e);return i},r.prototype.pow=function(t){return this.clone().ipow(t)},r.prototype.pown=function(t){return this.clone().ipown(t)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this)},r.prototype.iand=function(t){return h(r.isN64(t),"operand","int64"),this.hi&=t.hi,this.lo&=t.lo,this},r.prototype.iandn=function(t){return h(c(t),"operand","number"),this.hi&=t>>31&-this.sign,this.lo&=0|t,this},r.prototype.and=function(t){return this.clone().iand(t)},r.prototype.andn=function(t){return this.clone().iandn(t)},r.prototype.ior=function(t){return h(r.isN64(t),"operand","int64"),this.hi|=t.hi,this.lo|=t.lo,this},r.prototype.iorn=function(t){return h(c(t),"operand","number"),this.hi|=t>>31&-this.sign,this.lo|=0|t,this},r.prototype.or=function(t){return this.clone().ior(t)},r.prototype.orn=function(t){return this.clone().iorn(t)},r.prototype.ixor=function(t){return h(r.isN64(t),"operand","int64"),this.hi^=t.hi,this.lo^=t.lo,this},r.prototype.ixorn=function(t){return h(c(t),"operand","number"),this.hi^=t>>31&-this.sign,this.lo^=0|t,this},r.prototype.xor=function(t){return this.clone().ixor(t)},r.prototype.xorn=function(t){return this.clone().ixorn(t)},r.prototype.inot=function(){return this.hi=~this.hi,this.lo=~this.lo,this},r.prototype.not=function(){return this.clone().inot()},r.prototype.ishl=function(t){return h(r.isN64(t),"bits","int64"),this.ishln(t.lo)},r.prototype.ishln=function(t){if(h(c(t),"bits","number"),0==(t&=63))return this;let e=this.hi,i=this.lo;return t<32?(e<<=t,e|=i>>>32-t,i<<=t):(e=i<<t-32,i=0),this.hi=e,this.lo=i,this},r.prototype.shl=function(t){return this.clone().ishl(t)},r.prototype.shln=function(t){return this.clone().ishln(t)},r.prototype.ishr=function(t){return h(r.isN64(t),"bits","int64"),this.ishrn(t.lo)},r.prototype.ishrn=function(t){if(!this.sign)return this.iushrn(t);if(h(c(t),"bits","number"),0==(t&=63))return this;let e=this.hi,i=this.lo;return t<32?(i>>>=t,i|=e<<32-t,e>>=t):(i=e>>t-32,e>>=31),this.hi=e,this.lo=i,this},r.prototype.shr=function(t){return this.clone().ishr(t)},r.prototype.shrn=function(t){return this.clone().ishrn(t)},r.prototype.iushr=function(t){return h(r.isN64(t),"bits","int64"),this.iushrn(t.lo)},r.prototype.iushrn=function(t){if(h(c(t),"bits","number"),0==(t&=63))return this;let e=this.hi,i=this.lo;return t<32?(i>>>=t,i|=e<<32-t,e>>>=t):(i=e>>>t-32,e=0),this.hi=0|e,this.lo=0|i,this},r.prototype.ushr=function(t){return this.clone().iushr(t)},r.prototype.ushrn=function(t){return this.clone().iushrn(t)},r.prototype.setn=function(t,e){return h(c(t),"bit","number"),(t&=63)<32?e?this.lo|=1<<t:this.lo&=~(1<<t):e?this.hi|=1<<t-32:this.hi&=~(1<<t-32),this},r.prototype.testn=function(t){return h(c(t),"bit","number"),(t&=63)<32?this.lo>>>t&1:this.hi>>>t-32&1},r.prototype.setb=function(t,e){return h(c(t),"pos","number"),h(c(e),"ch","number"),e&=255,(t&=7)<4?(this.lo&=~(255<<8*t),this.lo|=e<<8*t):(this.hi&=~(255<<8*(t-4)),this.hi|=e<<8*(t-4)),this},r.prototype.orb=function(t,e){return h(c(t),"pos","number"),h(c(e),"ch","number"),e&=255,(t&=7)<4?this.lo|=e<<8*t:this.hi|=e<<8*(t-4),this},r.prototype.getb=function(t){return h(c(t),"pos","number"),(t&=7)<4?this.lo>>8*t&255:this.hi>>8*(t-4)&255},r.prototype.imaskn=function(t){return h(c(t),"bit","number"),(t&=63)<32?(this.hi=0,this.lo&=(1<<t)-1):(this.hi&=(1<<t-32)-1,this.lo&=4294967295),this},r.prototype.maskn=function(t){return this.clone().imaskn(t)},r.prototype.andln=function(t){return h(c(t),"operand","number"),this.lo&t},r.prototype.ineg=function(){let t=~this.hi,e=~this.lo;return-1===e?(e=0,t+=1,t|=0):e+=1,this.hi=t,this.lo=e,this},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.iabs=function(){return this.isNeg()&&this.ineg(),this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._cmp=function(t,e){const i=this;let r=i.hi,s=i.lo;if(r===t&&s===e)return 0;let n=!1;if(i.sign){const e=r<0,i=t<0;if(e&&!i)return-1;if(!e&&i)return 1;n=e}return n||(r>>>=0,t>>>=0),r<t?-1:r>t?1:(s>>>=0)<(e>>>=0)?-1:1},r.prototype.cmp=function(t){return h(r.isN64(t),"value","int64"),this._cmp(t.hi,t.lo)},r.prototype.cmpn=function(t){return h(c(t),"value","number"),this._cmp(t>>31&-this.sign,0|t)},r.prototype.eq=function(t){return h(r.isN64(t),"value","int64"),this.hi===t.hi&&this.lo===t.lo},r.prototype.eqn=function(t){return h(c(t),"value","number"),this.hi===(t>>31&-this.sign)&&this.lo===(0|t)},r.prototype.gt=function(t){return this.cmp(t)>0},r.prototype.gtn=function(t){return this.cmpn(t)>0},r.prototype.gte=function(t){return this.cmp(t)>=0},r.prototype.gten=function(t){return this.cmpn(t)>=0},r.prototype.lt=function(t){return this.cmp(t)<0},r.prototype.ltn=function(t){return this.cmpn(t)<0},r.prototype.lte=function(t){return this.cmp(t)<=0},r.prototype.lten=function(t){return this.cmpn(t)<=0},r.prototype.isZero=function(){return 0===this.hi&&0===this.lo},r.prototype.isNeg=function(){return 1===this.sign&&this.hi<0},r.prototype.isOdd=function(){return 1==(1&this.lo)},r.prototype.isEven=function(){return 0==(1&this.lo)},r.prototype.clone=function(){const t=new this.constructor;return t.hi=this.hi,t.lo=this.lo,t},r.prototype.inject=function(t){return h(r.isN64(t),"value","int64"),this.hi=t.hi,this.lo=t.lo,this},r.prototype.set=function(t){h(function(t){return Number.isSafeInteger?Number.isSafeInteger(t):c(t)&&Math.floor(t)===t&&t>=-9007199254740991&&t<=9007199254740991}(t),"number","integer");let e=!1;return t<0&&(t=-t,e=!0),this.hi=t*(1/4294967296)|0,this.lo=0|t,e&&this.ineg(),this},r.prototype.join=function(t,e){return h(c(t),"hi","number"),h(c(e),"lo","number"),this.hi=0|t,this.lo=0|e,this},r.prototype._small=function(t){const e=new this.constructor;return e.hi=t>>31&-this.sign,e.lo=0|t,e},r.prototype.bitLength=function(){let t=this;return this.isNeg()&&(t=this.neg()),0===t.hi?a(t.lo):a(t.hi)+32},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.isSafe=function(){let t=this.hi;return this.isNeg()&&(t=~t,0===this.lo&&(t+=1)),0==(4292870144&t)},r.prototype.inspect=function(){let t="I64";return this.sign||(t="U64"),`<${t}: ${this.toString(10)}>`},r.prototype.readLE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),this.lo=f(t,e),this.hi=f(t,e+4),e+8},r.prototype.readBE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),this.hi=d(t,e),this.lo=d(t,e+4),e+8},r.prototype.readRaw=function(t,e){return this.readLE(t,e)},r.prototype.writeLE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),p(t,this.lo,e),p(t,this.hi,e+4),e+8},r.prototype.writeBE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),g(t,this.hi,e),g(t,this.lo,e+4),e+8},r.prototype.writeRaw=function(t,e){return this.writeLE(t,e)},r.prototype.toU64=function(){const t=new s;return t.hi=this.hi,t.lo=this.lo,t},r.prototype.toI64=function(){const t=new n;return t.hi=this.hi,t.lo=this.lo,t},r.prototype.toNumber=function(){if(!this.isSafe())throw new Error("Number exceeds 53 bits.");return this.toDouble()},r.prototype.toDouble=function(){let t=this.hi;return this.sign||(t>>>=0),4294967296*t+(this.lo>>>0)},r.prototype.toInt=function(){return this.sign?this.lo:this.lo>>>0},r.prototype.toBool=function(){return!this.isZero()},r.prototype.toBits=function(){return[this.hi,this.lo]},r.prototype.toObject=function(){return{hi:this.hi,lo:this.lo}},r.prototype.toString=function(t,e){if(t=o(t),null==e&&(e=0),h(t>>>0===t,"base","integer"),h(e>>>0===e,"pad","integer"),t<2||t>16)throw new Error("Base ranges between 2 and 16.");if(e>64)throw new Error("Maximum padding is 64 characters.");let i=this,r=!1;i.isNeg()&&(i=i.neg(),r=!0);let s=i.hi>>>0,n=i.lo>>>0,a="";do{const e=s%t;s-=e,s/=t;const i=(n+=4294967296*e)%t;n-=i,n/=t;let r=i;r+=r<10?48:87,a=String.fromCharCode(r)+a}while(n>0||s>0);for(;a.length<e;)a="0"+a;return r&&(a="-"+a),a},r.prototype.toJSON=function(){return this.toString(16,16)},r.prototype.toBN=function(t){const e=this.isNeg();let i=this.hi,r=this.lo;e&&(i=~i,-1==(r=~r)?(r=0,i+=1,i|=0):r+=1),r>>>=0;const s=new t(i>>>=0);return s.ishln(32),s.iadd(new t(r)),e&&s.ineg(),s},r.prototype.toLE=function(t){h("function"==typeof t,"ArrayLike","constructor");const e=l(t,8);return this.writeLE(e,0),e},r.prototype.toBE=function(t){h("function"==typeof t,"ArrayLike","constructor");const e=l(t,8);return this.writeBE(e,0),e},r.prototype.toRaw=function(t){return this.toLE(t)},r.prototype.fromNumber=function(t){return this.set(t)},r.prototype.fromInt=function(t){return h(c(t),"integer","number"),this.join(t>>31&-this.sign,t)},r.prototype.fromBool=function(t){return h("boolean"==typeof t,"value","boolean"),this.hi=0,this.lo=t?1:0,this},r.prototype.fromBits=function(t,e){return this.join(t,e)},r.prototype.fromObject=function(t){return h(t&&"object"==typeof t,"number","object"),this.fromBits(t.hi,t.lo)},r.prototype.fromString=function(t,e){if(e=o(e),h("string"==typeof t,"string","string"),h(e>>>0===e,"base","integer"),e<2||e>16)throw new Error("Base ranges between 2 and 16.");let i=!1,r=0;if(t.length>0&&"-"===t[0]&&(r+=1,i=!0),t.length===r||t.length>r+64)throw new Error("Invalid string (bad length).");let s=0,n=0;for(;r<t.length;r++){let i=t.charCodeAt(r);if(i>=48&&i<=57?i-=48:i>=65&&i<=90?i-=55:i>=97&&i<=122?i-=87:i=e,i>=e)throw new Error("Invalid string (parse error).");if(n*=e,s*=e,(n+=i)>4294967295&&(s+=(n-(i=n%4294967296))/4294967296,n=i),s>4294967295)throw new Error("Invalid string (overflow).")}return this.hi=0|s,this.lo=0|n,i&&this.ineg(),this},r.prototype.fromJSON=function(t){return this.fromString(t,16)},r.prototype.fromBN=function(t){h(t&&u(t.words),"number","big number");const e=this,i=t.clone(),r=i.isNeg();if(e.sign&&i.testn(63))throw new Error("Big number overflow.");let s=0;for(;!i.isZero();){if(8===s)throw new Error("Big number overflow.");e.orb(s,i.andln(255)),i.iushrn(8),s++}return r&&e.ineg(),e},r.prototype.fromLE=function(t){return this.readLE(t,0),this},r.prototype.fromBE=function(t){return this.readBE(t,0),this},r.prototype.fromRaw=function(t){return this.fromLE(t)},r.prototype.from=function(t,e){if(null==t)return this;if("number"==typeof t)return"number"==typeof e?this.fromBits(t,e):this.fromNumber(t);if("string"==typeof t)return this.fromString(t,e);if("object"==typeof t)return u(t.words)?this.fromBN(t):"number"==typeof t.length?this.fromRaw(t):this.fromObject(t);if("boolean"==typeof t)return this.fromBool(t);throw new TypeError("Non-numeric object passed to N64.")},r.min=function(t,e){return t.cmp(e)<0?t:e},r.max=function(t,e){return t.cmp(e)>0?t:e},r.random=function(){const t=new this;return t.hi=4294967296*Math.random()|0,t.lo=4294967296*Math.random()|0,t},r.pow=function(t,e){return(new this).fromInt(t).ipown(e)},r.shift=function(t,e){return(new this).fromInt(t).ishln(e)},r.readLE=function(t,e){const i=new this;return i.readLE(t,e),i},r.readBE=function(t,e){const i=new this;return i.readBE(t,e),i},r.readRaw=function(t,e){const i=new this;return i.readRaw(t,e),i},r.fromNumber=function(t){return(new this).fromNumber(t)},r.fromInt=function(t){return(new this).fromInt(t)},r.fromBool=function(t){return(new this).fromBool(t)},r.fromBits=function(t,e){return(new this).fromBits(t,e)},r.fromObject=function(t){return(new this).fromObject(t)},r.fromString=function(t,e){return(new this).fromString(t,e)},r.fromJSON=function(t){return(new this).fromJSON(t)},r.fromBN=function(t){return(new this).fromBN(t)},r.fromLE=function(t){return(new this).fromLE(t)},r.fromBE=function(t){return(new this).fromBE(t)},r.fromRaw=function(t){return(new this).fromRaw(t)},r.from=function(t,e){return(new this).from(t,e)},r.isN64=function(t){return t instanceof r},r.isU64=function(t){return t instanceof s},r.isI64=function(t){return t instanceof n},s.__proto__=r,s.prototype.__proto__=r.prototype,s.ULONG_MIN=0,s.ULONG_MAX=4294967295,s.UINT32_MIN=s(0,0),s.UINT32_MAX=s(0,4294967295),s.UINT64_MIN=s(0,0),s.UINT64_MAX=s(4294967295,4294967295),n.__proto__=r,n.prototype.__proto__=r.prototype,n.LONG_MIN=-2147483648,n.LONG_MAX=2147483647,n.INT32_MIN=n(4294967295,2147483648),n.INT32_MAX=n(0,2147483647),n.INT64_MIN=n(2147483648,0),n.INT64_MAX=n(2147483647,4294967295),e.N64=r,e.U64=s,e.I64=n},function(t,e,i){"use strict";e.sha1=i(224),e.sha224=i(225),e.sha256=i(129),e.sha384=i(226),e.sha512=i(130)},function(t,e,i){"use strict";var r=i(32),s=i(55),n=i(128),o=r.rotl32,a=r.sum32,h=r.sum32_5,c=n.ft_1,u=s.BlockHash,l=[1518500249,1859775393,2400959708,3395469782];function f(){if(!(this instanceof f))return new f;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}r.inherits(f,u),t.exports=f,f.blockSize=512,f.outSize=160,f.hmacStrength=80,f.padLength=64,f.prototype._update=function(t,e){for(var i=this.W,r=0;r<16;r++)i[r]=t[e+r];for(;r<i.length;r++)i[r]=o(i[r-3]^i[r-8]^i[r-14]^i[r-16],1);var s=this.h[0],n=this.h[1],u=this.h[2],f=this.h[3],d=this.h[4];for(r=0;r<i.length;r++){var p=~~(r/20),g=h(o(s,5),c(p,n,u,f),d,i[r],l[p]);d=f,f=u,u=o(n,30),n=s,s=g}this.h[0]=a(this.h[0],s),this.h[1]=a(this.h[1],n),this.h[2]=a(this.h[2],u),this.h[3]=a(this.h[3],f),this.h[4]=a(this.h[4],d)},f.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(t,e,i){"use strict";var r=i(32),s=i(129);function n(){if(!(this instanceof n))return new n;s.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}r.inherits(n,s),t.exports=n,n.blockSize=512,n.outSize=224,n.hmacStrength=192,n.padLength=64,n.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")}},function(t,e,i){"use strict";var r=i(32),s=i(130);function n(){if(!(this instanceof n))return new n;s.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}r.inherits(n,s),t.exports=n,n.blockSize=1024,n.outSize=384,n.hmacStrength=192,n.padLength=128,n.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")}},function(t,e,i){"use strict";var r=i(32),s=i(55),n=r.rotl32,o=r.sum32,a=r.sum32_3,h=r.sum32_4,c=s.BlockHash;function u(){if(!(this instanceof u))return new u;c.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function l(t,e,i,r){return t<=15?e^i^r:t<=31?e&i|~e&r:t<=47?(e|~i)^r:t<=63?e&r|i&~r:e^(i|~r)}function f(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function d(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}r.inherits(u,c),e.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(t,e){for(var i=this.h[0],r=this.h[1],s=this.h[2],c=this.h[3],u=this.h[4],y=i,b=r,v=s,k=c,S=u,x=0;x<80;x++){var E=o(n(h(i,l(x,r,s,c),t[p[x]+e],f(x)),m[x]),u);i=u,u=c,c=n(s,10),s=r,r=E,E=o(n(h(y,l(79-x,b,v,k),t[g[x]+e],d(x)),w[x]),S),y=S,S=k,k=n(v,10),v=b,b=E}E=a(this.h[1],s,k),this.h[1]=a(this.h[2],c,S),this.h[2]=a(this.h[3],u,y),this.h[3]=a(this.h[4],i,b),this.h[4]=a(this.h[0],r,v),this.h[0]=E},u.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"little"):r.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],g=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],m=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],w=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},function(t,e,i){"use strict";var r=i(32),s=i(54);function n(t,e,i){if(!(this instanceof n))return new n(t,e,i);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(e,i))}t.exports=n,n.prototype._init=function(t){t.length>this.blockSize&&(t=(new this.Hash).update(t).digest()),s(t.length<=this.blockSize);for(var e=t.length;e<this.blockSize;e++)t.push(0);for(e=0;e<t.length;e++)t[e]^=54;for(this.inner=(new this.Hash).update(t),e=0;e<t.length;e++)t[e]^=106;this.outer=(new this.Hash).update(t)},n.prototype.update=function(t,e){return this.inner.update(t,e),this},n.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)}},function(t,e,i){"use strict";(function(i){
/*!
 * sha256.js - SHA256 implementation for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 * Parts of this software based on hash.js.
 */
const r=i.allocUnsafe(8),s=i.allocUnsafe(64),n=i.allocUnsafe(64),o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function a(){if(!(this instanceof a))return new a;this.s=new Array(8),this.w=new Array(64),this.block=i.allocUnsafe(64),this.bytes=0}function h(){if(!(this instanceof h))return new h;this.inner=new a,this.outer=new a}function c(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function u(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function l(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}function f(t){return(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10}function d(t,e,i){return i^t&(e^i)}function p(t,e,i){return t&e|i&(t|e)}function g(t,e,i){t[i]=e>>>24,t[i+1]=e>>16&255,t[i+2]=e>>8&255,t[i+3]=255&e}function m(t,e){return 16777216*(255&t[e])+((255&t[e+1])<<16)|(255&t[e+2])<<8|255&t[e+3]}n.fill(0),n[0]=128,a.prototype.init=function(){this.s[0]=1779033703,this.s[1]=3144134277,this.s[2]=1013904242,this.s[3]=2773480762,this.s[4]=1359893119,this.s[5]=2600822924,this.s[6]=528734635,this.s[7]=1541459225,this.bytes=0},a.prototype.update=function(t){return this._update(t,t.length)},a.prototype.finish=function(){return this._finish(i.allocUnsafe(32))},a.prototype._update=function(t,e){let i=63&this.bytes,r=0;if(this.bytes+=e,i>0){let s=64-i;s>e&&(s=e);for(let e=0;e<s;e++)this.block[i+e]=t[e];if(e-=s,r+=s,(i+=s)<64)return;this.transform(this.block,0)}for(;e>=64;)this.transform(t,r),r+=64,e-=64;for(let i=0;i<e;i++)this.block[i]=t[r+i]},a.prototype._finish=function(t){g(r,this.bytes>>>29,0),g(r,this.bytes<<3,4),this._update(n,1+(119-this.bytes%64)%64),this._update(r,8);for(let e=0;e<8;e++)g(t,this.s[e],4*e),this.s[e]=0;return t},a.prototype.transform=function(t,e){const i=this.w;let r=this.s[0],s=this.s[1],n=this.s[2],a=this.s[3],h=this.s[4],g=this.s[5],w=this.s[6],y=this.s[7],b=0;for(;b<16;b++)i[b]=m(t,e+4*b);for(;b<64;b++)i[b]=f(i[b-2])+i[b-7]+l(i[b-15])+i[b-16];for(b=0;b<64;b++){let t=y+u(h);t+=d(h,g,w),t+=o[b]+i[b];let e=c(r);e+=p(r,s,n),y=w,w=g,g=h,h=a+t,a=n,n=s,s=r,r=t+e}this.s[0]+=r,this.s[1]+=s,this.s[2]+=n,this.s[3]+=a,this.s[4]+=h,this.s[5]+=g,this.s[6]+=w,this.s[7]+=y,this.s[0]>>>=0,this.s[1]>>>=0,this.s[2]>>>=0,this.s[3]>>>=0,this.s[4]>>>=0,this.s[5]>>>=0,this.s[6]>>>=0,this.s[7]>>>=0},h.prototype.init=function(t){const e=s;t.length>64?(this.inner.init(),this.inner.update(t),this.inner._finish(e),e.fill(0,32,64)):(t.copy(e,0),e.fill(0,t.length,64));for(let t=0;t<e.length;t++)e[t]^=54;this.inner.init(),this.inner.update(e);for(let t=0;t<e.length;t++)e[t]^=106;this.outer.init(),this.outer.update(e)},h.prototype.update=function(t){this.inner.update(t)},h.prototype.finish=function(){return this.outer.update(this.inner.finish()),this.outer.finish()};const w=new a,y=new h;(e=a).SHA256=a,e.SHA256Hmac=h,e.digest=function(t){return w.init(),w.update(t),w.finish()},e.hmac=function(t,e){return y.init(e),y.update(t),y.finish()},e.hash256=function(t){const e=i.allocUnsafe(32);return w.init(),w.update(t),w._finish(e),w.init(),w.update(e),w._finish(e),e},t.exports=e}).call(this,i(0).Buffer)},function(t,e,i){!function(t){"undefined"==typeof DO_NOT_EXPORT_CRC?t(e):t({})}(function(t){t.version="1.2.0";var e=function(){for(var t=0,e=new Array(256),i=0;256!=i;++i)t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=i)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1,e[i]=t;return"undefined"!=typeof Int32Array?new Int32Array(e):e}();t.table=e,t.bstr=function(t,i){for(var r=-1^i,s=t.length-1,n=0;n<s;)r=(r=r>>>8^e[255&(r^t.charCodeAt(n++))])>>>8^e[255&(r^t.charCodeAt(n++))];return n===s&&(r=r>>>8^e[255&(r^t.charCodeAt(n))]),-1^r},t.buf=function(t,i){if(t.length>1e4)return function(t,i){for(var r=-1^i,s=t.length-7,n=0;n<s;)r=(r=(r=(r=(r=(r=(r=(r=r>>>8^e[255&(r^t[n++])])>>>8^e[255&(r^t[n++])])>>>8^e[255&(r^t[n++])])>>>8^e[255&(r^t[n++])])>>>8^e[255&(r^t[n++])])>>>8^e[255&(r^t[n++])])>>>8^e[255&(r^t[n++])])>>>8^e[255&(r^t[n++])];for(;n<s+7;)r=r>>>8^e[255&(r^t[n++])];return-1^r}(t,i);for(var r=-1^i,s=t.length-3,n=0;n<s;)r=(r=(r=(r=r>>>8^e[255&(r^t[n++])])>>>8^e[255&(r^t[n++])])>>>8^e[255&(r^t[n++])])>>>8^e[255&(r^t[n++])];for(;n<s+3;)r=r>>>8^e[255&(r^t[n++])];return-1^r},t.str=function(t,i){for(var r,s,n=-1^i,o=0,a=t.length;o<a;)(r=t.charCodeAt(o++))<128?n=n>>>8^e[255&(n^r)]:r<2048?n=(n=n>>>8^e[255&(n^(192|r>>6&31))])>>>8^e[255&(n^(128|63&r))]:r>=55296&&r<57344?(r=64+(1023&r),s=1023&t.charCodeAt(o++),n=(n=(n=(n=n>>>8^e[255&(n^(240|r>>8&7))])>>>8^e[255&(n^(128|r>>2&63))])>>>8^e[255&(n^(128|s>>6&15|(3&r)<<4))])>>>8^e[255&(n^(128|63&s))]):n=(n=(n=n>>>8^e[255&(n^(224|r>>12&15))])>>>8^e[255&(n^(128|r>>6&63))])>>>8^e[255&(n^(128|63&r))];return-1^n}})},function(t,e){},function(t,e,i){"use strict";
/*!
 * checkcontract.js - check contract outside of gamegold chain.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(10),s=e;class n{constructor(){this.checks=[]}getCheck(t){return this.checks.filter(e=>e.coinType==t)}}class o{constructor(t,e,i,r){this.coinType=t,this.url=e,this.check=i,this.verify=r}}function a(t,e,i){return 0==t}function h(t,e,i){return t>=e.dst}function c(t,e,i){if(t.txs&&0==t.txs.length)return!0}function u(t,e,i){let s=!1;if(t&&1==t.pagesTotal){const n=t.txs;if(n&&n.length>0)for(let t=0;t<n.length;t++){const o=n[t];if(o.confirmations>=i&&o.valueOut*r.COIN>=e.dst){s=!0;break}}}return s}function l(t,e,i){if(0==t.n_tx)return!0}function f(t,e,i){let r=!1;return t&&t.total_received>=e.dst&&(r=!0),r}s.main=new class extends n{constructor(){super(),this.checks.push(new o(1,"https://blockchain.info/q/getreceivedbyaddress/%s?confirmations=%d",a,h)),this.checks.push(new o(1,"https://api.blockcypher.com/v1/btc/main/addrs/%s",l,f))}},s.testnet=new class extends n{constructor(){super(),this.checks.push(new o(1,"https://test-insight.bitpay.com/api/txs?address=%s&confirmations=%d",c,u)),this.checks.push(new o(1,"https://api.blockcypher.com/v1/btc/test3/addrs/%s",l,f))}},s.regtest=new n,s.simnet=new n},function(t){t.exports={_args:[["elliptic@6.4.0","C:\\Users\\czy\\Documents\\SourceTree\\ggserver"]],_from:"elliptic@6.4.0",_id:"elliptic@6.4.0",_inBundle:!1,_integrity:"sha1-ysmvh2LIWDYYcAPI3+GT5eLq5d8=",_location:"/elliptic",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"elliptic@6.4.0",name:"elliptic",escapedName:"elliptic",rawSpec:"6.4.0",saveSpec:null,fetchSpec:"6.4.0"},_requiredBy:["/","/browserify-sign","/create-ecdh","/secp256k1"],_resolved:"http://registry.npm.taobao.org/elliptic/download/elliptic-6.4.0.tgz",_spec:"6.4.0",_where:"C:\\Users\\czy\\Documents\\SourceTree\\ggserver",author:{name:"Fedor Indutny",email:"fedor@indutny.com"},bugs:{url:"https://github.com/indutny/elliptic/issues"},dependencies:{"bn.js":"^4.4.0",brorand:"^1.0.1","hash.js":"^1.0.0","hmac-drbg":"^1.0.0",inherits:"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0"},description:"EC cryptography",devDependencies:{brfs:"^1.4.3",coveralls:"^2.11.3",grunt:"^0.4.5","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^8.6.2",istanbul:"^0.4.2",jscs:"^2.9.0",jshint:"^2.6.0",mocha:"^2.1.0"},files:["lib"],homepage:"https://github.com/indutny/elliptic",keywords:["EC","Elliptic","curve","Cryptography"],license:"MIT",main:"lib/elliptic.js",name:"elliptic",repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},scripts:{jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/index.js",version:"grunt dist && git add dist/"},version:"6.4.0"}},function(t,e,i){"use strict";var r=e,s=i(14),n=i(40),o=i(135);r.assert=n,r.toArray=o.toArray,r.zero2=o.zero2,r.toHex=o.toHex,r.encode=o.encode,r.getNAF=function(t,e){for(var i=[],r=1<<e+1,s=t.clone();s.cmpn(1)>=0;){var n;if(s.isOdd()){var o=s.andln(r-1);n=o>(r>>1)-1?(r>>1)-o:o,s.isubn(n)}else n=0;i.push(n);for(var a=0!==s.cmpn(0)&&0===s.andln(r-1)?e+1:1,h=1;h<a;h++)i.push(0);s.iushrn(a)}return i},r.getJSF=function(t,e){var i=[[],[]];t=t.clone(),e=e.clone();for(var r=0,s=0;t.cmpn(-r)>0||e.cmpn(-s)>0;){var n,o,a,h=t.andln(3)+r&3,c=e.andln(3)+s&3;3===h&&(h=-1),3===c&&(c=-1),n=0==(1&h)?0:3!=(a=t.andln(7)+r&7)&&5!==a||2!==c?h:-h,i[0].push(n),o=0==(1&c)?0:3!=(a=e.andln(7)+s&7)&&5!==a||2!==h?c:-c,i[1].push(o),2*r===n+1&&(r=1-r),2*s===o+1&&(s=1-s),t.iushrn(1),e.iushrn(1)}return i},r.cachedProperty=function(t,e,i){var r="_"+e;t.prototype[e]=function(){return void 0!==this[r]?this[r]:this[r]=i.call(this)}},r.parseBytes=function(t){return"string"==typeof t?r.toArray(t,"hex"):t},r.intFromLE=function(t){return new s(t,"hex","le")}},function(t,e){},function(t,e,i){"use strict";var r=i(14),s=i(21).utils,n=s.getNAF,o=s.getJSF,a=s.assert;function h(t,e){this.type=t,this.p=new r(e.p,16),this.red=e.prime?r.red(e.prime):r.mont(this.p),this.zero=new r(0).toRed(this.red),this.one=new r(1).toRed(this.red),this.two=new r(2).toRed(this.red),this.n=e.n&&new r(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4);var i=this.n&&this.p.div(this.n);!i||i.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function c(t,e){this.curve=t,this.type=e,this.precomputed=null}t.exports=h,h.prototype.point=function(){throw new Error("Not implemented")},h.prototype.validate=function(){throw new Error("Not implemented")},h.prototype._fixedNafMul=function(t,e){a(t.precomputed);var i=t._getDoubles(),r=n(e,1),s=(1<<i.step+1)-(i.step%2==0?2:1);s/=3;for(var o=[],h=0;h<r.length;h+=i.step){var c=0;for(e=h+i.step-1;e>=h;e--)c=(c<<1)+r[e];o.push(c)}for(var u=this.jpoint(null,null,null),l=this.jpoint(null,null,null),f=s;f>0;f--){for(h=0;h<o.length;h++)(c=o[h])===f?l=l.mixedAdd(i.points[h]):c===-f&&(l=l.mixedAdd(i.points[h].neg()));u=u.add(l)}return u.toP()},h.prototype._wnafMul=function(t,e){var i=4,r=t._getNAFPoints(i);i=r.wnd;for(var s=r.points,o=n(e,i),h=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(e=0;c>=0&&0===o[c];c--)e++;if(c>=0&&e++,h=h.dblp(e),c<0)break;var u=o[c];a(0!==u),h="affine"===t.type?u>0?h.mixedAdd(s[u-1>>1]):h.mixedAdd(s[-u-1>>1].neg()):u>0?h.add(s[u-1>>1]):h.add(s[-u-1>>1].neg())}return"affine"===t.type?h.toP():h},h.prototype._wnafMulAdd=function(t,e,i,r,s){for(var a=this._wnafT1,h=this._wnafT2,c=this._wnafT3,u=0,l=0;l<r;l++){var f=(R=e[l])._getNAFPoints(t);a[l]=f.wnd,h[l]=f.points}for(l=r-1;l>=1;l-=2){var d=l-1,p=l;if(1===a[d]&&1===a[p]){var g=[e[d],null,null,e[p]];0===e[d].y.cmp(e[p].y)?(g[1]=e[d].add(e[p]),g[2]=e[d].toJ().mixedAdd(e[p].neg())):0===e[d].y.cmp(e[p].y.redNeg())?(g[1]=e[d].toJ().mixedAdd(e[p]),g[2]=e[d].add(e[p].neg())):(g[1]=e[d].toJ().mixedAdd(e[p]),g[2]=e[d].toJ().mixedAdd(e[p].neg()));var m=[-3,-1,-5,-7,0,7,5,1,3],w=o(i[d],i[p]);u=Math.max(w[0].length,u),c[d]=new Array(u),c[p]=new Array(u);for(var y=0;y<u;y++){var b=0|w[0][y],v=0|w[1][y];c[d][y]=m[3*(b+1)+(v+1)],c[p][y]=0,h[d]=g}}else c[d]=n(i[d],a[d]),c[p]=n(i[p],a[p]),u=Math.max(c[d].length,u),u=Math.max(c[p].length,u)}var k=this.jpoint(null,null,null),S=this._wnafT4;for(l=u;l>=0;l--){for(var x=0;l>=0;){var E=!0;for(y=0;y<r;y++)S[y]=0|c[y][l],0!==S[y]&&(E=!1);if(!E)break;x++,l--}if(l>=0&&x++,k=k.dblp(x),l<0)break;for(y=0;y<r;y++){var R,_=S[y];0!==_&&(_>0?R=h[y][_-1>>1]:_<0&&(R=h[y][-_-1>>1].neg()),k="affine"===R.type?k.mixedAdd(R):k.add(R))}}for(l=0;l<r;l++)h[l]=null;return s?k:k.toP()},h.BasePoint=c,c.prototype.eq=function(){throw new Error("Not implemented")},c.prototype.validate=function(){return this.curve.validate(this)},h.prototype.decodePoint=function(t,e){t=s.toArray(t,e);var i=this.p.byteLength();if((4===t[0]||6===t[0]||7===t[0])&&t.length-1==2*i)return 6===t[0]?a(t[t.length-1]%2==0):7===t[0]&&a(t[t.length-1]%2==1),this.point(t.slice(1,1+i),t.slice(1+i,1+2*i));if((2===t[0]||3===t[0])&&t.length-1===i)return this.pointFromX(t.slice(1,1+i),3===t[0]);throw new Error("Unknown point format")},c.prototype.encodeCompressed=function(t){return this.encode(t,!0)},c.prototype._encode=function(t){var e=this.curve.p.byteLength(),i=this.getX().toArray("be",e);return t?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",e))},c.prototype.encode=function(t,e){return s.encode(this._encode(e),t)},c.prototype.precompute=function(t){if(this.precomputed)return this;var e={doubles:null,naf:null,beta:null};return e.naf=this._getNAFPoints(8),e.doubles=this._getDoubles(4,t),e.beta=this._getBeta(),this.precomputed=e,this},c.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var e=this.precomputed.doubles;return!!e&&e.points.length>=Math.ceil((t.bitLength()+1)/e.step)},c.prototype._getDoubles=function(t,e){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],r=this,s=0;s<e;s+=t){for(var n=0;n<t;n++)r=r.dbl();i.push(r)}return{step:t,points:i}},c.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var e=[this],i=(1<<t)-1,r=1===i?null:this.dbl(),s=1;s<i;s++)e[s]=e[s-1].add(r);return{wnd:t,points:e}},c.prototype._getBeta=function(){return null},c.prototype.dblp=function(t){for(var e=this,i=0;i<t;i++)e=e.dbl();return e}},function(t,e,i){"use strict";var r=i(76),s=i(21),n=i(14),o=i(5),a=r.base,h=s.utils.assert;function c(t){a.call(this,"short",t),this.a=new n(t.a,16).toRed(this.red),this.b=new n(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function u(t,e,i,r){a.BasePoint.call(this,t,"affine"),null===e&&null===i?(this.x=null,this.y=null,this.inf=!0):(this.x=new n(e,16),this.y=new n(i,16),r&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function l(t,e,i,r){a.BasePoint.call(this,t,"jacobian"),null===e&&null===i&&null===r?(this.x=this.curve.one,this.y=this.curve.one,this.z=new n(0)):(this.x=new n(e,16),this.y=new n(i,16),this.z=new n(r,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}o(c,a),t.exports=c,c.prototype._getEndomorphism=function(t){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var e,i;if(t.beta)e=new n(t.beta,16).toRed(this.red);else{var r=this._getEndoRoots(this.p);e=(e=r[0].cmp(r[1])<0?r[0]:r[1]).toRed(this.red)}if(t.lambda)i=new n(t.lambda,16);else{var s=this._getEndoRoots(this.n);0===this.g.mul(s[0]).x.cmp(this.g.x.redMul(e))?i=s[0]:(i=s[1],h(0===this.g.mul(i).x.cmp(this.g.x.redMul(e))))}return{beta:e,lambda:i,basis:t.basis?t.basis.map(function(t){return{a:new n(t.a,16),b:new n(t.b,16)}}):this._getEndoBasis(i)}}},c.prototype._getEndoRoots=function(t){var e=t===this.p?this.red:n.mont(t),i=new n(2).toRed(e).redInvm(),r=i.redNeg(),s=new n(3).toRed(e).redNeg().redSqrt().redMul(i);return[r.redAdd(s).fromRed(),r.redSub(s).fromRed()]},c.prototype._getEndoBasis=function(t){for(var e,i,r,s,o,a,h,c,u,l=this.n.ushrn(Math.floor(this.n.bitLength()/2)),f=t,d=this.n.clone(),p=new n(1),g=new n(0),m=new n(0),w=new n(1),y=0;0!==f.cmpn(0);){var b=d.div(f);c=d.sub(b.mul(f)),u=m.sub(b.mul(p));var v=w.sub(b.mul(g));if(!r&&c.cmp(l)<0)e=h.neg(),i=p,r=c.neg(),s=u;else if(r&&2==++y)break;h=c,d=f,f=c,m=p,p=u,w=g,g=v}o=c.neg(),a=u;var k=r.sqr().add(s.sqr());return o.sqr().add(a.sqr()).cmp(k)>=0&&(o=e,a=i),r.negative&&(r=r.neg(),s=s.neg()),o.negative&&(o=o.neg(),a=a.neg()),[{a:r,b:s},{a:o,b:a}]},c.prototype._endoSplit=function(t){var e=this.endo.basis,i=e[0],r=e[1],s=r.b.mul(t).divRound(this.n),n=i.b.neg().mul(t).divRound(this.n),o=s.mul(i.a),a=n.mul(r.a),h=s.mul(i.b),c=n.mul(r.b);return{k1:t.sub(o).sub(a),k2:h.add(c).neg()}},c.prototype.pointFromX=function(t,e){(t=new n(t,16)).red||(t=t.toRed(this.red));var i=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),r=i.redSqrt();if(0!==r.redSqr().redSub(i).cmp(this.zero))throw new Error("invalid point");var s=r.fromRed().isOdd();return(e&&!s||!e&&s)&&(r=r.redNeg()),this.point(t,r)},c.prototype.validate=function(t){if(t.inf)return!0;var e=t.x,i=t.y,r=this.a.redMul(e),s=e.redSqr().redMul(e).redIAdd(r).redIAdd(this.b);return 0===i.redSqr().redISub(s).cmpn(0)},c.prototype._endoWnafMulAdd=function(t,e,i){for(var r=this._endoWnafT1,s=this._endoWnafT2,n=0;n<t.length;n++){var o=this._endoSplit(e[n]),a=t[n],h=a._getBeta();o.k1.negative&&(o.k1.ineg(),a=a.neg(!0)),o.k2.negative&&(o.k2.ineg(),h=h.neg(!0)),r[2*n]=a,r[2*n+1]=h,s[2*n]=o.k1,s[2*n+1]=o.k2}for(var c=this._wnafMulAdd(1,r,s,2*n,i),u=0;u<2*n;u++)r[u]=null,s[u]=null;return c},o(u,a.BasePoint),c.prototype.point=function(t,e,i){return new u(this,t,e,i)},c.prototype.pointFromJSON=function(t,e){return u.fromJSON(this,t,e)},u.prototype._getBeta=function(){if(this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var e=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var i=this.curve,r=function(t){return i.point(t.x.redMul(i.endo.beta),t.y)};t.beta=e,e.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(r)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(r)}}}return e}},u.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},u.fromJSON=function(t,e,i){"string"==typeof e&&(e=JSON.parse(e));var r=t.point(e[0],e[1],i);if(!e[2])return r;function s(e){return t.point(e[0],e[1],i)}var n=e[2];return r.precomputed={beta:null,doubles:n.doubles&&{step:n.doubles.step,points:[r].concat(n.doubles.points.map(s))},naf:n.naf&&{wnd:n.naf.wnd,points:[r].concat(n.naf.points.map(s))}},r},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.inf},u.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(0===this.x.cmp(t.x))return this.curve.point(null,null);var e=this.y.redSub(t.y);0!==e.cmpn(0)&&(e=e.redMul(this.x.redSub(t.x).redInvm()));var i=e.redSqr().redISub(this.x).redISub(t.x),r=e.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,r)},u.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(0===t.cmpn(0))return this.curve.point(null,null);var e=this.curve.a,i=this.x.redSqr(),r=t.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(e).redMul(r),n=s.redSqr().redISub(this.x.redAdd(this.x)),o=s.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,o)},u.prototype.getX=function(){return this.x.fromRed()},u.prototype.getY=function(){return this.y.fromRed()},u.prototype.mul=function(t){return t=new n(t,16),this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)},u.prototype.mulAdd=function(t,e,i){var r=[this,e],s=[t,i];return this.curve.endo?this.curve._endoWnafMulAdd(r,s):this.curve._wnafMulAdd(1,r,s,2)},u.prototype.jmulAdd=function(t,e,i){var r=[this,e],s=[t,i];return this.curve.endo?this.curve._endoWnafMulAdd(r,s,!0):this.curve._wnafMulAdd(1,r,s,2,!0)},u.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||0===this.x.cmp(t.x)&&0===this.y.cmp(t.y))},u.prototype.neg=function(t){if(this.inf)return this;var e=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var i=this.precomputed,r=function(t){return t.neg()};e.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(r)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(r)}}}return e},u.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},o(l,a.BasePoint),c.prototype.jpoint=function(t,e,i){return new l(this,t,e,i)},l.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),e=t.redSqr(),i=this.x.redMul(e),r=this.y.redMul(e).redMul(t);return this.curve.point(i,r)},l.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},l.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.z.redSqr(),i=this.z.redSqr(),r=this.x.redMul(e),s=t.x.redMul(i),n=this.y.redMul(e.redMul(t.z)),o=t.y.redMul(i.redMul(this.z)),a=r.redSub(s),h=n.redSub(o);if(0===a.cmpn(0))return 0!==h.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=a.redSqr(),u=c.redMul(a),l=r.redMul(c),f=h.redSqr().redIAdd(u).redISub(l).redISub(l),d=h.redMul(l.redISub(f)).redISub(n.redMul(u)),p=this.z.redMul(t.z).redMul(a);return this.curve.jpoint(f,d,p)},l.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var e=this.z.redSqr(),i=this.x,r=t.x.redMul(e),s=this.y,n=t.y.redMul(e).redMul(this.z),o=i.redSub(r),a=s.redSub(n);if(0===o.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var h=o.redSqr(),c=h.redMul(o),u=i.redMul(h),l=a.redSqr().redIAdd(c).redISub(u).redISub(u),f=a.redMul(u.redISub(l)).redISub(s.redMul(c)),d=this.z.redMul(o);return this.curve.jpoint(l,f,d)},l.prototype.dblp=function(t){if(0===t)return this;if(this.isInfinity())return this;if(!t)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var e=this,i=0;i<t;i++)e=e.dbl();return e}var r=this.curve.a,s=this.curve.tinv,n=this.x,o=this.y,a=this.z,h=a.redSqr().redSqr(),c=o.redAdd(o);for(i=0;i<t;i++){var u=n.redSqr(),l=c.redSqr(),f=l.redSqr(),d=u.redAdd(u).redIAdd(u).redIAdd(r.redMul(h)),p=n.redMul(l),g=d.redSqr().redISub(p.redAdd(p)),m=p.redISub(g),w=d.redMul(m);w=w.redIAdd(w).redISub(f);var y=c.redMul(a);i+1<t&&(h=h.redMul(f)),n=g,a=y,c=w}return this.curve.jpoint(n,c.redMul(s),a)},l.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},l.prototype._zeroDbl=function(){var t,e,i;if(this.zOne){var r=this.x.redSqr(),s=this.y.redSqr(),n=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(r).redISub(n);o=o.redIAdd(o);var a=r.redAdd(r).redIAdd(r),h=a.redSqr().redISub(o).redISub(o),c=n.redIAdd(n);c=(c=c.redIAdd(c)).redIAdd(c),t=h,e=a.redMul(o.redISub(h)).redISub(c),i=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),l=this.y.redSqr(),f=l.redSqr(),d=this.x.redAdd(l).redSqr().redISub(u).redISub(f);d=d.redIAdd(d);var p=u.redAdd(u).redIAdd(u),g=p.redSqr(),m=f.redIAdd(f);m=(m=m.redIAdd(m)).redIAdd(m),t=g.redISub(d).redISub(d),e=p.redMul(d.redISub(t)).redISub(m),i=(i=this.y.redMul(this.z)).redIAdd(i)}return this.curve.jpoint(t,e,i)},l.prototype._threeDbl=function(){var t,e,i;if(this.zOne){var r=this.x.redSqr(),s=this.y.redSqr(),n=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(r).redISub(n);o=o.redIAdd(o);var a=r.redAdd(r).redIAdd(r).redIAdd(this.curve.a),h=a.redSqr().redISub(o).redISub(o);t=h;var c=n.redIAdd(n);c=(c=c.redIAdd(c)).redIAdd(c),e=a.redMul(o.redISub(h)).redISub(c),i=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),l=this.y.redSqr(),f=this.x.redMul(l),d=this.x.redSub(u).redMul(this.x.redAdd(u));d=d.redAdd(d).redIAdd(d);var p=f.redIAdd(f),g=(p=p.redIAdd(p)).redAdd(p);t=d.redSqr().redISub(g),i=this.y.redAdd(this.z).redSqr().redISub(l).redISub(u);var m=l.redSqr();m=(m=(m=m.redIAdd(m)).redIAdd(m)).redIAdd(m),e=d.redMul(p.redISub(t)).redISub(m)}return this.curve.jpoint(t,e,i)},l.prototype._dbl=function(){var t=this.curve.a,e=this.x,i=this.y,r=this.z,s=r.redSqr().redSqr(),n=e.redSqr(),o=i.redSqr(),a=n.redAdd(n).redIAdd(n).redIAdd(t.redMul(s)),h=e.redAdd(e),c=(h=h.redIAdd(h)).redMul(o),u=a.redSqr().redISub(c.redAdd(c)),l=c.redISub(u),f=o.redSqr();f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var d=a.redMul(l).redISub(f),p=i.redAdd(i).redMul(r);return this.curve.jpoint(u,d,p)},l.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),e=this.y.redSqr(),i=this.z.redSqr(),r=e.redSqr(),s=t.redAdd(t).redIAdd(t),n=s.redSqr(),o=this.x.redAdd(e).redSqr().redISub(t).redISub(r),a=(o=(o=(o=o.redIAdd(o)).redAdd(o).redIAdd(o)).redISub(n)).redSqr(),h=r.redIAdd(r);h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var c=s.redIAdd(o).redSqr().redISub(n).redISub(a).redISub(h),u=e.redMul(c);u=(u=u.redIAdd(u)).redIAdd(u);var l=this.x.redMul(a).redISub(u);l=(l=l.redIAdd(l)).redIAdd(l);var f=this.y.redMul(c.redMul(h.redISub(c)).redISub(o.redMul(a)));f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var d=this.z.redAdd(o).redSqr().redISub(i).redISub(a);return this.curve.jpoint(l,f,d)},l.prototype.mul=function(t,e){return t=new n(t,e),this.curve._wnafMul(this,t)},l.prototype.eq=function(t){if("affine"===t.type)return this.eq(t.toJ());if(this===t)return!0;var e=this.z.redSqr(),i=t.z.redSqr();if(0!==this.x.redMul(i).redISub(t.x.redMul(e)).cmpn(0))return!1;var r=e.redMul(this.z),s=i.redMul(t.z);return 0===this.y.redMul(s).redISub(t.y.redMul(r)).cmpn(0)},l.prototype.eqXToP=function(t){var e=this.z.redSqr(),i=t.toRed(this.curve.red).redMul(e);if(0===this.x.cmp(i))return!0;for(var r=t.clone(),s=this.curve.redN.redMul(e);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),0===this.x.cmp(i))return!0}return!1},l.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},function(t,e,i){"use strict";var r=i(76),s=i(14),n=i(5),o=r.base,a=i(21).utils;function h(t){o.call(this,"mont",t),this.a=new s(t.a,16).toRed(this.red),this.b=new s(t.b,16).toRed(this.red),this.i4=new s(4).toRed(this.red).redInvm(),this.two=new s(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function c(t,e,i){o.BasePoint.call(this,t,"projective"),null===e&&null===i?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new s(e,16),this.z=new s(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}n(h,o),t.exports=h,h.prototype.validate=function(t){var e=t.normalize().x,i=e.redSqr(),r=i.redMul(e).redAdd(i.redMul(this.a)).redAdd(e);return 0===r.redSqrt().redSqr().cmp(r)},n(c,o.BasePoint),h.prototype.decodePoint=function(t,e){return this.point(a.toArray(t,e),1)},h.prototype.point=function(t,e){return new c(this,t,e)},h.prototype.pointFromJSON=function(t){return c.fromJSON(this,t)},c.prototype.precompute=function(){},c.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},c.fromJSON=function(t,e){return new c(t,e[0],e[1]||t.one)},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},c.prototype.dbl=function(){var t=this.x.redAdd(this.z).redSqr(),e=this.x.redSub(this.z).redSqr(),i=t.redSub(e),r=t.redMul(e),s=i.redMul(e.redAdd(this.curve.a24.redMul(i)));return this.curve.point(r,s)},c.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.diffAdd=function(t,e){var i=this.x.redAdd(this.z),r=this.x.redSub(this.z),s=t.x.redAdd(t.z),n=t.x.redSub(t.z).redMul(i),o=s.redMul(r),a=e.z.redMul(n.redAdd(o).redSqr()),h=e.x.redMul(n.redISub(o).redSqr());return this.curve.point(a,h)},c.prototype.mul=function(t){for(var e=t.clone(),i=this,r=this.curve.point(null,null),s=[];0!==e.cmpn(0);e.iushrn(1))s.push(e.andln(1));for(var n=s.length-1;n>=0;n--)0===s[n]?(i=i.diffAdd(r,this),r=r.dbl()):(r=i.diffAdd(r,this),i=i.dbl());return r},c.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.eq=function(t){return 0===this.getX().cmp(t.getX())},c.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},function(t,e,i){"use strict";var r=i(76),s=i(21),n=i(14),o=i(5),a=r.base,h=s.utils.assert;function c(t){this.twisted=1!=(0|t.a),this.mOneA=this.twisted&&-1==(0|t.a),this.extended=this.mOneA,a.call(this,"edwards",t),this.a=new n(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new n(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new n(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),h(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|t.c)}function u(t,e,i,r,s){a.BasePoint.call(this,t,"projective"),null===e&&null===i&&null===r?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new n(e,16),this.y=new n(i,16),this.z=r?new n(r,16):this.curve.one,this.t=s&&new n(s,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}o(c,a),t.exports=c,c.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)},c.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)},c.prototype.jpoint=function(t,e,i,r){return this.point(t,e,i,r)},c.prototype.pointFromX=function(t,e){(t=new n(t,16)).red||(t=t.toRed(this.red));var i=t.redSqr(),r=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),o=r.redMul(s.redInvm()),a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");var h=a.fromRed().isOdd();return(e&&!h||!e&&h)&&(a=a.redNeg()),this.point(t,a)},c.prototype.pointFromY=function(t,e){(t=new n(t,16)).red||(t=t.toRed(this.red));var i=t.redSqr(),r=i.redSub(this.one),s=i.redMul(this.d).redAdd(this.one),o=r.redMul(s.redInvm());if(0===o.cmp(this.zero)){if(e)throw new Error("invalid point");return this.point(this.zero,t)}var a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");return a.isOdd()!==e&&(a=a.redNeg()),this.point(a,t)},c.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var e=t.x.redSqr(),i=t.y.redSqr(),r=e.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(e).redMul(i)));return 0===r.cmp(s)},o(u,a.BasePoint),c.prototype.pointFromJSON=function(t){return u.fromJSON(this,t)},c.prototype.point=function(t,e,i,r){return new u(this,t,e,i,r)},u.fromJSON=function(t,e){return new u(t,e[0],e[1],e[2])},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},u.prototype._extDbl=function(){var t=this.x.redSqr(),e=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var r=this.curve._mulA(t),s=this.x.redAdd(this.y).redSqr().redISub(t).redISub(e),n=r.redAdd(e),o=n.redSub(i),a=r.redSub(e),h=s.redMul(o),c=n.redMul(a),u=s.redMul(a),l=o.redMul(n);return this.curve.point(h,c,l,u)},u.prototype._projDbl=function(){var t,e,i,r=this.x.redAdd(this.y).redSqr(),s=this.x.redSqr(),n=this.y.redSqr();if(this.curve.twisted){var o=(c=this.curve._mulA(s)).redAdd(n);if(this.zOne)t=r.redSub(s).redSub(n).redMul(o.redSub(this.curve.two)),e=o.redMul(c.redSub(n)),i=o.redSqr().redSub(o).redSub(o);else{var a=this.z.redSqr(),h=o.redSub(a).redISub(a);t=r.redSub(s).redISub(n).redMul(h),e=o.redMul(c.redSub(n)),i=o.redMul(h)}}else{var c=s.redAdd(n);a=this.curve._mulC(this.c.redMul(this.z)).redSqr(),h=c.redSub(a).redSub(a),t=this.curve._mulC(r.redISub(c)).redMul(h),e=this.curve._mulC(c).redMul(s.redISub(n)),i=c.redMul(h)}return this.curve.point(t,e,i)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},u.prototype._extAdd=function(t){var e=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),i=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),r=this.t.redMul(this.curve.dd).redMul(t.t),s=this.z.redMul(t.z.redAdd(t.z)),n=i.redSub(e),o=s.redSub(r),a=s.redAdd(r),h=i.redAdd(e),c=n.redMul(o),u=a.redMul(h),l=n.redMul(h),f=o.redMul(a);return this.curve.point(c,u,f,l)},u.prototype._projAdd=function(t){var e,i,r=this.z.redMul(t.z),s=r.redSqr(),n=this.x.redMul(t.x),o=this.y.redMul(t.y),a=this.curve.d.redMul(n).redMul(o),h=s.redSub(a),c=s.redAdd(a),u=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(n).redISub(o),l=r.redMul(h).redMul(u);return this.curve.twisted?(e=r.redMul(c).redMul(o.redSub(this.curve._mulA(n))),i=h.redMul(c)):(e=r.redMul(c).redMul(o.redSub(n)),i=this.curve._mulC(h).redMul(c)),this.curve.point(l,e,i)},u.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)},u.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)},u.prototype.mulAdd=function(t,e,i){return this.curve._wnafMulAdd(1,[this,e],[t,i],2,!1)},u.prototype.jmulAdd=function(t,e,i){return this.curve._wnafMulAdd(1,[this,e],[t,i],2,!0)},u.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this},u.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()},u.prototype.getY=function(){return this.normalize(),this.y.fromRed()},u.prototype.eq=function(t){return this===t||0===this.getX().cmp(t.getX())&&0===this.getY().cmp(t.getY())},u.prototype.eqXToP=function(t){var e=t.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(e))return!0;for(var i=t.clone(),r=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(e.redIAdd(r),0===this.x.cmp(e))return!0}return!1},u.prototype.toP=u.prototype.normalize,u.prototype.mixedAdd=u.prototype.add},function(t,e,i){"use strict";var r,s=e,n=i(75),o=i(21),a=o.utils.assert;function h(t){"short"===t.type?this.curve=new o.curve.short(t):"edwards"===t.type?this.curve=new o.curve.edwards(t):this.curve=new o.curve.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function c(t,e){Object.defineProperty(s,t,{configurable:!0,enumerable:!0,get:function(){var i=new h(e);return Object.defineProperty(s,t,{configurable:!0,enumerable:!0,value:i}),i}})}s.PresetCurve=h,c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:n.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:n.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:n.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:n.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:n.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{r=i(241)}catch(t){r=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:n.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",r]})},function(t,e){t.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},function(t,e,i){"use strict";var r=i(14),s=i(243),n=i(21),o=n.utils.assert,a=i(244),h=i(106);function c(t){if(!(this instanceof c))return new c(t);"string"==typeof t&&(o(n.curves.hasOwnProperty(t),"Unknown curve "+t),t=n.curves[t]),t instanceof n.curves.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}t.exports=c,c.prototype.keyPair=function(t){return new a(this,t)},c.prototype.keyFromPrivate=function(t,e){return a.fromPrivate(this,t,e)},c.prototype.keyFromPublic=function(t,e){return a.fromPublic(this,t,e)},c.prototype.genKeyPair=function(t){t||(t={});for(var e=new s({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||n.rand(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),o=this.n.sub(new r(2));;){var a=new r(e.generate(i));if(!(a.cmp(o)>0))return a.iaddn(1),this.keyFromPrivate(a)}},c.prototype._truncateToN=function(t,e){var i=8*t.byteLength()-this.n.bitLength();return i>0&&(t=t.ushrn(i)),!e&&t.cmp(this.n)>=0?t.sub(this.n):t},c.prototype.sign=function(t,e,i,n){"object"==typeof i&&(n=i,i=null),n||(n={}),e=this.keyFromPrivate(e,i),t=this._truncateToN(new r(t,16));for(var o=this.n.byteLength(),a=e.getPrivate().toArray("be",o),c=t.toArray("be",o),u=new s({hash:this.hash,entropy:a,nonce:c,pers:n.pers,persEnc:n.persEnc||"utf8"}),l=this.n.sub(new r(1)),f=0;;f++){var d=n.k?n.k(f):new r(u.generate(this.n.byteLength()));if(!((d=this._truncateToN(d,!0)).cmpn(1)<=0||d.cmp(l)>=0)){var p=this.g.mul(d);if(!p.isInfinity()){var g=p.getX(),m=g.umod(this.n);if(0!==m.cmpn(0)){var w=d.invm(this.n).mul(m.mul(e.getPrivate()).iadd(t));if(0!==(w=w.umod(this.n)).cmpn(0)){var y=(p.getY().isOdd()?1:0)|(0!==g.cmp(m)?2:0);return n.canonical&&w.cmp(this.nh)>0&&(w=this.n.sub(w),y^=1),new h({r:m,s:w,recoveryParam:y})}}}}}},c.prototype.verify=function(t,e,i,s){t=this._truncateToN(new r(t,16)),i=this.keyFromPublic(i,s);var n=(e=new h(e,"hex")).r,o=e.s;if(n.cmpn(1)<0||n.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a,c=o.invm(this.n),u=c.mul(t).umod(this.n),l=c.mul(n).umod(this.n);return this.curve._maxwellTrick?!(a=this.g.jmulAdd(u,i.getPublic(),l)).isInfinity()&&a.eqXToP(n):!(a=this.g.mulAdd(u,i.getPublic(),l)).isInfinity()&&0===a.getX().umod(this.n).cmp(n)},c.prototype.recoverPubKey=function(t,e,i,s){o((3&i)===i,"The recovery param is more than two bits"),e=new h(e,s);var n=this.n,a=new r(t),c=e.r,u=e.s,l=1&i,f=i>>1;if(c.cmp(this.curve.p.umod(this.curve.n))>=0&&f)throw new Error("Unable to find sencond key candinate");c=f?this.curve.pointFromX(c.add(this.curve.n),l):this.curve.pointFromX(c,l);var d=e.r.invm(n),p=n.sub(a).mul(d).umod(n),g=u.mul(d).umod(n);return this.g.mulAdd(p,c,g)},c.prototype.getKeyRecoveryParam=function(t,e,i,r){if(null!==(e=new h(e,r)).recoveryParam)return e.recoveryParam;for(var s=0;s<4;s++){var n;try{n=this.recoverPubKey(t,e,s)}catch(t){continue}if(n.eq(i))return s}throw new Error("Unable to find valid recovery factor")}},function(t,e,i){"use strict";var r=i(75),s=i(135),n=i(40);function o(t){if(!(this instanceof o))return new o(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=s.toArray(t.entropy,t.entropyEnc||"hex"),i=s.toArray(t.nonce,t.nonceEnc||"hex"),r=s.toArray(t.pers,t.persEnc||"hex");n(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,i,r)}t.exports=o,o.prototype._init=function(t,e,i){var r=t.concat(e).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(r),this._reseed=1,this.reseedInterval=281474976710656},o.prototype._hmac=function(){return new r.hmac(this.hash,this.K)},o.prototype._update=function(t){var e=this._hmac().update(this.V).update([0]);t&&(e=e.update(t)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())},o.prototype.reseed=function(t,e,i,r){"string"!=typeof e&&(r=i,i=e,e=null),t=s.toArray(t,e),i=s.toArray(i,r),n(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(i||[])),this._reseed=1},o.prototype.generate=function(t,e,i,r){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof e&&(r=i,i=e,e=null),i&&(i=s.toArray(i,r||"hex"),this._update(i));for(var n=[];n.length<t;)this.V=this._hmac().update(this.V).digest(),n=n.concat(this.V);var o=n.slice(0,t);return this._update(i),this._reseed++,s.encode(o,e)}},function(t,e,i){"use strict";var r=i(14),s=i(21).utils.assert;function n(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}t.exports=n,n.fromPublic=function(t,e,i){return e instanceof n?e:new n(t,{pub:e,pubEnc:i})},n.fromPrivate=function(t,e,i){return e instanceof n?e:new n(t,{priv:e,privEnc:i})},n.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},n.prototype.getPublic=function(t,e){return"string"==typeof t&&(e=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),e?this.pub.encode(e,t):this.pub},n.prototype.getPrivate=function(t){return"hex"===t?this.priv.toString(16,2):this.priv},n.prototype._importPrivate=function(t,e){this.priv=new r(t,e||16),this.priv=this.priv.umod(this.ec.curve.n)},n.prototype._importPublic=function(t,e){if(t.x||t.y)return"mont"===this.ec.curve.type?s(t.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||s(t.x&&t.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(t.x,t.y));this.pub=this.ec.curve.decodePoint(t,e)},n.prototype.derive=function(t){return t.mul(this.priv).getX()},n.prototype.sign=function(t,e,i){return this.ec.sign(t,this,e,i)},n.prototype.verify=function(t,e){return this.ec.verify(t,e,this)},n.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},function(t,e,i){"use strict";var r=i(75),s=i(21),n=s.utils,o=n.assert,a=n.parseBytes,h=i(246),c=i(247);function u(t){if(o("ed25519"===t,"only tested with ed25519 so far"),!(this instanceof u))return new u(t);t=s.curves[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=r.sha512}t.exports=u,u.prototype.sign=function(t,e){t=a(t);var i=this.keyFromSecret(e),r=this.hashInt(i.messagePrefix(),t),s=this.g.mul(r),n=this.encodePoint(s),o=this.hashInt(n,i.pubBytes(),t).mul(i.priv()),h=r.add(o).umod(this.curve.n);return this.makeSignature({R:s,S:h,Rencoded:n})},u.prototype.verify=function(t,e,i){t=a(t),e=this.makeSignature(e);var r=this.keyFromPublic(i),s=this.hashInt(e.Rencoded(),r.pubBytes(),t),n=this.g.mul(e.S());return e.R().add(r.pub().mul(s)).eq(n)},u.prototype.hashInt=function(){for(var t=this.hash(),e=0;e<arguments.length;e++)t.update(arguments[e]);return n.intFromLE(t.digest()).umod(this.curve.n)},u.prototype.keyFromPublic=function(t){return h.fromPublic(this,t)},u.prototype.keyFromSecret=function(t){return h.fromSecret(this,t)},u.prototype.makeSignature=function(t){return t instanceof c?t:new c(this,t)},u.prototype.encodePoint=function(t){var e=t.getY().toArray("le",this.encodingLength);return e[this.encodingLength-1]|=t.getX().isOdd()?128:0,e},u.prototype.decodePoint=function(t){var e=(t=n.parseBytes(t)).length-1,i=t.slice(0,e).concat(-129&t[e]),r=0!=(128&t[e]),s=n.intFromLE(i);return this.curve.pointFromY(s,r)},u.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)},u.prototype.decodeInt=function(t){return n.intFromLE(t)},u.prototype.isPoint=function(t){return t instanceof this.pointClass}},function(t,e,i){"use strict";var r=i(21).utils,s=r.assert,n=r.parseBytes,o=r.cachedProperty;function a(t,e){this.eddsa=t,this._secret=n(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=n(e.pub)}a.fromPublic=function(t,e){return e instanceof a?e:new a(t,{pub:e})},a.fromSecret=function(t,e){return e instanceof a?e:new a(t,{secret:e})},a.prototype.secret=function(){return this._secret},o(a,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),o(a,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),o(a,"privBytes",function(){var t=this.eddsa,e=this.hash(),i=t.encodingLength-1,r=e.slice(0,t.encodingLength);return r[0]&=248,r[i]&=127,r[i]|=64,r}),o(a,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),o(a,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),o(a,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),a.prototype.sign=function(t){return s(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)},a.prototype.verify=function(t,e){return this.eddsa.verify(t,e,this)},a.prototype.getSecret=function(t){return s(this._secret,"KeyPair is public only"),r.encode(this.secret(),t)},a.prototype.getPublic=function(t){return r.encode(this.pubBytes(),t)},t.exports=a},function(t,e,i){"use strict";var r=i(14),s=i(21).utils,n=s.assert,o=s.cachedProperty,a=s.parseBytes;function h(t,e){this.eddsa=t,"object"!=typeof e&&(e=a(e)),Array.isArray(e)&&(e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),n(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof r&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}o(h,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),o(h,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),o(h,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),o(h,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),h.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},h.prototype.toHex=function(){return s.encode(this.toBytes(),"hex").toUpperCase()},t.exports=h},function(t,e){class i{constructor(t){this.indicate=t||0}get value(){return this.indicate}set(t){return this.indicate=this.indicate|t,this}unSet(t){return this.indicate=this.indicate&~t,this}check(t){return!!this.indicate&&(this.indicate&t)==t}static inst(t){return new i(t)}}t.exports=i},function(t,e,i){const{contractStatus:r}=i(8);t.exports=class extends class{constructor(t){this.period=t.period}run(t){let e=this.getResult();if(e&&Array.isArray(e)&&e.length<=10)for(let i of e)t.pushInt(i)}getResult(){return[]}}{constructor(t,e){super(t),this.type=t.type,this.addr=t.addr,this.dst=t.dst,this.status=e}getResult(){return this.status===r.Expired||this.status===r.Backed?[1,2]:this.status===r.Confirmed||this.status===r.Exchanged?[2,1]:[]}}},function(t,e,i){"use strict";(function(e){
/*!
 * paymentdetails.js - bip70 paymentdetails for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(3),n=i(28),o=i(127),a=i(131);function h(t){if(!(this instanceof h))return new h(t);this.network=null,this.outputs=[],this.time=s.now(),this.expires=-1,this.memo=null,this.paymentUrl=null,this.merchantData=null,t&&this.fromOptions(t)}h.prototype.fromOptions=function(t){if(null!=t.network&&(r("string"==typeof t.network),this.network=t.network),t.outputs){r(Array.isArray(t.outputs));for(const e of t.outputs){const t=new n(e);this.outputs.push(t)}}return null!=t.time&&(r(s.isInt(t.time)),this.time=t.time),null!=t.expires&&(r(s.isInt(t.expires)),this.expires=t.expires),null!=t.memo&&(r("string"==typeof t.memo),this.memo=t.memo),null!=t.paymentUrl&&(r("string"==typeof t.paymentUrl),this.paymentUrl=t.paymentUrl),t.merchantData&&this.setData(t.merchantData),this},h.fromOptions=function(t){return(new h).fromOptions(t)},h.prototype.isExpired=function(){return-1!==this.expires&&s.now()>this.expires},h.prototype.setData=function(t,i){if(null!=t&&!e.isBuffer(t))return"string"!=typeof t?(r(!i||"json"===i),void(this.merchantData=e.from(JSON.stringify(t),"utf8"))):void(this.merchantData=e.from(t,i));this.merchantData=t},h.prototype.getData=function(t){let e=this.merchantData;if(!e)return null;if(!t)return e;if("json"===t){e=e.toString("utf8");try{e=JSON.parse(e)}catch(t){return null}return e}return e.toString(t)},h.prototype.fromRaw=function(t){const e=new o(t);for(this.network=e.readFieldString(1,!0);2===e.nextTag();){const t=new o(e.readFieldBytes(2)),i=new n;i.value=t.readFieldU64(1,!0),i.script.fromRaw(t.readFieldBytes(2,!0)),this.outputs.push(i)}return this.time=e.readFieldU64(3),this.expires=e.readFieldU64(4,!0),this.memo=e.readFieldString(5,!0),this.paymentUrl=e.readFieldString(6,!0),this.merchantData=e.readFieldBytes(7,!0),this},h.fromRaw=function(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new h).fromRaw(t)},h.prototype.toRaw=function(){const t=new a;null!=this.network&&t.writeFieldString(1,this.network);for(const e of this.outputs){const i=new a;i.writeFieldU64(1,e.value),i.writeFieldBytes(2,e.script.toRaw()),t.writeFieldBytes(2,i.render())}return t.writeFieldU64(3,this.time),-1!==this.expires&&t.writeFieldU64(4,this.expires),null!=this.memo&&t.writeFieldString(5,this.memo),null!=this.paymentUrl&&t.writeFieldString(6,this.paymentUrl),this.merchantData&&t.writeFieldString(7,this.merchantData),t.render()},t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t){
/*!
 * asn1.js - asn1 parsing for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 *
 * Parts of this software are based on asn1.js.
 * https://github.com/indutny/asn1.js
 *
 * Copyright Fedor Indutny, 2013.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 */
const r=i(2),s=e;s.readTag=function(t){let e=t.readU8();const i=0==(32&e);if(31==(31&e)){let i=e;for(e=0;128==(128&i);)e<<=7,e|=127&(i=t.readU8())}else e&=31;return{type:e,primitive:i,size:s.readSize(t,i)}},s.readSize=function(t,e){let i=t.readU8();if(!e&&128===i)throw new Error("Indefinite size.");if(0==(128&i))return i;const r=127&i;if(r>3)throw new Error("Length octet is too long.");i=0;for(let e=0;e<r;e++)i<<=8,i|=t.readU8();return i},s.readSeq=function(t){const e=s.implicit(t,16);return t.readBytes(e.size)},s.implicit=function(t,e){const i=s.readTag(t);if(i.type!==e)throw new Error(`Unexpected tag: ${i.type}.`);return i},s.explicit=function(t,e){const i=t.offset;return s.readTag(t).type===e||(t.offset=i,!1)},s.seq=function(t){return new r(s.readSeq(t),!0)},s.readInt=function(t,e){const i=s.implicit(t,2),r=t.readBytes(i.size);return e?r.readUIntBE(0,r.length):r},s.readExplicitInt=function(t,e,i){return s.explicit(t,e)?s.readInt(t,i):-1},s.readBitstr=function(t){const e=s.implicit(t,3),i=t.readBytes(e.size);return s.alignBitstr(i)},s.readString=function(t){const e=s.readTag(t);switch(e.type){case 3:{const i=t.readBytes(e.size);return s.alignBitstr(i).toString("utf8")}case 4:case 18:case 19:case 20:case 21:case 22:case 25:case 12:case 26:case 27:case 28:case 29:case 30:return t.readString("utf8",e.size);default:throw new Error(`Unexpected tag: ${e.type}.`)}},s.alignBitstr=function(e){const i=e[0],r=8*(e.length-1)-i,s=e.slice(1),n=8-r%8;if(8===n||0===s.length)return s;const o=t.allocUnsafe(s.length);o[0]=s[0]>>>n;for(let t=1;t<s.length;t++)o[t]=s[t-1]<<8-n,o[t]|=s[t]>>>n;return o},s.readCert=function(t){const e=t;return e.start(),t=s.seq(e),{tbs:s.readTBS(t),sigAlg:s.readAlgIdent(t),sig:s.readBitstr(t),raw:e.endData(!0)}},s.readTBS=function(t){const e=t;return e.start(),t=s.seq(e),{version:s.readExplicitInt(t,0,!0),serial:s.readInt(t),sig:s.readAlgIdent(t),issuer:s.readName(t),validity:s.readValidity(t),subject:s.readName(t),pubkey:s.readPubkey(t),raw:e.endData(!0)}},s.readPubkey=function(t){return t=s.seq(t),{alg:s.readAlgIdent(t),pubkey:s.readBitstr(t)}},s.readName=function(t){const e=[];for(t=s.seq(t);t.left();)s.implicit(t,17),s.implicit(t,16),e.push({type:s.readOID(t),value:s.readString(t)});return e},s.readValidity=function(t){return t=s.seq(t),{notBefore:s.readTime(t),notAfter:s.readTime(t)}},s.readTime=function(t){const e=s.readTag(t),i=t.readString("ascii",e.size);let r,n,o,a,h,c;switch(e.type){case 23:r=0|i.slice(0,2),n=0|i.slice(2,4),o=0|i.slice(4,6),a=0|i.slice(6,8),h=0|i.slice(8,10),c=0|i.slice(10,12),r=r<70?2e3+r:1900+r;break;case 24:r=0|i.slice(0,4),n=0|i.slice(4,6),o=0|i.slice(6,8),a=0|i.slice(8,10),h=0|i.slice(10,12),c=0|i.slice(12,14);break;default:throw new Error(`Unexpected tag: ${e.type}.`)}return Date.UTC(r,n-1,o,a,h,c,0)/1e3},s.readOID=function(t){const e=s.implicit(t,6),i=t.readBytes(e.size);return s.formatOID(i)},s.formatOID=function(t){const e=new r(t),i=[];let s=0,n=0;for(;e.left();)s<<=7,s|=127&(n=e.readU8()),0==(128&n)&&(i.push(s),s=0);return 128&n&&i.push(s),[i[0]/40|0,i[0]%40].concat(i.slice(1)).join(".")},s.readAlgIdent=function(t){let e=null;t=s.seq(t);const i=s.readOID(t);if(t.left()>0){const i=s.readTag(t);0===(e=t.readBytes(i.size)).length&&(e=null)}return{alg:i,params:e}},s.readRSAPublic=function(t){return t=s.seq(t),{modulus:s.readInt(t),publicExponent:s.readInt(t)}},s.readRSAPrivate=function(t){return t=s.seq(t),{version:s.readInt(t,!0),modulus:s.readInt(t),publicExponent:s.readInt(t),privateExponent:s.readInt(t),prime1:s.readInt(t),prime2:s.readInt(t),exponent1:s.readInt(t),exponent2:s.readInt(t),coefficient:s.readInt(t)}},s.parseRSAPublic=function(t){return s.readRSAPublic(new r(t,!0))},s.parseRSAPrivate=function(t){return s.readRSAPrivate(new r(t,!0))},s.parseCert=function(t){return s.readCert(new r(t,!0))},s.parseTBS=function(t){return s.readTBS(new r(t,!0))}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t){
/*!
 * pem.js - pem parsing for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=e;s.parse=function(e){const i=[];let s,n="";for(;e.length;){let o;if(o=/^-----BEGIN ([^\-]+)-----/.exec(e))e=e.substring(o[0].length),s=o[1];else if(o=/^-----END ([^\-]+)-----/.exec(e)){e=e.substring(o[0].length),r(s===o[1],"Tag mismatch.");const a=s.split(" ")[0].toLowerCase(),h=t.from(n,"base64");i.push({tag:s,type:a,data:h}),n="",s=null}else if(o=/^[a-zA-Z0-9\+=\/]+/.exec(e))e=e.substring(o[0].length),n+=o[0];else{if(!(o=/^\s+/.exec(e)))throw new Error("PEM parse error.");e=e.substring(o[0].length)}}return r(0!==i.length,"PEM parse error."),r(!s,"Un-ended tag."),r(0===n.length,"Trailing data."),i},s.decode=function(t){const e=s.parse(t),i=e[0],r=e[1];let n=null;r&&-1!==r.tag.indexOf("PARAMETERS")&&(n=r.data);let o=null;switch(i.type){case"dsa":o="dsa";break;case"rsa":o="rsa";break;case"ec":o="ecdsa"}return{type:i.type,alg:o,data:i.data,params:n}},s.encode=function(t,e,i){let r="";i&&(e+=" "+i),e=e.toUpperCase(),t=t.toString("base64");for(let e=0;e<t.length;e+=64)r+=t.slice(e,e+64)+"\n";return""+`-----BEGIN ${e}-----\n`+r+`-----END ${e}-----\n`}}).call(this,i(0).Buffer)},function(t,e){},function(t,e,i){"use strict";var r=i(7).Buffer,s=i(255);function n(t,e,i){t.copy(e,i)}t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,i=""+e.data;e=e.next;)i+=t+e.data;return i},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e=r.allocUnsafe(t>>>0),i=this.head,s=0;i;)n(i.data,e,s),s+=i.data.length,i=i.next;return e},t}(),s&&s.inspect&&s.inspect.custom&&(t.exports.prototype[s.inspect.custom]=function(){var t=s.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,i){(function(t,e){!function(t,i){"use strict";if(!t.setImmediate){var r,s=1,n={},o=!1,a=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){u(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?function(){var e="setImmediate$"+Math.random()+"$",i=function(i){i.source===t&&"string"==typeof i.data&&0===i.data.indexOf(e)&&u(+i.data.slice(e.length))};t.addEventListener?t.addEventListener("message",i,!1):t.attachEvent("onmessage",i),r=function(i){t.postMessage(e+i,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){u(t.data)},r=function(e){t.port2.postMessage(e)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var t=a.documentElement;r=function(e){var i=a.createElement("script");i.onreadystatechange=function(){u(e),i.onreadystatechange=null,t.removeChild(i),i=null},t.appendChild(i)}}():r=function(t){setTimeout(u,0,t)},h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var o={callback:t,args:e};return n[s]=o,r(s),s++},h.clearImmediate=c}function c(t){delete n[t]}function u(t){if(o)setTimeout(u,0,t);else{var e=n[t];if(e){o=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(i,r)}}(e)}finally{c(t),o=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,i(12),i(23))},function(t,e,i){(function(e){function i(t){try{if(!e.localStorage)return!1}catch(t){return!1}var i=e.localStorage[t];return null!=i&&"true"===String(i).toLowerCase()}t.exports=function(t,e){if(i("noDeprecation"))return t;var r=!1;return function(){if(!r){if(i("throwDeprecation"))throw new Error(e);i("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}}).call(this,i(12))},function(t,e,i){"use strict";t.exports=n;var r=i(142),s=i(58);function n(t){if(!(this instanceof n))return new n(t);r.call(this,t)}s.inherits=i(5),s.inherits(n,r),n.prototype._transform=function(t,e,i){i(null,t)}},function(t,e,i){let r=i(260);const s=i(195);t.exports=class{constructor(t){this.parent=t,this.updateRecord={};let e=this;new r(1e3).tick(0,async()=>{try{await e.checkTask.apply(e)}catch(t){console.error(t)}})}addTask(t,e=3e4){"function"==typeof t&&(t={execute:t,id:s()}),this.updateRecord[t.id]||(t.$taskTime=new r(e),this.updateRecord[t.id]=t)}async checkTask(){try{let t=5;for(let e of Object.keys(this.updateRecord))t>0&&this.updateRecord[e].$taskTime.check()&&(t--,await this.updateRecord[e].execute(this.parent)&&Reflect.deleteProperty(this.updateRecord,e));return Object.keys(this.updateRecord).length}catch(t){console.error(t)}}}},function(t,e,i){let{waiting:r}=i(3);t.exports=class{constructor(t){this.rev=t,this.now=Date.parse(new Date)}check(){return Date.parse(new Date)-this.now>=this.rev&&(this.now=Date.parse(new Date),!0)}tick(t,e){let i=0,s=async()=>{if(this.check()){try{e(i++)}catch(t){console.log(t)}(0==t||i<t)&&s()}else await r(100),s()};s()}}},function(t,e){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var r=new Uint8Array(16);t.exports=function(){return i(r),r}}else{var s=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),s[e]=t>>>((3&e)<<3)&255;return s}}},function(t,e){for(var i=[],r=0;r<256;++r)i[r]=(r+256).toString(16).substr(1);t.exports=function(t,e){var r=e||0,s=i;return[s[t[r++]],s[t[r++]],s[t[r++]],s[t[r++]],"-",s[t[r++]],s[t[r++]],"-",s[t[r++]],s[t[r++]],"-",s[t[r++]],s[t[r++]],"-",s[t[r++]],s[t[r++]],s[t[r++]],s[t[r++]],s[t[r++]],s[t[r++]]].join("")}},function(t,e,i){
/*!
 * selector.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * 
 * 注册一个新的智能合约需要执行如下步骤：
 * 1. 在 OperTypeExecutable 中新增一个类型枚举
 * 2. 在 lib/contract 目录下书写对应的智能合约类
 * 3. 在 lib/contract/selector 中手工注册两者间的映射关系
 * 
 * @note 为了让打包程序正常工作，没有使用自动化方案来引入类文件
 */
const{OperType:r}=i(8);t.exports=function(t){if(!t)return i(264);switch(t.oper){case r.propFound:return i(265);case r.propSale:return i(266);case r.payOrder:return i(267);case r.notify:return i(268);case r.cpRegister:return i(269);case r.cpChange:return i(270);case r.contractCreate:return i(271);case r.contractPromise:return i(272);case r.contractExecute:return i(274);case r.coinbase:return i(275);default:return i(29)}}},function(t,e,i){const r=i(29),{operatorType:s}=i(8),{opcodes:n}=i(27),o=i(10);i(3),t.exports=class extends r{async execute(){let t=this.options.env,e=(this.options.facade,this.options.tx);if(!t.node||!t.node.middleHash)return;let i=t.node.middleHash(this.mode);if(i)for(let r=0;r<e.outputs.length;r++)if(!i.has(this.options.hash+r.toString()))switch(this.mode){case s.Wallet:{let i=e.outputs[r];i.script.code[0].value!=n.OP_PROPEXCHANGE&&i.script.code[0].value!=n.OP_PROPCREATE||(t.propMgr.dirty=!0);break}case s.Mem:case s.Db:await this.HandleOutput(r)}}async HandleOutput(t){let e=this.options.env,i=this.options.tx,r=i.hash("hex"),o=i.outputs[t];if((o.script.code[0].value==n.OP_PROPEXCHANGE||o.script.code[0].value==n.OP_PROPCREATE)&&this.mode==s.Db){let i=o.getReturnData();if(i)if(i.current={hash:r,index:t,address:o.getAddress().toString()},i.gold=o.value,i.height=e.node.chain.height,await e.setVp(i),o.script.code[0].value==n.OP_PROPCREATE)await e.setVpp(i);else{let t=0,r=i;for(;o&&o.script.code[0].value==n.OP_PROPEXCHANGE&&t++<2e3;){let t=r.prev;e.node.middleHash(this.mode).add(t.hash+t.index.toString());let i=await this.options.finder(t.hash);if(!i)break;if(!(r=(o=i.outputs[t.index]).getReturnData())||!r.prev||e.node.middleHash(this.mode).has(r.prev.hash+r.prev.index.toString()))break}}}e.node.middleHash(this.mode).add(r+t.toString())}async cancel(){let t=this.options.tx,e=this.options.env;switch(this.mode){case s.Wallet:for(let i=0;i<t.outputs.length;i++){let r=t.outputs[i];r.script.code[0].value!=n.OP_PROPEXCHANGE&&r.script.code[0].value!=n.OP_PROPCREATE||(e.propMgr.dirty=!0)}break;default:await this.$cancel()}}async $cancel(){let t=this.options.env;if(!t.node.middleHash||!t.node.middleHash(this.mode))return;let e=this.options.tx,i=e.hash("hex");for(let r=0;r<e.outputs.length;r++){t.node.middleHash(this.mode).delete(i+r.toString());let o=e.outputs[r];if((o.script.code[0].value==n.OP_PROPEXCHANGE||o.script.code[0].value==n.OP_PROPCREATE)&&this.mode==s.Db){let e=o.getReturnData();e&&await t.delVp(e.pid)}}}async verify(){let t=this.options.env,e=this.options.tx;for(const i of e.outputs)if(i.script.code[0].value==n.OP_PROPCREATE){let e=i.getReturnData();if(!e)return!1;if(i.value<o.MINPROPVALUE)return!1;let r=t.network.stockReg;if(r.test(e.pid))return!1;if((r=t.network.tokenReg).test(e.pid))return!1}else if(i.script.code[0].value==n.OP_PROPEXCHANGE){let e=i.getReturnData();if(!e)return!1;if(e.cid==t.network.bossId&&parseInt(e.pid.match(/\d+$/i)[0])>o.getEpoch(t.node.chain.height).token)return!1}return!0}}},function(t,e,i){const r=i(29),{operatorType:s}=i(8);t.exports=class extends r{async execute(){let t=this.options.env;switch(this.mode){case s.Db:await t.delVp(this.data.ori.pid);break;case s.Wallet:t.propMgr.dirty=!0}return!0}async cancel(){let t=this.options.env,e=this.options.tx;switch(this.mode){case s.Db:this.data.ori.current={hash:e.inputs[0].prevout.hash,index:e.inputs[0].prevout.index,address:this.data.addr},this.data.ori.gold=e.outputs[0].value,await t.setVp(this.data.ori);break;case s.Wallet:t.propMgr.dirty=!0}return!0}async verify(){let t=this.options.env;if(!this.data.ori||!this.data.ori.pid)return!1;let e=t.network.stockReg;return!e.test(this.data.ori.pid)&&!(e=t.network.tokenReg).test(this.data.ori.pid)}}},function(t,e,i){const r=i(1),s=i(29),{blockFinalType:n,operatorType:o,OperType:a}=i(8),h=i(145),{VerifyError:c}=i(36),u=i(10);t.exports=class extends s{async execute(){let t=this.options.env;switch(this.mode){case o.Db:t.node.delSaleOrder(this.data.pid,!0);break;case o.Mem:if(this.data.period<t.chain.height)return void t.node.delSaleOrder(this.data.pid,!0);if(this.data.current={hash:this.options.hash,index:0},this.data.times=0,this.options.tx.outputs.length>=2?(this.data.bid=Math.min(this.options.tx.outputs[1].value,this.data.fixed),this.data.current.address=this.options.tx.outputs[2].getAddress().getHash("hex")):this.data.bid=this.data.price,t.node.saleList.has(this.data.pid)){let e=t.node.saleList.get(this.data.pid);e.status!=h.status.Finished&&this.data.bid>e.bid?(this.data.times=++e.times,this.data.bid>=e.fixed&&(this.data.status=h.status.Finished),await t.node.addSaleOrder(this.data)):t.node.recoverSaleOrder(e.pid)}else await t.node.addSaleOrder(this.data);break;case o.Wallet:if(this.options.block)await t.delSaleOrder(this.data.pid,!0);else{if(this.data.period<t.state.height){await t.delSaleOrder(this.data.pid,!0);break}if(this.data.current={hash:this.options.hash,index:0},this.data.times=0,this.options.tx.outputs.length>=2?(this.data.bid=Math.min(this.options.tx.outputs[1].value,this.data.fixed),this.data.current.address=this.options.tx.outputs[2].getAddress().getHash("hex")):this.data.bid=this.data.price,t.saleList.has(this.data.pid)||t.client&&await t.client.execute("prop.list.market",["",1,[this.data.pid]]),t.saleList.has(this.data.pid)){let e=t.saleList.get(this.data.pid);if(e.current.hash!==this.data.current.hash&&e.status!=h.status.Finished&&this.data.bid>e.bid){let i=await t.getTXFromDb(this.data.current.hash);if(i){let e=await t.getWalletsByTX(i);if(e)for(const i of e){const e=await t.get(i);r(e),await e.remove(this.options.hash)}}this.data.times=++e.times,this.data.bid>=e.fixed&&(this.data.status=h.status.Finished),this.data.raw=this.options.raw,await t.addSaleOrder(this.data)}else t.recoverSaleOrder(e.pid)}else this.data.raw=this.options.raw,await t.addSaleOrder(this.data)}}return!0}async cancel(){let t=this.options.env;switch(this.mode){case o.Db:if(this.data.period<t.node.chain.height)break;this.data.current={hash:this.options.hash,index:0},this.data.times=0,this.options.tx.outputs.length>=2?(this.data.bid=Math.min(this.options.tx.outputs[1].value,this.data.fixed),this.data.current.address=this.options.tx.outputs[2].getAddress().getHash("hex")):this.data.bid=this.data.price,this.data.bid>=this.data.fixed&&(this.data.status=h.status.Finished),await t.node.addSaleOrder(this.data);break;case o.Mem:t.node.delSaleOrder(this.data.pid,!1);break;case o.Wallet:if(this.options.block){if(this.data.period<t.state.height)break;this.data.current={hash:this.options.hash,index:0},this.data.times=0,this.data.bid>=this.data.fixed&&(this.data.status=h.status.Finished),await t.addSaleOrder(this.data)}}return!0}async verify(){let t=this.data,e=this.options.env,i=this.options.tx;if(t.cid==e.network.bossId&&parseInt(t.pid.match(/\d+$/i)[0])>u.getEpoch(e.node.chain.height).token)throw new c(i,"invalid","prop sale unactivated",100);if(t.period<e.node.chain.height)throw new c(i,"sale order expired","contract",0);if(r.strictEqual(t.prev.hash,i.inputs[0].prevout.hash),r.strictEqual(t.prev.index,i.inputs[0].prevout.index),t.buyOrder&&(r.strictEqual(t.buyOrder.prev.hash,i.inputs[0].prevout.hash),r.strictEqual(t.buyOrder.prev.index,i.inputs[0].prevout.index),r.strictEqual(t.buyOrder.pid,t.pid),r.strictEqual(t.buyOrder.oper,a.propExchange),r(t.bid>t.price),this.mode==o.Mem&&e.node.saleList)){let r=e.node.saleList.get(t.pid);if(r){if(r.status==h.status.Finished)throw e.node.recoverSaleOrder(r.bid),new c(i,"can not bid on sale order finished","contract",0);if(t.bid<=r.bid)throw e.node.recoverSaleOrder(r.bid),new c(i,"invalid bid price","contract",0);let s=e.node.mempool.getTX(r.current.hash);s&&await e.node.mempool.removeDoubleSpenders(s)}}return!0}isBlockFinal(){let t=this.options.tx;return this.data.period<this.options.height?n.Expired:t.outputs.length>=2&&(t.outputs[1].value>=this.data.fixed||this.data.period==this.options.height&&t.outputs[1].value>=this.data.price)?n.Final:n.Waiting}}},function(t,e,i){const r=i(29),{OrderData:s,operatorType:n}=i(8),o=i(143),a=i(3),h=i(28),c=i(10),u=i(194);t.exports=class extends r{async execute(){let t=this.options.env;switch(this.mode){case n.Db:{let e=new s(this.data.cid,this.data.uid,this.data.sn,this.data.sum,this.data.addr,this.data.gaddr);e.hash=this.options.hash,e.height=this.options.coinbaseHeight,await t.addOrder(e),-1!=t.node.hmacConnection.indexOf(this.data.cid)&&(this.data.hash=this.options.hash,this.data.height=this.options.coinbaseHeight,this.data.confirm=1+t.node.chain.height-this.data.height,t.node.emit("contract.order.confirm",this.data));break}case n.Mem:{let e=new s(this.data.cid,this.data.uid,this.data.sn,this.data.sum,this.data.addr,this.data.gaddr);e.hash=this.options.hash,e.height=-1,await t.node.chain.db.addOrder(e),-1!=t.node.hmacConnection.indexOf(this.data.cid)&&(this.data.hash=this.options.hash,this.data.height=-1,this.data.confirm=0,t.node.emit("contract.order.add",this.data));break}case n.Wallet:}return!0}async cancel(){let t=this.options.env;switch(this.mode){case n.Db:{let e=new s(this.data.cid,this.data.uid,this.data.sn,this.data.sum,this.data.addr,this.data.gaddr);e.hash=this.options.hash,e.height=-1,await t.addOrder(e),-1!=t.node.hmacConnection.indexOf(this.data.cid)&&(this.data.hash=this.options.hash,this.data.height=-1,this.data.confirm=0,t.node.emit("contract.order.unconfirm",this.data));break}case n.Mem:this.data.confirm=0,t.node.emit("contract.order.remove",this.data);break;case n.Wallet:}return!0}async verify(){let t=this.options.env,e=this.options.tx;const i=await t.node.mempool.getSpentViewUnLock(e);let r=e.getInputValue(i),s=(await this.options.finder(e.inputs[0].prevout.hash)).outputs[e.inputs[0].prevout.index].getAddress(),n=t.node.getCpItem(this.data.cid),l=n.current.address;const f=(await t.node.chain.db.db.range({gte:o.VP(`${a.sprintf("%010d",a.hashInt(this.data.cid))}${t.network.stockFix}${a.sprintf("%02d",0)}`),lte:o.VP(`${a.sprintf("%010d",a.hashInt(this.data.cid))}${t.network.stockFix}${a.sprintf("%02d",69)}`),values:!0})).reduce((e,i)=>{let r=u.fromRaw(i.value);return r.height<=t.node.chain.height-c.BLOCK_DAY&&e.push(r),e},[]);let d={},p=100;for(const t of f)if(t.current.address!=l&&(d[t.current.address]=(d[t.current.address]||0)+1,p--),p<=30)break;let g=this.data.sum;if(1==e.outputs.length){if(this.data.gaddr&&n.grate&&n.grate<20&&n.grate>0){let t=g/100*n.grate|0;e.outputs.push(h.fromScript(this.data.gaddr,t)),g-=t}e.outputs.push(h.fromScript(l,g/100*p|0)),Object.keys(d).map(t=>{e.outputs.push(h.fromScript(t,g/100*d[t]|0))});let t=r-this.data.sum;t>0&&e.outputs.push(h.fromScript(s,t)),e.refresh()}else{let t=Object.keys(d);for(let i=1;i<e.outputs.length-1;i++){let r=e.outputs[i],s=r.getAddress().toString();if(1==i&&this.data.gaddr&&s==this.data.gaddr){if(!(n.grate&&n.grate<30&&n.grate>0))return!1;if(r.value!=g/100*n.grate|0)return!1;g-=r.value}else if(s==l){if(r.value!=g/100*p|0)return!1}else{if(-1==t.indexOf(s))return!1;if(r.value!=g/100*d[s]|0)return!1}}}return!0}}},function(t,e,i){const r=i(29),{operatorType:s,blockFinalType:n}=i(8),o=i(10);t.exports=class extends r{async execute(){let t=this.options.env;switch(this.mode){case s.Wallet:await t.addNotify(this.data)}return!0}async cancel(){let t=this.options.env;switch(this.mode){case s.Wallet:await t.delNotify(this.data.sn)}return!0}async verify(){return!(this.options.tx.getOutputValue()<o.COIN)}isBlockFinal(){return this.data.h<this.options.height-6?n.Expired:n.Waiting}}},function(t,e,i){const r=i(29),{operatorType:s}=i(8),{VerifyError:n}=i(36),{opcodes:o}=i(27);i(3),t.exports=class extends r{async execute(){let t=this.options.env;if(this.options.facade,this.options.tx,!t.node||!t.node.middleHash)return;let e=t.node.middleHash(this.mode);if(e&&!e.has(`${this.options.hash}0`))switch(this.mode){case s.Wallet:t.cpList.dirty=!0;break;case s.Mem:case s.Db:await this.HandleOutput()}}async HandleOutput(){let t=this.options.env,e=this.options.tx,i=e.hash("hex"),r=e.outputs[0],n=r.getReturnData();if(n){switch(n.current={hash:i,index:0,address:r.getAddress().toString()},this.mode){case s.Db:await t.setCp(n),n.immutable=!0,await t.node.addCpItem(n);break;case s.WalletInit:case s.Wallet:break;case s.Mem:await t.node.addCpItem(n);break;case s.DbInit:n.immutable=!0,await t.node.addCpItem(n)}if(this.mode==s.Db)for(let r=1;r<=Math.min(70,e.outputs.length-1);r++){if(e.outputs[r].script.code[0].value!=o.OP_PROPCREATE)continue;let s=e.outputs[r].getReturnData();s&&t.network.stockReg.test(s.pid)&&(s.current={hash:i,index:r,address:e.outputs[r].getAddress().toString()},s.gold=e.outputs[r].value,s.height=t.node.chain.height,await t.setVp(s),await t.setVpp(s))}t.node.middleHash(this.mode).add(`${i}0`)}else t.node.middleHash(this.mode).add(`${i}0`)}async cancel(){this.options.tx;let t=this.options.env;switch(this.mode){case s.Wallet:t.cpList.dirty=!0;break;default:await this.$cancel()}}async $cancel(){let t=this.options.env,e=this.data,i=this.options.tx,r=i.hash("hex");if(t.node.middleHash&&t.node.middleHash(this.mode)&&(t.node.middleHash(this.mode).delete(`${r}0`),i.outputs[0],(this.mode==s.Db||1!=t.node.checkCpItem(e.cid))&&(t.node.cpList.delItem(e),this.mode==s.Db))){await t.delCp(e.cid);for(let e=1;e<=Math.min(70,i.outputs.length-1);e++){if(i.outputs[e].script.code[0].value!=o.OP_PROPCREATE)continue;let r=i.outputs[e].getReturnData();r&&t.network.stockReg.test(r.pid)&&(await t.delVp(r.pid),await t.delVpp(r.pid))}}}async verify(){let t=this.options.env,e=this.options.tx;if(e.outputs[0].script.code[0].value!=o.OP_CPREGISTER)return!1;if(this.mode==s.Mem){if(!this.data)throw new n(block,"invalid","null cpRegister data",100);if(!await t.node.rpc.execute({method:"canExecute",params:[{cid:this.data.cid,name:this.data.name},this.data.oper]}))throw new n(e,`invalid info on ${this.data.oper}`,"cp manager",0)}return!0}}},function(t,e,i){const r=i(1),s=i(29),{operatorType:n}=i(8),{VerifyError:o}=i(36),{opcodes:a}=i(27);i(3),t.exports=class extends s{async execute(){let t=this.options.env;if(this.options.facade,this.options.tx,!t.node||!t.node.middleHash)return;let e=t.node.middleHash(this.mode);if(e&&!e.has(`${this.options.hash}0`))switch(this.mode){case n.Wallet:t.cpList.dirty=!0;break;case n.Mem:case n.Db:await this.HandleOutput()}}async HandleOutput(){let t=this.options.env,e=this.options.tx,i=e.hash("hex"),r=e.outputs[0],s=r.getReturnData();if(!s)return void t.node.middleHash(this.mode).add(`${i}0`);switch(s.current={hash:i,index:0,address:r.getAddress().toString()},this.mode){case n.Db:await t.setCp(s),s.immutable=!0,await t.node.addCpItem(s);break;case n.Mem:await t.node.addCpItem(s);break;case n.DbInit:s.immutable=!0,await t.node.addCpItem(s)}let o=0,h=s;for(;r&&r.script.code[0].value==a.OP_CPCHANGE&&o++<2e3;){t.node.middleHash(this.mode).add(h.prev.hash+h.prev.index.toString());let e=await this.options.finder(h.prev.hash);if(!e)break;if(!(h=(r=e.outputs[h.prev.index]).getReturnData()))break;if(h.name!=s.name&&t.node.cpList.removeNameIndex(h.name),!h.prev||t.node.middleHash(this.mode).has(h.prev.hash+h.prev.index.toString()))break}t.node.middleHash(this.mode).add(`${i}0`)}async cancel(){this.options.tx;let t=this.options.env;switch(this.mode){case n.Wallet:t.cpList.dirty=!0;break;default:await this.$cancel()}}async $cancel(){let t=this.options.env,e=this.data,i=this.options.tx,r=i.hash("hex");if(!t.node.middleHash||!t.node.middleHash(this.mode))return;t.node.middleHash(this.mode).delete(`${r}0`);let s=i.outputs[0];if(this.mode!=n.Db&&1==t.node.checkCpItem(e.cid))return;t.node.cpList.delItem(e),this.mode==n.Db&&await t.delCp(e.cid);let o=e.prev,h=await this.options.finder(o.hash);h&&(!(e=(s=h.outputs[o.index]).getReturnData())||s.script.code[0].value!=a.OP_CPCHANGE&&s.script.code[0].value!=a.OP_CPREGISTER||(e.current={hash:o.hash,index:o.index,address:s.getAddress().toString()},await t.node.addCpItem(e)))}async verify(){let t=this.options.env,e=this.options.tx,i=this.data;r.strictEqual(i.prev.hash,e.inputs[0].prevout.hash),r.strictEqual(i.prev.index,e.inputs[0].prevout.index);let s=await this.options.finder(i.prev.hash);r(s);let h=s.outputs[i.prev.index];r(h),r(h.script.code[0].value==a.OP_CPREGISTER||h.script.code[0].value==a.OP_CPCHANGE);let c=h.getReturnData();if(r(c),r(c.cid===i.cid),this.mode==n.Mem){if(!i)throw new o(block,"invalid","null cpchange data",100);if(!await t.node.rpc.execute({method:"canExecute",params:[{cid:i.cid,name:i.name},i.oper]}))throw new o(e,`invalid info on ${i.oper}`,"cp manager",0)}return!0}}},function(t,e,i){const r=i(29),{operatorType:s,contractStatus:n,blockFinalType:o}=i(8),{VerifyError:a}=i(36);t.exports=class extends r{async execute(){let t=this.options.env,e=this.options.facade;switch(this.mode){case s.Mem:if(this.data.period<t.chain.height){e.delTransContract(this.data);break}this.data.current={hash:this.options.hash,index:0},this.data.raw=this.options.raw,e.addTransContract(s.Mem,this.data);break;case s.Wallet:this.options.block||(this.data.current={hash:this.options.hash,index:0},this.data.raw=this.options.raw,e.addTransContract(s.Mem,this.data,t,this.options.tidCreator))}return!0}async verify(){let t=this.options.env,e=this.options.tx,i=this.options.facade;if(this.data.period<t.node.chain.height)throw new a(e,"transaction contract expired","contract",0);if(i.queryContract(this.data.type,this.data.addr)!=n.None)throw new a(e,"Same Address Contract Finded","contract",0);return!0}isBlockFinal(){return this.data.period<this.options.height?o.Expired:o.Waiting}}},function(t,e,i){(function(e){const r=i(273),s=i(91),n=i(113),{VerifyError:o}=i(36),a=i(29),{blockFinalType:h,OperType:c,contractStatus:u,operatorType:l}=i(8),f=i(147),{opcodes:d}=i(27);t.exports=class extends a{async execute(){let t=this.options.env,e=this.options.facade;switch(this.data.current={hash:this.options.hash,index:0},this.data.raw=this.options.raw,this.mode){case l.Db:if(!e.promiseContract(this.data,t,this.options.tidCreator))break;if(t.network.txcheckpoint.getCheck(this.data.type).length<=0||!t.network.txchecktime[this.data.type])break;e.autoTaskMgr.addTask(new f(t.network.txcheckpoint,this.mode,this.data,{env:t,tidCreator:this.options.tidCreator}),t.network.txchecktime[this.data.type]);break;case l.Mem:if(!e.promiseContract(this.data))break;if(t.network.txcheckpoint.getCheck(this.data.type).length<=0||!t.network.txchecktime[this.data.type])break;e.autoTaskMgr.addTask(new f(t.network.txcheckpoint,this.mode,this.data,{env:t}),t.network.txchecktime[this.data.type]);break;case l.Wallet:{let i=!1;if(i=this.options.block?e.promiseContract(this.data,t,this.options.tidCreator):e.promiseContract(this.data)){if(t.network.txcheckpoint.getCheck(this.data.type).length<=0||!t.network.txchecktime[this.data.type])break;e.autoTaskMgr.addTask(new f(t.network.txcheckpoint,this.mode,this.data,{env:t,tidCreator:this.options.tidCreator}),t.network.txchecktime[this.data.type])}}}return!0}async verify(){let t=this.options.env,i=this.options.facade;r(this.options.tx.outputs.length>1);let o=this.options.tx.outputs[1].script.code;if(r.strictEqual(o[0].value,d.OP_PROMISE),r.strictEqual(o[2].value,d.OP_DROP),r.strictEqual(o[3].value,d.OP_GREATERTHAN),r.strictEqual(o[4].value,d.OP_IF),r.bufferEqual(o[5].data,e.from(this.data.bob,"hex")),r.strictEqual(o[6].value,d.OP_ELSE),r.bufferEqual(o[7].data,e.from(this.data.ori.alice,"hex")),r.strictEqual(o[8].value,d.OP_ENDIF),r.strictEqual(o[9].value,d.OP_CHECKSIG),r.strictEqual(this.data.addr,this.data.ori.addr),r.strictEqual(this.data.type,this.data.ori.type),r.strictEqual(this.data.dst,this.data.ori.dst),r.strictEqual(this.data.period,this.data.ori.period),this.mode==l.Mem){let e=await this.options.finder(this.data.prevhash);if(e){let r=await i.FactoryOfContract(l.Mem,e,{env:t,finder:this.options.finder});if(!r.data||r.data.oper!==c.contractCreate)throw new s(n.errors.TYPE_ERROR,"Contract promise: Invalid ori tx type");await t.node.mempool.removeDoubleSpenders(e)}}return!0}isBlockFinal(){return this.data.transStatus==u.Confirmed?h.Final:this.data.period<this.options.height||this.data.transStatus==u.Expired?h.Final:h.Waiting}}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){const r=i(1),s=i(66),n=function t(e,i){if(!e)throw new t.AssertionError({message:i,actual:e,expected:!0,operator:"==",stackStartFunction:t})};function o(t,e,i){if("string"!=typeof t)throw new n.AssertionError({message:e,actual:c(t),expected:"string",operator:"typeof ==",stackStartFunction:i})}function a(t,e,i){if("function"!=typeof t)throw new n.AssertionError({message:e,actual:c(t),expected:"function",operator:"typeof ==",stackStartFunction:i})}function h(t,i,r){if(!e.isBuffer(t))throw new n.AssertionError({message:i,actual:c(t),expected:"buffer",operator:"typeof ==",stackStartFunction:r})}function c(t){const i=typeof t;switch(i){case"object":if(null===t)return"null";if(Array.isArray(t))return"array";if(e.isBuffer(t))return"buffer";if(ArrayBuffer.isView(t))return"arraybuffer";if(s.isError(t))return"error";if(s.isDate(t))return"date";if(s.isRegExp(t))return"regexp";break;case"number":if(!isFinite(t))return"nan"}return i}function u(t){if(void 0===t)return"undefined";if(null===t)return"null";const e=Object.getPrototypeOf(t);if(void 0===e)throw new Error("Bad prototype.");return null===e?"Null":e.constructor?e.constructor.name?e.constructor.name:"Unknown":"Object"}function l(t){return t.name||"Unknown"}Object.setPrototypeOf(n,r),n.typeOf=function t(e,i,r){o(i,"`expected` must be a string.",t);const s=c(e);if(s!==i)throw new n.AssertionError({message:r,actual:s,expected:i,operator:"typeof ==",stackStartFunction:t})},n.notTypeOf=function t(e,i,r){o(i,"`expected` must be a string.",t);const s=c(e);if(s===i)throw new n.AssertionError({message:r,actual:s,expected:i,operator:"typeof !=",stackStartFunction:t})},n.instanceOf=function t(e,i,r){if(a(i,"`parent` must be a constructor.",t),!(e instanceof i))throw new n.AssertionError({message:r,actual:u(e),expected:l(i),operator:"instanceof",stackStartFunction:t})},n.notInstanceOf=function t(e,i,r){if(a(i,"`parent` must be a constructor.",t),e instanceof i)throw new n.AssertionError({message:r,actual:u(e),expected:l(i),operator:"not instanceof",stackStartFunction:t})},n.bufferEqual=function t(e,i,r){if(h(e,"`actual` must be a buffer.",t),h(i,"`expected` must be a buffer.",t),e!==i&&!e.equals(i))throw new n.AssertionError({message:r,actual:e.toString("hex"),expected:i.toString("hex"),operator:"===",stackStartFunction:t})},n.notBufferEqual=function t(e,i,r){if(h(e,"`actual` must be a buffer.",t),h(i,"`expected` must be a buffer.",t),e===i||e.equals(i))throw new n.AssertionError({message:r,actual:e.toString("hex"),expected:i.toString("hex"),operator:"!==",stackStartFunction:t})},t.exports=n}).call(this,i(0).Buffer)},function(t,e,i){const r=i(29),{operatorType:s,contractStatus:n,blockFinalType:o}=i(8);i(1),t.exports=class extends r{async execute(){let t=this.options.env,e=this.options.facade,i=n.Backed;switch(2==this.data.master&&(i=n.Exchanged),this.mode){case s.Db:case s.Wallet:e.executeContract(this.data,i,t,this.options.tidCreator)}return!0}async verify(){return!0}isBlockFinal(){let t=this.options.facade,e=this.data,i=e.master,r=t.queryContract(e.type,e.addr);return r==n.CreatedOnMem?o.Waiting:r==n.Expired&&1!=i||r==n.Confirmed&&2!=i?o.Expired:o.Final}}},function(t,e,i){const r=i(1),{VerifyError:s}=i(36),n=i(29),{blockFinalType:o,operatorType:a}=i(8),{opcodes:h}=i(27),c=(i(196),i(10));i(3),t.exports=class extends n{async execute(){return!0}async cancel(){return!0}async verify(){if(this.mode!=a.Db)return null;let t=this.options.env,e=await t.node.chain.getPid(this.options.block),i=await t.node.chain.getMedianBlockNum(this.options.prev,e);r(i<=c.MAX_BLOCK_NUM);let n=c.getEpoch(t.node.chain.height);const o=await t.node.getCoinsByAddress(this.data.data.addr);if(!o||0==o.length)throw new s(this.options.block,"invalid","bad-coinbase coin values",100);if(c.getRealValues(o)<n.value)return null;let u=await t.node.chain.getCoin(this.data.data.hash,this.data.data.index);if(!u||u.script.code[0].value!==h.OP_PROPEXCHANGE)throw new s(this.options.block,"invalid","bad-coinbase token for opcode",100);if(r(this.data.data.addr,this.options.block.txs[0].outputs[0].getAddress().toString()),r(this.data.data.addr,u.getAddress().toString()),u.height<1)throw new s(this.options.block,"invalid","bad-coinbase token for not enough confirmation",100);let l=u.getReturnData();if(!l)throw new s(this.options.block,"invalid","bad-coinbase token for opcode",100);if(r.strictEqual(l.cid,t.network.bossId),!t.network.tokenReg.test(l.pid))throw new s(this.options.block,"invalid","bad-coinbase token for bad format pid",100);if(parseInt(l.pid.match(/\d+$/i)[0])>n.token)throw new s(this.options.block,"invalid","bad-coinbase token for unactivated",100);return!0}isBlockFinal(){return o.Final}}},function(t,e,i){"use strict";(function(e){var i=new e(4);i.fill(0),t.exports=function(t,r){var s=r(function(t){if(t.length%4!=0){var r=t.length+(4-t.length%4);t=e.concat([t,i],r)}for(var s=new Array(t.length>>>2),n=0,o=0;n<t.length;n+=4,o++)s[o]=t.readInt32LE(n);return s}(t),8*t.length);t=new e(16);for(var n=0;n<s.length;n++)t.writeInt32LE(s[n],n<<2,!0);return t}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){var r=i(83).Transform;function s(t){r.call(this),this._block=new e(t),this._blockSize=t,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}i(5)(s,r),s.prototype._transform=function(t,i,r){var s=null;try{"buffer"!==i&&(t=new e(t,i)),this.update(t)}catch(t){s=t}r(s)},s.prototype._flush=function(t){var e=null;try{this.push(this._digest())}catch(t){e=t}t(e)},s.prototype.update=function(t,i){if(!e.isBuffer(t)&&"string"!=typeof t)throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Digest already called");e.isBuffer(t)||(t=new e(t,i||"binary"));for(var r=this._block,s=0;this._blockOffset+t.length-s>=this._blockSize;){for(var n=this._blockOffset;n<this._blockSize;)r[n++]=t[s++];this._update(),this._blockOffset=0}for(;s<t.length;)r[this._blockOffset++]=t[s++];for(var o=0,a=8*t.length;a>0;++o)this._length[o]+=a,(a=this._length[o]/4294967296|0)>0&&(this._length[o]-=4294967296*a);return this},s.prototype._update=function(t){throw new Error("_update is not implemented")},s.prototype.digest=function(t){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var e=this._digest();return void 0!==t&&(e=e.toString(t)),e},s.prototype._digest=function(){throw new Error("_digest is not implemented")},t.exports=s}).call(this,i(0).Buffer)},function(t,e,i){t.exports=i(97)},function(t,e,i){t.exports=i(42)},function(t,e,i){t.exports=i(89).Transform},function(t,e,i){t.exports=i(89).PassThrough},function(t,e,i){var r=i(5),s=i(50),n=i(7).Buffer,o=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function h(){this.init(),this._w=a,s.call(this,64,56)}function c(t){return t<<5|t>>>27}function u(t){return t<<30|t>>>2}function l(t,e,i,r){return 0===t?e&i|~e&r:2===t?e&i|e&r|i&r:e^i^r}r(h,s),h.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},h.prototype._update=function(t){for(var e=this._w,i=0|this._a,r=0|this._b,s=0|this._c,n=0|this._d,a=0|this._e,h=0;h<16;++h)e[h]=t.readInt32BE(4*h);for(;h<80;++h)e[h]=e[h-3]^e[h-8]^e[h-14]^e[h-16];for(var f=0;f<80;++f){var d=~~(f/20),p=c(i)+l(d,r,s,n)+a+e[f]+o[d]|0;a=n,n=s,s=u(r),r=i,i=p}this._a=i+this._a|0,this._b=r+this._b|0,this._c=s+this._c|0,this._d=n+this._d|0,this._e=a+this._e|0},h.prototype._hash=function(){var t=n.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=h},function(t,e,i){var r=i(5),s=i(50),n=i(7).Buffer,o=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function h(){this.init(),this._w=a,s.call(this,64,56)}function c(t){return t<<1|t>>>31}function u(t){return t<<5|t>>>27}function l(t){return t<<30|t>>>2}function f(t,e,i,r){return 0===t?e&i|~e&r:2===t?e&i|e&r|i&r:e^i^r}r(h,s),h.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},h.prototype._update=function(t){for(var e=this._w,i=0|this._a,r=0|this._b,s=0|this._c,n=0|this._d,a=0|this._e,h=0;h<16;++h)e[h]=t.readInt32BE(4*h);for(;h<80;++h)e[h]=c(e[h-3]^e[h-8]^e[h-14]^e[h-16]);for(var d=0;d<80;++d){var p=~~(d/20),g=u(i)+f(p,r,s,n)+a+e[d]+o[p]|0;a=n,n=s,s=l(r),r=i,i=g}this._a=i+this._a|0,this._b=r+this._b|0,this._c=s+this._c|0,this._d=n+this._d|0,this._e=a+this._e|0},h.prototype._hash=function(){var t=n.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=h},function(t,e,i){var r=i(5),s=i(149),n=i(50),o=i(7).Buffer,a=new Array(64);function h(){this.init(),this._w=a,n.call(this,64,56)}r(h,s),h.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},h.prototype._hash=function(){var t=o.allocUnsafe(28);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t},t.exports=h},function(t,e,i){var r=i(5),s=i(150),n=i(50),o=i(7).Buffer,a=new Array(160);function h(){this.init(),this._w=a,n.call(this,128,112)}r(h,s),h.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},h.prototype._hash=function(){var t=o.allocUnsafe(48);function e(e,i,r){t.writeInt32BE(e,r),t.writeInt32BE(i,r+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),t},t.exports=h},function(t,e,i){"use strict";var r=i(5),s=i(7).Buffer,n=i(38),o=s.alloc(128),a=64;function h(t,e){n.call(this,"digest"),"string"==typeof e&&(e=s.from(e)),this._alg=t,this._key=e,e.length>a?e=t(e):e.length<a&&(e=s.concat([e,o],a));for(var i=this._ipad=s.allocUnsafe(a),r=this._opad=s.allocUnsafe(a),h=0;h<a;h++)i[h]=54^e[h],r[h]=92^e[h];this._hash=[i]}r(h,n),h.prototype._update=function(t){this._hash.push(t)},h.prototype._final=function(){var t=this._alg(s.concat(this._hash));return this._alg(s.concat([this._opad,t]))},t.exports=h},function(t,e,i){t.exports=i(152)},function(t,e,i){(function(e,r){var s,n=i(154),o=i(155),a=i(156),h=i(7).Buffer,c=e.crypto&&e.crypto.subtle,u={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},l=[];function f(t,e,i,r,s){return c.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits"]).then(function(t){return c.deriveBits({name:"PBKDF2",salt:e,iterations:i,hash:{name:s}},t,r<<3)}).then(function(t){return h.from(t)})}t.exports=function(t,i,d,p,g,m){"function"==typeof g&&(m=g,g=void 0);var w=u[(g=g||"sha1").toLowerCase()];if(!w||"function"!=typeof e.Promise)return r.nextTick(function(){var e;try{e=a(t,i,d,p,g)}catch(t){return m(t)}m(null,e)});if(n(t,i,d,p),"function"!=typeof m)throw new Error("No callback provided to pbkdf2");h.isBuffer(t)||(t=h.from(t,o)),h.isBuffer(i)||(i=h.from(i,o)),function(t,e){t.then(function(t){r.nextTick(function(){e(null,t)})},function(t){r.nextTick(function(){e(t)})})}(function(t){if(e.process&&!e.process.browser)return Promise.resolve(!1);if(!c||!c.importKey||!c.deriveBits)return Promise.resolve(!1);if(void 0!==l[t])return l[t];var i=f(s=s||h.alloc(8),s,10,128,t).then(function(){return!0}).catch(function(){return!1});return l[t]=i,i}(w).then(function(e){return e?f(t,i,d,p,w):a(t,i,d,p,g)}),m)}}).call(this,i(12),i(23))},function(t,e,i){var r=i(290),s=i(103),n=i(104),o=i(308),a=i(85);function h(t,e,i){if(t=t.toLowerCase(),n[t])return s.createCipheriv(t,e,i);if(o[t])return new r({key:e,iv:i,mode:t});throw new TypeError("invalid suite type")}function c(t,e,i){if(t=t.toLowerCase(),n[t])return s.createDecipheriv(t,e,i);if(o[t])return new r({key:e,iv:i,mode:t,decrypt:!0});throw new TypeError("invalid suite type")}e.createCipher=e.Cipher=function(t,e){var i,r;if(t=t.toLowerCase(),n[t])i=n[t].key,r=n[t].iv;else{if(!o[t])throw new TypeError("invalid suite type");i=8*o[t].key,r=o[t].iv}var s=a(e,!1,i,r);return h(t,s.key,s.iv)},e.createCipheriv=e.Cipheriv=h,e.createDecipher=e.Decipher=function(t,e){var i,r;if(t=t.toLowerCase(),n[t])i=n[t].key,r=n[t].iv;else{if(!o[t])throw new TypeError("invalid suite type");i=8*o[t].key,r=o[t].iv}var s=a(e,!1,i,r);return c(t,s.key,s.iv)},e.createDecipheriv=e.Decipheriv=c,e.listCiphers=e.getCiphers=function(){return Object.keys(o).concat(s.getCiphers())}},function(t,e,i){var r=i(38),s=i(102),n=i(5),o=i(296).Buffer,a={"des-ede3-cbc":s.CBC.instantiate(s.EDE),"des-ede3":s.EDE,"des-ede-cbc":s.CBC.instantiate(s.EDE),"des-ede":s.EDE,"des-cbc":s.CBC.instantiate(s.DES),"des-ecb":s.DES};function h(t){r.call(this);var e,i=t.mode.toLowerCase(),s=a[i];e=t.decrypt?"decrypt":"encrypt";var n=t.key;o.isBuffer(n)||(n=o.from(n)),"des-ede"!==i&&"des-ede-cbc"!==i||(n=o.concat([n,n.slice(0,8)]));var h=t.iv;o.isBuffer(h)||(h=o.from(h)),this._des=s.create({key:n,iv:h,type:e})}a.des=a["des-cbc"],a.des3=a["des-ede3-cbc"],t.exports=h,n(h,r),h.prototype._update=function(t){return o.from(this._des.update(t))},h.prototype._final=function(){return o.from(this._des.final())}},function(t,e,i){"use strict";e.readUInt32BE=function(t,e){return(t[0+e]<<24|t[1+e]<<16|t[2+e]<<8|t[3+e])>>>0},e.writeUInt32BE=function(t,e,i){t[0+i]=e>>>24,t[1+i]=e>>>16&255,t[2+i]=e>>>8&255,t[3+i]=255&e},e.ip=function(t,e,i,r){for(var s=0,n=0,o=6;o>=0;o-=2){for(var a=0;a<=24;a+=8)s<<=1,s|=e>>>a+o&1;for(a=0;a<=24;a+=8)s<<=1,s|=t>>>a+o&1}for(o=6;o>=0;o-=2){for(a=1;a<=25;a+=8)n<<=1,n|=e>>>a+o&1;for(a=1;a<=25;a+=8)n<<=1,n|=t>>>a+o&1}i[r+0]=s>>>0,i[r+1]=n>>>0},e.rip=function(t,e,i,r){for(var s=0,n=0,o=0;o<4;o++)for(var a=24;a>=0;a-=8)s<<=1,s|=e>>>a+o&1,s<<=1,s|=t>>>a+o&1;for(o=4;o<8;o++)for(a=24;a>=0;a-=8)n<<=1,n|=e>>>a+o&1,n<<=1,n|=t>>>a+o&1;i[r+0]=s>>>0,i[r+1]=n>>>0},e.pc1=function(t,e,i,r){for(var s=0,n=0,o=7;o>=5;o--){for(var a=0;a<=24;a+=8)s<<=1,s|=e>>a+o&1;for(a=0;a<=24;a+=8)s<<=1,s|=t>>a+o&1}for(a=0;a<=24;a+=8)s<<=1,s|=e>>a+o&1;for(o=1;o<=3;o++){for(a=0;a<=24;a+=8)n<<=1,n|=e>>a+o&1;for(a=0;a<=24;a+=8)n<<=1,n|=t>>a+o&1}for(a=0;a<=24;a+=8)n<<=1,n|=t>>a+o&1;i[r+0]=s>>>0,i[r+1]=n>>>0},e.r28shl=function(t,e){return t<<e&268435455|t>>>28-e};var r=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];e.pc2=function(t,e,i,s){for(var n=0,o=0,a=r.length>>>1,h=0;h<a;h++)n<<=1,n|=t>>>r[h]&1;for(h=a;h<r.length;h++)o<<=1,o|=e>>>r[h]&1;i[s+0]=n>>>0,i[s+1]=o>>>0},e.expand=function(t,e,i){var r=0,s=0;r=(1&t)<<5|t>>>27;for(var n=23;n>=15;n-=4)r<<=6,r|=t>>>n&63;for(n=11;n>=3;n-=4)s|=t>>>n&63,s<<=6;s|=(31&t)<<1|t>>>31,e[i+0]=r>>>0,e[i+1]=s>>>0};var s=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];e.substitute=function(t,e){for(var i=0,r=0;r<4;r++)i<<=4,i|=s[64*r+(t>>>18-6*r&63)];for(r=0;r<4;r++)i<<=4,i|=s[256+64*r+(e>>>18-6*r&63)];return i>>>0};var n=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];e.permute=function(t){for(var e=0,i=0;i<n.length;i++)e<<=1,e|=t>>>n[i]&1;return e>>>0},e.padSplit=function(t,e,i){for(var r=t.toString(2);r.length<e;)r="0"+r;for(var s=[],n=0;n<e;n+=i)s.push(r.slice(n,n+i));return s.join(" ")}},function(t,e,i){"use strict";var r=i(40);function s(t){this.options=t,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}t.exports=s,s.prototype._init=function(){},s.prototype.update=function(t){return 0===t.length?[]:"decrypt"===this.type?this._updateDecrypt(t):this._updateEncrypt(t)},s.prototype._buffer=function(t,e){for(var i=Math.min(this.buffer.length-this.bufferOff,t.length-e),r=0;r<i;r++)this.buffer[this.bufferOff+r]=t[e+r];return this.bufferOff+=i,i},s.prototype._flushBuffer=function(t,e){return this._update(this.buffer,0,t,e),this.bufferOff=0,this.blockSize},s.prototype._updateEncrypt=function(t){var e=0,i=0,r=(this.bufferOff+t.length)/this.blockSize|0,s=new Array(r*this.blockSize);0!==this.bufferOff&&(e+=this._buffer(t,e),this.bufferOff===this.buffer.length&&(i+=this._flushBuffer(s,i)));for(var n=t.length-(t.length-e)%this.blockSize;e<n;e+=this.blockSize)this._update(t,e,s,i),i+=this.blockSize;for(;e<t.length;e++,this.bufferOff++)this.buffer[this.bufferOff]=t[e];return s},s.prototype._updateDecrypt=function(t){for(var e=0,i=0,r=Math.ceil((this.bufferOff+t.length)/this.blockSize)-1,s=new Array(r*this.blockSize);r>0;r--)e+=this._buffer(t,e),i+=this._flushBuffer(s,i);return e+=this._buffer(t,e),s},s.prototype.final=function(t){var e,i;return t&&(e=this.update(t)),i="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),e?e.concat(i):i},s.prototype._pad=function(t,e){if(0===e)return!1;for(;e<t.length;)t[e++]=0;return!0},s.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var t=new Array(this.blockSize);return this._update(this.buffer,0,t,0),t},s.prototype._unpad=function(t){return t},s.prototype._finalDecrypt=function(){r.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var t=new Array(this.blockSize);return this._flushBuffer(t,0),this._unpad(t)}},function(t,e,i){"use strict";var r=i(40),s=i(5),n=i(102),o=n.utils,a=n.Cipher;function h(t){a.call(this,t);var e=new function(){this.tmp=new Array(2),this.keys=null};this._desState=e,this.deriveKeys(e,t.key)}s(h,a),t.exports=h,h.create=function(t){return new h(t)};var c=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];h.prototype.deriveKeys=function(t,e){t.keys=new Array(32),r.equal(e.length,this.blockSize,"Invalid key length");var i=o.readUInt32BE(e,0),s=o.readUInt32BE(e,4);o.pc1(i,s,t.tmp,0),i=t.tmp[0],s=t.tmp[1];for(var n=0;n<t.keys.length;n+=2){var a=c[n>>>1];i=o.r28shl(i,a),s=o.r28shl(s,a),o.pc2(i,s,t.keys,n)}},h.prototype._update=function(t,e,i,r){var s=this._desState,n=o.readUInt32BE(t,e),a=o.readUInt32BE(t,e+4);o.ip(n,a,s.tmp,0),n=s.tmp[0],a=s.tmp[1],"encrypt"===this.type?this._encrypt(s,n,a,s.tmp,0):this._decrypt(s,n,a,s.tmp,0),n=s.tmp[0],a=s.tmp[1],o.writeUInt32BE(i,n,r),o.writeUInt32BE(i,a,r+4)},h.prototype._pad=function(t,e){for(var i=t.length-e,r=e;r<t.length;r++)t[r]=i;return!0},h.prototype._unpad=function(t){for(var e=t[t.length-1],i=t.length-e;i<t.length;i++)r.equal(t[i],e);return t.slice(0,t.length-e)},h.prototype._encrypt=function(t,e,i,r,s){for(var n=e,a=i,h=0;h<t.keys.length;h+=2){var c=t.keys[h],u=t.keys[h+1];o.expand(a,t.tmp,0),c^=t.tmp[0],u^=t.tmp[1];var l=o.substitute(c,u),f=a;a=(n^o.permute(l))>>>0,n=f}o.rip(a,n,r,s)},h.prototype._decrypt=function(t,e,i,r,s){for(var n=i,a=e,h=t.keys.length-2;h>=0;h-=2){var c=t.keys[h],u=t.keys[h+1];o.expand(n,t.tmp,0),c^=t.tmp[0],u^=t.tmp[1];var l=o.substitute(c,u),f=n;n=(a^o.permute(l))>>>0,a=f}o.rip(n,a,r,s)}},function(t,e,i){"use strict";var r=i(40),s=i(5),n={};e.instantiate=function(t){function e(e){t.call(this,e),this._cbcInit()}s(e,t);for(var i=Object.keys(n),r=0;r<i.length;r++){var o=i[r];e.prototype[o]=n[o]}return e.create=function(t){return new e(t)},e},n._cbcInit=function(){var t=new function(t){r.equal(t.length,8,"Invalid IV length"),this.iv=new Array(8);for(var e=0;e<this.iv.length;e++)this.iv[e]=t[e]}(this.options.iv);this._cbcState=t},n._update=function(t,e,i,r){var s=this._cbcState,n=this.constructor.super_.prototype,o=s.iv;if("encrypt"===this.type){for(var a=0;a<this.blockSize;a++)o[a]^=t[e+a];for(n._update.call(this,o,0,i,r),a=0;a<this.blockSize;a++)o[a]=i[r+a]}else{for(n._update.call(this,t,e,i,r),a=0;a<this.blockSize;a++)i[r+a]^=o[a];for(a=0;a<this.blockSize;a++)o[a]=t[e+a]}}},function(t,e,i){"use strict";var r=i(40),s=i(5),n=i(102),o=n.Cipher,a=n.DES;function h(t){o.call(this,t);var e=new function(t,e){r.equal(e.length,24,"Invalid key length");var i=e.slice(0,8),s=e.slice(8,16),n=e.slice(16,24);this.ciphers="encrypt"===t?[a.create({type:"encrypt",key:i}),a.create({type:"decrypt",key:s}),a.create({type:"encrypt",key:n})]:[a.create({type:"decrypt",key:n}),a.create({type:"encrypt",key:s}),a.create({type:"decrypt",key:i})]}(this.type,this.options.key);this._edeState=e}s(h,o),t.exports=h,h.create=function(t){return new h(t)},h.prototype._update=function(t,e,i,r){var s=this._edeState;s.ciphers[0]._update(t,e,i,r),s.ciphers[1]._update(i,r,i,r),s.ciphers[2]._update(i,r,i,r)},h.prototype._pad=a.prototype._pad,h.prototype._unpad=a.prototype._unpad},function(t,e,i){var r=i(0),s=r.Buffer;function n(t,e){for(var i in t)e[i]=t[i]}function o(t,e,i){return s(t,e,i)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?t.exports=r:(n(r,e),e.Buffer=o),n(s,o),o.from=function(t,e,i){if("number"==typeof t)throw new TypeError("Argument must not be a number");return s(t,e,i)},o.alloc=function(t,e,i){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=s(t);return void 0!==e?"string"==typeof i?r.fill(e,i):r.fill(e):r.fill(0),r},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return s(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,i){var r=i(104),s=i(160),n=i(7).Buffer,o=i(161),a=i(38),h=i(84),c=i(85);function u(t,e,i){a.call(this),this._cache=new f,this._cipher=new h.AES(e),this._prev=n.from(i),this._mode=t,this._autopadding=!0}i(5)(u,a),u.prototype._update=function(t){var e,i;this._cache.add(t);for(var r=[];e=this._cache.get();)i=this._mode.encrypt(this,e),r.push(i);return n.concat(r)};var l=n.alloc(16,16);function f(){this.cache=n.allocUnsafe(0)}function d(t,e,i){var a=r[t.toLowerCase()];if(!a)throw new TypeError("invalid suite type");if("string"==typeof e&&(e=n.from(e)),e.length!==a.key/8)throw new TypeError("invalid key length "+e.length);if("string"==typeof i&&(i=n.from(i)),"GCM"!==a.mode&&i.length!==a.iv)throw new TypeError("invalid iv length "+i.length);return"stream"===a.type?new o(a.module,e,i):"auth"===a.type?new s(a.module,e,i):new u(a.module,e,i)}u.prototype._final=function(){var t=this._cache.flush();if(this._autopadding)return t=this._mode.encrypt(this,t),this._cipher.scrub(),t;if(!t.equals(l))throw this._cipher.scrub(),new Error("data not multiple of block length")},u.prototype.setAutoPadding=function(t){return this._autopadding=!!t,this},f.prototype.add=function(t){this.cache=n.concat([this.cache,t])},f.prototype.get=function(){if(this.cache.length>15){var t=this.cache.slice(0,16);return this.cache=this.cache.slice(16),t}return null},f.prototype.flush=function(){for(var t=16-this.cache.length,e=n.allocUnsafe(t),i=-1;++i<t;)e.writeUInt8(t,i);return n.concat([this.cache,e])},e.createCipheriv=d,e.createCipher=function(t,e){var i=r[t.toLowerCase()];if(!i)throw new TypeError("invalid suite type");var s=c(e,!1,i.key,i.iv);return d(t,s.key,s.iv)}},function(t,e){e.encrypt=function(t,e){return t._cipher.encryptBlock(e)},e.decrypt=function(t,e){return t._cipher.decryptBlock(e)}},function(t,e,i){var r=i(62);e.encrypt=function(t,e){var i=r(e,t._prev);return t._prev=t._cipher.encryptBlock(i),t._prev},e.decrypt=function(t,e){var i=t._prev;t._prev=e;var s=t._cipher.decryptBlock(e);return r(s,i)}},function(t,e,i){var r=i(7).Buffer,s=i(62);function n(t,e,i){var n=e.length,o=s(e,t._cache);return t._cache=t._cache.slice(n),t._prev=r.concat([t._prev,i?e:o]),o}e.encrypt=function(t,e,i){for(var s,o=r.allocUnsafe(0);e.length;){if(0===t._cache.length&&(t._cache=t._cipher.encryptBlock(t._prev),t._prev=r.allocUnsafe(0)),!(t._cache.length<=e.length)){o=r.concat([o,n(t,e,i)]);break}s=t._cache.length,o=r.concat([o,n(t,e.slice(0,s),i)]),e=e.slice(s)}return o}},function(t,e,i){var r=i(7).Buffer;function s(t,e,i){var s=t._cipher.encryptBlock(t._prev)[0]^e;return t._prev=r.concat([t._prev.slice(1),r.from([i?e:s])]),s}e.encrypt=function(t,e,i){for(var n=e.length,o=r.allocUnsafe(n),a=-1;++a<n;)o[a]=s(t,e[a],i);return o}},function(t,e,i){var r=i(7).Buffer;function s(t,e,i){for(var r,s,o,a=-1,h=0;++a<8;)r=t._cipher.encryptBlock(t._prev),s=e&1<<7-a?128:0,h+=(128&(o=r[0]^s))>>a%8,t._prev=n(t._prev,i?s:o);return h}function n(t,e){var i=t.length,s=-1,n=r.allocUnsafe(t.length);for(t=r.concat([t,r.from([e])]);++s<i;)n[s]=t[s]<<1|t[s+1]>>7;return n}e.encrypt=function(t,e,i){for(var n=e.length,o=r.allocUnsafe(n),a=-1;++a<n;)o[a]=s(t,e[a],i);return o}},function(t,e,i){(function(t){var r=i(62);function s(t){return t._prev=t._cipher.encryptBlock(t._prev),t._prev}e.encrypt=function(e,i){for(;e._cache.length<i.length;)e._cache=t.concat([e._cache,s(e)]);var n=e._cache.slice(0,i.length);return e._cache=e._cache.slice(i.length),r(i,n)}}).call(this,i(0).Buffer)},function(t,e,i){var r=i(7).Buffer,s=r.alloc(16,0);function n(t){var e=r.allocUnsafe(16);return e.writeUInt32BE(t[0]>>>0,0),e.writeUInt32BE(t[1]>>>0,4),e.writeUInt32BE(t[2]>>>0,8),e.writeUInt32BE(t[3]>>>0,12),e}function o(t){this.h=t,this.state=r.alloc(16,0),this.cache=r.allocUnsafe(0)}o.prototype.ghash=function(t){for(var e=-1;++e<t.length;)this.state[e]^=t[e];this._multiply()},o.prototype._multiply=function(){for(var t,e,i=function(t){return[t.readUInt32BE(0),t.readUInt32BE(4),t.readUInt32BE(8),t.readUInt32BE(12)]}(this.h),r=[0,0,0,0],s=-1;++s<128;){for(0!=(this.state[~~(s/8)]&1<<7-s%8)&&(r[0]^=i[0],r[1]^=i[1],r[2]^=i[2],r[3]^=i[3]),e=0!=(1&i[3]),t=3;t>0;t--)i[t]=i[t]>>>1|(1&i[t-1])<<31;i[0]=i[0]>>>1,e&&(i[0]=i[0]^225<<24)}this.state=n(r)},o.prototype.update=function(t){var e;for(this.cache=r.concat([this.cache,t]);this.cache.length>=16;)e=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(e)},o.prototype.final=function(t,e){return this.cache.length&&this.ghash(r.concat([this.cache,s],16)),this.ghash(n([0,t,0,e])),this.state},t.exports=o},function(t,e,i){"use strict";(function(e){var r=i(5),s=i(306),n=new Array(16);function o(){s.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function a(t,e){return t<<e|t>>>32-e}function h(t,e,i,r,s,n,o){return a(t+(e&i|~e&r)+s+n|0,o)+e|0}function c(t,e,i,r,s,n,o){return a(t+(e&r|i&~r)+s+n|0,o)+e|0}function u(t,e,i,r,s,n,o){return a(t+(e^i^r)+s+n|0,o)+e|0}function l(t,e,i,r,s,n,o){return a(t+(i^(e|~r))+s+n|0,o)+e|0}r(o,s),o.prototype._update=function(){for(var t=n,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);var i=this._a,r=this._b,s=this._c,o=this._d;r=l(r=l(r=l(r=l(r=u(r=u(r=u(r=u(r=c(r=c(r=c(r=c(r=h(r=h(r=h(r=h(r,s=h(s,o=h(o,i=h(i,r,s,o,t[0],3614090360,7),r,s,t[1],3905402710,12),i,r,t[2],606105819,17),o,i,t[3],3250441966,22),s=h(s,o=h(o,i=h(i,r,s,o,t[4],4118548399,7),r,s,t[5],1200080426,12),i,r,t[6],2821735955,17),o,i,t[7],4249261313,22),s=h(s,o=h(o,i=h(i,r,s,o,t[8],1770035416,7),r,s,t[9],2336552879,12),i,r,t[10],4294925233,17),o,i,t[11],2304563134,22),s=h(s,o=h(o,i=h(i,r,s,o,t[12],1804603682,7),r,s,t[13],4254626195,12),i,r,t[14],2792965006,17),o,i,t[15],1236535329,22),s=c(s,o=c(o,i=c(i,r,s,o,t[1],4129170786,5),r,s,t[6],3225465664,9),i,r,t[11],643717713,14),o,i,t[0],3921069994,20),s=c(s,o=c(o,i=c(i,r,s,o,t[5],3593408605,5),r,s,t[10],38016083,9),i,r,t[15],3634488961,14),o,i,t[4],3889429448,20),s=c(s,o=c(o,i=c(i,r,s,o,t[9],568446438,5),r,s,t[14],3275163606,9),i,r,t[3],4107603335,14),o,i,t[8],1163531501,20),s=c(s,o=c(o,i=c(i,r,s,o,t[13],2850285829,5),r,s,t[2],4243563512,9),i,r,t[7],1735328473,14),o,i,t[12],2368359562,20),s=u(s,o=u(o,i=u(i,r,s,o,t[5],4294588738,4),r,s,t[8],2272392833,11),i,r,t[11],1839030562,16),o,i,t[14],4259657740,23),s=u(s,o=u(o,i=u(i,r,s,o,t[1],2763975236,4),r,s,t[4],1272893353,11),i,r,t[7],4139469664,16),o,i,t[10],3200236656,23),s=u(s,o=u(o,i=u(i,r,s,o,t[13],681279174,4),r,s,t[0],3936430074,11),i,r,t[3],3572445317,16),o,i,t[6],76029189,23),s=u(s,o=u(o,i=u(i,r,s,o,t[9],3654602809,4),r,s,t[12],3873151461,11),i,r,t[15],530742520,16),o,i,t[2],3299628645,23),s=l(s,o=l(o,i=l(i,r,s,o,t[0],4096336452,6),r,s,t[7],1126891415,10),i,r,t[14],2878612391,15),o,i,t[5],4237533241,21),s=l(s,o=l(o,i=l(i,r,s,o,t[12],1700485571,6),r,s,t[3],2399980690,10),i,r,t[10],4293915773,15),o,i,t[1],2240044497,21),s=l(s,o=l(o,i=l(i,r,s,o,t[8],1873313359,6),r,s,t[15],4264355552,10),i,r,t[6],2734768916,15),o,i,t[13],1309151649,21),s=l(s,o=l(o,i=l(i,r,s,o,t[4],4149444226,6),r,s,t[11],3174756917,10),i,r,t[2],718787259,15),o,i,t[9],3951481745,21),this._a=this._a+i|0,this._b=this._b+r|0,this._c=this._c+s|0,this._d=this._d+o|0},o.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=new e(16);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t},t.exports=o}).call(this,i(0).Buffer)},function(t,e,i){"use strict";var r=i(7).Buffer,s=i(83).Transform;function n(t){s.call(this),this._block=r.allocUnsafe(t),this._blockSize=t,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}i(5)(n,s),n.prototype._transform=function(t,e,i){var r=null;try{this.update(t,e)}catch(t){r=t}i(r)},n.prototype._flush=function(t){var e=null;try{this.push(this.digest())}catch(t){e=t}t(e)},n.prototype.update=function(t,e){if(function(t,e){if(!r.isBuffer(t)&&"string"!=typeof t)throw new TypeError("Data must be a string or a buffer")}(t),this._finalized)throw new Error("Digest already called");r.isBuffer(t)||(t=r.from(t,e));for(var i=this._block,s=0;this._blockOffset+t.length-s>=this._blockSize;){for(var n=this._blockOffset;n<this._blockSize;)i[n++]=t[s++];this._update(),this._blockOffset=0}for(;s<t.length;)i[this._blockOffset++]=t[s++];for(var o=0,a=8*t.length;a>0;++o)this._length[o]+=a,(a=this._length[o]/4294967296|0)>0&&(this._length[o]-=4294967296*a);return this},n.prototype._update=function(){throw new Error("_update is not implemented")},n.prototype.digest=function(t){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var e=this._digest();void 0!==t&&(e=e.toString(t)),this._block.fill(0),this._blockOffset=0;for(var i=0;i<4;++i)this._length[i]=0;return e},n.prototype._digest=function(){throw new Error("_digest is not implemented")},t.exports=n},function(t,e,i){var r=i(160),s=i(7).Buffer,n=i(104),o=i(161),a=i(38),h=i(84),c=i(85);function u(t,e,i){a.call(this),this._cache=new l,this._last=void 0,this._cipher=new h.AES(e),this._prev=s.from(i),this._mode=t,this._autopadding=!0}function l(){this.cache=s.allocUnsafe(0)}function f(t,e,i){var a=n[t.toLowerCase()];if(!a)throw new TypeError("invalid suite type");if("string"==typeof i&&(i=s.from(i)),"GCM"!==a.mode&&i.length!==a.iv)throw new TypeError("invalid iv length "+i.length);if("string"==typeof e&&(e=s.from(e)),e.length!==a.key/8)throw new TypeError("invalid key length "+e.length);return"stream"===a.type?new o(a.module,e,i,!0):"auth"===a.type?new r(a.module,e,i,!0):new u(a.module,e,i)}i(5)(u,a),u.prototype._update=function(t){var e,i;this._cache.add(t);for(var r=[];e=this._cache.get(this._autopadding);)i=this._mode.decrypt(this,e),r.push(i);return s.concat(r)},u.prototype._final=function(){var t=this._cache.flush();if(this._autopadding)return function(t){for(var e=t[15],i=-1;++i<e;)if(t[i+(16-e)]!==e)throw new Error("unable to decrypt data");if(16!==e)return t.slice(0,16-e)}(this._mode.decrypt(this,t));if(t)throw new Error("data not multiple of block length")},u.prototype.setAutoPadding=function(t){return this._autopadding=!!t,this},l.prototype.add=function(t){this.cache=s.concat([this.cache,t])},l.prototype.get=function(t){var e;if(t){if(this.cache.length>16)return e=this.cache.slice(0,16),this.cache=this.cache.slice(16),e}else if(this.cache.length>=16)return e=this.cache.slice(0,16),this.cache=this.cache.slice(16),e;return null},l.prototype.flush=function(){if(this.cache.length)return this.cache},e.createDecipher=function(t,e){var i=n[t.toLowerCase()];if(!i)throw new TypeError("invalid suite type");var r=c(e,!1,i.key,i.iv);return f(t,r.key,r.iv)},e.createDecipheriv=f},function(t,e){e["des-ecb"]={key:8,iv:0},e["des-cbc"]=e.des={key:8,iv:8},e["des-ede3-cbc"]=e.des3={key:24,iv:8},e["des-ede3"]={key:24,iv:0},e["des-ede-cbc"]={key:16,iv:8},e["des-ede"]={key:16,iv:0}},function(t,e,i){(function(t){var r=i(162),s=i(310),n=i(311),o={binary:!0,hex:!0,base64:!0};e.DiffieHellmanGroup=e.createDiffieHellmanGroup=e.getDiffieHellman=function(e){var i=new t(s[e].prime,"hex"),r=new t(s[e].gen,"hex");return new n(i,r)},e.createDiffieHellman=e.DiffieHellman=function e(i,s,a,h){return t.isBuffer(s)||void 0===o[s]?e(i,"binary",s,a):(s=s||"binary",h=h||"binary",a=a||new t([2]),t.isBuffer(a)||(a=new t(a,h)),"number"==typeof i?new n(r(i,a),a,!0):(t.isBuffer(i)||(i=new t(i,s)),new n(i,a,!0)))}}).call(this,i(0).Buffer)},function(t){t.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},function(t,e,i){(function(e){var r=i(14),s=new(i(163)),n=new r(24),o=new r(11),a=new r(10),h=new r(3),c=new r(7),u=i(162),l=i(49);function f(t,i){return i=i||"utf8",e.isBuffer(t)||(t=new e(t,i)),this._pub=new r(t),this}function d(t,i){return i=i||"utf8",e.isBuffer(t)||(t=new e(t,i)),this._priv=new r(t),this}t.exports=g;var p={};function g(t,e,i){this.setGenerator(e),this.__prime=new r(t),this._prime=r.mont(this.__prime),this._primeLen=t.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,i?(this.setPublicKey=f,this.setPrivateKey=d):this._primeCode=8}function m(t,i){var r=new e(t.toArray());return i?r.toString(i):r}Object.defineProperty(g.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(t,e){var i=e.toString("hex"),r=[i,t.toString(16)].join("_");if(r in p)return p[r];var l,f=0;if(t.isEven()||!u.simpleSieve||!u.fermatTest(t)||!s.test(t))return f+=1,f+="02"===i||"05"===i?8:4,p[r]=f,f;switch(s.test(t.shrn(1))||(f+=2),i){case"02":t.mod(n).cmp(o)&&(f+=8);break;case"05":(l=t.mod(a)).cmp(h)&&l.cmp(c)&&(f+=8);break;default:f+=4}return p[r]=f,f}(this.__prime,this.__gen)),this._primeCode}}),g.prototype.generateKeys=function(){return this._priv||(this._priv=new r(l(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},g.prototype.computeSecret=function(t){var i=(t=(t=new r(t)).toRed(this._prime)).redPow(this._priv).fromRed(),s=new e(i.toArray()),n=this.getPrime();if(s.length<n.length){var o=new e(n.length-s.length);o.fill(0),s=e.concat([o,s])}return s},g.prototype.getPublicKey=function(t){return m(this._pub,t)},g.prototype.getPrivateKey=function(t){return m(this._priv,t)},g.prototype.getPrime=function(t){return m(this.__prime,t)},g.prototype.getGenerator=function(t){return m(this._gen,t)},g.prototype.setGenerator=function(t,i){return i=i||"utf8",e.isBuffer(t)||(t=new e(t,i)),this.__gen=t,this._gen=new r(t),this}}).call(this,i(0).Buffer)},function(t,e,i){(function(e){var r=i(61),s=i(83),n=i(5),o=i(313),a=i(327),h=i(152);function c(t){s.Writable.call(this);var e=h[t];if(!e)throw new Error("Unknown message digest");this._hashType=e.hash,this._hash=r(e.hash),this._tag=e.id,this._signType=e.sign}function u(t){s.Writable.call(this);var e=h[t];if(!e)throw new Error("Unknown message digest");this._hash=r(e.hash),this._tag=e.id,this._signType=e.sign}function l(t){return new c(t)}function f(t){return new u(t)}Object.keys(h).forEach(function(t){h[t].id=new e(h[t].id,"hex"),h[t.toLowerCase()]=h[t]}),n(c,s.Writable),c.prototype._write=function(t,e,i){this._hash.update(t),i()},c.prototype.update=function(t,i){return"string"==typeof t&&(t=new e(t,i)),this._hash.update(t),this},c.prototype.sign=function(t,e){this.end();var i=this._hash.digest(),r=o(i,t,this._hashType,this._signType,this._tag);return e?r.toString(e):r},n(u,s.Writable),u.prototype._write=function(t,e,i){this._hash.update(t),i()},u.prototype.update=function(t,i){return"string"==typeof t&&(t=new e(t,i)),this._hash.update(t),this},u.prototype.verify=function(t,i,r){"string"==typeof i&&(i=new e(i,r)),this.end();var s=this._hash.digest();return a(i,s,t,this._signType,this._tag)},t.exports={Sign:l,Verify:f,createSign:l,createVerify:f}}).call(this,i(0).Buffer)},function(t,e,i){(function(e){var r=i(151),s=i(105),n=i(21).ec,o=i(14),a=i(86),h=i(169);function c(t,i,s,n){if((t=new e(t.toArray())).length<i.byteLength()){var o=new e(i.byteLength()-t.length);o.fill(0),t=e.concat([o,t])}var a=s.length,h=function(t,i){t=(t=u(t,i)).mod(i);var r=new e(t.toArray());if(r.length<i.byteLength()){var s=new e(i.byteLength()-r.length);s.fill(0),r=e.concat([s,r])}return r}(s,i),c=new e(a);c.fill(1);var l=new e(a);return l.fill(0),l=r(n,l).update(c).update(new e([0])).update(t).update(h).digest(),c=r(n,l).update(c).digest(),{k:l=r(n,l).update(c).update(new e([1])).update(t).update(h).digest(),v:c=r(n,l).update(c).digest()}}function u(t,e){var i=new o(t),r=(t.length<<3)-e.bitLength();return r>0&&i.ishrn(r),i}function l(t,i,s){var n,o;do{for(n=new e(0);8*n.length<t.bitLength();)i.v=r(s,i.k).update(i.v).digest(),n=e.concat([n,i.v]);o=u(n,t),i.k=r(s,i.k).update(i.v).update(new e([0])).digest(),i.v=r(s,i.k).update(i.v).digest()}while(-1!==o.cmp(t));return o}function f(t,e,i,r){return t.toRed(o.mont(i)).redPow(e).fromRed().mod(r)}t.exports=function(t,i,r,d,p){var g=a(i);if(g.curve){if("ecdsa"!==d&&"ecdsa/rsa"!==d)throw new Error("wrong private key type");return function(t,i){var r=h[i.curve.join(".")];if(!r)throw new Error("unknown curve "+i.curve.join("."));var s=new n(r).keyFromPrivate(i.privateKey).sign(t);return new e(s.toDER())}(t,g)}if("dsa"===g.type){if("dsa"!==d)throw new Error("wrong private key type");return function(t,i,r){for(var s,n=i.params.priv_key,a=i.params.p,h=i.params.q,d=i.params.g,p=new o(0),g=u(t,h).mod(h),m=!1,w=c(n,h,t,r);!1===m;)p=f(d,s=l(h,w,r),a,h),0===(m=s.invm(h).imul(g.add(n.mul(p))).mod(h)).cmpn(0)&&(m=!1,p=new o(0));return function(t,i){t=t.toArray(),i=i.toArray(),128&t[0]&&(t=[0].concat(t)),128&i[0]&&(i=[0].concat(i));var r=[48,t.length+i.length+4,2,t.length];return r=r.concat(t,[2,i.length],i),new e(r)}(p,m)}(t,g,r)}if("rsa"!==d&&"ecdsa/rsa"!==d)throw new Error("wrong private key type");t=e.concat([p,t]);for(var m=g.modulus.byteLength(),w=[0,1];t.length+w.length+1<m;)w.push(255);w.push(0);for(var y=-1;++y<t.length;)w.push(t[y]);return s(w,g)},t.exports.getKey=c,t.exports.makeKey=l}).call(this,i(0).Buffer)},function(t,e,i){"use strict";var r=i(63);e.certificate=i(324);var s=r.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});e.RSAPrivateKey=s;var n=r.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});e.RSAPublicKey=n;var o=r.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())});e.PublicKey=o;var a=r.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),h=r.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(a),this.key("subjectPrivateKey").octstr())});e.PrivateKey=h;var c=r.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});e.EncryptedPrivateKey=c;var u=r.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});e.DSAPrivateKey=u,e.DSAparam=r.define("DSAparam",function(){this.int()});var l=r.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(f),this.key("publicKey").optional().explicit(1).bitstr())});e.ECPrivateKey=l;var f=r.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});e.signature=r.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},function(t,e,i){var r=i(63),s=i(5);function n(t,e){this.name=t,this.body=e,this.decoders={},this.encoders={}}e.define=function(t,e){return new n(t,e)},n.prototype._createNamed=function(t){var e;try{e=i(316).runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(t){e=function(t){this._initNamed(t)}}return s(e,t),e.prototype._initNamed=function(e){t.call(this,e)},new e(this)},n.prototype._getDecoder=function(t){return t=t||"der",this.decoders.hasOwnProperty(t)||(this.decoders[t]=this._createNamed(r.decoders[t])),this.decoders[t]},n.prototype.decode=function(t,e,i){return this._getDecoder(e).decode(t,i)},n.prototype._getEncoder=function(t){return t=t||"der",this.encoders.hasOwnProperty(t)||(this.encoders[t]=this._createNamed(r.encoders[t])),this.encoders[t]},n.prototype.encode=function(t,e,i){return this._getEncoder(e).encode(t,i)}},function(module,exports,__webpack_require__){var indexOf=__webpack_require__(164),Object_keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var i in t)e.push(i);return e},forEach=function(t,e){if(t.forEach)return t.forEach(e);for(var i=0;i<t.length;i++)e(t[i],i,t)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(t,e,i){Object.defineProperty(t,e,{writable:!0,enumerable:!1,configurable:!0,value:i})}}catch(t){return function(t,e,i){t[e]=i}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(t){if(!(this instanceof Script))return new Script(t);this.code=t};Script.prototype.runInContext=function(t){if(!(t instanceof Context))throw new TypeError("needs a 'context' argument.");var e=document.createElement("iframe");e.style||(e.style={}),e.style.display="none",document.body.appendChild(e);var i=e.contentWindow,r=i.eval,s=i.execScript;!r&&s&&(s.call(i,"null"),r=i.eval),forEach(Object_keys(t),function(e){i[e]=t[e]}),forEach(globals,function(e){t[e]&&(i[e]=t[e])});var n=Object_keys(i),o=r.call(i,this.code);return forEach(Object_keys(i),function(e){(e in t||-1===indexOf(n,e))&&(t[e]=i[e])}),forEach(globals,function(e){e in t||defineProp(t,e,i[e])}),document.body.removeChild(e),o},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(t){var e=Script.createContext(t),i=this.runInContext(e);return forEach(Object_keys(e),function(i){t[i]=e[i]}),i},forEach(Object_keys(Script.prototype),function(t){exports[t]=Script[t]=function(e){var i=Script(e);return i[t].apply(i,[].slice.call(arguments,1))}}),exports.createScript=function(t){return exports.Script(t)},exports.createContext=Script.createContext=function(t){var e=new Context;return"object"==typeof t&&forEach(Object_keys(t),function(i){e[i]=t[i]}),e}},function(t,e,i){var r=i(5);function s(t){this._reporterState={obj:null,path:[],options:t||{},errors:[]}}function n(t,e){this.path=t,this.rethrow(e)}e.Reporter=s,s.prototype.isError=function(t){return t instanceof n},s.prototype.save=function(){var t=this._reporterState;return{obj:t.obj,pathLen:t.path.length}},s.prototype.restore=function(t){var e=this._reporterState;e.obj=t.obj,e.path=e.path.slice(0,t.pathLen)},s.prototype.enterKey=function(t){return this._reporterState.path.push(t)},s.prototype.exitKey=function(t){var e=this._reporterState;e.path=e.path.slice(0,t-1)},s.prototype.leaveKey=function(t,e,i){var r=this._reporterState;this.exitKey(t),null!==r.obj&&(r.obj[e]=i)},s.prototype.path=function(){return this._reporterState.path.join("/")},s.prototype.enterObject=function(){var t=this._reporterState,e=t.obj;return t.obj={},e},s.prototype.leaveObject=function(t){var e=this._reporterState,i=e.obj;return e.obj=t,i},s.prototype.error=function(t){var e,i=this._reporterState,r=t instanceof n;if(e=r?t:new n(i.path.map(function(t){return"["+JSON.stringify(t)+"]"}).join(""),t.message||t,t.stack),!i.options.partial)throw e;return r||i.errors.push(e),e},s.prototype.wrapResult=function(t){var e=this._reporterState;return e.options.partial?{result:this.isError(t)?null:t,errors:e.errors}:t},r(n,Error),n.prototype.rethrow=function(t){if(this.message=t+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,n),!this.stack)try{throw new Error(this.message)}catch(t){this.stack=t.stack}return this}},function(t,e,i){var r=i(64).Reporter,s=i(64).EncoderBuffer,n=i(64).DecoderBuffer,o=i(40),a=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],h=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(a);function c(t,e){var i={};this._baseState=i,i.enc=t,i.parent=e||null,i.children=null,i.tag=null,i.args=null,i.reverseArgs=null,i.choice=null,i.optional=!1,i.any=!1,i.obj=!1,i.use=null,i.useDecoder=null,i.key=null,i.default=null,i.explicit=null,i.implicit=null,i.contains=null,i.parent||(i.children=[],this._wrap())}t.exports=c;var u=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];c.prototype.clone=function(){var t=this._baseState,e={};u.forEach(function(i){e[i]=t[i]});var i=new this.constructor(e.parent);return i._baseState=e,i},c.prototype._wrap=function(){var t=this._baseState;h.forEach(function(e){this[e]=function(){var i=new this.constructor(this);return t.children.push(i),i[e].apply(i,arguments)}},this)},c.prototype._init=function(t){var e=this._baseState;o(null===e.parent),t.call(this),e.children=e.children.filter(function(t){return t._baseState.parent===this},this),o.equal(e.children.length,1,"Root node can have only one child")},c.prototype._useArgs=function(t){var e=this._baseState,i=t.filter(function(t){return t instanceof this.constructor},this);t=t.filter(function(t){return!(t instanceof this.constructor)},this),0!==i.length&&(o(null===e.children),e.children=i,i.forEach(function(t){t._baseState.parent=this},this)),0!==t.length&&(o(null===e.args),e.args=t,e.reverseArgs=t.map(function(t){if("object"!=typeof t||t.constructor!==Object)return t;var e={};return Object.keys(t).forEach(function(i){i==(0|i)&&(i|=0);var r=t[i];e[r]=i}),e}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(t){c.prototype[t]=function(){var e=this._baseState;throw new Error(t+" not implemented for encoding: "+e.enc)}}),a.forEach(function(t){c.prototype[t]=function(){var e=this._baseState,i=Array.prototype.slice.call(arguments);return o(null===e.tag),e.tag=t,this._useArgs(i),this}}),c.prototype.use=function(t){o(t);var e=this._baseState;return o(null===e.use),e.use=t,this},c.prototype.optional=function(){return this._baseState.optional=!0,this},c.prototype.def=function(t){var e=this._baseState;return o(null===e.default),e.default=t,e.optional=!0,this},c.prototype.explicit=function(t){var e=this._baseState;return o(null===e.explicit&&null===e.implicit),e.explicit=t,this},c.prototype.implicit=function(t){var e=this._baseState;return o(null===e.explicit&&null===e.implicit),e.implicit=t,this},c.prototype.obj=function(){var t=this._baseState,e=Array.prototype.slice.call(arguments);return t.obj=!0,0!==e.length&&this._useArgs(e),this},c.prototype.key=function(t){var e=this._baseState;return o(null===e.key),e.key=t,this},c.prototype.any=function(){return this._baseState.any=!0,this},c.prototype.choice=function(t){var e=this._baseState;return o(null===e.choice),e.choice=t,this._useArgs(Object.keys(t).map(function(e){return t[e]})),this},c.prototype.contains=function(t){var e=this._baseState;return o(null===e.use),e.contains=t,this},c.prototype._decode=function(t,e){var i=this._baseState;if(null===i.parent)return t.wrapResult(i.children[0]._decode(t,e));var r,s=i.default,o=!0,a=null;if(null!==i.key&&(a=t.enterKey(i.key)),i.optional){var h=null;if(null!==i.explicit?h=i.explicit:null!==i.implicit?h=i.implicit:null!==i.tag&&(h=i.tag),null!==h||i.any){if(o=this._peekTag(t,h,i.any),t.isError(o))return o}else{var c=t.save();try{null===i.choice?this._decodeGeneric(i.tag,t,e):this._decodeChoice(t,e),o=!0}catch(t){o=!1}t.restore(c)}}if(i.obj&&o&&(r=t.enterObject()),o){if(null!==i.explicit){var u=this._decodeTag(t,i.explicit);if(t.isError(u))return u;t=u}var l=t.offset;if(null===i.use&&null===i.choice){i.any&&(c=t.save());var f=this._decodeTag(t,null!==i.implicit?i.implicit:i.tag,i.any);if(t.isError(f))return f;i.any?s=t.raw(c):t=f}if(e&&e.track&&null!==i.tag&&e.track(t.path(),l,t.length,"tagged"),e&&e.track&&null!==i.tag&&e.track(t.path(),t.offset,t.length,"content"),s=i.any?s:null===i.choice?this._decodeGeneric(i.tag,t,e):this._decodeChoice(t,e),t.isError(s))return s;if(i.any||null!==i.choice||null===i.children||i.children.forEach(function(i){i._decode(t,e)}),i.contains&&("octstr"===i.tag||"bitstr"===i.tag)){var d=new n(s);s=this._getUse(i.contains,t._reporterState.obj)._decode(d,e)}}return i.obj&&o&&(s=t.leaveObject(r)),null===i.key||null===s&&!0!==o?null!==a&&t.exitKey(a):t.leaveKey(a,i.key,s),s},c.prototype._decodeGeneric=function(t,e,i){var r=this._baseState;return"seq"===t||"set"===t?null:"seqof"===t||"setof"===t?this._decodeList(e,t,r.args[0],i):/str$/.test(t)?this._decodeStr(e,t,i):"objid"===t&&r.args?this._decodeObjid(e,r.args[0],r.args[1],i):"objid"===t?this._decodeObjid(e,null,null,i):"gentime"===t||"utctime"===t?this._decodeTime(e,t,i):"null_"===t?this._decodeNull(e,i):"bool"===t?this._decodeBool(e,i):"objDesc"===t?this._decodeStr(e,t,i):"int"===t||"enum"===t?this._decodeInt(e,r.args&&r.args[0],i):null!==r.use?this._getUse(r.use,e._reporterState.obj)._decode(e,i):e.error("unknown tag: "+t)},c.prototype._getUse=function(t,e){var i=this._baseState;return i.useDecoder=this._use(t,e),o(null===i.useDecoder._baseState.parent),i.useDecoder=i.useDecoder._baseState.children[0],i.implicit!==i.useDecoder._baseState.implicit&&(i.useDecoder=i.useDecoder.clone(),i.useDecoder._baseState.implicit=i.implicit),i.useDecoder},c.prototype._decodeChoice=function(t,e){var i=this._baseState,r=null,s=!1;return Object.keys(i.choice).some(function(n){var o=t.save(),a=i.choice[n];try{var h=a._decode(t,e);if(t.isError(h))return!1;r={type:n,value:h},s=!0}catch(e){return t.restore(o),!1}return!0},this),s?r:t.error("Choice not matched")},c.prototype._createEncoderBuffer=function(t){return new s(t,this.reporter)},c.prototype._encode=function(t,e,i){var r=this._baseState;if(null===r.default||r.default!==t){var s=this._encodeValue(t,e,i);if(void 0!==s&&!this._skipDefault(s,e,i))return s}},c.prototype._encodeValue=function(t,e,i){var s=this._baseState;if(null===s.parent)return s.children[0]._encode(t,e||new r);var n=null;if(this.reporter=e,s.optional&&void 0===t){if(null===s.default)return;t=s.default}var o=null,a=!1;if(s.any)n=this._createEncoderBuffer(t);else if(s.choice)n=this._encodeChoice(t,e);else if(s.contains)o=this._getUse(s.contains,i)._encode(t,e),a=!0;else if(s.children)o=s.children.map(function(i){if("null_"===i._baseState.tag)return i._encode(null,e,t);if(null===i._baseState.key)return e.error("Child should have a key");var r=e.enterKey(i._baseState.key);if("object"!=typeof t)return e.error("Child expected, but input is not object");var s=i._encode(t[i._baseState.key],e,t);return e.leaveKey(r),s},this).filter(function(t){return t}),o=this._createEncoderBuffer(o);else if("seqof"===s.tag||"setof"===s.tag){if(!s.args||1!==s.args.length)return e.error("Too many args for : "+s.tag);if(!Array.isArray(t))return e.error("seqof/setof, but data is not Array");var h=this.clone();h._baseState.implicit=null,o=this._createEncoderBuffer(t.map(function(i){var r=this._baseState;return this._getUse(r.args[0],t)._encode(i,e)},h))}else null!==s.use?n=this._getUse(s.use,i)._encode(t,e):(o=this._encodePrimitive(s.tag,t),a=!0);if(!s.any&&null===s.choice){var c=null!==s.implicit?s.implicit:s.tag,u=null===s.implicit?"universal":"context";null===c?null===s.use&&e.error("Tag could be omitted only for .use()"):null===s.use&&(n=this._encodeComposite(c,a,u,o))}return null!==s.explicit&&(n=this._encodeComposite(s.explicit,!1,"context",n)),n},c.prototype._encodeChoice=function(t,e){var i=this._baseState,r=i.choice[t.type];return r||o(!1,t.type+" not found in "+JSON.stringify(Object.keys(i.choice))),r._encode(t.value,e)},c.prototype._encodePrimitive=function(t,e){var i=this._baseState;if(/str$/.test(t))return this._encodeStr(e,t);if("objid"===t&&i.args)return this._encodeObjid(e,i.reverseArgs[0],i.args[1]);if("objid"===t)return this._encodeObjid(e,null,null);if("gentime"===t||"utctime"===t)return this._encodeTime(e,t);if("null_"===t)return this._encodeNull();if("int"===t||"enum"===t)return this._encodeInt(e,i.args&&i.reverseArgs[0]);if("bool"===t)return this._encodeBool(e);if("objDesc"===t)return this._encodeStr(e,t);throw new Error("Unsupported tag: "+t)},c.prototype._isNumstr=function(t){return/^[0-9 ]*$/.test(t)},c.prototype._isPrintstr=function(t){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(t)}},function(t,e,i){var r=i(166);e.tagClass={0:"universal",1:"application",2:"context",3:"private"},e.tagClassByName=r._reverse(e.tagClass),e.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},e.tagByName=r._reverse(e.tag)},function(t,e,i){var r=e;r.der=i(167),r.pem=i(321)},function(t,e,i){var r=i(5),s=i(0).Buffer,n=i(167);function o(t){n.call(this,t),this.enc="pem"}r(o,n),t.exports=o,o.prototype.decode=function(t,e){for(var i=t.toString().split(/[\r\n]+/g),r=e.label.toUpperCase(),o=/^-----(BEGIN|END) ([^-]+)-----$/,a=-1,h=-1,c=0;c<i.length;c++){var u=i[c].match(o);if(null!==u&&u[2]===r){if(-1!==a){if("END"!==u[1])break;h=c;break}if("BEGIN"!==u[1])break;a=c}}if(-1===a||-1===h)throw new Error("PEM section not found for: "+r);var l=i.slice(a+1,h).join("");l.replace(/[^a-z0-9\+\/=]+/gi,"");var f=new s(l,"base64");return n.prototype.decode.call(this,f,e)}},function(t,e,i){var r=e;r.der=i(168),r.pem=i(323)},function(t,e,i){var r=i(5),s=i(168);function n(t){s.call(this,t),this.enc="pem"}r(n,s),t.exports=n,n.prototype.encode=function(t,e){for(var i=s.prototype.encode.call(this,t).toString("base64"),r=["-----BEGIN "+e.label+"-----"],n=0;n<i.length;n+=64)r.push(i.slice(n,n+64));return r.push("-----END "+e.label+"-----"),r.join("\n")}},function(t,e,i){"use strict";var r=i(63),s=r.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),n=r.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),o=r.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional())}),a=r.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(o),this.key("subjectPublicKey").bitstr())}),h=r.define("RelativeDistinguishedName",function(){this.setof(n)}),c=r.define("RDNSequence",function(){this.seqof(h)}),u=r.define("Name",function(){this.choice({rdnSequence:this.use(c)})}),l=r.define("Validity",function(){this.seq().obj(this.key("notBefore").use(s),this.key("notAfter").use(s))}),f=r.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),d=r.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int(),this.key("serialNumber").int(),this.key("signature").use(o),this.key("issuer").use(u),this.key("validity").use(l),this.key("subject").use(u),this.key("subjectPublicKeyInfo").use(a),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(f).optional())}),p=r.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(d),this.key("signatureAlgorithm").use(o),this.key("signatureValue").bitstr())});t.exports=p},function(t){t.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},function(t,e,i){(function(e){var r=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r\+\/\=]+)[\n\r]+/m,s=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----/m,n=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----([0-9A-z\n\r\+\/\=]+)-----END \1-----$/m,o=i(85),a=i(103);t.exports=function(t,i){var h,c=t.toString(),u=c.match(r);if(u){var l="aes"+u[1],f=new e(u[2],"hex"),d=new e(u[3].replace(/[\r\n]/g,""),"base64"),p=o(i,f.slice(0,8),parseInt(u[1],10)).key,g=[],m=a.createDecipheriv(l,p,f);g.push(m.update(d)),g.push(m.final()),h=e.concat(g)}else{var w=c.match(n);h=new e(w[2].replace(/[\r\n]/g,""),"base64")}return{tag:c.match(s)[1],data:h}}}).call(this,i(0).Buffer)},function(t,e,i){(function(e){var r=i(14),s=i(21).ec,n=i(86),o=i(169);function a(t,e){if(t.cmpn(0)<=0)throw new Error("invalid sig");if(t.cmp(e)>=e)throw new Error("invalid sig")}t.exports=function(t,i,h,c,u){var l=n(h);if("ec"===l.type){if("ecdsa"!==c&&"ecdsa/rsa"!==c)throw new Error("wrong public key type");return function(t,e,i){var r=o[i.data.algorithm.curve.join(".")];if(!r)throw new Error("unknown curve "+i.data.algorithm.curve.join("."));var n=new s(r),a=i.data.subjectPrivateKey.data;return n.verify(e,t,a)}(t,i,l)}if("dsa"===l.type){if("dsa"!==c)throw new Error("wrong public key type");return function(t,e,i){var s=i.data.p,o=i.data.q,h=i.data.g,c=i.data.pub_key,u=n.signature.decode(t,"der"),l=u.s,f=u.r;a(l,o),a(f,o);var d=r.mont(s),p=l.invm(o);return 0===h.toRed(d).redPow(new r(e).mul(p).mod(o)).fromRed().mul(c.toRed(d).redPow(f.mul(p).mod(o)).fromRed()).mod(s).mod(o).cmp(f)}(t,i,l)}if("rsa"!==c&&"ecdsa/rsa"!==c)throw new Error("wrong public key type");i=e.concat([u,i]);for(var f=l.modulus.byteLength(),d=[1],p=0;i.length+d.length+2<f;)d.push(255),p++;d.push(0);for(var g=-1;++g<i.length;)d.push(i[g]);d=new e(d);var m=r.mont(l.modulus);t=(t=new r(t).toRed(m)).redPow(new r(l.publicExponent)),t=new e(t.fromRed().toArray());var w=p<8?1:0;for(f=Math.min(t.length,d.length),t.length!==d.length&&(w=1),g=-1;++g<f;)w|=t[g]^d[g];return 0===w}}).call(this,i(0).Buffer)},function(t,e,i){(function(e){var r=i(21),s=i(14);t.exports=function(t){return new o(t)};var n={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function o(t){this.curveType=n[t],this.curveType||(this.curveType={name:t}),this.curve=new r.ec(this.curveType.name),this.keys=void 0}function a(t,i,r){Array.isArray(t)||(t=t.toArray());var s=new e(t);if(r&&s.length<r){var n=new e(r-s.length);n.fill(0),s=e.concat([n,s])}return i?s.toString(i):s}n.p224=n.secp224r1,n.p256=n.secp256r1=n.prime256v1,n.p192=n.secp192r1=n.prime192v1,n.p384=n.secp384r1,n.p521=n.secp521r1,o.prototype.generateKeys=function(t,e){return this.keys=this.curve.genKeyPair(),this.getPublicKey(t,e)},o.prototype.computeSecret=function(t,i,r){return i=i||"utf8",e.isBuffer(t)||(t=new e(t,i)),a(this.curve.keyFromPublic(t).getPublic().mul(this.keys.getPrivate()).getX(),r,this.curveType.byteLength)},o.prototype.getPublicKey=function(t,e){var i=this.keys.getPublic("compressed"===e,!0);return"hybrid"===e&&(i[i.length-1]%2?i[0]=7:i[0]=6),a(i,t)},o.prototype.getPrivateKey=function(t){return a(this.keys.getPrivate(),t)},o.prototype.setPublicKey=function(t,i){return i=i||"utf8",e.isBuffer(t)||(t=new e(t,i)),this.keys._importPublic(t),this},o.prototype.setPrivateKey=function(t,i){i=i||"utf8",e.isBuffer(t)||(t=new e(t,i));var r=new s(t);return r=r.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(r),this}}).call(this,i(0).Buffer)},function(t,e,i){e.publicEncrypt=i(330),e.privateDecrypt=i(331),e.privateEncrypt=function(t,i){return e.publicEncrypt(t,i,!0)},e.publicDecrypt=function(t,i){return e.privateDecrypt(t,i,!0)}},function(t,e,i){(function(e){var r=i(86),s=i(49),n=i(61),o=i(170),a=i(171),h=i(14),c=i(172),u=i(105);t.exports=function(t,i,l){var f;f=t.padding?t.padding:l?1:4;var d,p=r(t);if(4===f)d=function(t,i){var r=t.modulus.byteLength(),c=i.length,u=n("sha1").update(new e("")).digest(),l=u.length,f=2*l;if(c>r-f-2)throw new Error("message too long");var d=new e(r-c-f-2);d.fill(0);var p=r-l-1,g=s(l),m=a(e.concat([u,d,new e([1]),i],p),o(g,p)),w=a(g,o(m,l));return new h(e.concat([new e([0]),w,m],r))}(p,i);else if(1===f)d=function(t,i,r){var n,o=i.length,a=t.modulus.byteLength();if(o>a-11)throw new Error("message too long");return r?(n=new e(a-o-3)).fill(255):n=function(t,i){for(var r,n=new e(t),o=0,a=s(2*t),h=0;o<t;)h===a.length&&(a=s(2*t),h=0),(r=a[h++])&&(n[o++]=r);return n}(a-o-3),new h(e.concat([new e([0,r?1:2]),n,new e([0]),i],a))}(p,i,l);else{if(3!==f)throw new Error("unknown padding");if((d=new h(i)).cmp(p.modulus)>=0)throw new Error("data too long for modulus")}return l?u(d,p):c(d,p)}}).call(this,i(0).Buffer)},function(t,e,i){(function(e){var r=i(86),s=i(170),n=i(171),o=i(14),a=i(105),h=i(61),c=i(172);t.exports=function(t,i,u){var l;l=t.padding?t.padding:u?1:4;var f,d=r(t),p=d.modulus.byteLength();if(i.length>p||new o(i).cmp(d.modulus)>=0)throw new Error("decryption error");f=u?c(new o(i),d):a(i,d);var g=new e(p-f.length);if(g.fill(0),f=e.concat([g,f],p),4===l)return function(t,i){t.modulus;var r=t.modulus.byteLength(),o=(i.length,h("sha1").update(new e("")).digest()),a=o.length;if(0!==i[0])throw new Error("decryption error");var c=i.slice(1,a+1),u=i.slice(a+1),l=n(c,s(u,a)),f=n(u,s(l,r-a-1));if(function(t,i){t=new e(t),i=new e(i);var r=0,s=t.length;t.length!==i.length&&(r++,s=Math.min(t.length,i.length));for(var n=-1;++n<s;)r+=t[n]^i[n];return r}(o,f.slice(0,a)))throw new Error("decryption error");for(var d=a;0===f[d];)d++;if(1!==f[d++])throw new Error("decryption error");return f.slice(d)}(d,f);if(1===l)return function(t,e,i){for(var r=e.slice(0,2),s=2,n=0;0!==e[s++];)if(s>=e.length){n++;break}var o=e.slice(2,s-1);if(e.slice(s-1,s),("0002"!==r.toString("hex")&&!i||"0001"!==r.toString("hex")&&i)&&n++,o.length<8&&n++,n)throw new Error("decryption error");return e.slice(s)}(0,f,u);if(3===l)return f;throw new Error("unknown padding")}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t,r){function s(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var n=i(7),o=i(49),a=n.Buffer,h=n.kMaxLength,c=t.crypto||t.msCrypto,u=Math.pow(2,32)-1;function l(t,e){if("number"!=typeof t||t!=t)throw new TypeError("offset must be a number");if(t>u||t<0)throw new TypeError("offset must be a uint32");if(t>h||t>e)throw new RangeError("offset out of range")}function f(t,e,i){if("number"!=typeof t||t!=t)throw new TypeError("size must be a number");if(t>u||t<0)throw new TypeError("size must be a uint32");if(t+e>i||t>h)throw new RangeError("buffer too small")}function d(t,e,i,s){if(r.browser){var n=t.buffer,a=new Uint8Array(n,e,i);return c.getRandomValues(a),s?void r.nextTick(function(){s(null,t)}):t}if(!s)return o(i).copy(t,e),t;o(i,function(i,r){if(i)return s(i);r.copy(t,e),s(null,t)})}c&&c.getRandomValues||!r.browser?(e.randomFill=function(e,i,r,s){if(!(a.isBuffer(e)||e instanceof t.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"==typeof i)s=i,i=0,r=e.length;else if("function"==typeof r)s=r,r=e.length-i;else if("function"!=typeof s)throw new TypeError('"cb" argument must be a function');return l(i,e.length),f(r,i,e.length),d(e,i,r,s)},e.randomFillSync=function(e,i,r){if(void 0===i&&(i=0),!(a.isBuffer(e)||e instanceof t.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return l(i,e.length),void 0===r&&(r=e.length-i),f(r,i,e.length),d(e,i,r)}):(e.randomFill=s,e.randomFillSync=s)}).call(this,i(12),i(23))},function(t,e,i){const r=i(31);class s extends Error{constructor(t,e,i){super(),this.type="FundingError",this.message=t,this.availableFunds=-1,this.requiredFunds=-1,null!=e&&(this.message+=` (available=${r.btc(e)},`,this.message+=` required=${r.btc(i)})`,this.availableFunds=e,this.requiredFunds=i),Error.captureStackTrace&&Error.captureStackTrace(this,s)}}t.exports=s},function(t,e,i){"use strict";
/*!
 * child.js - child processes for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */i(1);const r=i(24);function s(t){if(!(this instanceof s))return new s(t);r.call(this),this.init(t)}Object.setPrototypeOf(s.prototype,r.prototype),s.hasSupport=function(){return!1},s.prototype.init=function(t){this.child=null},s.prototype.write=function(t){return this.child&&(2===this.child.postMessage.length?(t.__proto__=Uint8Array.prototype,this.child.postMessage({data:t},[t])):this.child.postMessage(t.toString("hex"))),!0},s.prototype.destroy=function(){this.child&&this.child.terminate(),this.emit("exit",143,"SIGTERM")},t.exports=s},function(t,e,i){"use strict";
/*!
 * EnvPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(15),o=i(11),a=i(3);class h extends n{constructor(t){super(),this.env=t||{},this.json=JSON.stringify(this.env),this.cmd=o.ENV}getSize(){return s.sizeVarString(this.json,"utf8")}toWriter(t){return t.writeVarString(this.json,"utf8"),t}fromRaw(t){const e=new r(t,!0);return this.json=e.readVarString("utf8"),this.env=a.parseJson(this.json),this}static fromRaw(t){return(new h).fromRaw(t)}masterHandle(t){t.setEnv(this.env)}}t.exports=h},function(t,e,i){"use strict";(function(e,r){
/*!
 * parent.js - parent worker processes for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const s=i(1),n=i(24);function o(){if(!(this instanceof o))return new o;n.call(this),this.init()}Object.setPrototypeOf(o.prototype,n.prototype),o.prototype.init=function(){e.onerror=(t=>{this.emit("error",new Error("Worker error."))}),e.onmessage=(t=>{let e;"string"==typeof t.data?(e=r.from(t.data,"hex"),s(e.length===t.data.length/2),this.emit("data",e)):(t.data&&"object"==typeof t.data&&t.data.data&&"number"==typeof t.data.data.length&&((e=t.data.data).__proto__=r.prototype),this.emit("data",e))})},o.prototype.write=function(t){return 2===e.postMessage.length?(t.__proto__=Uint8Array.prototype,e.postMessage({data:t},[t])):e.postMessage(t.toString("hex")),!0},o.prototype.destroy=function(){e.close()},t.exports=o}).call(this,i(12),i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * EventPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(11),o=i(15),a=i(3);class h extends o{constructor(t){super(),this.items=t||[],this.json=JSON.stringify(this.items),this.cmd=n.EVENT}getSize(){return s.sizeVarString(this.json,"utf8")}toWriter(t){return t.writeVarString(this.json,"utf8"),t}fromRaw(t){const e=new r(t,!0);return this.json=e.readVarString("utf8"),this.items=a.parseJson(this.json),this}static fromRaw(t){return(new h).fromRaw(t)}workerHandle(t){t.emit("event",this.items),t.emit(...this.items)}masterHandle(t){t.emit("event",this.items),t.emit(...this.items)}}t.exports=h},function(t,e,i){"use strict";
/*!
 * LogPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(11),o=i(15);class a extends o{constructor(t){super(),this.text=t||"",this.cmd=n.LOG}getSize(){return s.sizeVarString(this.text,"utf8")}toWriter(t){return t.writeVarString(this.text,"utf8"),t}fromRaw(t){const e=new r(t,!0);return this.text=e.readVarString("utf8"),this}static fromRaw(t){return(new a).fromRaw(t)}workerHandle(t){t.emit("log",this.text)}}t.exports=a},function(t,e,i){"use strict";
/*!
 * ErrorResultPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(175),s=i(11);class n extends r{constructor(t){super(t),this.cmd=s.ERRORRESULT}static fromRaw(t){return(new n).fromRaw(t)}workerHandle(t){t.rejectJob(this.id,this.error)}}t.exports=n},function(t,e,i){"use strict";
/*!
 * CheckPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(17),n=i(44),o=i(15),a=i(11),{contractStatus:h}=i(8);class c extends o{constructor(t,e,i,r){super(),this.tx=t||null,this.view=e||null,this.flags=null!=i?i:null,this.status=null!=r?r:h.None,this.cmd=a.CHECK}getSize(){return this.tx.getSize()+this.view.getSize(this.tx)+4+4}toWriter(t){return this.tx.toWriter(t),this.view.toWriter(t,this.tx),t.writeI32(null!=this.flags?this.flags:-1),t.writeI32(null!=this.status?this.status:0),t}fromRaw(t){const e=new r(t,!0);return this.tx=s.fromReader(e),this.view=n.fromReader(e,this.tx),this.flags=e.readI32(),-1===this.flags&&(this.flags=null),this.status=e.readI32(),this.status<0&&(this.status=h.None),this}static fromRaw(t){return(new c).fromRaw(t)}jobsHandle(t){return t.check(this.tx,this.view,this.flags,this.status)}}t.exports=c},function(t,e,i){"use strict";
/*!
 * SignPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(51),o=i(46),a=i(15),h=i(11);i(72);class c extends a{constructor(t,e,i,r){super(),this.tx=t||null,this.rings=e||[],this.type=null!=i?i:1,this.except=r||[],this.cmd=h.SIGN}getSize(){let t=0;t+=this.tx.getSize(),t+=this.tx.view.getSize(this.tx),t+=s.sizeVarint(this.rings.length);for(const e of this.rings)t+=e.getSize();return t+=1,(t+=s.sizeVarint(this.except.length))+1*this.except.length}toWriter(t){this.tx.toWriter(t),this.tx.view.toWriter(t,this.tx),t.writeVarint(this.rings.length);for(const e of this.rings)e.toWriter(t);t.writeU8(this.type),t.writeVarint(this.except.length);for(const e of this.except)t.writeU8(e);return t}fromRaw(t){const e=new r(t,!0);this.tx=n.fromReader(e),this.tx.view.fromReader(e,this.tx);const i=e.readVarint();for(let t=0;t<i;t++){const t=o.fromReader(e);this.rings.push(t)}this.type=e.readU8();const s=e.readVarint();for(let t=0;t<s;t++)this.except.push(e.readU8());return this}static fromRaw(t){return(new c).fromRaw(t)}jobsHandle(t){return t.sign(this.tx,this.rings,this.type,this.except)}}t.exports=c},function(t,e,i){"use strict";
/*!
 * SignResultPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(2),n=i(4),o=i(20),a=i(78),h=i(15),c=i(11);class u extends h{constructor(t,e,i){super(),this.total=t||0,this.script=i||[],this.witness=e||[],this.cmd=c.SIGNRESULT}fromTX(t,e){this.total=e;for(const e of t.inputs)this.script.push(e.script),this.witness.push(e.witness);return this}static fromTX(t,e){return(new u).fromTX(t,e)}getSize(){let t=0;t+=n.sizeVarint(this.total),t+=n.sizeVarint(this.script.length);for(let e=0;e<this.script.length;e++){const i=this.script[e],r=this.witness[e];t+=i.getVarSize(),t+=r.getVarSize()}return t}toWriter(t){r(this.script.length===this.witness.length),t.writeVarint(this.total),t.writeVarint(this.script.length);for(let e=0;e<this.script.length;e++)this.script[e].toWriter(t),this.witness[e].toWriter(t);return t}inject(t){r(this.script.length===t.inputs.length),r(this.witness.length===t.inputs.length);for(let e=0;e<t.inputs.length;e++){const i=t.inputs[e];i.script=this.script[e],i.witness=this.witness[e]}}fromRaw(t){const e=new s(t,!0);this.total=e.readVarint();const i=e.readVarint();for(let t=0;t<i;t++)this.script.push(o.fromReader(e)),this.witness.push(a.fromReader(e));return this}static fromRaw(t){return(new u).fromRaw(t)}}t.exports=u},function(t,e,i){"use strict";
/*!
 * CheckInputPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(28),o=i(17),a=i(11),h=i(15),{contractStatus:c}=i(8);class u extends h{constructor(t,e,i,r,s){super(),this.tx=t||null,this.index=e,this.coin=i||null,this.flags=null!=r?r:null,this.status=null!=s?s:c.None,this.cmd=a.CHECKINPUT}getSize(){let t=0;return t+=this.tx.getSize(),t+=s.sizeVarint(this.index),t+=s.sizeVarint(this.coin.value),t+=this.coin.script.getVarSize(),(t+=4)+4}toWriter(t){return this.tx.toWriter(t),t.writeVarint(this.index),t.writeVarint(this.coin.value),this.coin.script.toWriter(t),t.writeI32(null!=this.flags?this.flags:-1),t.writeI32(null!=this.status?this.status:0),t}fromRaw(t){const e=new r(t,!0);return this.tx=o.fromReader(e),this.index=e.readVarint(),this.coin=new n,this.coin.value=e.readVarint(),this.coin.script.fromReader(e),this.flags=e.readI32(),-1===this.flags&&(this.flags=null),this.status=e.readI32(),this.status<0&&(this.status=c.None),this}static fromRaw(t){return(new u).fromRaw(t)}jobsHandle(t){return t.checkInput(this.tx,this.index,this.coin,this.flags,this.status)}}t.exports=u},function(t,e,i){"use strict";
/*!
 * CheckInputResultPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */i(1);const r=i(11),s=i(176);class n extends s{constructor(t){super(t),this.cmd=r.CHECKINPUTRESULT}static fromRaw(t){return(new n).fromRaw(t)}}t.exports=n},function(t,e,i){"use strict";
/*!
 * SignInputPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(28),o=i(51),a=i(46),h=i(15),c=i(11);class u extends h{constructor(t,e,i,r,s){super(),this.tx=t||null,this.index=e,this.coin=i||null,this.ring=r||null,this.type=null!=s?s:1,this.cmd=c.SIGNINPUT}getSize(){let t=0;return t+=this.tx.getSize(),t+=s.sizeVarint(this.index),t+=s.sizeVarint(this.coin.value),t+=this.coin.script.getVarSize(),(t+=this.ring.getSize())+1}toWriter(t){return this.tx.toWriter(t),t.writeVarint(this.index),t.writeVarint(this.coin.value),this.coin.script.toWriter(t),this.ring.toWriter(t),t.writeU8(this.type),t}fromRaw(t){const e=new r(t,!0);return this.tx=o.fromReader(e),this.index=e.readVarint(),this.coin=new n,this.coin.value=e.readVarint(),this.coin.script.fromReader(e),this.ring=a.fromReader(e),this.type=e.readU8(),this}static fromRaw(t){return(new u).fromRaw(t)}jobsHandle(t){return t.signInput(this.tx,this.index,this.coin,this.ring,this.type)}}t.exports=u},function(t,e,i){"use strict";
/*!
 * SignInputResultPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(2),n=i(20),o=i(78),a=i(15),h=i(11);class c extends a{constructor(t,e,i){super(),this.value=t||!1,this.script=i||null,this.witness=e||null,this.cmd=h.SIGNINPUTRESULT}fromTX(t,e,i){const s=t.inputs[e];return r(s),this.value=i,this.script=s.script,this.witness=s.witness,this}static fromTX(t,e,i){return(new c).fromTX(t,e,i)}getSize(){return 1+this.script.getVarSize()+this.witness.getVarSize()}toWriter(t){return t.writeU8(this.value?1:0),this.script.toWriter(t),this.witness.toWriter(t),t}inject(t,e){const i=t.inputs[e];r(i),i.script=this.script,i.witness=this.witness}fromRaw(t){const e=new s(t,!0);return this.value=1===e.readU8(),this.script=n.fromReader(e),this.witness=o.fromReader(e),this}static fromRaw(t){return(new c).fromRaw(t)}}t.exports=c},function(t,e,i){"use strict";
/*!
 * ECVerifyPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(15),o=i(11);class a extends n{constructor(t,e,i){super(),this.msg=t||null,this.sig=e||null,this.key=i||null,this.cmd=o.ECVERIFY}getSize(){let t=0;return t+=s.sizeVarBytes(this.msg),(t+=s.sizeVarBytes(this.sig))+s.sizeVarBytes(this.key)}toWriter(t){return t.writeVarBytes(this.msg),t.writeVarBytes(this.sig),t.writeVarBytes(this.key),t}fromRaw(t){const e=new r(t,!0);return this.msg=e.readVarBytes(),this.sig=e.readVarBytes(),this.key=e.readVarBytes(),this}static fromRaw(t){return(new a).fromRaw(t)}jobsHandle(t){return t.ecVerify(this.msg,this.sig,this.key)}}t.exports=a},function(t,e,i){"use strict";
/*!
 * ECVerifyResultPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(15),n=i(11);class o extends s{constructor(t){super(),this.value=t,this.cmd=n.ECVERIFYRESULT}getSize(){return 1}toWriter(t){return t.writeU8(this.value?1:0),t}fromRaw(t){const e=new r(t,!0);return this.value=1===e.readU8(),this}static fromRaw(t){return(new o).fromRaw(t)}}t.exports=o},function(t,e,i){"use strict";
/*!
 * ECSignPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(15),o=i(11);class a extends n{constructor(t,e){super(),this.msg=t||null,this.key=e||null,this.cmd=o.ECSIGN}getSize(){let t=0;return(t+=s.sizeVarBytes(this.msg))+s.sizeVarBytes(this.key)}toWriter(t){return t.writeVarBytes(this.msg),t.writeVarBytes(this.key),t}fromRaw(t){const e=new r(t,!0);return this.msg=e.readVarBytes(),this.key=e.readVarBytes(),this}static fromRaw(t){return(new a).fromRaw(t)}jobsHandle(t){return t.ecSign(this.msg,this.key)}}t.exports=a},function(t,e,i){"use strict";
/*!
 * ECSignResultPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(15),o=i(11);class a extends n{constructor(t){super(),this.sig=t,this.cmd=o.ECSIGNRESULT}getSize(){return s.sizeVarBytes(this.sig)}toWriter(t){return t.writeVarBytes(this.sig),t}fromRaw(t){const e=new r(t,!0);return this.sig=e.readVarBytes(),this}static fromRaw(t){return(new a).fromRaw(t)}}t.exports=a},function(t,e,i){"use strict";
/*!
 * MinePacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(15),n=i(11);class o extends s{constructor(t,e,i,r){super(),this.data=t||null,this.target=e||null,this.min=null!=i?i:-1,this.max=null!=r?r:-1,this.cmd=n.MINE}getSize(){return 120}toWriter(t){return t.writeBytes(this.data),t.writeBytes(this.target),t.writeU32(this.min),t.writeU32(this.max),t}fromRaw(t){const e=new r(t,!0);return this.data=e.readBytes(80),this.target=e.readBytes(32),this.min=e.readU32(),this.max=e.readU32(),this}static fromRaw(t){return(new o).fromRaw(t)}jobsHandle(t){return t.mine(this.data,this.target,this.min,this.max)}}t.exports=o},function(t,e,i){"use strict";
/*!
 * MineResultPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(15),n=i(11);class o extends s{constructor(t){super(),this.nonce=null!=t?t:-1,this.cmd=n.MINERESULT}getSize(){return 5}toWriter(t){return t.writeU8(-1!==this.nonce?1:0),t.writeU32(this.nonce),t}fromRaw(t){const e=new r(t,!0);return this.nonce=-1,1===e.readU8()&&(this.nonce=e.readU32()),this}static fromRaw(t){return(new o).fromRaw(t)}}t.exports=o},function(t,e,i){"use strict";
/*!
 * ScryptPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(15),o=i(11);class a extends n{constructor(t,e,i,r,s,n){super(),this.passwd=t||null,this.salt=e||null,this.N=null!=i?i:-1,this.r=null!=r?r:-1,this.p=null!=s?s:-1,this.len=null!=n?n:-1,this.cmd=o.SCRYPT}getSize(){let t=0;return t+=s.sizeVarBytes(this.passwd),(t+=s.sizeVarBytes(this.salt))+16}toWriter(t){return t.writeVarBytes(this.passwd),t.writeVarBytes(this.salt),t.writeU32(this.N),t.writeU32(this.r),t.writeU32(this.p),t.writeU32(this.len),t}fromRaw(t){const e=new r(t,!0);return this.passwd=e.readVarBytes(),this.salt=e.readVarBytes(),this.N=e.readU32(),this.r=e.readU32(),this.p=e.readU32(),this.len=e.readU32(),this}static fromRaw(t){return(new a).fromRaw(t)}jobsHandle(t){return t.scrypt(this.passwd,this.salt,this.N,this.r,this.p,this.len)}}t.exports=a},function(t,e,i){"use strict";
/*!
 * ScryptResultPacket.js - worker packets for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(4),n=i(15),o=i(11);class a extends n{constructor(t){super(),this.key=t||null,this.cmd=o.SCRYPTRESULT}getSize(){return s.sizeVarBytes(this.key)}toWriter(t){return t.writeVarBytes(this.key),t}fromRaw(t){const e=new r(t,!0);return this.key=e.readVarBytes(),this}static fromRaw(t){return(new a).fromRaw(t)}}t.exports=a},function(t,e,i){"use strict";(function(e){
/*!
 * chacha20.js - chacha20 for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(47).binding,n=0===new Int8Array(new Int16Array([1]).buffer)[0];function o(){if(!(this instanceof o))return new o;this.state=new Uint32Array(16),this.stream=new Uint32Array(16),this.bytes=new Uint8Array(this.stream.buffer),n&&(this.bytes=e.allocUnsafe(64)),this.pos=0,this.ivSize=0}function a(t,e,i,r,s){t[e]+=t[i],t[s]=h(t[s]^t[e],16),t[r]+=t[s],t[i]=h(t[i]^t[r],12),t[e]+=t[i],t[s]=h(t[s]^t[e],8),t[r]+=t[s],t[i]=h(t[i]^t[r],7)}function h(t,e){return t<<e|t>>>32-e}o.prototype.init=function(t,e,i){t&&this.initKey(t),e&&this.initIV(e,i)},o.prototype.initKey=function(t){this.state[0]=1634760805,this.state[1]=857760878,this.state[2]=2036477234,this.state[3]=1797285236,this.state[4]=t.readUInt32LE(0,!0),this.state[5]=t.readUInt32LE(4,!0),this.state[6]=t.readUInt32LE(8,!0),this.state[7]=t.readUInt32LE(12,!0),this.state[8]=t.readUInt32LE(16,!0),this.state[9]=t.readUInt32LE(20,!0),this.state[10]=t.readUInt32LE(24,!0),this.state[11]=t.readUInt32LE(28,!0),this.state[12]=0,this.pos=4294967295},o.prototype.initIV=function(t,e){8===t.length?(this.state[13]=0,this.state[14]=t.readUInt32LE(0,!0),this.state[15]=t.readUInt32LE(4,!0)):12===t.length?(this.state[13]=t.readUInt32LE(0,!0),this.state[14]=t.readUInt32LE(4,!0),this.state[15]=t.readUInt32LE(8,!0)):r(!1,"Bad iv size."),this.ivSize=8*t.length,this.setCounter(e)},o.prototype.encrypt=function(t){for(let e=0;e<t.length;e++){if(this.pos>=64){for(let t=0;t<16;t++)this.stream[t]=this.state[t];for(let t=0;t<10;t++)a(this.stream,0,4,8,12),a(this.stream,1,5,9,13),a(this.stream,2,6,10,14),a(this.stream,3,7,11,15),a(this.stream,0,5,10,15),a(this.stream,1,6,11,12),a(this.stream,2,7,8,13),a(this.stream,3,4,9,14);for(let t=0;t<16;t++)this.stream[t]+=this.state[t],n&&this.bytes.writeUInt32LE(this.stream[t],4*t,!0);this.state[12]++,0===this.state[12]&&(r(64===this.ivSize,"Counter overflow."),this.state[13]++,r(0!==this.state[13],"Counter overflow.")),this.pos=0}t[e]^=this.bytes[this.pos++]}return t},o.prototype.setCounter=function(t){t||(t=0);const e=t%4294967296,i=(t-e)/4294967296;this.state[12]=e,64===this.ivSize&&(this.state[13]=i)},o.prototype.getCounter=function(){const t=this.state[12],e=this.state[13];return 64===this.ivSize?4294967296*e+t:t},s&&(o=s.ChaCha20),t.exports=o}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * poly1305.js - poly1305 for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(47).binding;function s(){if(!(this instanceof s))return new s;this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.fin=0,this.leftover=0,this.buffer=e.allocUnsafe(16)}s.prototype.init=function(t){const e=t.readUInt16LE(0,!0),i=t.readUInt16LE(2,!0),r=t.readUInt16LE(4,!0),s=t.readUInt16LE(6,!0),n=t.readUInt16LE(8,!0),o=t.readUInt16LE(10,!0),a=t.readUInt16LE(12,!0),h=t.readUInt16LE(14,!0);this.r[0]=8191&e,this.r[1]=8191&(e>>>13|i<<3),this.r[2]=7939&(i>>>10|r<<6),this.r[3]=8191&(r>>>7|s<<9),this.r[4]=255&(s>>>4|n<<12),this.r[5]=n>>>1&8190,this.r[6]=8191&(n>>>14|o<<2),this.r[7]=8065&(o>>>11|a<<5),this.r[8]=8191&(a>>>8|h<<8),this.r[9]=h>>>5&127;for(let t=0;t<10;t++)this.h[t]=0;for(let e=0;e<8;e++)this.pad[e]=t.readUInt16LE(16+2*e,!0);this.leftover=0,this.fin=0},s.prototype.blocks=function(t,e,i){const r=this.fin?0:2048,s=new Uint32Array(10);for(;e>=16;){const n=t.readUInt16LE(i+0,!0),o=t.readUInt16LE(i+2,!0),a=t.readUInt16LE(i+4,!0),h=t.readUInt16LE(i+6,!0),c=t.readUInt16LE(i+8,!0),u=t.readUInt16LE(i+10,!0),l=t.readUInt16LE(i+12,!0),f=t.readUInt16LE(i+14,!0);this.h[0]+=8191&n,this.h[1]+=8191&(n>>>13|o<<3),this.h[2]+=8191&(o>>>10|a<<6),this.h[3]+=8191&(a>>>7|h<<9),this.h[4]+=8191&(h>>>4|c<<12),this.h[5]+=c>>>1&8191,this.h[6]+=8191&(c>>>14|u<<2),this.h[7]+=8191&(u>>>11|l<<5),this.h[8]+=8191&(l>>>8|f<<8),this.h[9]+=f>>>5|r;let d=0;for(let t=0;t<10;t++){s[t]=d;for(let e=0;e<10;e++){let i=this.h[e];i*=e<=t?this.r[t-e]:5*this.r[t+10-e],s[t]+=i,4===e&&(d=s[t]>>>13,s[t]&=8191)}d+=s[t]>>>13,s[t]&=8191}d=(d<<2)+d,d+=s[0],s[0]=8191&d,d>>>=13,s[1]+=d;for(let t=0;t<10;t++)this.h[t]=s[t];i+=16,e-=16}},s.prototype.update=function(t){let e=t.length,i=0;if(this.leftover){let r=16-this.leftover;r>e&&(r=e);for(let e=0;e<r;e++)this.buffer[this.leftover+e]=t[i+e];if(e-=r,i+=r,this.leftover+=r,this.leftover<16)return;this.blocks(this.buffer,16,0),this.leftover=0}if(e>=16){const r=-16&e;this.blocks(t,r,i),i+=r,e-=r}if(e){for(let r=0;r<e;r++)this.buffer[this.leftover+r]=t[i+r];this.leftover+=e}},s.prototype.finish=function(){const t=e.allocUnsafe(16),i=new Uint16Array(10);if(this.leftover){let t=this.leftover;for(this.buffer[t++]=1;t<16;t++)this.buffer[t]=0;this.fin=1,this.blocks(this.buffer,16,0)}let r=this.h[1]>>>13;this.h[1]&=8191;for(let t=2;t<10;t++)this.h[t]+=r,r=this.h[t]>>>13,this.h[t]&=8191;this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,i[0]=this.h[0]+5,r=i[0]>>>13,i[0]&=8191;for(let t=1;t<10;t++)i[t]=this.h[t]+r,r=i[t]>>>13,i[t]&=8191;let s=(1^r)-1;for(let t=0;t<10;t++)i[t]&=s;s=~s;for(let t=0;t<10;t++)this.h[t]=this.h[t]&s|i[t];this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5);let n=this.h[0]+this.pad[0];this.h[0]=n;for(let t=1;t<8;t++)n=this.h[t]+this.pad[t]+(n>>>16),this.h[t]=n;for(let e=0;e<8;e++)t.writeUInt16LE(this.h[e],2*e,!0);for(let t=0;t<10;t++)this.h[t]=0;for(let t=0;t<10;t++)this.r[t]=0;for(let t=0;t<8;t++)this.pad[t]=0;return t},s.auth=function(t,e){const i=new s;return i.init(e),i.update(t),i.finish()},s.verify=function(t,e){let i=0;for(let r=0;r<16;r++)i|=t[r]^e[r];return 0!=(1&i-1>>>31)},r&&(s=r.Poly1305),t.exports=s}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * siphash.js - siphash for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 *
 * Ported from:
 * https://github.com/bitcoin/bitcoin/blob/master/src/hash.cpp
 */const r=i(47).binding;function s(t,e,i){const r=Math.floor(t.length/8),s=u(1936682341,1886610805),n=u(1685025377,1852075885),o=u(1819895653,1852142177),a=u(1952801890,2037671283),h=u(r<<i-32,0),c=u(0,255),f=u.fromRaw(e,0),d=u.fromRaw(e,8),p=s.ixor(f),g=n.ixor(d),m=o.ixor(f),w=a.ixor(d);let y=0;for(let e=0;e<r;e++){const e=u.fromRaw(t,y);y+=8,w.ixor(e),l(p,g,m,w),l(p,g,m,w),p.ixor(e)}switch(7&t.length){case 7:h.hi|=t[y+6]<<16;case 6:h.hi|=t[y+5]<<8;case 5:h.hi|=t[y+4];case 4:h.lo|=t[y+3]<<24;case 3:h.lo|=t[y+2]<<16;case 2:h.lo|=t[y+1]<<8;case 1:h.lo|=t[y]}return w.ixor(h),l(p,g,m,w),l(p,g,m,w),p.ixor(h),m.ixor(c),l(p,g,m,w),l(p,g,m,w),l(p,g,m,w),l(p,g,m,w),p.ixor(g),p.ixor(m),p.ixor(w),[p.hi,p.lo]}function n(t,e,i){const r=u(1936682341,1886610805),s=u(1685025377,1852075885),n=u(1819895653,1852142177),o=u(1952801890,2037671283),a=u(t,e),h=u(0,255),c=u.fromRaw(i,0),f=u.fromRaw(i,8),d=r.ixor(c),p=s.ixor(f),g=n.ixor(c),m=o.ixor(f);return m.ixor(a),l(d,p,g,m),l(d,p,g,m),d.ixor(a),g.ixor(h),l(d,p,g,m),l(d,p,g,m),l(d,p,g,m),l(d,p,g,m),d.ixor(p),d.ixor(g),d.ixor(m),[d.hi,d.lo]}function o(t,e){return s(t,e,56)}function a(t,e){return s(t,e,59)}function h(t,e){return n(0,t,e)[1]}function c(t,e,i){return n(t,e,i)}function u(t,e){if(!(this instanceof u))return new u(t,e);this.hi=0|t,this.lo=0|e}function l(t,e,i,r){t.iadd(e),e.irotl(13),e.ixor(t),t.irotl(32),i.iadd(r),r.irotl(16),r.ixor(i),t.iadd(r),r.irotl(21),r.ixor(t),i.iadd(e),e.irotl(17),e.ixor(i),i.irotl(32)}r&&(o=r.siphash,a=r.siphash256,h=r.siphash32,c=r.siphash64),u.prototype.iadd=function(t){const e=this,i=e.lo+t.lo|0,r=i>>31,s=e.lo>>31,n=t.lo>>31,o=1&(s&n|~r&(s^n)),a=(e.hi+t.hi|0)+o;return e.hi=0|a,e.lo=i,e},u.prototype.ixor=function(t){return this.hi^=t.hi,this.lo^=t.lo,this},u.prototype.irotl=function(t){let e=this.hi,i=this.lo,r=this.hi,s=this.lo;return t<32?(e<<=t,e|=i>>>32-t,i<<=t):(e=i<<t-32,i=0),(t=64-t)<32?(s>>>=t,s|=r<<32-t,r>>>=t):(s=r>>>t-32,r=0),this.hi=e|r,this.lo=i|s,this},u.fromRaw=function(t,e){const i=t.readUInt32LE(e,!0);return new u(t.readUInt32LE(e+4,!0),i)},(e=o).siphash=o,e.siphash256=a,e.siphash32=h,e.siphash64=c,t.exports=e},function(t,e,i){"use strict";(function(e){
/*!
 * mnemonic.js - hd mnemonics for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(9),o=i(120),a=i(93),h=i(117),c=i(6),u=i(2),l=i(4),f=i(402),d=i(201),p=i(404),{languages:g,languageEnum:m}=i(403),w=i(503),y=Object.create(null);class b{constructor(t){this.bits=d.MIN_ENTROPY,this.language=m.English,this.entropy=null,this.phrase=null,this.passphrase="",t&&this.fromOptions(t)}fromOptions(t){return"string"==typeof t&&(t={phrase:t}),null!=t.bits&&(r(s.isU16(t.bits)),r(t.bits>=d.MIN_ENTROPY),r(t.bits<=d.MAX_ENTROPY),r(t.bits%32==0),this.bits=t.bits),t.language&&(r("string"==typeof t.language),r(-1!==g.indexOf(t.language)),this.language=t.language),t.passphrase&&(r("string"==typeof t.passphrase),this.passphrase=t.passphrase),t.phrase?(this.fromPhrase(t.phrase),this):t.entropy?(this.fromEntropy(t.entropy),this):this}static fromOptions(t){return(new b).fromOptions(t)}destroy(){this.bits=d.MIN_ENTROPY,this.language="english",this.entropy&&(o(this.entropy),this.entropy=null),this.phrase=null,this.passphrase=""}toSeed(t){t||(t=this.passphrase),this.passphrase=t;const i=p(this.getPhrase()),r=p("mnemonic"+t);return h.derive(e.from(i,"utf8"),e.from(r,"utf8"),2048,64,"sha512")}getEntropy(){if(!this.entropy){this.entropy=a.randomBytes(this.bits/8);let t=new w;t.seed(t.int());let e=t.randomBytes(this.bits/8);for(let t=0;t<this.entropy.length;t++)this.entropy[t]=this.entropy[t]^e[t]}return r(this.bits/8===this.entropy.length),this.entropy}getPhrase(){if(this.phrase)return this.phrase;const t=this.bits+this.bits/32,i=this.getEntropy(),r=n.sha256(i),s=Math.ceil(t/8),o=e.allocUnsafe(s);i.copy(o,0),r.copy(o,i.length);const a=b.getWordlist(this.language);let h=[];for(let e=0;e<t/11;e++){let t=0;for(let i=0;i<11;i++){const r=11*e+i,s=r%8;t<<=1,t|=o[(r-s)/8]>>>7-s&1}h.push(a.words[t])}return h="japanese"===this.language?h.join("　"):h.join(" "),this.phrase=h,h}fromPhrase(t){r("string"==typeof t),r(t.length<=1e3);const i=t.trim().split(/[\s\u3000]+/),s=11*i.length,o=s%32;r(0!==o,"Invalid checksum.");const a=s-o;r(a>=d.MIN_ENTROPY),r(a<=d.MAX_ENTROPY),r(a%32==0);const h=Math.ceil(s/8),c=e.allocUnsafe(h);c.fill(0);const u=b.getLanguage(i[0]),l=b.getWordlist(u);for(let t=0;t<i.length;t++){const e=i[t],r=l.map[e];if(null==r)throw new Error("Could not find word.");for(let e=0;e<11;e++){const i=11*t+e,s=i%8,n=r>>>10-e&1;c[(i-s)/8]|=n<<7-s}}const f=Math.ceil(o/8),p=c.slice(0,c.length-f),g=c.slice(c.length-f),m=n.sha256(p);for(let t=0;t<o;t++){const e=t%8,i=(t-e)/8;if((g[i]>>>7-e&1)!=(m[i]>>>7-e&1))throw new Error("Invalid checksum.")}return r(a/8===p.length),this.bits=a,this.language=u,this.entropy=p,this.phrase=t,this}static fromPhrase(t){return(new b).fromPhrase(t)}fromEntropy(t,i){return r(e.isBuffer(t)),r(8*t.length>=d.MIN_ENTROPY),r(8*t.length<=d.MAX_ENTROPY),r(8*t.length%32==0),r(!i||-1!==g.indexOf(i)),this.entropy=t,this.bits=8*t.length,i&&(this.language=i),this}static fromEntropy(t,e){return(new b).fromEntropy(t,e)}static getLanguage(t){for(const e of g)if(null!=b.getWordlist(e).map[t])return e;throw new Error("Could not determine language.")}static getWordlist(t){const e=y[t];if(e)return e;const i=new function(t){this.words=t,this.map=Object.create(null);for(let e=0;e<t.length;e++){const i=t[e];this.map[i]=e}}(f.get(t));return y[t]=i,i}toJSON(){return{bits:this.bits,language:this.language,entropy:this.getEntropy().toString("hex"),phrase:this.getPhrase(),passphrase:this.passphrase}}fromJSON(t){return r(s.isU16(t.bits)),r("string"==typeof t.language),r("string"==typeof t.entropy),r("string"==typeof t.phrase),r("string"==typeof t.passphrase),r(t.bits>=d.MIN_ENTROPY),r(t.bits<=d.MAX_ENTROPY),r(t.bits%32==0),r(t.bits/8==t.entropy.length/2),this.bits=t.bits,this.language=t.language,this.entropy=e.from(t.entropy,"hex"),this.phrase=t.phrase,this.passphrase=t.passphrase,this}static fromJSON(t){return(new b).fromJSON(t)}getSize(){let t=0;return t+=3,t+=this.getEntropy().length,(t+=l.sizeVarString(this.getPhrase(),"utf8"))+l.sizeVarString(this.passphrase,"utf8")}toWriter(t){const e=g.indexOf(this.language);return r(-1!==e),t.writeU16(this.bits),t.writeU8(e),t.writeBytes(this.getEntropy()),t.writeVarString(this.getPhrase(),"utf8"),t.writeVarString(this.passphrase,"utf8"),t}toRaw(t){const e=this.getSize();return this.toWriter(new c(e)).render()}fromReader(t){const e=t.readU16();r(e>=d.MIN_ENTROPY),r(e<=d.MAX_ENTROPY),r(e%32==0);const i=g[t.readU8()];return r(i),this.bits=e,this.language=i,this.entropy=t.readBytes(e/8),this.phrase=t.readVarString("utf8"),this.passphrase=t.readVarString("utf8"),this}fromRaw(t){return this.fromReader(new u(t))}static fromReader(t){return(new b).fromReader(t)}static fromRaw(t){return(new b).fromRaw(t)}toString(){return this.getPhrase()}inspect(){return`<Mnemonic: ${this.getPhrase()}>`}static isMnemonic(t){return t instanceof b}}t.exports=b}).call(this,i(0).Buffer)},function(t,e,i){"use strict";e.unsupported=!0},function(t,e,i){"use strict";(function(e,r){
/*!
 * rpc.js - bitcoind-compatible json rpc for gamegold.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const s=i(1),n=i(3),o=i(35),a=i(9),h=i(109),c=i(65),u=i(92),l=i(30),f=i(31),d=i(20),p=i(26),g=i(52),m=i(69),w=i(68),y=i(111),b=i(51),v=i(16),k=i(37),S=i(28),x=i(17),E=i(4),R=i(10),_=i(179),A=i(113),I=A.errors,O=A.MAGIC_STRING,C=i(91),P=i(114),B=(i(180),i(178)),{openapi:T}=i(362);function N(t){for(let e=0;e<t.length;e+=4){const i=t.readUInt32LE(e,!0);t.writeUInt32BE(i,e,!0)}return t}t.exports=class extends A{constructor(t){super(),s(t,"RPC requires a Node."),this.node=t,this.network=t.network,this.workers=t.workers,this.chain=t.chain,this.mempool=t.mempool,this.pool=t.pool,this.fees=t.fees,this.miner=t.miner,this.logger=t.logger.context("rpc"),this.mining=!1,this.procLimit=0,this.attempt=null,this.lastActivity=0,this.boundChain=!1,this.nonce1=0,this.nonce2=0,this.merkleMap=new Map,this.pollers=[],this.init()}init(){this.add("help",this.help),this.add("miner",this.routerOfMiner),this.add("miner.generate",this.generate),this.add("miner.generateto",this.generateToAddress),this.add("miner.set",this.setGenerate),this.add("miner.setsync",this.setSync),this.add("miner.check",this.getGenerate),this.add("miner.difficulty",this.getDifficulty),this.add("block",this.routerOfBlock),this.add("block.best",this.getBestBlockHash),this.add("block.count",this.getBlockCount),this.add("block.info",this.getBlock),this.add("block.entry",this.getBlockEntry),this.add("block.info.byheight",this.getBlockByHeight),this.add("block.hash",this.getBlockHash),this.add("block.header",this.getBlockHeader),this.add("block.template",this.getBlockTemplate),this.add("block.submit",this.submitBlock),this.add("block.verify",this.verifyBlock),this.add("block.invalidate",this.invalidateBlock),this.add("block.reconsider",this.reconsiderBlock),this.add("block.tips",this.getChainTips),this.add("block.tip",this.getChainTip),this.add("block.reset",this.reset),this.add("cp.byClass",this.cpByClass),this.add("address.filter",this.addressFilter),this.add("token.auth",this.authtoken),this.add("order.query",this.queryOrder),this.add("tx",this.routerOfTx),this.add("tx.raw.get",this.getRawTransaction),this.add("tx.raw.decode",this.decodeRawTransaction),this.add("tx.raw.create",this.createRawTransaction),this.add("tx.raw.send",this.sendRawTransaction),this.add("tx.raw.sign",this.signRawTransaction),this.add("tx.get",this.getTXByHash),this.add("tx.list.address",this.getTXByAddress),this.add("tx.list.addresses",this.getTXByAddresses),this.add("tx.broadcast",this.broadcast),this.add("tx.prioritise",this.prioritiseTransaction),this.add("tx.txo",this.getTXOut),this.add("tx.txo.proof",this.getTXOutProof),this.add("tx.txo.verifyproof",this.verifyTXOutProof),this.add("tx.coins",this.getCoins),this.add("tx.coins.byoutpoint",this.getCoinByOutpoint),this.add("sys",this.routerOfSys),this.add("sys.info",this.getInfo),this.add("sys.blockinfo",this.getBlockchainInfo),this.add("sys.peerinfo",this.getPeerInfo),this.add("sys.networkinfo",this.getNetworkInfo),this.add("sys.memoryinfo",this.getMemoryInfo),this.add("sys.mempoolinfo",this.getMempoolInfo),this.add("sys.mininginfo",this.getMiningInfo),this.add("sys.addednodeinfo",this.getAddedNodeInfo),this.add("sys.txoinfo",this.getTXOutSetInfo),this.add("sys.connectioncount",this.getConnectionCount),this.add("sys.disconnectnode",this.disconnectNode),this.add("sys.nettotals",this.getNetTotals),this.add("sys.prune",this.pruneBlockchain),this.add("sys.ping",this.ping),this.add("sys.setloglevel",this.setLogLevel),this.add("sys.setban",this.setBan),this.add("sys.listbanned",this.listBanned),this.add("sys.clearbanned",this.clearBanned),this.add("sys.addnode",this.addNode),this.add("sys.hashrate",this.getNetworkHashPS),this.add("sys.work",this.getWork),this.add("sys.worklp",this.getWorkLongpoll),this.add("sys.setmocktime",this.setMockTime),this.add("sys.message.verify",this.verifyMessage),this.add("sys.message.signk",this.signMessageWithPrivkey),this.add("sys.stop",this.stop),this.add("sys.decodescript",this.decodeScript),this.add("sys.validateaddress",this.validateAddress),this.add("sys.createmultisig",this.createMultisig),this.add("sys.createwitnessaddress",this.createWitnessAddress),this.add("sys.testlist",this.testlist),this.add("estimate",this.routerOfEstimate),this.add("estimate.fee",this.estimateFee),this.add("estimate.smartfee",this.estimateSmartFee),this.add("estimate.priority",this.estimatePriority),this.add("estimate.smartpriority",this.estimateSmartPriority),this.add("mempool",this.routerOfMempool),this.add("mempool.info",this.getMempoolInfo),this.add("mempool.ancestors",this.getMempoolAncestors),this.add("mempool.descendants",this.getMempoolDescendants),this.add("mempool.entry",this.getMempoolEntry),this.add("mempool.raw",this.getRawMempool),this.add("mempool.snap",this.getMempool),Object.values(T).map(t=>{this.add(t.name,async(e,i)=>await this.node.conn_s2local.execute(t.name,e))})}get wallet(){return null}set wallet(t){}async routerOfMiner(t){throw new C(I.MISC_ERROR,"\n      miner.generate        生产一个区块\n      miner.generateto      生产一个区块，发送奖励到指定地址\n      miner.set             设置矿机运行状态\n      miner.setsync         设置块链同步完成\n      miner.check           检查矿机运行状态\n      miner.difficulty      检查当前挖矿难度\n    ")}async routerOfBlock(t){throw new C(I.MISC_ERROR,"\n      block.best              获取当前主链顶部区块哈希(小端)\n      block.count             获取当前主链区块数量\n      block.info              查询区块内容\n      block.info.byheight     根据高度查询区块内容\n      block.hash              根据高度查询区块哈希(小端)\n      block.header            根据哈希(小端)查询区块头\n      block.template          生成或校验区块数据模板\n      block.submit            提交区块数据\n      block.verify            校验区块数据\n      block.invalidate        标记区块无效\n      block.reconsider        取消区块无效标记\n      block.tips              列表所有分叉的头部信息\n      block.reset             重置区块头至指定区块\n    ")}async routerOfMempool(t){throw new C(I.MISC_ERROR,"\n      mempool.info            查看交易池概要信息\n      mempool.ancestors       向前搠源交易池中指定交易\n      mempool.descendants     向后搠源交易池中指定交易\n      mempool.entry           查询交易记录\n      mempool.raw             查询交易池中原始数据\n      mempool.snap            查询交易池中原始数据\n    ")}async routerOfEstimate(t){throw new C(I.MISC_ERROR,"\n      estimate.fee            评估费用\n      estimate.smartfee       评估智能费用\n      estimate.priority       评估优先权\n      estimate.smartpriority  评估智能优先权\n    ")}async routerOfSys(t){throw new C(I.MISC_ERROR,"\n      sys.info            查询系统概要信息\n      sys.blockinfo       查询块链概要信息\n      sys.memoryinfo      查询交易池概要信息\n      sys.networkinfo     查询网络概要信息\n      sys.nettotals       查询网速概要\n      sys.peerinfo        查询对等节点概要信息\n      sys.mininginfo      查询矿机概要信息\n      sys.txoinfo         查询TXO概要信息\n      sys.prune           修剪块链数据\n      sys.ping            PING所有管道\n      sys.setloglevel     设置日志等级\n      sys.setban          禁止管道\n      sys.listbanned      列表已禁管道\n      sys.clearbanned     清除已禁管道\n      sys.addnode         添加管道\n      sys.addednodeinfo   查询管道信息\n      sys.connectioncount 查询连接数\n      sys.disconnectnode  断开管道\n      sys.hashrate        查询网络哈希速率\n      sys.work            获取工作量\n      sys.worklp          获取工作量\n      sys.setmocktime     修改网络时间戳\n      sys.message.sign    签署网络消息\n      sys.message.signk   指定私钥签署网络消息\n      sys.message.verify  验证网络消息\n      sys.stop            停止节点运行\n      sys.decodescript    解码脚本\n      sys.validateaddress 校验地址\n      sys.zap             移除超龄挂起交易\n      sys.createmultisig  生成多签脚本\n      sys.walletdb.stop   停止钱包数据库的运行\n      sys.walletdb.create 重新创立钱包数据库\n      sys.walletdb.destroy      新增RPC指令：彻底删除钱包数据库\n      sys.createwitnessaddress  生成见证地址\n      sys.groupPrefix     添加ACL前缀成员\n      sys.groupSuffix     添加ACL后缀成员\n      sys.notify          通知(钱包)\n      sys.listNotify      查询通知列表(钱包)\n    ")}async routerOfTx(t){throw new C(I.MISC_ERROR,"\n      tx.raw.get              获取交易原始数据\n      tx.raw.decode           解码交易原始数据\n      tx.raw.create           创建交易，返回交易原始数据\n      tx.raw.send             发送交易数据返回交易ID\n      tx.raw.sign             签署交易\n      tx.get                  查询交易记录\n      tx.list.address         按地址查询交易列表\n      tx.list.addresses       按地址列表查询交易列表\n      tx.broadcast            广播交易\n      tx.prioritise           优化交易池中的交易\n      tx.txo                  查询TXO信息\n      tx.coins                查询硬币信息\n      tx.coins.byoutpoint     查询硬币信息\n      tx.txo.proof            查询TXO工作量信息\n      tx.txo.verifyproof      校验TXO工作量信息\n      tx.get.wallet           查询交易记录(钱包)\n      tx.list                 交易列表(钱包)\n      tx.sign                 签署交易(钱包)\n      tx.create               创建交易(钱包)\n      tx.send                 发送交易(钱包)\n      tx.last                 最近的交易\n      tx.abandon              丢弃指定交易\n      tx.sendfrom             指定账号，创建并发送交易\n      tx.sendto               创建并发送交易到指定地址\n      tx.sendmany             指定账号，创建并发送交易至多个地址\n      tx.resendall            重发所有钱包的挂起交易\n      tx.penging              查询挂起交易\n      tx.importprunedfunds    导入修剪资金\n      tx.removeprunedfunds    移除已导入修剪资金\n      tx.resend               重发当前钱包的挂起交易\n      tx.range                范围查询\n      tx.history              查询历史交易\n      tx.history.since        查询指定日期后的历史交易\n      tx.fund                 填充资金\n    ")}async getInfo(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.info");const i=this.mempool?this.mempool.map.size:0,r=this.mempool?this.mempool.getSize():0;let s=this.pool.hosts.getLocal();return s||(s=this.pool.hosts.address),{version:P.version,testnet:this.network!==v.main,paytxfee:f.btc(this.network.feeRate,!0),relayfee:f.btc(this.network.minRelay,!0),network:this.network.type,chain:{height:this.chain.height,tip:this.chain.tip.rhash(),progress:this.chain.getProgress(),difficulty:u.bits2Diff(this.chain.tip.bits)},mempool:{tx:i,size:r},time:{uptime:this.node.uptime(),system:n.now(),adjusted:this.network.now(),offset:this.network.time.offset},memory:n.memoryUsage(),pool:{host:s.host,port:s.port,agent:this.pool.options.agent,protocolversion:this.pool.options.version,services:this.pool.options.services.toString(2),outbound:this.pool.peers.outbound,inbound:this.pool.peers.inbound,connections:this.pool.peers.size()},walletversion:0,balance:0,proxy:"",keypoololdest:0,keypoolsize:0,unlocked_until:0,errors:""}}async help(t){if(0===t.length)throw new C(I.MISC_ERROR,"\n        miner         挖矿相关\n        block         区块相关\n        cp            实体管理\n        prop          道具相关\n        contract      合同相关\n        tx            交易相关\n        sys           系统管理和状态监控\n        estimate      评估\n        mempool       交易池\n        wallet        钱包\n        key           密钥管理\n        account       账户管理\n        adress        地址管理\n        coin          硬币管理\n      ");const e={method:t[0],params:[]};return await this.execute(e,!0)}async broadcast(t,e){const i=new _([t]).buf(0);s(i,"TX is required.");const r=x.fromRaw(i);return await this.node.sendTX(r),!0}async authtoken(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,"token.auth clientNoList: 制备令牌固定量 终端编码列表");let i=new _([t]).str(0);if(i&&"string"==typeof i){this.logger.info("print hmac token:"),i=i.split(","),Array.isArray(i)||(i=[i]);let t=[];for(let e of i){let{token:i}=await B.fromKey(E.ONE_HASH,this.node.hmacSalt).getHMAC(n.hashInt(e.toString()));t.push({cid:e,token:i})}return t}return null}async queryOrder(t,e){if(e||2!==t.length)throw new C(I.MISC_ERROR,"order.query clientNo sn: 查询订单 终端编码 订单编码");const i=new _([t]);let r=i.str(0,""),s=i.array(1,[]);return await this.node.chain.db.getOrder(r,s)}async cpByClass(t,e){if(e||t.length<1||t.length>3)throw new C(I.MISC_ERROR,"cp.byclass cls: 查询CP编码集合 游戏类别 页码 页宽");const i=new _([t]),r=i.str(0,"");let s={page:i.uint(1,1),pageSize:i.uint(2,10),pageCount:0,cls:r};return{list:this.node.cpList.getCPList([],s),page:s.page,total:s.pageCount}}async addressFilter(t,e){if(e||t.length<3)throw new C(I.MISC_ERROR,"address.filter cls amount time (pageNo pageSize): 查询地址集合 游戏类别 消费额阀值 距今最大时间(单位秒) (页码 页宽)");const i=new _([t]);let r={cls:i.str(0)?i.str(0):null,amount:i.uint(1,null),time:i.uint(2,null),page:i.uint(3,1),pageSize:i.uint(4,50)};return await this.node.chain.db.getAddressesFromOrder(r)}async reset(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,"block.reset [hash | height]: 重置区块头 [区块高度 | 区块哈希]");let i=new _([t]).str(0);return s(i,"Height is required."),64!==i.length&&(i=parseInt(i,10)),await this.chain.reset(i),this.logger.info("Chain has been reset: %s.",i),!0}async stop(t,i){if(i||0!==t.length)throw new C(I.MISC_ERROR,"sys.stop");return this.node.close().catch(t=>{e(()=>{throw t})}),"Stopping."}async getNetworkInfo(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.networkinfo");const i=this.pool.hosts,r=[];for(const t of i.local.values())r.push({address:t.addr.host,port:t.addr.port,score:t.score});return{version:P.version,subversion:this.pool.options.agent,protocolversion:this.pool.options.version,localservices:n.hex32(this.pool.options.services),localrelay:!this.pool.options.noRelay,timeoffset:this.network.time.offset,networkactive:this.pool.connected,connections:this.pool.peers.size(),networks:[],relayfee:f.btc(this.network.minRelay,!0),incrementalfee:0,localaddresses:r,warnings:""}}async addNode(t,e){if(e||2!==t.length)throw new C(I.MISC_ERROR,'sys.addnode "node" "add|remove|onetry"');const i=new _([t]),r=i.str(0,"");switch(i.str(1,"")){case"add":this.pool.hosts.addNode(r);case"onetry":{const t=A.parseNetAddress(r,this.network);if(!this.pool.peers.get(t.hostname)){const e=this.pool.createOutbound(t);this.pool.peers.add(e)}break}case"remove":this.pool.hosts.removeNode(r)}return null}async disconnectNode(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,'sys.disconnectnode "node"');const i=new _([t]).str(0,""),r=A.parseIP(i,this.network),s=this.pool.peers.get(r.hostname);return s&&s.destroy(),null}async getAddedNodeInfo(t,e){if(e||t.length>1)throw new C(I.MISC_ERROR,'sys.addednodeinfo ( "node" )');const i=this.pool.hosts,r=new _([t]).str(0,"");let s;1===t.length&&(s=A.parseIP(r,this.network));const n=[];for(const t of i.nodes){if(s){if(t.host!==s.host)continue;if(t.port!==s.port)continue}const e=this.pool.peers.get(t.hostname);e&&e.connected?n.push({addednode:t.hostname,connected:e.connected,addresses:[{address:e.hostname(),connected:e.outbound?"outbound":"inbound"}]}):n.push({addednode:t.hostname,connected:!1,addresses:[]})}if(s&&0===n.length)throw new C(I.CLIENT_NODE_NOT_ADDED,"Node has not been added.");return n}async getConnectionCount(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.connectioncount");return this.pool.peers.size()}async getNetTotals(t,e){if(e||t.length>0)throw new C(I.MISC_ERROR,"sys.nettotals");let i=0,r=0;for(let t=this.pool.peers.head();t;t=t.next)i+=t.socket.bytesWritten,r+=t.socket.bytesRead;return{totalbytesrecv:r,totalbytessent:i,timemillis:n.ms()}}async getPeerInfo(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.peerinfo");const i=[];for(let t=this.pool.peers.head();t;t=t.next){let e=this.network.time.known.get(t.hostname());const r=[];null==e&&(e=0);for(const e in t.blockMap.keys()){const t=n.revHex(e);r.push(t)}i.push({id:t.id,addr:t.hostname(),addrlocal:t.local.isNull()?void 0:t.local.hostname,services:n.hex32(t.services),relaytxes:!t.noRelay,lastsend:t.lastSend/1e3|0,lastrecv:t.lastRecv/1e3|0,bytessent:t.socket.bytesWritten,bytesrecv:t.socket.bytesRead,conntime:0!==t.time?(n.ms()-t.time)/1e3|0:0,timeoffset:e,pingtime:-1!==t.lastPong?(t.lastPong-t.lastPing)/1e3:-1,minping:-1!==t.minPing?t.minPing/1e3:-1,version:t.version,subver:t.agent,inbound:!t.outbound,startingheight:t.height,besthash:t.bestHash?n.revHex(t.bestHash):null,bestheight:t.bestHeight,banscore:t.banScore,inflight:r,whitelisted:!1})}return i}async ping(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.ping");for(let t=this.pool.peers.head();t;t=t.next)t.sendPing();return null}async setBan(t,e){const i=new _([t]),r=i.str(0,""),s=i.str(1,"");if(e||t.length<2||"add"!==s&&"remove"!==s)throw new C(I.MISC_ERROR,'sys.setban "ip(/netmask)" "add|remove" (bantime) (absolute)');const n=A.parseNetAddress(r,this.network);switch(s){case"add":this.pool.ban(n);break;case"remove":this.pool.unban(n)}return null}async listBanned(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.listbanned");const i=[];for(const[t,e]of this.pool.hosts.banned)i.push({address:t,banned_until:e+this.pool.options.banTime,ban_created:e,ban_reason:""});return i}async clearBanned(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.clearbanned");return this.pool.hosts.clearBanned(),null}async getBlockchainInfo(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.blockinfo");return{chain:"testnet"!==this.network.type?this.network.type:"test",blocks:this.chain.height,headers:this.chain.height,bestblockhash:this.chain.tip.rhash(),difficulty:u.bits2Diff(this.chain.tip.bits),mediantime:await this.chain.getMedianTime(this.chain.tip),verificationprogress:this.chain.getProgress(),chainwork:this.chain.tip.chainwork.toString("hex",64),pruned:this.chain.options.prune,softforks:this.getSoftforks(),bip9_softforks:await this.getBIP9Softforks(),pruneheight:this.chain.options.prune?Math.max(0,this.chain.height-this.network.block.keepBlocks):null}}async getBestBlockHash(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"block.best: 获取当前主链顶部区块哈希(小端)");return this.chain.tip.rhash()}async getBlockCount(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"block.count: 获取当前主链区块数量");return this.chain.tip.height}async getBlockEntry(t,e){const i=new _([t]).numhash(0);if(null==i)throw new Error("Invalid parameter.");const r=await this.chain.getEntry(i);return r&&await this.chain.isMainChain(r)?r.toRaw():null}async getBlock(t,e){if(e||t.length<1||t.length>3)throw new C(I.MISC_ERROR,"block.info hash ( bool-verbose bool-details ): 查询区块内容 大端哈希 (展开为对象 更多细节)");const i=new _([t]),r=i.hash(0),s=i.bool(1,!0),n=i.bool(2,!1);if(!r)throw new C(I.TYPE_ERROR,"Invalid block hash.");const o=await this.chain.getEntry(r);if(!o)throw new C(I.MISC_ERROR,"Block not found");const a=await this.chain.getBlock(o.hash);if(!a){if(this.chain.options.spv)throw new C(I.MISC_ERROR,"Block not available (spv mode)");if(this.chain.options.prune)throw new C(I.MISC_ERROR,"Block not available (pruned data)");throw new C(I.MISC_ERROR,"Can't read block from disk")}return s?await this.blockToJSON(o,a,n):a.toRaw().toString("hex")}async getBlockByHeight(t,e){if(e||t.length<1||t.length>3)throw new C(I.MISC_ERROR,'block.info.byheight "height" ( bool-verbose bool-details ): 根据高度查询区块 高度 (展开为对象 更多细节)');const i=new _([t]),r=i.u32(0,-1),s=i.bool(1,!0),n=i.bool(2,!1);if(-1===r)throw new C(I.TYPE_ERROR,"Invalid block height.");const o=await this.chain.getEntry(r);if(!o)throw new C(I.MISC_ERROR,"Block not found");const a=await this.chain.getBlock(o.hash);if(!a){if(this.chain.options.spv)throw new C(I.MISC_ERROR,"Block not available (spv mode)");if(this.chain.options.prune)throw new C(I.MISC_ERROR,"Block not available (pruned data)");throw new C(I.DATABASE_ERROR,"Can't read block from disk")}return s?await this.blockToJSON(o,a,n):a.toRaw().toString("hex")}async getBlockHash(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,"block.hash height: 根据高度查询区块哈希(小端)");const i=new _([t]).u32(0);if(null==i||i>this.chain.height)throw new C(I.INVALID_PARAMETER,"Block height out of range.");const r=await this.chain.getHash(i);if(!r)throw new C(I.MISC_ERROR,"Not found.");return n.revHex(r)}async getCoinByOutpoint(t,e){if(e||2!=t.length)throw new C(I.MISC_ERROR,"tx.coins.byoutpoint txid index: 查询硬币列表 交易ID 交易内索引");const i=new _([t]),r=i.hash(0),n=i.u32(1);s(r,"Hash is required."),s(null!=n,"Index is required."),s(!this.chain.options.spv,"Cannot get coins in SPV mode.");const o=await this.node.getCoin(r,n);return o?o.getJSON(this.network):null}async getCoins(t,e){if(e||1!=t.length)throw new C(I.MISC_ERROR,"tx.coins addr: 查询硬币列表 地址");const i=new _([t]).str(0,"");s(i,"Address is required."),s(!this.chain.options.spv,"Cannot get coins in SPV mode.");const r=await this.node.getCoinsByAddress(i.split(",")),n=[];for(const t of r)n.push(t.getJSON(this.network));return n}async getBlockHeader(t,e){if(e||t.length<1||t.length>2)throw new C(I.MISC_ERROR,'block.header "hash" ( verbose ): 查询区块头 哈希(小端) (展开为对象)');const i=new _([t]),r=i.hash(0),s=i.bool(1,!0);if(!r)throw new C(I.MISC_ERROR,"Invalid block hash.");const n=await this.chain.getEntry(r);if(!n)throw new C(I.MISC_ERROR,"Block not found");return s?await this.headerToJSON(n):n.toRaw().toString("hex",0,80)}getChainTip(t,e){return this.chain.tip.toRaw()}async getChainTips(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"block.tips: 列表所有分叉的头部信息");const i=await this.chain.getTips(),r=[];for(const t of i){const e=await this.chain.getEntry(t);s(e);const i=await this.findFork(e),n=await this.chain.isMainChain(e);r.push({height:e.height,hash:e.rhash(),branchlen:e.height-i.height,status:n?"active":"valid-headers"})}return r}async getDifficulty(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"miner.difficulty: 查看当前挖矿难度");return u.bits2Diff(this.chain.tip.bits)}async getMempoolInfo(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.mempoolinfo");if(!this.mempool)throw new C(I.MISC_ERROR,"No mempool available.");return{size:this.mempool.map.size,bytes:this.mempool.getSize(),usage:this.mempool.getSize(),maxmempool:this.mempool.options.maxSize,mempoolminfee:f.btc(this.mempool.options.minRelay,!0)}}async getMempoolAncestors(t,e){if(e||t.length<1||t.length>2)throw new C(I.MISC_ERROR,"mempool.ancestors txid (bool-verbose): 向前搠源 交易哈希小端 [展开为对象]");const i=new _([t]),r=i.hash(0),s=i.bool(1,!1);if(!this.mempool)throw new C(I.MISC_ERROR,"No mempool available.");if(!r)throw new C(I.TYPE_ERROR,"Invalid TXID.");const n=this.mempool.getEntry(r);if(!n)throw new C(I.MISC_ERROR,"Transaction not in mempool.");const o=this.mempool.getAncestors(n),a=[];if(s)for(const t of o)a.push(this.entryToJSON(t));else for(const t of o)a.push(t.txid());return a}async getMempoolDescendants(t,e){if(e||t.length<1||t.length>2)throw new C(I.MISC_ERROR,"mempool.descendants txid (bool-verbose): 向后搠源 交易哈希小端 [展开为对象]");const i=new _([t]),r=i.hash(0),s=i.bool(1,!1);if(!this.mempool)throw new C(I.MISC_ERROR,"No mempool available.");if(!r)throw new C(I.TYPE_ERROR,"Invalid TXID.");const n=this.mempool.getEntry(r);if(!n)throw new C(I.MISC_ERROR,"Transaction not in mempool.");const o=this.mempool.getDescendants(n),a=[];if(s)for(const t of o)a.push(this.entryToJSON(t));else for(const t of o)a.push(t.txid());return a}async getMempoolEntry(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,"mempool.entry txid: 查询交易记录");const i=new _([t]).hash(0);if(!this.mempool)throw new C(I.MISC_ERROR,"No mempool available.");if(!i)throw new C(I.TYPE_ERROR,"Invalid TXID.");const r=this.mempool.getEntry(i);if(!r)throw new C(I.MISC_ERROR,"Transaction not in mempool.");return this.entryToJSON(r)}async getMempool(t,e){if(e||t.length>0)throw new C(I.MISC_ERROR,"mempool.snap: 查询交易池原始记录");s(this.mempool,"No mempool available.");const i=this.mempool.getSnapshot(),r=[];for(const t of i)r.push(n.revHex(t));return r}async getRawMempool(t,e){if(e||t.length>1)throw new C(I.MISC_ERROR,"mempool.raw ( bool-verbose ): 查询交易池原始记录 [展开为对象]");const i=new _([t]).bool(0,!1);if(!this.mempool)throw new C(I.MISC_ERROR,"No mempool available.");if(i){const t={};for(const e of this.mempool.map.values())t[e.txid()]=this.entryToJSON(e);return t}return this.mempool.getSnapshot().map(n.revHex)}async getTXOut(t,e){if(e||t.length<2||t.length>3)throw new C(I.MISC_ERROR,'tx.txo "txid" n ( includemempool )');const i=new _([t]),r=i.hash(0),s=i.u32(1),n=i.bool(2,!0);if(this.chain.options.spv)throw new C(I.MISC_ERROR,"Cannot get coins in SPV mode.");if(this.chain.options.prune)throw new C(I.MISC_ERROR,"Cannot get coins when pruned.");if(!r||null==s)throw new C(I.TYPE_ERROR,"Invalid outpoint.");let o;if(n){if(!this.mempool)throw new C(I.MISC_ERROR,"No mempool available.");o=this.mempool.getCoin(r,s)}return o||(o=await this.chain.getCoin(r,s)),o?{bestblock:this.chain.tip.rhash(),confirmations:o.getDepth(this.chain.height),value:f.btc(o.value,!0),scriptPubKey:this.scriptToJSON(o.script,!0),version:o.version,coinbase:o.coinbase}:null}async getTXOutProof(t,e){if(e||1!==t.length&&2!==t.length)throw new C(I.MISC_ERROR,'tx.txo.proof ["txid",...] ( blockhash )');const i=new _([t]),r=i.array(0),s=i.hash(1);if(this.chain.options.spv)throw new C(I.MISC_ERROR,"Cannot get coins in SPV mode.");if(this.chain.options.prune)throw new C(I.MISC_ERROR,"Cannot get coins when pruned.");if(!r||0===r.length)throw new C(I.INVALID_PARAMETER,"Invalid TXIDs.");const n=new _([r]),o=new Set,a=[];let h=null;for(let t=0;t<r.length;t++){const e=n.hash(t);if(!e)throw new C(I.TYPE_ERROR,"Invalid TXID.");if(o.has(e))throw new C(I.INVALID_PARAMETER,"Duplicate txid.");o.add(e),a.push(e),h=e}let c=null;if(s)c=await this.chain.getBlock(s);else if(this.chain.options.indexTX){const t=await this.chain.getMeta(h);t&&(c=await this.chain.getBlock(t.block))}else{const t=await this.chain.getCoin(h,0);t&&(c=await this.chain.getBlock(t.height))}if(!c)throw new C(I.MISC_ERROR,"Block not found.");for(const t of a)if(!c.hasTX(t))throw new C(I.VERIFY_ERROR,"Block does not contain all txids.");return(c=y.fromHashes(c,a)).toRaw().toString("hex")}async verifyTXOutProof(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,'tx.txo.verifyproof "proof"');const i=new _([t]).buf(0);if(!i)throw new C(I.TYPE_ERROR,"Invalid hex string.");const r=y.fromRaw(i);if(!r.verify())return[];if(!await this.chain.getEntry(r.hash("hex")))throw new C(I.MISC_ERROR,"Block not found in chain.");const s=r.getTree(),o=[];for(const t of s.matches)o.push(n.revHex(t.toString("hex")));return o}async getTXOutSetInfo(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.txoinfo");if(this.chain.options.spv)throw new C(I.MISC_ERROR,"Chainstate not available (SPV mode).");return{height:this.chain.height,bestblock:this.chain.tip.rhash(),transactions:this.chain.db.state.tx,txouts:this.chain.db.state.coin,bytes_serialized:0,hash_serialized:0,total_amount:f.btc(this.chain.db.state.value,!0)}}async pruneBlockchain(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.prune: 修剪块链数据");if(this.chain.options.spv)throw new C(I.MISC_ERROR,"Cannot prune chain in SPV mode.");if(this.chain.options.prune)throw new C(I.MISC_ERROR,"Chain is already pruned.");if(this.chain.height<this.network.block.pruneAfterHeight)throw new C(I.MISC_ERROR,"Chain is too short for pruning.");try{await this.chain.prune()}catch(t){throw new C(I.DATABASE_ERROR,t.message)}}async verifyChain(t,e){if(e||t.length>2)throw new C(I.MISC_ERROR,"block.verify ( checklevel numblocks ): 检测块链数据(功能未实现)");const i=new _([t]),r=i.u32(0),s=i.u32(1);if(null==r||null==s)throw new C(I.TYPE_ERROR,"Missing parameters.");if(this.chain.options.spv)throw new C(I.MISC_ERROR,"Cannot verify chain in SPV mode.");if(this.chain.options.prune)throw new C(I.MISC_ERROR,"Cannot verify chain when pruned.");return null}async submitWork(t){const e=await this.locker.lock();try{return await this._submitWork(t)}finally{e()}}async _submitWork(t){const e=this.attempt;if(!e)return!1;if(128!==t.length)throw new C(I.INVALID_PARAMETER,"Invalid work size.");const i=t.slice(0,80);N(i);const r=m.fromHead(i);if(r.prevBlock!==e.prevBlock||r.bits!==e.bits)return!1;if(!r.verify())return!1;const s=this.merkleMap.get(r.merkleRoot);if(!s)return!1;const[n,o]=s,a=r.nonce,h=r.time,c=e.getProof(n,o,h,a);if(!c.verify(e.target))return!1;const u=e.commit(c);let l;try{l=await this.chain.add(u)}catch(t){if("VerifyError"===t.type)return this.logger.warning("RPC block rejected: %s (%s).",u.rhash(),t.reason),!1;throw t}return!!l||(this.logger.warning("RPC block rejected: %s (bad-prevblk).",u.rhash()),!1)}async createWork(t){const e=await this.locker.lock();try{return await this._createWork(t)}finally{e()}}async _createWork(){const t=await this.updateWork(),e=this.nonce1,i=this.nonce2,s=t.time,n=r.allocUnsafe(128);n.fill(0);const o=t.getRoot(e,i);return t.getHeader(o,s,0).copy(n,0),n[80]=128,n.writeUInt32BE(640,n.length-4,!0),N(n),{data:n.toString("hex"),target:t.target.toString("hex"),height:t.height}}async getWorkLongpoll(t,e){if(e||0!=t.length)throw new C(I.MISC_ERROR,"sys.worklp");return await this.longpoll(),await this.createWork()}async getWork(t,e){if(e||t.length>1)throw new C(I.MISC_ERROR,'sys.work ( "data" )');if(1===t.length){const e=new _([t]).buf(0);if(!e)throw new C(I.TYPE_ERROR,"Invalid work data.");return await this.submitWork(e)}return await this.createWork()}async submitBlock(t,e){if(e||t.length<1||t.length>2)throw new C(I.MISC_ERROR,'block.submit "hexdata" ( "jsonparametersobject" ): 提交区块数据 区块数据HEX串');const i=new _([t]).buf(0),r=g.fromRaw(i);return await this.addBlock(r)}async getBlockTemplate(t,e){if(e||t.length>1)throw new C(I.MISC_ERROR,"block.template ( \"{'mode':'template | proposal', 'data': '{hex}', 'rules':['segwit']}\" ): 生成或校验区块数据模板");const i=new _([t]).obj(0,{}),r=new _([i]),s=r.str("mode","template");if("template"!==s&&"proposal"!==s)throw new C(I.INVALID_PARAMETER,"Invalid mode.");if("proposal"===s){const e=r.buf("data");if(!e)throw new C(I.TYPE_ERROR,"Missing data parameter.");const i=g.fromRaw(e);if(i.prevBlock!==this.chain.tip.hash)return"inconclusive-not-best-prevblk";try{await this.chain.verifyBlock(i)}catch(t){if("VerifyError"===t.type)return t.reason;throw t}return null}let n=r.u32("maxversion",-1),o=r.array("rules");o&&(n=-1);const a=r.array("capabilities");let h=!1;if(a){let t=!1,e=!1;for(const i of a){if("string"!=typeof i)throw new C(I.TYPE_ERROR,"Invalid capability.");switch(i){case"coinbasetxn":t=!0;break;case"coinbasevalue":e=!0}}if(e=!0,t&&!e){if(0===this.miner.addresses.length)throw new C(I.MISC_ERROR,"No addresses available for coinbase.");h=!0}}const c=r.str("longpollid");return c&&await this.handleLongpoll(c),o||(o=[]),await this.createTemplate(n,h,o)}async createTemplate(t,e,i){const r=await this.locker.lock();try{return await this._createTemplate(t,e,i)}finally{r()}}async _createTemplate(t,e,i){const r=await this.getTemplate(),o=r.witness?1:R.WITNESS_SCALE_FACTOR,a=["time","transactions","prevblock"];t>=2&&a.push("version/force"),e&&(a.push("coinbase"),a.push("coinbase/append"),a.push("generation"));const h=new Map;for(let t=0;t<r.items.length;t++){const e=r.items[t];h.set(e.hash,t+1)}const u=[];for(let t=0;t<r.items.length;t++){const e=r.items[t],i=e.tx,n=[];for(let e=0;e<i.inputs.length;e++){const r=i.inputs[e],o=h.get(r.prevout.hash);null!=o&&-1===n.indexOf(o)&&(s(o<t+1),n.push(o))}u.push({data:i.toRaw().toString("hex"),txid:i.txid(),hash:i.wtxid(),depends:n,fee:e.fee,sigops:e.sigops/o|0,weight:i.getWeight()})}let l=r.version;const f={},d=[];for(const t of this.network.deploys){const e=await this.chain.getState(this.chain.tip,t);let r=t.name;switch(e){case c.thresholdStates.DEFINED:case c.thresholdStates.FAILED:break;case c.thresholdStates.LOCKED_IN:l|=1<<t.bit;case c.thresholdStates.STARTED:t.force||(-1===i.indexOf(r)&&(l&=~(1<<t.bit)),t.required&&(r="!"+r)),f[r]=t.bit;break;case c.thresholdStates.ACTIVE:if(!t.force&&t.required){if(-1===i.indexOf(r))throw new C(I.INVALID_PARAMETER,`Client must support ${r}.`);r="!"+r}d.push(r);break;default:s(!1,"Bad state.")}}const p={capabilities:["proposal"],mutable:a,version:l>>>=0,rules:d,vbavailable:f,vbrequired:0,height:r.height,previousblockhash:n.revHex(r.prevBlock),target:n.revHex(r.target.toString("hex")),bits:n.hex32(r.bits),noncerange:"00000000ffffffff",curtime:r.time,mintime:r.mtp+1,maxtime:r.time+7200,expires:r.time+7200,sigoplimit:R.MAX_BLOCK_SIGOPS_COST/o|0,sizelimit:R.MAX_BLOCK_SIZE,weightlimit:void 0,longpollid:this.chain.tip.rhash()+n.pad32(this.totalTX()),submitold:!1,coinbaseaux:{flags:r.coinbaseFlags.toString("hex")},coinbasevalue:void 0,coinbasetxn:void 0,default_witness_commitment:void 0,transactions:u};if(r.witness&&(p.sizelimit=R.MAX_RAW_BLOCK_SIZE,p.weightlimit=R.MAX_BLOCK_WEIGHT),e){const t=r.toCoinbase(),e=t.inputs[0];if(e.script.pop(),e.script.compile(),r.witness){const i=t.outputs.pop();s(i.script.isCommitment()),e.witness.clear()}t.refresh(),p.coinbasetxn={data:t.toRaw().toString("hex"),txid:t.txid(),hash:t.wtxid(),depends:[],fee:0,sigops:t.getSigopsCost()/o|0,weight:t.getWeight()}}else p.coinbasevalue=r.getReward();return-1!==i.indexOf("segwit")&&(p.default_witness_commitment=r.getWitnessScript().toJSON()),p}async getMiningInfo(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.mininginfo");const i=this.attempt;let r=0,s=0,n=0,o=0;if(i){s=i.weight,n=i.items.length+1,o=i.getDifficulty(),r=1e3;for(const t of i.items)r+=t.tx.getBaseSize()}return{blocks:this.chain.height,currentblocksize:r,currentblockweight:s,currentblocktx:n,difficulty:o,errors:"",genproclimit:this.procLimit,networkhashps:await this.getHashRate(120),pooledtx:this.totalTX(),testnet:this.network!==v.main,chain:"testnet"!==this.network.type?this.network.type:"test",generate:this.mining}}async getNetworkHashPS(t,e){if(e||t.length>2)throw new C(I.MISC_ERROR,"getnetworkhashps ( blocks height )");const i=new _([t]),r=i.u32(0,120),s=i.u32(1);return await this.getHashRate(r,s)}async prioritiseTransaction(t,e){if(e||3!==t.length)throw new C(I.MISC_ERROR,"tx.prioritise <txid> <priority delta> <fee delta>");const i=new _([t]),r=i.hash(0),s=i.i64(1),n=i.i64(2);if(!this.mempool)throw new C(I.MISC_ERROR,"No mempool available.");if(!r)throw new C(I.TYPE_ERROR,"Invalid TXID");if(null==s||null==n)throw new C(I.TYPE_ERROR,"Invalid fee or priority.");const o=this.mempool.getEntry(r);if(!o)throw new C(I.MISC_ERROR,"Transaction not in mempool.");return this.mempool.prioritise(o,s,n),!0}async verifyBlock(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,'block.verify "hexdata": 校验区块数据 区块数据HEX串');const i=new _([t]).buf(0);if(!i)throw new C(I.TYPE_ERROR,"Invalid block hex.");if(this.chain.options.spv)throw new C(I.MISC_ERROR,"Cannot verify block in SPV mode.");const r=g.fromRaw(i);try{await this.chain.verifyBlock(r)}catch(t){if("VerifyError"===t.type)return t.reason;throw t}return null}async getGenerate(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"miner.check: 检查矿机运行状态");return this.mining}async setSync(t,e){this.node.chain.synced=!0}async setGenerate(t,e){if(e||t.length<1||t.length>2)throw new C(I.MISC_ERROR,"miner.set mine ( proclimit ): 设置矿机运行状态 [true|false] (进程数限制)");const i=new _([t]),r=i.bool(0,!1),s=i.u32(1,0);if(r&&0===this.miner.addresses.length)throw new C(I.MISC_ERROR,"No addresses available for coinbase.");return this.mining=r,this.procLimit=s,r?(this.miner.cpu.start(),!0):(this.miner.cpu.stop(),!1)}async generate(t,e){if(this.node.spv)throw new C(I.INVALID_REQUEST,"spv node can not generate new block");if(e||t.length<1||t.length>2)throw new C(I.MISC_ERROR,"miner.generate numblocks ( maxtries ): 生产区块 生产数量 (最大尝试次数)");const i=new _([t]),r=i.u32(0,1),s=i.str(1);if(0===this.miner.addresses.length)throw new C(I.MISC_ERROR,"No addresses available for coinbase.");return await this.mineBlocks(r,null,s)}async generateToAddress(t,e){if(this.node.spv)throw new C(I.INVALID_REQUEST,"spv node can not generate new block");if(e||t.length<2||t.length>3)throw new C(I.MISC_ERROR,"miner.generateto numblocks address ( maxtries ): 生产区块并发奖至 生产数量 奖励地址 (最大尝试次数)");const i=new _([t]),r=i.u32(0,1),s=i.str(1,""),n=i.u32(2),o=A.parseAddress(s,this.network);return await this.mineBlocks(r,o,n)}async createRawTransaction(t,e){if(e||t.length<2||t.length>3)throw new C(I.MISC_ERROR,'tx.raw.create [{"txid":"id","vout":n},...] {"address":amount,"data":"hex",...} ( locktime ): 创建交易，返回交易原始数据');const i=new _([t]),r=i.array(0),s=i.obj(1),n=i.u32(2);if(!r||!s)throw new C(I.TYPE_ERROR,"Invalid parameters (inputs and sendTo).");const o=new b;null!=n&&(o.locktime=n);for(const t of r){const e=new _([t]),i=e.hash("txid"),r=e.u32("vout");let s=e.u32("sequence",4294967295);if(o.locktime&&s--,!i||null==r)throw new C(I.TYPE_ERROR,"Invalid outpoint.");const n=new w;n.prevout.hash=i,n.prevout.index=r,n.sequence=s,o.inputs.push(n)}const a=new _([s]),h=new Set;for(const t of Object.keys(s)){if("data"===t){const e=a.buf(t);if(!e)throw new C(I.TYPE_ERROR,"Invalid nulldata..");const i=new S;i.value=0,i.script.createScript(e,d.types.NULLDATA),o.outputs.push(i);continue}const e=A.parseAddress(t,this.network),i=e.toString(this.network);if(h.has(i))throw new C(I.INVALID_PARAMETER,"Duplicate address");h.add(i);const r=a.ufixed(t,8);if(null==r)throw new C(I.TYPE_ERROR,"Invalid output value.");const s=new S;s.value=r,s.script.fromAddress(e),o.outputs.push(s)}return o.toRaw().toString("hex")}async decodeRawTransaction(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,'tx.raw.decode "hexstring": 解码交易原始数据 交易原始数据');s(!this.chain.options.spv,"Cannot get TX in SPV mode.");const i=new _([t]).buf(0);if(!i)throw new C(I.TYPE_ERROR,"Invalid hex string.");const r=x.fromRaw(i),n=await this.node.getMeta(r.hash("hex"));let o=null;return n&&(o=await this.chain.getEntry(n.block)),this.txToJSON(r,o)}async decodeScript(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,'sys.decodescript "hex"');const i=new _([t]).buf(0);let r=new d;i&&(r=d.fromRaw(i));const s=p.fromScripthash(r.hash160()),n=this.scriptToJSON(r);return n.p2sh=s.toString(this.network),n}async getRawTransaction(t,e){if(e||t.length<1||t.length>2)throw new C(I.MISC_ERROR,'tx.raw.get "txid" ( verbose ): 获取交易原始数据 交易哈希小端 [展开为对象]');s(!this.chain.options.spv,"Cannot get TX in SPV mode.");const i=new _([t]),r=i.hash(0),n=i.bool(1,!1);if(!r)throw new C(I.TYPE_ERROR,"Invalid TXID.");const o=await this.node.getMeta(r);if(!o)throw new C(I.MISC_ERROR,"Transaction not found.");const a=o.tx;if(!n)return a.toRaw().toString("hex");let h;o.block&&(h=await this.chain.getEntry(o.block));const c=this.txToJSON(a,h);return c.time=o.mtime,c.hex=a.toRaw().toString("hex"),c}async getTXByHash(t,e){if(e||1!=t.length)throw new C(I.MISC_ERROR,'tx.get "txid": 查询交易记录 交易哈希小端');const i=new _([t]).hash(0);s(i,"Hash is required."),s(!this.chain.options.spv,"Cannot get TX in SPV mode.");const r=await this.node.getMeta(i);if(!r)return null;const n=await this.node.getMetaView(r);return r.getJSON(this.network,n,this.chain.height)}async sendRawTransaction(t,e){if(e||t.length<1||t.length>2)throw new C(I.MISC_ERROR,'tx.raw.send "hexstring" ( allowhighfees ): 发送交易数据返回交易ID 交易原始数据 [允许高手续费]');const i=new _([t]).buf(0);if(!i)throw new C(I.TYPE_ERROR,"Invalid hex string.");const r=x.fromRaw(i);return this.node.relay(r),r.txid()}async signRawTransaction(t,e){if(e||t.length<1||t.length>4)throw new C(I.MISC_ERROR,'tx.raw.sign "hexstring" ( [{"txid":"id","vout":n,"scriptPubKey":"hex",redeemScript":"hex"},...] ["privatekey1",...] sighashtype ): 签署交易');const i=new _([t]),r=i.buf(0),s=i.array(1),n=i.array(2),o=i.str(3);if(!r)throw new C(I.TYPE_ERROR,"Invalid hex string.");if(!this.mempool)throw new C(I.MISC_ERROR,"No mempool available.");const a=b.fromRaw(r);a.view=await this.mempool.getSpentView(a);const h=new Map,c=[];if(n){const t=new _([n]);for(let e=0;e<n.length;e++){const i=t.str(e,""),r=A.parseSecret(i,this.network);h.set(r.getPublicKey("hex"),r),c.push(r)}}if(s)for(const t of s){const e=new _([t]),i=e.hash("txid"),r=e.u32("vout"),s=e.buf("scriptPubKey"),n=e.ufixed("amount",8),o=e.buf("redeemScript");if(!i||null==r||!s||null==n)throw new C(I.INVALID_PARAMETER,"Invalid UTXO.");const u=new k(i,r),l=d.fromRaw(s),f=S.fromScript(l,n);if(a.view.addOutput(u,f),0===c.length||!o)continue;if(!l.isScripthash()&&!l.isWitnessScripthash())continue;if(!o)throw new C(I.INVALID_PARAMETER,"P2SH requires redeem script.");const p=d.fromRaw(o);for(const t of p.code){if(!t.data)continue;const e=h.get(t.data.toString("hex"));if(e){e.script=p,e.witness=l.isWitnessScripthash(),e.refresh();break}}}let u=d.hashType.ALL;if(o){const t=o.split("|");if(t.length<1||t.length>2)throw new C(I.INVALID_PARAMETER,"Invalid sighash type.");if(null==(u=d.hashType[t[0]]))throw new C(I.INVALID_PARAMETER,"Invalid sighash type.");if(2===t.length){if("ANYONECANPAY"!==t[1])throw new C(I.INVALID_PARAMETER,"Invalid sighash type.");u|=d.hashType.ANYONECANPAY}}return await a.signAsync(c,u,this.workers),{hex:a.toRaw().toString("hex"),complete:a.isSigned()}}async createMultisig(t,e){if(e||t.length<2||t.length>2)throw new C(I.MISC_ERROR,'sys.createmultisig nrequired ["key",...]');const i=new _([t]),r=i.array(1,[]),s=i.u32(0,0),n=r.length;if(s<1||n<s||n>16)throw new C(I.INVALID_PARAMETER,"Invalid m and n values.");const o=new _([r]);for(let t=0;t<r.length;t++){const e=o.buf(t);if(!e)throw new C(I.TYPE_ERROR,"Invalid key.");if(!l.publicKeyVerify(e))throw new C(I.INVALID_ADDRESS_OR_KEY,"Invalid key.");r[t]=e}const a=d.createScript([s,n,r],d.types.MULTISIG);if(a.getSize()>R.MAX_SCRIPT_PUSH)throw new C(I.VERIFY_ERROR,"Redeem script exceeds size limit.");return{address:p.fromScript(a).toString(this.network),redeemScript:a.toJSON()}}async testlist(t){return[{id:1,title:"百晓生",description:"优秀的游戏发行商",avatar:"https://gw.alipayobjects.com/zos/rmsportal/WdGqmHpayyMjiEhcKoVE.png",cid:"xxxxxxxx-game-gold-test-xxxxxxxxxxxx",name:"test1",url:"920.cc",ip:"*",current:{hash:"f1573c53d45441e7d38b1e06ff3687bc26f716b0af06bc6cd219fb3768406087",index:0,address:"tb1qpmzc83qca4snn62ee0eul8rqtzrp5a5q0f96rs"},owned:!0,status:1},{id:2,title:"百谷王",description:"优秀的游戏生态建设者",avatar:"https://gw.alipayobjects.com/zos/rmsportal/zOsKZmFRdUtvpqCImOVY.png",cid:"xxxxxxxx-game-gold-test-xxxxxxxxxxxx",name:"test2",url:"920.cc",ip:"*",current:{hash:"f1573c53d45441e7d38b1e06ff3687bc26f716b0af06bc6cd219fb3768406087",index:0,address:"tb1qpmzc83qca4snn62ee0eul8rqtzrp5a5q0f96rs"},owned:!0,status:1},{id:3,title:"酷喵",description:"优秀的游戏开发商",avatar:"https://gw.alipayobjects.com/zos/rmsportal/zOsKZmFRdUtvpqCImOVY.png",cid:"xxxxxxxx-game-gold-test-xxxxxxxxxxxx",name:"test3",url:"920.cc",ip:"*",current:{hash:"f1573c53d45441e7d38b1e06ff3687bc26f716b0af06bc6cd219fb3768406087",index:0,address:"tb1qpmzc83qca4snn62ee0eul8rqtzrp5a5q0f96rs"},owned:!0,status:1}]}async createWitnessAddress(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,'sys.createwitnessaddress "script"');const i=new _([t]).buf(0);if(!i)throw new C(I.TYPE_ERROR,"Invalid script hex.");const r=d.fromRaw(i).forWitness();return{address:p.fromScript(r).toString(this.network),witnessScript:r.toJSON()}}async validateAddress(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,'sys.validateaddress "address"');const i=new _([t]).str(0,"");let r;try{r=p.fromString(i,this.network)}catch(t){return{isvalid:!1}}const s=d.fromAddress(r);return{isvalid:!0,address:r.toString(this.network),scriptPubKey:s.toJSON(),ismine:!1,iswatchonly:!1}}async verifyMessage(t,e){if(e||3!==t.length)throw new C(I.MISC_ERROR,'sys.message.verify "bitcoinaddress" "signature" "message"');const i=new _([t]),s=i.str(0,""),n=i.buf(1,null,"base64"),o=i.str(2);if(!n||!o)throw new C(I.TYPE_ERROR,"Invalid parameters.");const c=A.parseAddress(s,this.network),u=r.from(O+o,"utf8"),f=a.hash256(u),d=l.recover(f,n,0,!0);return!!d&&h(a.hash160(d),c.hash)}async signMessageWithPrivkey(t,e){if(e||2!==t.length)throw new C(I.MISC_ERROR,'sys.message.signk "privkey" "message"');const i=new _([t]),s=i.str(0,""),n=i.str(1,""),o=A.parseSecret(s,this.network),h=r.from(O+n,"utf8"),c=a.hash256(h);return o.sign(c).toString("base64")}async estimateFee(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,"estimate.fee nblocks");const i=new _([t]).u32(0,1);if(!this.fees)throw new C(I.MISC_ERROR,"Fee estimation not available.");const r=this.fees.estimateFee(i,!1);return 0===r?-1:f.btc(r,!0)}async estimatePriority(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,"estimate.priority nblocks");const i=new _([t]).u32(0,1);if(!this.fees)throw new C(I.MISC_ERROR,"Priority estimation not available.");return this.fees.estimatePriority(i,!1)}async estimateSmartFee(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,"estimate.smartfee nblocks");const i=new _([t]).u32(0,1);if(!this.fees)throw new C(I.MISC_ERROR,"Fee estimation not available.");let r=this.fees.estimateFee(i,!0);return{fee:r=0===r?-1:f.btc(r,!0),blocks:i}}async estimateSmartPriority(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,"estimate.smartpriority nblocks");const i=new _([t]).u32(0,1);if(!this.fees)throw new C(I.MISC_ERROR,"Priority estimation not available.");return{priority:this.fees.estimatePriority(i,!0),blocks:i}}async invalidateBlock(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,'block.invalidate "hash": 标记区块为无效 区块哈希(小端)');const i=new _([t]).hash(0);if(!i)throw new C(I.TYPE_ERROR,"Invalid block hash.");return await this.chain.invalidate(i),null}async reconsiderBlock(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,'block.reconsider "hash": 取消区块无效标记 区块哈希(小端)');const i=new _([t]).hash(0);if(!i)throw new C(I.TYPE_ERROR,"Invalid block hash.");return this.chain.removeInvalid(i),null}async setMockTime(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,"sys.setmocktime timestamp");const i=new _([t]).u32(0);if(null==i)throw new C(I.TYPE_ERROR,"Invalid timestamp.");this.network.time.offset=0;const r=this.network.now()-i;return this.network.time.offset=-r,null}async getMemoryInfo(t,e){if(e||0!==t.length)throw new C(I.MISC_ERROR,"sys.memoryinfo");return n.memoryUsage()}async setLogLevel(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,'sys.setloglevel "level"');const i=new _([t]).str(0,"");return this.logger.setLevel(i),null}async handleLongpoll(t){if(74!==t.length)throw new C(I.INVALID_PARAMETER,"Invalid longpoll ID.");const e=t.slice(0,64),i=parseInt(t.slice(64,74),10);if(!n.isHex(e)||!n.isU32(i))throw new C(I.INVALID_PARAMETER,"Invalid longpoll ID.");const r=n.revHex(e);this.chain.tip.hash===r&&await this.longpoll()}longpoll(){return new Promise((t,e)=>{this.pollers.push(o.job(t,e))})}refreshBlock(){const t=this.pollers;this.attempt=null,this.lastActivity=0,this.merkleMap.clear(),this.nonce1=0,this.nonce2=0,this.pollers=[];for(const e of t)e.resolve()}bindChain(){this.boundChain||(this.boundChain=!0,this.node.on("chain.connect",()=>{this.attempt&&this.refreshBlock()}),this.mempool&&this.node.on("tx",()=>{this.attempt&&n.now()-this.lastActivity>10&&this.refreshBlock()}))}async getTemplate(){this.bindChain();let t=this.attempt;return t?this.miner.updateTime(t):(t=await this.miner.createBlock(),this.attempt=t,this.lastActivity=n.now()),t}async updateWork(){this.bindChain();let t=this.attempt;if(t){if(t.address.isNull())throw new C(I.MISC_ERROR,"No addresses available for coinbase.");this.miner.updateTime(t),4294967296==++this.nonce2&&(this.nonce2=0,this.nonce1++);const e=this.nonce1,i=this.nonce2,r=t.getRoot(e,i).toString("hex");return this.merkleMap.set(r,[e,i]),t}if(0===this.miner.addresses.length)throw new C(I.MISC_ERROR,"No addresses available for coinbase.");t=await this.miner.createBlock();const e=this.nonce1,i=this.nonce2,r=t.getRoot(e,i).toString("hex");return this.attempt=t,this.lastActivity=n.now(),this.merkleMap.set(r,[e,i]),t}async addBlock(t){const e=await this.locker.lock(),i=await this.chain.locker.lock();try{return await this._addBlock(t)}finally{i(),e()}}async _addBlock(t){this.logger.info("Handling submitted block: %s.",t.rhash());const e=await this.chain.getEntry(t.prevBlock);if(e&&(await this.chain.getDeployments(t.time,e)).hasWitness()&&t.getCommitmentHash()){const e=t.txs[0],i=e.inputs[0];e.hasWitness()||(this.logger.warning("Submitted block had no witness nonce."),this.logger.debug(e),i.witness.push(E.ZERO_HASH),i.witness.compile(),e.refresh(),t.refresh())}let i;try{i=await this.chain._add(t)}catch(e){if("VerifyError"===e.type)return this.logger.warning("RPC block rejected: %s (%s).",t.rhash(),e.reason),`rejected: ${e.reason}`;throw e}return i?null:(this.logger.warning("RPC block rejected: %s (bad-prevblk).",t.rhash()),"rejected: bad-prevblk")}totalTX(){return this.mempool?this.mempool.map.size:0}getSoftforks(){return[function(t,e,i){return{id:"bip66",version:3,reject:{status:i}}}(0,0,this.chain.state.hasBIP66())]}async getBIP9Softforks(){const t=this.chain.tip,e={};for(const i of this.network.deploys){const r=await this.chain.getState(t,i);let s=c.thresholdStates.getName(r);e[i.name]={status:s,bit:i.bit,startTime:i.startTime,timeout:i.timeout}}return e}async getTXByAddress(t,e){if(e||1!==t.length)throw new C(I.MISC_ERROR,"tx.list.address address: 按地址查询交易列表");const i=new _([t]).str(0);s(i,"Address is required."),s(!this.chain.options.spv,"Cannot get TX in SPV mode.");const r=[],n=await this.node.getMetaByAddress(i);for(const t of n){const e=await this.node.getMetaView(t);r.push(t.getJSON(this.network,e,this.chain.height))}return r}async getTXByAddresses(t,e){if(help||1!==args.length)throw new C(I.MISC_ERROR,"tx.list.addresses addresses: 按地址集合查询交易列表");const i=new _([args]).array(0);s(i,"Address is required."),s(!this.chain.options.spv,"Cannot get TX in SPV mode.");const r=[],n=await this.node.getMetaByAddress(i);for(const t of n){const e=await this.node.getMetaView(t);r.push(t.getJSON(this.network,e,this.chain.height))}return r}async getHashRate(t,e){let i=this.chain.tip;if(null!=e&&(i=await this.chain.getEntry(e)),!i)return 0;s("number"==typeof t),s(t>=0),0===t&&(t=i.height%this.network.pow.retargetInterval+1),t>i.height&&(t=i.height);let r=i.time,n=r,o=i;for(let e=0;e<t;e++){if(!(o=await this.chain.getPrevious(o)))throw new C(I.DATABASE_ERROR,"Not found.");r=Math.min(o.time,r),n=Math.max(o.time,n)}const a=n-r;if(0===a)return 0;const h=i.chainwork.sub(o.chainwork);return Number(h.toString())/a}async mineBlocks(t,e,i){const r=await this.locker.lock();try{return await this._mineBlocks(t,e,i)}finally{r()}}async _mineBlocks(t,e,i){const r=[];for(let n=0;n<t;n++){const t=await this.miner.mineBlock(null,e,i),n=await this.chain.add(t);s(n),r.push(n.rhash())}return r}async findFork(t){for(;t;){if(await this.chain.isMainChain(t))return t;t=await this.chain.getPrevious(t)}throw new Error("Fork not found.")}txToJSON(t,e){let i=-1,r=0,s=null,n=0;e&&(i=e.height,r=e.time,s=e.rhash(),n=this.chain.height-i+1);const o=[];for(const e of t.inputs){const i={coinbase:void 0,txid:void 0,scriptSig:void 0,txinwitness:void 0,sequence:e.sequence};t.isCoinbase()?i.coinbase=e.script.toJSON():(i.txid=e.prevout.txid(),i.vout=e.prevout.index,i.scriptSig={asm:e.script.toASM(),hex:e.script.toJSON()}),e.witness.items.length>0&&(i.txinwitness=e.witness.items.map(t=>t.toString("hex"))),o.push(i)}const a=[];for(let e=0;e<t.outputs.length;e++){const i=t.outputs[e];a.push({value:f.btc(i.value,!0),n:e,scriptPubKey:this.scriptToJSON(i.script,!0)})}return{txid:t.txid(),hash:t.wtxid(),size:t.getSize(),vsize:t.getVirtualSize(),version:t.version,locktime:t.locktime,vin:o,vout:a,blockhash:s,confirmations:n,time:r,blocktime:r,hex:void 0}}scriptToJSON(t,e){const i=t.getType(),r={asm:t.toASM(),hex:void 0,type:d.typesByVal[i],reqSigs:1,addresses:[],p2sh:void 0};e&&(r.hex=t.toJSON());const[s]=t.getMultisig();-1!==s&&(r.reqSigs=s);const n=p.fromScript(t);if(n){const t=n.toString(this.network);r.addresses.push(t)}return r}async headerToJSON(t){const e=await this.chain.getMedianTime(t),i=await this.chain.getNextHash(t.hash);return{hash:t.rhash(),confirmations:this.chain.height-t.height+1,height:t.height,version:t.version,versionHex:n.hex32(t.version),merkleroot:n.revHex(t.merkleRoot),time:t.time,mediantime:e,bits:t.bits,difficulty:u.bits2Diff(t.bits),chainwork:t.chainwork.toString("hex",64),previousblockhash:t.prevBlock!==E.NULL_HASH?n.revHex(t.prevBlock):null,nextblockhash:i?n.revHex(i):null}}async blockToJSON(t,e,i){const r=await this.chain.getMedianTime(t),s=await this.chain.getNextHash(t.hash),o=[];for(const r of e.txs)if(i){const e=this.txToJSON(r,t);o.push(e)}else o.push(r.txid());return{hash:t.rhash(),confirmations:this.chain.height-t.height+1,strippedsize:e.getBaseSize(),size:e.getSize(),weight:e.getWeight(),height:t.height,version:t.version,versionHex:n.hex32(t.version),merkleroot:n.revHex(t.merkleRoot),coinbase:e.txs[0].inputs[0].script.toJSON(),tx:o,time:t.time,mediantime:r,bits:t.bits,nonce:e.nonce,difficulty:u.bits2Diff(t.bits),chainwork:t.chainwork.toString("hex",64),previousblockhash:t.prevBlock!==E.NULL_HASH?n.revHex(t.prevBlock):null,nextblockhash:s?n.revHex(s):null}}entryToJSON(t){return{size:t.size,fee:f.btc(t.deltaFee,!0),modifiedfee:0,time:t.time,height:t.height,startingpriority:t.priority,currentpriority:t.getPriority(this.chain.height),descendantcount:this.mempool.countDescendants(t),descendantsize:t.descSize,descendantfees:t.descFee,ancestorcount:this.mempool.countAncestors(t),ancestorsize:0,ancestorfees:0,depends:this.mempool.getDepends(t.tx).map(n.revHex)}}}}).call(this,i(81).setImmediate,i(0).Buffer)},function(t,e,i){"use strict";(function(e,r,s){
/*!
 * config.js - configuration parsing
 */
const n=i(1),o=i(74),a=i(71),h=i(3),c="./";class u{constructor(t){n("string"==typeof t),n(t.length>0),this.module=t,this.network="testnet",this.prefix=o.join(c,`.${t}`),this.options=Object.create(null),this.data=Object.create(null),this.env=Object.create(null),this.args=Object.create(null),this.argv=[],this.pass=[],this.query=Object.create(null),this.hash=Object.create(null)}inject(t){for(const e of Object.keys(t)){const i=t[e];switch(e){case"hash":case"query":case"env":case"argv":case"config":continue}this.set(e,i)}}load(t){t.hash&&this.parseHash(t.hash),t.query&&this.parseQuery(t.query),t.env&&this.parseEnv(t.env),t.argv&&this.parseArg(t.argv),this.network=this.getNetwork(),this.prefix=this.getPrefix()}open(t){if(a.unsupported)return;const e=this.getFile(t);let i;try{i=a.readFileSync(e,"utf8")}catch(t){if("ENOENT"===t.code)return;throw t}this.parseConfig(i),this.network=this.getNetwork(),this.prefix=this.getPrefix()}set(t,e){n("string"==typeof t,"Key must be a string."),null!=e&&(t=(t=t.replace(/-/g,"")).toLowerCase(),this.options[t]=e)}has(t){return"number"==typeof t?(n(t>=0,"Index must be positive."),!(t>=this.argv.length)):(n("string"==typeof t,"Key must be a string."),t=(t=t.replace(/-/g,"")).toLowerCase(),null!=this.hash[t]||null!=this.query[t]||null!=this.args[t]||null!=this.env[t]||null!=this.data[t]||null!=this.options[t])}get(t,e){if(void 0===e&&(e=null),Array.isArray(t)){const i=t;for(const t of i){const e=this.get(t);if(null!==e)return e}return e}return"number"==typeof t?(n(t>=0,"Index must be positive."),t>=this.argv.length?e:null!=this.argv[t]?this.argv[t]:e):(n("string"==typeof t,"Key must be a string."),t=(t=t.replace(/-/g,"")).toLowerCase(),null!=this.hash[t]?this.hash[t]:null!=this.query[t]?this.query[t]:null!=this.args[t]?this.args[t]:null!=this.env[t]?this.env[t]:null!=this.data[t]?this.data[t]:null!=this.options[t]?this.options[t]:e)}typeOf(t){const e=this.get(t);return null===e?"null":typeof e}str(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i)throw new Error(`${l(t)} must be a string.`);return i}int(t,e){let i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if("number"!=typeof i)throw new Error(`${l(t)} must be an int.`);if(!Number.isSafeInteger(i))throw new Error(`${l(t)} must be an int.`);return i}if(!/^\-?\d+$/.test(i))throw new Error(`${l(t)} must be an int.`);if(i=parseInt(i,10),!Number.isSafeInteger(i))throw new Error(`${l(t)} must be an int.`);return i}uint(t,e){const i=this.int(t);if(void 0===e&&(e=null),null===i)return e;if(i<0)throw new Error(`${l(t)} must be a uint.`);return i}float(t,e){let i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if("number"!=typeof i)throw new Error(`${l(t)} must be a float.`);if(!isFinite(i))throw new Error(`${l(t)} must be a float.`);return i}if(!/^\-?\d*(?:\.\d*)?$/.test(i))throw new Error(`${l(t)} must be a float.`);if(!/\d/.test(i))throw new Error(`${l(t)} must be a float.`);if(i=parseFloat(i),!isFinite(i))throw new Error(`${l(t)} must be a float.`);return i}ufloat(t,e){const i=this.float(t);if(void 0===e&&(e=null),null===i)return e;if(i<0)throw new Error(`${l(t)} must be a positive float.`);return i}fixed(t,e,i){const r=this.float(t);if(void 0===i&&(i=null),null===r)return i;try{return h.fromFloat(r,e||0)}catch(e){throw new Error(`${l(t)} must be a fixed number.`)}}ufixed(t,e,i){const r=this.fixed(t,e);if(void 0===i&&(i=null),null===r)return i;if(r<0)throw new Error(`${l(t)} must be a positive fixed number.`);return r}bool(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("number"==typeof i){if(1===i)return!0;if(0===i)return!1}if("string"!=typeof i){if("boolean"!=typeof i)throw new Error(`${l(t)} must be a boolean.`);return i}if("true"===i||"1"===i)return!0;if("false"===i||"0"===i)return!1;throw new Error(`${l(t)} must be a boolean.`)}buf(t,i,r){const s=this.get(t);if(r||(r="hex"),void 0===i&&(i=null),null===s)return i;if("string"!=typeof s){if(!e.isBuffer(s))throw new Error(`${l(t)} must be a buffer.`);return s}const n=e.from(s,r);if(n.length!==e.byteLength(s,r))throw new Error(`${l(t)} must be a ${r} string.`);return n}array(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if(!Array.isArray(i))throw new Error(`${l(t)} must be an array.`);return i}const r=i.trim().split(/\s*,\s*/),s=[];for(const t of r)0!==t.length&&s.push(t);return s}obj(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("object"!=typeof i)throw new Error(`${l(t)} must be an object.`);return i}func(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("function"!=typeof i)throw new Error(`${l(t)} must be a function.`);return i}path(t,e){let i=this.str(t);if(void 0===e&&(e=null),null===i)return e;switch(i[0]){case"~":i=o.join(c,i.substring(1));break;case"@":i=o.join(this.prefix,i.substring(1))}return o.normalize(i)}mb(t,e){const i=this.uint(t);return void 0===e&&(e=null),null===i?e:1024*i*1024}getNetwork(){let t=this.str("network");return t||(t="testnet"),n(d(t),"Bad network."),t}getPrefix(){let t=this.str("prefix");if(t)return"~"===t[0]&&(t=o.join(c,t.substring(1))),t;t=o.join(c,`.${this.module}`);const e=this.str("network");return e?(n(d(e),"Bad network."),t=o.join(t,e)):t=o.join(t,"testnet"),o.normalize(t)}getFile(t){return this.str("config")||o.join(this.prefix,t)}ensure(){return a.unsupported?Promise.resolve():a.mkdirp(this.prefix)}location(t){return o.join(this.prefix,t)}parseConfig(t){n("string"==typeof t,"Config must be text."),65279===t.charCodeAt(0)&&(t=t.substring(1)),t=(t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).replace(/\\\n/g,"");let e=!0,i=!1,r=0;for(const s of t.split("\n")){const t=s.trim();if(r+=1,0===t.length)continue;if("#"===t[0])continue;const n=t.indexOf("="),o=t.indexOf(":");let a=-1;if(-1!==o&&(o<n||-1===n)){if(i&&!e)throw new Error(`Expected '=' on line ${r}: "${t}".`);a=o,i=!0,e=!0}else{if(-1===n)throw new Error(`Expected '${e?":":"="}' on line ${r}: "${t}".`);if(i&&e)throw new Error(`Expected ':' on line ${r}: "${t}".`);a=n,i=!0,e=!1}let h=t.substring(0,a).trim();if(!g(h=h.replace(/\-/g,"")))throw new Error(`Invalid option on line ${r}: ${h}.`);const c=t.substring(a+1).trim();if(0===c.length)continue;const l=u.alias[h];l&&(h=l),this.data[h]=c}}parseArg(t){t&&"object"==typeof t||(t=r.argv),n(Array.isArray(t));let e=null,i=!1;for(let r=2;r<t.length;r++){const s=t[r];if(n("string"==typeof s),"--"===s){i=!0;continue}if(i){this.pass.push(s);continue}if(0===s.length){e=null;continue}if(0===s.indexOf("--")){const t=s.indexOf("=");let i=null,r=null,n=!1;if(-1!==t?(i=s.substring(2,t),r=s.substring(t+1),e=null,n=!1):(i=s.substring(2),r="true",e=null,n=!0),!g(i=i.replace(/\-/g,"")))throw new Error(`Invalid argument: --${i}.`);if(0===r.length)continue;if(i.length>1){const t=u.alias[i];t&&(i=t)}this.args[i]=r,n&&(e=i);continue}if("-"===s[0]){e=null;for(let t=1;t<s.length;t++){let i=s[t];if((i<"a"||i>"z")&&(i<"A"||i>"Z")&&(i<"0"||i>"9")&&"?"!==i)throw new Error(`Invalid argument: -${i}.`);const r=u.alias[i];r&&(i=r),this.args[i]="true",e=i}continue}const o=s;0!==o.length?e?(this.args[e]=o,e=null):this.argv.push(o):e=null}}parseEnv(t){let e=this.module;e=(e=e.toUpperCase()).replace(/-/g,"_"),e+="_",t&&"object"==typeof t||(t=r.env),n(t&&"object"==typeof t);for(let i of Object.keys(t)){const r=t[i];if(n("string"==typeof r),h.startsWith(i,e)&&m(i=(i=i.substring(e.length)).replace(/_/g,""))&&0!==r.length){if((i=i.toLowerCase()).length>1){const t=u.alias[i];t&&(i=t)}this.env[i]=r}}}parseQuery(t){if("string"!=typeof t){if(!s.location)return{};if("string"!=typeof(t=s.location.search))return{}}return this.parseForm(t,this.query)}parseHash(t){if("string"!=typeof t){if(!s.location)return{};if("string"!=typeof(t=s.location.hash))return{}}return this.parseForm(t,this.hash)}parseForm(t,e){if(n("string"==typeof t),0===t.length)return;let i="?";e===this.hash&&(i="#"),t[0]===i&&(t=t.substring(1));for(const i of t.split("&")){const t=i.indexOf("=");let r,s;if(-1!==t?(r=i.substring(0,t),s=i.substring(t+1)):(r=i,s="true"),!g(r=(r=f(r)).replace(/\-/g,"")))continue;if(0===(s=f(s)).length)continue;const n=u.alias[r];n&&(r=n),e[r]=s}}}function l(t){return Array.isArray(t)&&(t=t[0]),"number"==typeof t?`Argument #${t}`:t}function f(t){try{t=(t=decodeURIComponent(t)).replace(/\+/g," ")}catch(t){}return t.replace(/\0/g,"")}function d(t){return/^[a-z0-9]+$/.test(t)}function p(t){return/^[a-zA-Z0-9]+$/.test(t)}function g(t){return!!p(t)&&!/[A-Z]/.test(t)}function m(t){return!!p(t)&&!/[a-z]/.test(t)}u.alias={seed:"seeds",node:"nodes",n:"network"},t.exports=u}).call(this,i(0).Buffer,i(23),i(12))},function(t,e,i){
/*!
 * router.js - Intelligent RPC function for gamegold.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(509),s=i(510),n=i(511);let o=[].concat(s).concat(n).concat(r);e.route=o,e.openapi=o.reduce((t,e)=>("jsonp"==e.method&&(t[e.name]=e),t),{})},function(t,e,i){"use strict";(function(e){
/*!
 * layout-browser.js - mempooldb layout for browser.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s={binary:!1,R:"R",V:"V",F:"F",e:function(t){return"e"+function(t){return e.isBuffer(t)&&(t=t.toString("hex")),r("string"==typeof t),t}(t)},ee:function(t){return r("string"==typeof t),r(65===t.length),t.slice(1,65)}};t.exports=s}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * mempool.js - mempool for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(59),n=i(3),o=i(365),a=(i(34),i(204)),h=i(20),c=i(93),u=i(10),l=i(33),{VerifyError:f}=i(36),d=i(26),p=i(37),g=(i(17),i(41)),m=i(193),w=i(182),y=i(44),b=i(519),v=i(521),k=i(522),S=i(523),x=i(524),E=i(65),R=i(53),{OperType:_,contractStatus:A,operatorType:I,blockFinalType:O}=i(8);function C(t,e){}function P(t,e){t.descFee+=e.deltaFee,t.descSize+=e.size}function B(t,e){t.descFee-=e.descFee,t.descSize-=e.descSize}function T(t,e){t.descFee-=e.deltaFee}function N(t,e){t.descFee+=e.deltaFee}function M(t,e){let i,r,s=t.deltaFee,n=t.size,o=e.deltaFee,a=e.size;return U(t)&&(s=t.descFee,n=t.descSize),U(e)&&(o=e.descFee,a=e.descSize),(i=s*a)==(r=n*o)&&(i=t.time,r=e.time),i-r}function U(t){const e=t.deltaFee*t.descSize;return t.descFee*t.size>e}t.exports=class extends s{constructor(t){super(),this.options=new k(t),this.node=this.options.node,this.chain=this.options.chain,this.network=this.options.network,this.logger=this.options.logger.context("mempool"),this.workers=this.options.workers,this.fees=this.options.fees,this.locker=this.chain.locker,this.cache=new v(this.options),this.size=0,this.freeCount=0,this.lastTime=0,this.lastFlush=0,this.tip=this.network.genesis.hash,this.waiting=new Map,this.orphans=new Map,this.map=new Map,this.spents=new Map,this.rejects=new a(12e4,1e-6),this.coinIndex=new b,this.txIndex=new x}async _open(){if(await this.chain.open(),await this.cache.open(),this.options.persistent){const t=await this.cache.getEntries();for(const e of t){const t=await this.getCoinView(e.tx);await this.addEntry(e,t)}if(this.logger.info("Loaded mempool from disk (%d entries).",t.length),this.fees){const t=await this.cache.getFees();t&&(this.fees.inject(t),this.logger.info("Loaded mempool fee data (rate=%d).",this.fees.estimateFee()))}}this.tip=this.chain.tip.hash;const t=(this.options.maxSize/1024).toFixed(2);this.logger.info("Mempool loaded (maxsize=%dkb).",t)}async _close(){await this.cache.close()}async addBlock(t,e){const i=await this.locker.lock();try{return await this._addBlock(t,e)}finally{i()}}async _addBlock(t,e){if(0===this.map.size)return this.tip=t.hash,void this.logger.debug("addBlock and update tip %s:",this.tip);const i=[];for(let r=e.length-1;r>=1;r--){const s=e[r],n=s.hash("hex"),o=this.getEntry(n);o||await this.insertTX(s),await this.removeEntry(o,!1),i.push(o),this.emit("confirmed",s,t)}this.rejects.reset(),this.fees&&(this.fees.processBlock(t.height,i,this.chain.synced),this.cache.writeFees(this.fees)),this.cache.sync(t.hash),await this.cache.flush(),this.tip=t.hash,this.logger.debug("addBlock and update tip %s:",this.tip);for(const e of this.map.values()){const i=e.tx;let r=await R.FactoryOfContract(I.Mem,i,{env:this,height:t.height,finder:()=>{}});if(r.data)switch(r.data.oper){case _.contractCreate:{const e=R.transactionList.get(`${r.data.type}.${r.data.addr}`);r=await R.FactoryOfContract(I.Mem,i,{env:this,height:t.height,finder:()=>{},contract:e});break}}await r.isBlockFinal()==O.Expired&&await this.removeEntry(e)}0!==i.length&&this.logger.debug("Removed %d txs from mempool for block %d.",i.length,t.height)}async removeBlock(t,e){const i=await this.locker.lock();try{return await this._removeBlock(t,e)}finally{i()}}async _removeBlock(t,e){if(0===this.map.size)return this.tip=t.prevBlock,void this.logger.debug("removeBlock and update tip %s:",this.tip);let i=0;for(let r=1;r<e.length;r++){const s=e[r],n=s.hash("hex");if(!this.hasEntry(n)){try{await this.insertTX(s,-1),i++}catch(t){this.emit("error",t);continue}this.emit("unconfirmed",s,t)}}this.rejects.reset(),this.cache.sync(t.prevBlock),await this.cache.flush(),this.tip=t.prevBlock,this.logger.debug("removeBlock and update tip %s:",this.tip),0!==i&&this.logger.debug("Added %d txs back into the mempool for block %d.",i,t.height)}async handleReorg(){const t=await this.locker.lock();try{return await this._handleReorg()}finally{t()}}async _handleReorg(){const t=this.chain.height+1,e=await this.chain.getMedianTime(this.chain.tip),i=[];for(const[r,s]of this.map){const{tx:n}=s;if(n.isFinal(t,e)){if(n.version>1){let t=!1;for(const{sequence:e}of n.inputs)if(!(e&u.SEQUENCE_DISABLE_FLAG)){t=!0;break}if(t){i.push(r);continue}}s.coinbase&&i.push(r)}else i.push(r)}for(const t of i){const e=this.getEntry(t);e&&await this.removeEntry(e)}}async reset(){const t=await this.locker.lock();try{return await this._reset()}finally{t()}}async _reset(){this.logger.info("Mempool reset (%d txs removed).",this.map.size),this.size=0,this.waiting.clear(),this.orphans.clear(),this.map.clear(),this.spents.clear(),this.coinIndex.reset(),this.txIndex.reset(),this.freeCount=0,this.lastTime=0,this.fees&&this.fees.reset(),this.rejects.reset(),this.options.persistent&&(await this.cache.wipe(),this.cache.clear()),this.tip=this.chain.tip.hash}async limitSize(t){const e=this.options.maxSize;if(this.size<=e)return!1;const i=e-e/10,s=this.options.expiryTime,a=n.now();let h=n.hrtime();const c=new o(M);for(const t of this.map.values())this.hasDepends(t.tx)||(a<t.time+s?c.insert(t):(this.logger.debug("Removing package %s from mempool (too old).",t.txid()),await this.removeEntry(t)));if(this.size<=i)return!this.hasEntry(t);for(this.logger.debug("(bench) Heap mempool traversal: %d.",n.hrtime(h)),h=n.hrtime(),this.logger.debug("(bench) Heap mempool queue size: %d.",c.size());c.size()>0;){const t=c.shift(),e=t.hash("hex");if(r(this.hasEntry(e)),this.logger.debug("Removing package %s from mempool (low fee).",t.txid()),await this.removeEntry(t),this.size<=i)break}return this.logger.debug("(bench) Heap mempool map removal: %d.",n.hrtime(h)),!this.hasEntry(t)}getTX(t){const e=this.getEntry(t);return e?e.tx:null}getEntry(t){return this.map.get(t)}getCoin(t,e){const i=this.getEntry(t);return i?this.isSpent(t,e)?null:e>=i.tx.outputs.length?null:g.fromTX(i.tx,e,-1):null}isSpent(t,e){const i=p.toKey(t,e);return this.spents.has(i)}getSpender(t,e){const i=p.toKey(t,e);return this.spents.get(i)}getSpentTX(t,e){const i=p.toKey(t,e),r=this.spents.get(i);return r?r.tx:null}getCoinsByAddress(t){Array.isArray(t)||(t=[t]);const e=[];for(const i of t){const t=d.getHash(i,"hex"),r=this.coinIndex.get(t);for(const t of r)e.push(t)}return e}getTXByAddress(t){Array.isArray(t)||(t=[t]);const e=[];for(const i of t){const t=d.getHash(i,"hex"),r=this.txIndex.get(t);for(const t of r)e.push(t)}return e}getMetaByAddress(t){Array.isArray(t)||(t=[t]);const e=[];for(const i of t){const t=d.getHash(i,"hex"),r=this.txIndex.getMeta(t);for(const t of r)e.push(t)}return e}getMeta(t){const e=this.getEntry(t);if(!e)return null;const i=m.fromTX(e.tx);return i.mtime=e.time,i}hasEntry(t){return this.map.has(t)}has(t){return!!this.locker.has(t)||!!this.hasOrphan(t)||this.hasEntry(t)}exists(t){return!!this.locker.hasPending(t)||!!this.hasOrphan(t)||this.hasEntry(t)}hasReject(t){return this.rejects.test(t,"hex")}async addTX(t,e){const i=t.hash("hex"),r=await this.locker.lock(i);try{return await this._addTX(t,e)}finally{r()}}async _addTX(t,e){let i;null==e&&(e=-1);try{i=await this.insertTX(t,e)}catch(e){throw"VerifyError"===e.type&&(t.hasWitness()||e.malleated||this.rejects.add(t.hash())),e}return n.now()-this.lastFlush>10&&(await this.cache.flush(),this.lastFlush=n.now()),i}async insertTX(t,e){r(!t.mutable,"Cannot add mutable TX to mempool.");const i=E.lockFlags.STANDARD_LOCKTIME_FLAGS,s=this.chain.height,n=t.hash("hex"),[o,a,h]=t.checkSanity();if(!o)throw new f(t,"invalid",a,h);if(t.isCoinbase())throw new f(t,"invalid","coinbase",100);if(this.options.requireStandard&&!this.chain.state.hasCSV()&&t.version>=2)throw new f(t,"nonstandard","premature-version2-tx",0);if(this.options.requireStandard){const[e,i,r]=t.checkStandard();if(!e)throw new f(t,"nonstandard",i,r);if(!this.options.replaceByFee&&t.isRBF())throw new f(t,"nonstandard","replace-by-fee",0)}if(!await this.verifyFinal(t,i))throw new f(t,"nonstandard","non-final",0);if(this.exists(n))throw new f(t,"alreadyknown","txn-already-in-mempool",0);if(await this.chain.hasCoins(t))throw new f(t,"alreadyknown","txn-already-known",0);let c=this.node.getTXFromAll?this.node.getTXFromAll.bind(this.node):this.getTX.bind(this),u=await R.FactoryOfContract(I.Mem,t,{env:this,finder:c}),l=null;if(u.data&&(u.data.oper==_.contractPromise||u.data.oper==_.contractExecute)){const e=R.transactionList.get(`${u.data.type}.${u.data.addr}`);e&&u.data.oper==_.contractPromise&&u.data.oper==e.oper&&(u.data.ori&&(e.ori=u.data.ori),u=await R.FactoryOfContract(I.Mem,t,{env:this,height:this.chain.height,finder:()=>{},contract:e})),e&&(l=e.transStatus)}if(!await u.verify())throw new f(t,"invalid","bad-contract-verify",100);if(this.isDoubleSpend(t))throw this.emit("conflict",t),new f(t,"duplicate","bad-txns-inputs-spent",0);const d=await this.getCoinView(t),p=this.maybeOrphan(t,d,e);if(p)return p;const g=w.fromTX(t,d,s);return await this.verify(g,d,l),await this.addEntry(g,d),null}async verify(t,e,i){const s=this.chain.height+1,o=E.lockFlags.STANDARD_LOCKTIME_FLAGS,a=t.tx;if(!await this.verifyLocks(a,e,o))throw new f(a,"nonstandard","non-BIP68-final",0);if(this.options.requireStandard){if(!a.hasStandardInputs(e))throw new f(a,"nonstandard","bad-txns-nonstandard-inputs",0);if(this.chain.state.hasWitness()&&!a.hasStandardWitness(e))throw new f(a,"nonstandard","bad-witness-nonstandard",0,!0)}if(t.sigops>l.MAX_TX_SIGOPS_COST)throw new f(a,"nonstandard","bad-txns-too-many-sigops",0);const c=l.getMinFee(t.size,this.options.minRelay);if(this.options.relayPriority&&t.fee<c&&!t.isFree(s))throw new f(a,"insufficientfee","insufficient priority",0);if(this.options.limitFree&&t.fee<c){const e=n.now();if(this.freeCount*=Math.pow(1-1/600,e-this.lastTime),this.lastTime=e,this.freeCount>10*this.options.limitFreeRelay*1e3)throw new f(a,"insufficientfee","rate limited free transaction",0);this.freeCount+=t.size}if(this.options.rejectAbsurdFees&&t.fee>1e4*c){let t=await R.FactoryOfContract(I.Mem,a,{env:this,height:this.chain.height,finder:()=>{}});if(t.data&&t.data.oper==_.contractPromise);else if(O.Final==await t.isBlockFinal())throw new f(a,"highfee","absurdly-high-fee",0)}if(this.countAncestors(t)+1>this.options.maxAncestors)throw new f(a,"nonstandard","too-long-mempool-chain",0);const[u,d,p]=a.checkInputs(e,s);if(-1===u)throw new f(a,"invalid",d,p);let g=h.flags.STANDARD_VERIFY_FLAGS;try{await this.verifyInputs(a,e,g,i)}catch(t){if(a.hasWitness())throw t;if(g&=~h.flags.VERIFY_WITNESS,g&=~h.flags.VERIFY_CLEANSTACK,!await this.verifyResult(a,e,g))throw t;if(g|=h.flags.VERIFY_CLEANSTACK,await this.verifyResult(a,e,g))throw t;throw t.malleated=!0,t}if(this.options.paranoidChecks){const t=h.flags.MANDATORY_VERIFY_FLAGS;r(await this.verifyResult(a,e,t),"BUG: Verify failed for mandatory but not standard.")}}async verifyResult(t,e,i){try{await this.verifyInputs(t,e,i)}catch(t){if("VerifyError"===t.type)return!1;throw t}return!0}async verifyInputs(t,e,i,r){if(!await t.verifyAsync(e,i,r,this.workers)){if(i&h.flags.ONLY_STANDARD_VERIFY_FLAGS&&(i&=~h.flags.ONLY_STANDARD_VERIFY_FLAGS,await t.verifyAsync(e,i,r,this.workers)))throw new f(t,"nonstandard","non-mandatory-script-verify-flag",0);throw new f(t,"nonstandard","mandatory-script-verify-flag",100)}}async addEntry(t,e){const i=t.tx;await this.trackEntry(t,e),this.updateAncestors(t,P),this.emit("tx",i,e),this.fees&&this.fees.processTX(t,this.chain.synced),this.logger.debug("Added %s to mempool (txs=%d).",i.txid(),this.map.size),this.cache.save(t),await this.handleOrphans(i);let r=this.node.getTXFromAll?this.node.getTXFromAll.bind(this.node):this.getTX.bind(this),s=await R.FactoryOfContract(I.Mem,i,{env:this,finder:r});if(await s.execute(),await this.limitSize(i.hash("hex")))throw new f(i,"insufficient size","mempool full",0)}async removeEntry(t,e=!0){const i=t.tx,r=i.hash("hex");if(e){for(let t=0;t<i.outputs.length;t++){const i=this.getSpender(r,t);i&&await this.removeEntry(i,e)}this.updateAncestors(t,B)}this.untrackEntry(t),this.fees&&this.fees.removeTX(r),this.cache.remove(i.hash()),this.emit("entry.remove",t);let s=this.node.getTXFromAll?this.node.getTXFromAll.bind(this.node):this.getTX.bind(this),n=await R.FactoryOfContract(I.Mem,i,{env:this,finder:s});await n.cancel()}async removeTX(t){const e=t.hash("hex"),i=await this.locker.lock(e);try{await this.removeDoubleSpenders(t)}finally{i()}}async removeDoubleSpenders(t){for(const{prevout:e}of t.inputs){const{hash:t,index:i}=e,r=this.getSpender(t,i);r&&(this.logger.debug("Removing double spender from mempool: %s.",r.txid()),await this.removeEntry(r),this.emit("doublespend",r))}}countAncestors(t){return this._countAncestors(t,new Set,t,C)}updateAncestors(t,e){return this._countAncestors(t,new Set,t,e)}_countAncestors(t,e,i,r){const s=t.tx;for(const{prevout:t}of s.inputs){if(e.size>=this.options.maxAncestors)break;const s=t.hash;if(e.has(s))continue;const n=this.getEntry(s);n&&(e.add(s),r(n,i),this._countAncestors(n,e,i,r))}return e.size}countDescendants(t){return this._countDescendants(t,new Set)}_countDescendants(t,e){const i=t.tx,r=i.hash("hex");for(let t=0;t<i.outputs.length;t++){const i=this.getSpender(r,t);if(!i)continue;const s=i.hash("hex");e.has(s)||(e.add(s),this._countDescendants(i,e))}return e.size}getAncestors(t){return this._getAncestors(t,[],new Set)}_getAncestors(t,e,i){const r=t.tx;for(const{prevout:t}of r.inputs){const r=t.hash,s=this.getEntry(r);s&&(i.has(r)||(i.add(r),e.push(s),this._getAncestors(s,e,i)))}return e}getDescendants(t){return this._getDescendants(t,[],new Set)}_getDescendants(t,e,i){const r=t.tx,s=r.hash("hex");for(let t=0;t<r.outputs.length;t++){const r=this.getSpender(s,t);if(!r)continue;const n=r.hash("hex");i.has(n)||(i.add(n),e.push(r),this._getDescendants(r,e,i))}return e}getDepends(t){const e=t.getPrevout(),i=[];for(const t of e)this.hasEntry(t)&&i.push(t);return i}hasDepends(t){for(const{prevout:e}of t.inputs)if(this.hasEntry(e.hash))return!0;return!1}getBalance(){let t=0;for(const[e,i]of this.map){const r=i.tx;for(let i=0;i<r.outputs.length;i++){const r=this.getCoin(e,i);r&&(t+=r.value)}}return t}getHistory(){const t=[];for(const e of this.map.values())t.push(e.tx);return t}getOrphan(t){return this.orphans.get(t)}hasOrphan(t){return this.orphans.has(t)}maybeOrphan(t,e,i){const r=new Set,s=[];for(const{prevout:i}of t.inputs)if(!e.hasEntry(i)){if(this.hasReject(i.hash))return this.logger.debug("Not storing orphan %s (rejected parents).",t.txid()),this.rejects.add(t.hash()),s;if(this.hasEntry(i.hash))return this.logger.debug("Not storing orphan %s (non-existent output).",t.txid()),this.rejects.add(t.hash()),s;r.add(i.hash)}if(0===r.size)return null;if(0===this.options.maxOrphans)return s;if(t.getWeight()>l.MAX_TX_WEIGHT)return this.logger.debug("Ignoring large orphan: %s",t.txid()),t.hasWitness()||this.rejects.add(t.hash()),s;this.limitOrphans();const n=t.hash("hex");for(const t of r.keys())this.waiting.has(t)||this.waiting.set(t,new Set),this.waiting.get(t).add(n),s.push(t);return this.orphans.set(n,new S(t,s.length,i)),this.logger.debug("Added orphan %s to mempool.",t.txid()),this.emit("orphan.add",t),s}async handleOrphans(t){const e=this.resolveOrphans(t);for(const i of e){let e;try{e=i.toTX()}catch(t){this.logger.warning("%s %s","Warning: possible memory corruption.","Orphan failed deserialization.");continue}try{await this.insertTX(e,i.id)}catch(t){if("VerifyError"===t.type){this.logger.debug("Could not resolve orphan %s: %s.",e.txid(),t.message),e.hasWitness()||t.malleated||this.rejects.add(e.hash()),this.emit("orphan.bad",t,i.id);continue}throw t}this.removeOrphan(e.hash("hex")),this.logger.debug("Resolved orphan %s in mempool.",e.txid())}}resolveOrphans(t){const e=t.hash("hex"),i=this.waiting.get(e);if(!i||0==i.size)return this.waiting.delete(e),[];const s=[];for(const t of i.keys()){const e=this.getOrphan(t);r(e),0==--e.missing&&(this.orphans.delete(t),s.push(e))}return this.waiting.delete(e),s}removeOrphan(t){const e=this.getOrphan(t);if(!e)return!1;let i;try{i=e.toTX()}catch(e){return this.orphans.delete(t),this.logger.warning("%s %s","Warning: possible memory corruption.","Orphan failed deserialization."),!1}for(const e of i.getPrevout()){const i=this.waiting.get(e);i&&(r(i.has(t)),i.delete(t),0===i.size&&this.waiting.delete(e))}return this.orphans.delete(t),this.emit("remove orphan",i),!0}limitOrphans(){if(this.orphans.size<this.options.maxOrphans)return!1;let t,e=c.randomRange(0,this.orphans.size);for(t of this.orphans.keys()){if(0===e)break;e--}return r(t),this.logger.debug("Removing orphan %s from mempool.",n.revHex(t)),this.removeOrphan(t),!0}isDoubleSpend(t){for(const{prevout:e}of t.inputs){const{hash:t,index:i}=e;if(this.isSpent(t,i))return!0}return!1}async getSpentView(t){const e=await this.locker.lock();try{return await this.getSpentViewUnLock(t)}finally{e()}}async getSpentViewUnLock(t){const e=new y;for(const{prevout:i}of t.inputs){const{hash:t,index:r}=i,s=this.getTX(t);if(s){r<s.outputs.length&&e.addIndex(s,r,-1);continue}const n=await this.chain.readCoin(i);if(n){e.addEntry(i,n);continue}const o=await this.getMeta(t);if(!o)continue;const{tm:a,height:h}=o;r<a.outputs.length&&e.addIndex(a,r,h)}return e}async getCoinView(t){const e=new y;for(const{prevout:i}of t.inputs){const{hash:t,index:r}=i,s=this.getTX(t);if(s){r<s.outputs.length&&e.addIndex(s,r,-1);continue}const n=await this.chain.readCoin(i);n&&e.addEntry(i,n)}return e}getSnapshot(){const t=[];for(const e of this.map.keys())t.push(e);return t}verifyLocks(t,e,i){return this.chain.verifyLocks(this.chain.tip,t,e,i)}verifyFinal(t,e){return this.chain.verifyFinal(this.chain.tip,t,e)}async trackEntry(t,e){const i=t.tx,s=i.hash("hex");r(!this.map.has(s)),this.map.set(s,t),r(!i.isCoinbase());for(const{prevout:e}of i.inputs){const i=e.toKey();this.spents.set(i,t)}this.options.indexAddress&&e&&this.indexEntry(t,e),this.size+=t.memUsage()}untrackEntry(t){const e=t.tx,i=e.hash("hex");r(this.map.has(i)),this.map.delete(i),r(!e.isCoinbase());for(const{prevout:t}of e.inputs){const e=t.toKey();this.spents.delete(e)}this.options.indexAddress&&this.unindexEntry(t),this.size-=t.memUsage()}indexEntry(t,e){const i=t.tx;this.txIndex.insert(t,e);for(const{prevout:t}of i.inputs){const{hash:e,index:i}=t;this.coinIndex.remove(e,i)}for(let t=0;t<i.outputs.length;t++)this.coinIndex.insert(i,t)}unindexEntry(t){const e=t.tx,i=e.hash("hex");this.txIndex.remove(i);for(const{prevout:t}of e.inputs){const{hash:e,index:i}=t,r=this.getTX(e);r&&this.coinIndex.insert(r,i)}for(let t=0;t<e.outputs.length;t++)this.coinIndex.remove(i,t)}getSize(){return this.size}prioritise(t,e,i){e<-t.priority&&(e=-t.priority),t.priority+=e,i<-t.deltaFee&&(i=-t.deltaFee),0!==i&&(this.updateAncestors(t,T),t.deltaFee+=i,t.descFee+=i,this.updateAncestors(t,N))}}},function(t,e,i){"use strict";
/*!
 * heap.js - heap object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1);function s(t){if(!(this instanceof s))return new s(t);this.compare=n,this.items=[],t&&this.set(t)}function n(t,e){throw new Error("No heap comparator set.")}s.prototype.init=function(){const t=this.items.length;if(!(t<=1))for(let e=(t/2|0)-1;e>=0;e--)this.down(e,t)},s.prototype.size=function(){return this.items.length},s.prototype.set=function(t){r("function"==typeof t,"Comparator must be a function."),this.compare=t},s.prototype.insert=function(t){return this.items.push(t),this.up(this.items.length-1),this.items.length},s.prototype.shift=function(){if(0===this.items.length)return null;const t=this.items.length-1;return this.swap(0,t),this.down(0,t),this.items.pop()},s.prototype.remove=function(t){if(0===this.items.length)return null;const e=this.items.length-1;return t<0||t>e?null:(e!==t&&(this.swap(t,e),this.down(t,e),this.up(t)),this.items.pop())},s.prototype.swap=function(t,e){const i=this.items[t],r=this.items[e];this.items[t]=r,this.items[e]=i},s.prototype.less=function(t,e){return this.compare(this.items[t],this.items[e])<0},s.prototype.down=function(t,e){for(;;){const i=2*t+1;if(r(i>=0),i<0||i>=e)break;let s=i;const n=i+1;if(n<e&&!this.less(i,n)&&(s=n),!this.less(s,t))break;this.swap(t,s),t=s}},s.prototype.up=function(t){for(;;){const e=(t-1)/2|0;if(r(e>=0),e<0||e===t)break;if(!this.less(t,e))break;this.swap(e,t),t=e}},s.prototype.toArray=function(){const t=new s,e=[];for(t.compare=this.compare,t.items=this.items.slice();t.size()>0;)e.push(t.shift());return e},s.fromArray=function(t,e){const i=new s;return i.set(t),i.items=e,i.init(),i},t.exports=s},function(t,e,i){"use strict";(function(e){
/*!
 * miner.js - block generator for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(365),o=i(59),a=i(31),h=i(26),c=i(205),u=i(16),l=i(10),f=i(33),d=i(408),p=i(409),g=i(410),{OperType:m,operatorType:w,blockFinalType:y}=i(8),b=i(53),{opcodes:v}=i(27),k=i(93);function S(t){if(!(this instanceof S))return new S(t);this.network=u.primary,this.logger=null,this.workers=null,this.node=null,this.chain=null,this.mempool=null,this.version=-1,this.addresses=[],this.coinbaseFlags=e.from("mined by gamegold","ascii"),this.preverify=!1,this.minWeight=f.MIN_BLOCK_WEIGHT,this.maxWeight=f.MAX_BLOCK_WEIGHT,this.priorityWeight=f.BLOCK_PRIORITY_WEIGHT,this.priorityThreshold=f.BLOCK_PRIORITY_THRESHOLD,this.maxSigops=l.MAX_BLOCK_SIGOPS_COST,this.reservedWeight=4e3,this.reservedSigops=400,this.fromOptions(t)}function x(t,e){return t.priority===e.priority?E(t,e):e.priority-t.priority}function E(t,e){let i=t.rate,r=e.rate;return t.descRate>t.rate&&(i=t.descRate),e.descRate>e.rate&&(r=e.descRate),i===r&&(i=t.priority,r=e.priority),r-i}S.prototype.fromOptions=function(t){if(r(t,"Miner requires options."),r(t.node&&"object"==typeof t.node,"Miner requires a node."),r(t.node.chain&&"object"==typeof t.node.chain,"Miner requires a blockchain."),this.node=t.node,this.node.chain?(r("object"==typeof this.node.chain),this.chain=this.node.chain):this.chain={},this.node.mempool&&(r("object"==typeof this.node.mempool),this.mempool=this.node.mempool),this.network=this.chain.network,this.logger=this.chain.logger,this.workers=this.chain.workers,null!=t.logger&&(r("object"==typeof t.logger),this.logger=t.logger),null!=t.workers&&(r("object"==typeof t.workers),this.workers=t.workers),null!=t.version&&(r(s.isInt(t.version)),this.version=t.version),t.address)if(Array.isArray(t.address))for(const e of t.address)this.addresses.push(new h(e));else this.addresses.push(new h(t.address));if(t.addresses){r(Array.isArray(t.addresses));for(const e of t.addresses)this.addresses.push(new h(e))}if(t.tokenAddress?this.tokenAddress=new h(t.tokenAddress):this.tokenAddress=null,t.coinbaseFlags){let i=t.coinbaseFlags;"string"==typeof i&&(i=e.from(i,"utf8")),r(e.isBuffer(i)),r(i.length<=20,"Coinbase flags > 20 bytes."),this.coinbaseFlags=i}return null!=t.preverify&&(r("boolean"==typeof t.preverify),this.preverify=t.preverify),null!=t.minWeight&&(r(s.isU32(t.minWeight)),this.minWeight=t.minWeight),null!=t.maxWeight&&(r(s.isU32(t.maxWeight)),r(t.maxWeight<=l.MAX_BLOCK_WEIGHT,"Max weight must be below MAX_BLOCK_WEIGHT"),this.maxWeight=t.maxWeight),null!=t.maxSigops&&(r(s.isU32(t.maxSigops)),r(t.maxSigops<=l.MAX_BLOCK_SIGOPS_COST,"Max sigops must be below MAX_BLOCK_SIGOPS_COST"),this.maxSigops=t.maxSigops),null!=t.priorityWeight&&(r(s.isU32(t.priorityWeight)),this.priorityWeight=t.priorityWeight),null!=t.priorityThreshold&&(r(s.isU32(t.priorityThreshold)),this.priorityThreshold=t.priorityThreshold),null!=t.reservedWeight&&(r(s.isU32(t.reservedWeight)),this.reservedWeight=t.reservedWeight),null!=t.reservedSigops&&(r(s.isU32(t.reservedSigops)),this.reservedSigops=t.reservedSigops),this},S.fromOptions=function(t){return(new S).fromOptions(t)},t.exports=class extends o{constructor(t){super(),this.options=new S(t),this.node=this.options.node,this.chain=this.options.chain,this.mempool=this.options.mempool,this.network=this.options.network,this.logger=this.options.logger.context("miner"),this.workers=this.options.workers,this.addresses=this.options.addresses,this.locker=this.chain.locker,this.cpu=new d(this),this.tokenAddress=this.options.tokenAddress,this.init()}init(){this.cpu.on("error",t=>{this.emit("error",t)})}async _open(){await this.chain.open(),this.mempool&&await this.mempool.open(),await this.cpu.open(),this.logger.info("Miner loaded (flags=%s).",this.options.coinbaseFlags.toString("utf8")),0===this.addresses.length&&this.logger.warning("No reward address is set for miner!")}async _close(){await this.cpu.close()}async createBlock(t,e,i){const r=await this.locker.lock();try{return await this._createBlock(t,e,i)}finally{r()}}async _createBlock(t,e,i){let r=this.options.version;t||(t=this.chain.tip),e||(e=this.getAddress()),-1===r&&(r=await this.chain.computeBlockVersion(t));const s=await this.chain.getMedianTime(t),n=Math.max(this.network.now(),s+1),o=await this.chain.getDeployments(n,t),{target:h}=await this.chain.getTarget(n,t),u=o.hasMTP()?s:n,l=new c({prevBlock:t.hash,height:t.height+1,version:r,time:n,bits:h,locktime:u,mtp:s,flags:o.flags,address:e,coinbaseFlags:this.options.coinbaseFlags,witness:o.hasWitness(),interval:this.network.halvingInterval,weight:this.options.reservedWeight,sigops:this.options.reservedSigops});if(await this.assemble(l,await this.getTokenByAddress(i)),this.logger.debug("Created block template (height=%d, weight=%d, fees=%d, txs=%s, diff=%d).",l.height,l.weight,a.btc(l.fees),l.items.length+1,l.getDifficulty()),this.options.preverify){const e=l.toBlock();try{await this.chain._verifyBlock(e)}catch(t){if("VerifyError"===t.type)throw this.logger.warning("Miner created invalid block!"),this.logger.error(t),new Error("BUG: Miner created invalid block.");throw t}this.logger.debug("Preverified block %d successfully!",l.height)}return l}async getTokenByAddress(t){if(!this.tokenAddress)return null;const e=await this.node.getCoinsByAddress(this.tokenAddress);if(!e||0==e.length)return null;let i=[],r=l.getEpoch(this.chain.height);for(const t of e)if(!(t.height<1||t.script.code.length<2||t.script.code[0].value!=v.OP_PROPEXCHANGE)){let e=t.getReturnData();if(!e||e.cid!==this.network.bossId)continue;if(parseInt(e.pid.match(/\d+$/i)[0])>r.token)continue;i.push(t)}if(0==i.length)return null;if(l.getRealValues(e)<r.value)return null;let s=i[k.randomRange(0,i.length)];return{addr:this.tokenAddress.toString(),oper:m.coinbase,hash:s.hash,index:s.index}}updateTime(t){t.time=Math.max(this.network.now(),t.mtp+1)}async createJob(t,e,i){const r=await this.createBlock(t,e,i);return new p(this.cpu,r)}async mineBlock(t,e,i){const r=await this.createJob(t,e,i);return await r.mineAsync()}addAddress(t){this.addresses.push(new h(t))}getAddress(){return 0===this.addresses.length?new h:this.addresses[Math.random()*this.addresses.length|0]}async assemble(t,e){if(!this.mempool)return void t.refresh(e);if(this.mempool.tip!==this.chain.tip.hash)throw new Error(`Mempool/chain tip mismatch! Unsafe to create block. ${this.mempool.tip} vs ${this.chain.tip.hash}`);const i=new Map,s=new n(E);let o=this.options.priorityWeight>0;o&&s.set(x);for(const e of this.mempool.map.values()){const r=g.fromEntry(e,t),n=r.tx;if(n.isCoinbase())throw await this.mempool.removeDoubleSpenders(n),new Error("Cannot add coinbase to block.");for(const{prevout:t}of n.inputs){const e=t.hash;this.mempool.hasEntry(e)&&(r.depCount+=1,i.has(e)||i.set(e,[]),i.get(e).push(r))}if(r.depCount>0)continue;let o=await b.FactoryOfContract(w.Mem,n,{env:this.mempool,height:this.chain.height,finder:()=>{}});if(o.data&&o.data.oper==m.contractPromise){const t=b.transactionList.get(`${o.data.type}.${o.data.addr}`);o.data.ori&&(t.ori=o.data.ori),o=await b.FactoryOfContract(w.Mem,n,{env:this.mempool,height:this.chain.height,finder:()=>{},contract:t})}await o.isBlockFinal()==y.Final&&s.insert(r)}for(;s.size()>0;){const e=s.shift(),r=e.tx,n=e.hash;let a=t.weight,h=t.sigops;if(!r.isFinal(t.height,t.locktime))continue;if(!t.witness&&r.hasWitness())continue;if((a+=r.getWeight())>this.options.maxWeight)continue;if((h+=e.sigops)>this.options.maxSigops)continue;if(o){if(a>this.options.priorityWeight||e.priority<this.options.priorityThreshold){o=!1,s.set(E),s.init(),s.insert(e);continue}}else if(e.free&&a>=this.options.minWeight)continue;t.weight=a,t.sigops=h,t.fees+=e.fee,t.items.push(e);const c=i.get(n);if(c)for(const t of c)if(0==--t.depCount){let e=await b.FactoryOfContract(w.Mem,t.tx,{env:this.mempool,height:this.chain.height,finder:()=>{}});if(e.data&&e.data.oper==m.contractPromise){const i=b.transactionList.get(`${e.data.type}.${e.data.addr}`);e.data.ori&&(i.ori=e.data.ori),e=await b.FactoryOfContract(w.Mem,t.tx,{env:this.mempool,height:this.chain.height,finder:()=>{},contract:i})}if(await e.isBlockFinal()!=y.Final)continue;s.insert(t)}}if(t.refresh(e),r(t.weight<=l.MAX_BLOCK_WEIGHT,"Block exceeds reserved weight!"),this.options.preverify){const e=t.toBlock();r(e.getWeight()<=t.weight,"Block exceeds reserved weight!"),r(e.getBaseSize()<=l.MAX_BLOCK_SIZE,"Block exceeds max block size.")}}}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * AuthDB.js - peer auth.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 * Resources:
 *   https://github.com/bitcoin/bips/blob/master/bip-0150.mediawiki
 */
const r=i(1),s=i(74),n=i(48),o=i(183),a=i(71),h=i(45);t.exports=class{constructor(t){this.logger=h.global,this.resolve=o.lookup,this.prefix=null,this.dnsKnown=[],this.known=new Map,this.authorized=[],this._init(t)}_init(t){t&&(null!=t.logger&&(r("object"==typeof t.logger),this.logger=t.logger.context("authdb")),null!=t.resolve&&(r("function"==typeof t.resolve),this.resolve=t.resolve),null!=t.knownPeers&&(r("object"==typeof t.knownPeers),this.setKnown(t.knownPeers)),null!=t.authPeers&&(r(Array.isArray(t.authPeers)),this.setAuthorized(t.authPeers)),null!=t.prefix&&(r("string"==typeof t.prefix),this.prefix=t.prefix))}async open(){await this.readKnown(),await this.readAuth(),await this.lookup()}async close(){}addKnown(t,i){r("string"==typeof t,"Known host must be a string."),r(e.isBuffer(i)&&33===i.length,"Invalid public key for known peer.");const s=n.fromHostname(t);s.type!==n.types.DNS?this.known.set(t,i):this.dnsKnown.push([s,i])}addAuthorized(t){r(e.isBuffer(t)&&33===t.length,"Invalid public key for authorized peer."),this.authorized.push(t)}setKnown(t){this.known.clear();for(const e of Object.keys(t)){const i=t[e];this.addKnown(e,i)}}setAuthorized(t){this.authorized.length=0;for(const e of t)this.addAuthorized(e)}getKnown(t){const e=this.known.get(t);if(e)return e;const i=n.fromHostname(t);return this.known.get(i.host)}async lookup(){const t=[];for(const[e,i]of this.dnsKnown)t.push(this.populate(e,i));await Promise.all(t)}async populate(t,e){let i;r(t.type===n.types.DNS,"Resolved host passed."),this.logger.info("Resolving authorized hosts from: %s.",t.host);try{i=await this.resolve(t.host)}catch(t){return void this.logger.error(t)}for(let r of i)0!==t.port&&(r=n.toHostname(r,t.port)),this.known.set(r,e)}async readKnown(){if(a.unsupported)return;if(!this.prefix)return;const t=s.join(this.prefix,"known-peers");let e;try{e=await a.readFile(t,"utf8")}catch(t){if("ENOENT"===t.code)return;throw t}this.parseKnown(e)}parseKnown(t){r("string"==typeof t),65279===t.charCodeAt(0)&&(t=t.substring(1)),t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n");let i=0;for(const r of t.split("\n")){const t=r.trim();if(i+=1,0===t.length)continue;if("#"===t[0])continue;const s=t.split(/\s+/);if(s.length<2)throw new Error(`No key present on line ${i}: "${t}".`);const n=s[0].split(",");let o,a;n.length>=2?(o=n[0],a=n[1]):(o=null,a=n[0]);const h=e.from(s[1],"hex");if(33!==h.length)throw new Error(`Invalid key on line ${i}: "${s[1]}".`);o&&o.length>0&&this.addKnown(o,h),0!==a.length&&this.addKnown(a,h)}}async readAuth(){if(a.unsupported)return;if(!this.prefix)return;const t=s.join(this.prefix,"authorized-peers");let e;try{e=await a.readFile(t,"utf8")}catch(t){if("ENOENT"===t.code)return;throw t}this.parseAuth(e)}parseAuth(t){r("string"==typeof t),65279===t.charCodeAt(0)&&(t=t.substring(1)),t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n");let i=0;for(const r of t.split("\n")){const t=r.trim();if(i+=1,0===t.length)continue;if("#"===t[0])continue;const s=e.from(t,"hex");if(33!==s.length)throw new Error(`Invalid key on line ${i}: "${t}".`);this.addAuthorized(s)}}}}).call(this,i(0).Buffer)},function(t,e,i){
/*!
 * TXResponse.js - BIP152 related
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(2),s=i(6),n=i(4),o=i(17);function a(t){if(!(this instanceof a))return new a(t);this.hash=n.NULL_HASH,this.txs=[],t&&this.fromOptions(t)}i(52),a.prototype.fromOptions=function(t){return this.hash=t.hash,t.txs&&(this.txs=t.txs),this},a.fromOptions=function(t){return(new a).fromOptions(t)},a.prototype.fromReader=function(t){this.hash=t.readHash("hex");const e=t.readVarint();for(let i=0;i<e;i++)this.txs.push(o.fromReader(t));return this},a.prototype.fromRaw=function(t){return this.fromReader(new r(t))},a.fromReader=function(t){return(new a).fromReader(t)},a.fromRaw=function(t){return(new a).fromRaw(t)},a.prototype.fromBlock=function(t,e){this.hash=e.hash;for(const i of e.indexes){if(i>=t.txs.length)break;this.txs.push(t.txs[i])}return this},a.fromBlock=function(t,e){return(new a).fromBlock(t,e)},a.prototype.toRaw=function(){return this.frameRaw(!0)},a.prototype.toNormal=function(){return this.frameRaw(!1)},a.prototype.toWriter=function(t){return this.writeRaw(t,!0)},a.prototype.toNormalWriter=function(t){return this.writeRaw(t,!1)},a.prototype.getSize=function(t){let e=0;e+=32,e+=n.sizeVarint(this.txs.length);for(const i of this.txs)e+=t?i.getSize():i.getBaseSize();return e},a.prototype.writeRaw=function(t,e){t.writeHash(this.hash),t.writeVarint(this.txs.length);for(const i of this.txs)e?i.toWriter(t):i.toNormalWriter(t);return t},a.prototype.frameRaw=function(t){const e=this.getSize(t);return this.writeRaw(new s(e),t).render()},t.exports=a},function(t,e){var i=1e3,r=6e4,s=36e5,n=24*s;function o(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}t.exports=function(t,e){e=e||{};var a=typeof t;if("string"===a&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var o=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*n;case"hours":case"hour":case"hrs":case"hr":case"h":return o*s;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(t);if("number"===a&&!1===isNaN(t))return e.long?function(t){return o(t,n,"day")||o(t,s,"hour")||o(t,r,"minute")||o(t,i,"second")||t+" ms"}(t):function(t){return t>=n?Math.round(t/n)+"d":t>=s?Math.round(t/s)+"h":t>=r?Math.round(t/r)+"m":t>=i?Math.round(t/i)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,i){var r=i(532)("socket.io-parser"),s=i(122),n=i(534),o=i(417),a=i(418);function h(){}e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=h,e.Decoder=l;var c=e.ERROR+'"encode error"';function u(t){var i=""+t.type;if(e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(i+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(i+=t.nsp+","),null!=t.id&&(i+=t.id),null!=t.data){var s=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===s)return c;i+=s}return r("encoded %j as %s",t,i),i}function l(){this.reconstructor=null}function f(t){this.reconPack=t,this.buffers=[]}function d(t){return{type:e.ERROR,data:"parser error: "+t}}h.prototype.encode=function(t,i){r("encoding packet %j",t),e.BINARY_EVENT===t.type||e.BINARY_ACK===t.type?function(t,e){n.removeBlobs(t,function(t){var i=n.deconstructPacket(t),r=u(i.packet),s=i.buffers;s.unshift(r),e(s)})}(t,i):i([u(t)])},s(l.prototype),l.prototype.add=function(t){var i;if("string"==typeof t)i=function(t){var i=0,s={type:Number(t.charAt(0))};if(null==e.types[s.type])return d("unknown packet type "+s.type);if(e.BINARY_EVENT===s.type||e.BINARY_ACK===s.type){for(var n="";"-"!==t.charAt(++i)&&(n+=t.charAt(i),i!=t.length););if(n!=Number(n)||"-"!==t.charAt(i))throw new Error("Illegal attachments");s.attachments=Number(n)}if("/"===t.charAt(i+1))for(s.nsp="";++i;){if(","===(h=t.charAt(i)))break;if(s.nsp+=h,i===t.length)break}else s.nsp="/";var a=t.charAt(i+1);if(""!==a&&Number(a)==a){for(s.id="";++i;){var h;if(null==(h=t.charAt(i))||Number(h)!=h){--i;break}if(s.id+=t.charAt(i),i===t.length)break}s.id=Number(s.id)}if(t.charAt(++i)){var c=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(i));if(!(!1!==c&&(s.type===e.ERROR||o(c))))return d("invalid payload");s.data=c}return r("decoded %s as %j",t,s),s}(t),e.BINARY_EVENT===i.type||e.BINARY_ACK===i.type?(this.reconstructor=new f(i),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",i)):this.emit("decoded",i);else{if(!a(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(i=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",i))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},f.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=n.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},f.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e,i){(function(e){var r=i(537);t.exports=function(t){var i=t.xdomain,s=t.xscheme,n=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!i||r))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!s&&n)return new XDomainRequest}catch(t){}if(!i)try{return new(e[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}).call(this,i(12))},function(t,e,i){var r=i(123),s=i(122);function n(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}t.exports=n,s(n.prototype),n.prototype.onError=function(t,e){var i=new Error(t);return i.type="TransportError",i.description=e,this.emit("error",i),this},n.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},n.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(t){var e=r.decodePacket(t,this.socket.binaryType);this.onPacket(e)},n.prototype.onPacket=function(t){this.emit("packet",t)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e,i){"use strict";(function(e){
/*!
 * AuthProposePacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
let r=i(25),s=i(22);const n=i(2),o=(i(13),i(4)),a=(i(18),i(19),i(374));class h extends r{constructor(t,e=s.AUTHPROPOSE){super(e),this.hash=t||o.ZERO_HASH}getSize(){return 32}toWriter(t){return t.writeBytes(this.hash),t}toRaw(){return this.hash}fromReader(t){return this.hash=t.readHash(),this}fromRaw(t){return this.fromReader(new n(t))}static fromReader(t){return(new h).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new h).fromRaw(t)}async poolHandle(t,e){}async peerHandle(t){if(!t.bip150)return;const e=t.bip150.propose(this.hash);t.send(new a(e))}}t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * AuthChallengePacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=i(2),o=(i(13),i(3),i(4)),a=(i(18),i(19),i(375));class h extends r{constructor(t,e=s.AUTHCHALLENGE){super(e),this.hash=t||o.ZERO_HASH}getSize(){return 32}toWriter(t){return t.writeBytes(this.hash),t}toRaw(){return this.hash}fromReader(t){return this.hash=t.readHash(),this}fromRaw(t){return this.fromReader(new n(t))}static fromReader(t){return(new h).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new h).fromRaw(t)}async poolHandle(t,e){}async peerHandle(t){if(!t.bip150)return;const e=t.bip150.challenge(this.hash);t.send(new a(e))}}t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * AuthReplyPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=i(2),o=(i(13),i(4)),a=(i(18),i(19),i(373));class h extends r{constructor(t,e=s.AUTHREPLY){super(e),this.signature=t||o.ZERO_SIG64}getSize(){return 64}toWriter(t){return t.writeBytes(this.signature),t}toRaw(){return this.signature}fromReader(t){return this.signature=t.readBytes(64),this}fromRaw(t){return this.fromReader(new n(t))}static fromReader(t){return(new h).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new h).fromRaw(t)}async poolHandle(t,e){}async peerHandle(t){if(!t.bip150)return;const e=t.bip150.reply(this.signature);e&&t.send(new a(e))}}t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * VerackPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22);i(2),i(13),i(18),i(19);class n extends r{constructor(t=s.VERACK){super(t)}static fromReader(t){return(new n).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new n).fromRaw(t)}async poolHandle(t,e){return Promise.resolve()}async peerHandle(t){t.ack?t.logger.debug("Peer sent duplicate ack (%s).",t.hostname()):(t.ack=!0,t.logger.debug("Received verack (%s).",t.hostname()))}}t.exports=n}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * PongPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=i(2),o=(i(13),i(6)),a=i(4),h=(i(18),i(19),i(3));class c extends r{constructor(t,e=s.PONG){super(e),this.nonce=t||a.ZERO_U64}getSize(){return 8}toWriter(t){return t.writeBytes(this.nonce),t}toRaw(){return this.toWriter(new o(8)).render()}fromReader(t){return this.nonce=t.readBytes(8),this}fromRaw(t){return this.fromReader(new n(t))}static fromReader(t){return(new c).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new c).fromRaw(t)}async peerHandle(t){const e=this.nonce,i=h.ms();if(t.challenge){if(!e.equals(t.challenge))return e.equals(a.ZERO_U64)?(t.logger.debug("Peer sent a zero nonce (%s).",t.hostname()),void(t.challenge=null)):void t.logger.debug("Peer sent the wrong nonce (%s).",t.hostname());i>=t.lastPing?(t.lastPong=i,-1===t.minPing&&(t.minPing=i-t.lastPing),t.minPing=Math.min(t.minPing,i-t.lastPing)):t.logger.debug("Timing mismatch (what?) (%s).",t.hostname()),t.challenge=null}else t.logger.debug("Peer sent an unsolicited pong (%s).",t.hostname())}async poolHandle(t,e){}}t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * AddrPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=i(2),o=(i(13),i(6)),a=i(4),h=i(82);i(18),i(19);class c extends r{constructor(t,e=s.ADDR){super(e),this.items=t||[]}getSize(){let t=0;return(t+=a.sizeVarint(this.items.length))+30*this.items.length}toWriter(t){t.writeVarint(this.items.length);for(const e of this.items)e.toWriter(t,!0);return t}toRaw(){const t=this.getSize();return this.toWriter(new o(t)).render()}fromRaw(t){const e=new n(t),i=e.readVarint();for(let t=0;t<i;t++)this.items.push(h.fromReader(e,!0));return this}static fromReader(t){return(new c).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new c).fromRaw(t)}async poolHandle(t,e){const i=this.items,r=e.network.now(),s=e.options.getRequiredServices();for(const n of i)t.addrFilter.add(n.hostname,"ascii"),n.isRoutable()&&n.hasServices(s)&&((n.time<=1e8||n.time>r+600)&&(n.time=r-432e3),0!==n.port&&e.hosts.add(n,t.address));e.logger.info("Received %d addrs (hosts=%d, peers=%d) (%s).",i.length,e.hosts.size(),e.peers.size(),t.hostname()),e.fillOutbound()}}t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * TXPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(25),n=i(22),o=(i(2),i(13),i(17)),a=(i(18),i(19),i(65)),{broadcast:h}=i(202);class c extends s{constructor(t,e,i=n.TX){super(i),this.tx=t||new o,this.witness=e||!1}getSize(){return this.witness?this.tx.getSize():this.tx.getBaseSize()}toWriter(t){return this.witness?this.tx.toWriter(t):this.tx.toNormalWriter(t)}toRaw(){return this.witness?this.tx.toRaw():this.tx.toNormal()}fromReader(t){return this.tx.fromRaw(t),this}fromRaw(t){return this.tx.fromRaw(t),this}static fromReader(t){return(new c).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new c).fromRaw(t)}async poolHandle(t,e){const i=this.tx.hash("hex"),r=await e.locker.lock(i);try{return await this._poolHandle(t,e)}finally{r()}}async _poolHandle(t,e){const i=this.tx,s=i.hash("hex"),n=a.flags.VERIFY_NONE,o=t.merkleBlock;if(o&&(r(t.merkleMatches>0),r(t.merkleMap),o.hasTX(s)))return t.merkleMap.has(s)?(e.logger.warning("Peer sent duplicate merkle tx: %s (%s).",i.txid(),t.hostname()),void t.increaseBan(100)):(t.merkleMap.add(s),o.txs.push(i),void(0==--t.merkleMatches&&(t.merkleBlock=null,t.merkleTime=-1,t.merkleMatches=0,t.merkleMap=null,await e._addBlock(t,o,n))));if(!e.resolveTX(t,s))return e.logger.warning("Peer sent unrequested tx: %s (%s).",i.txid(),t.hostname()),void t.destroy();if(h("p2p/transaction",this.tx.formatInsight()),e.mempool){let r;try{r=await e.mempool.addTX(i,t.id)}catch(i){if("VerifyError"===i.type)return t.reject("tx",i),void e.logger.info(i);throw i}r&&r.length>0&&(e.logger.debug("Requesting %d missing transactions (%s).",r.length,t.hostname()),e.ensureTX(t,r))}else e.emit("tx",i)}}t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * NotFoundPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(214),s=i(22);i(2),i(13),i(39),i(18),i(19);class n extends r{constructor(t,e=s.NOTFOUND){super(t,e)}static fromReader(t){return(new n).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new n).fromRaw(t)}async poolHandle(t,e){const i=this.items;for(const r of i)if(!e.resolveItem(t,r))return e.logger.warning("Peer sent notfound for unrequested item: %s (%s).",r.hash,t.hostname()),void t.destroy()}}t.exports=n}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * GetBlocksPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(25),n=i(22),o=i(2),a=(i(13),i(6)),h=i(60),c=i(4),u=(i(18),i(19),i(39));class l extends s{constructor(t,e,i=n.GETBLOCKS){super(i),this.version=h.PROTOCOL_VERSION,this.locator=t||[],this.stop=e||null}getSize(){let t=0;return t+=4,t+=c.sizeVarint(this.locator.length),(t+=32*this.locator.length)+32}toWriter(t){r(this.locator.length<=5e4,"Too many block hashes."),t.writeU32(this.version),t.writeVarint(this.locator.length);for(const e of this.locator)t.writeHash(e);return t.writeHash(this.stop||c.ZERO_HASH),t}toRaw(){const t=this.getSize();return this.toWriter(new a(t)).render()}fromReader(t){this.version=t.readU32();const e=t.readVarint();r(e<=5e4,"Too many block hashes.");for(let i=0;i<e;i++)this.locator.push(t.readHash("hex"));return this.stop=t.readHash("hex"),this.stop===c.NULL_HASH&&(this.stop=null),this}fromRaw(t){return this.fromReader(new o(t))}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new l).fromRaw(t)}async poolHandle(t,e){if(!e.chain.synced)return;if(e.options.selfish)return;if(e.chain.options.spv)return;if(e.chain.options.prune)return;let i=await e.chain.findLocator(this.locator);i&&(i=await e.chain.getNextHash(i));const r=[];for(;i&&(r.push(new u(u.types.BLOCK,i)),i!==this.stop);){if(500===r.length){t.hashContinue=i;break}i=await e.chain.getNextHash(i)}t.sendInv(r)}}t.exports=l}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * GetBlockTxnPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=(i(2),i(13),i(368)),o=i(414),a=(i(18),i(19),i(39)),h=i(383);class c extends r{constructor(t,e=s.GETBLOCKTXN){super(e),this.request=t||new o}getSize(){return this.request.getSize()}toWriter(t){return this.request.toWriter(t)}toRaw(){return this.request.toRaw()}fromReader(t){return this.request.fromReader(t),this}fromRaw(t){return this.request.fromRaw(t),this}static fromReader(t){return(new c).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new c).fromRaw(t)}async poolHandle(t,e){const i=this.request;if(e.chain.options.spv)return;if(e.chain.options.prune)return;if(e.options.selfish)return;const r=new a(a.types.BLOCK,i.hash),s=await e.getItem(t,r);if(!s)return e.logger.debug("Peer sent getblocktxn for non-existent block (%s).",t.hostname()),void t.increaseBan(100);if(await e.chain.getHeight(i.hash)<e.chain.tip.height-15)return void e.logger.debug("Peer sent a getblocktxn for a block > 15 deep (%s)",t.hostname());e.logger.debug("Sending blocktxn for %s to peer (%s).",s.rhash(),t.hostname());const o=n.fromBlock(s,i);t.send(new h(o,t.compactWitness))}}t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * BlockTxnPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(25),n=i(22),o=(i(2),i(13),i(368)),a=(i(18),i(19),i(65));class h extends s{constructor(t,e,i=n.BLOCKTXN){super(i),this.response=t||new o,this.witness=e||!1}getSize(){return this.witness?this.response.getSize(!0):this.response.getSize(!1)}toWriter(t){return this.witness?this.response.toWriter(t):this.response.toNormalWriter(t)}toRaw(){return this.witness?this.response.toRaw():this.response.toNormal()}fromReader(t){return this.response.fromReader(t),this}fromRaw(t){return this.response.fromRaw(t),this}static fromReader(t){return(new h).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new h).fromRaw(t)}async poolHandle(t,e){const i=this.response,s=t.compactBlocks.get(i.hash),n=a.flags.VERIFY_BODY;if(s){if(t.compactBlocks.delete(i.hash),r(e.compactBlocks.has(i.hash)),e.compactBlocks.delete(i.hash),!s.fillMissing(i))return e.logger.warning("Peer sent non-full blocktxn for %s. Requesting full block (%s).",s.rhash(),t.hostname()),t.getFullBlock(i.hash),void t.increaseBan(10);e.logger.debug("Filled compact block %s (%s).",s.rhash(),t.hostname()),await e.addBlock(t,s.toBlock(),n)}else e.logger.debug("Peer sent unsolicited blocktxn (%s).",t.hostname())}}t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * mappedlock.js - lock and queue for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */function r(){}t.exports=class{constructor(){this.jobs=new Map,this.busy=new Set,this.destroyed=!1}has(t){return this.busy.has(t)}hasPending(t){return this.jobs.has(t)}lock(t,e){return this.destroyed?Promise.reject(new Error("Lock is destroyed.")):null==t?Promise.resolve(r):e?Promise.resolve(r):this.busy.has(t)?new Promise((e,i)=>{this.jobs.has(t)||this.jobs.set(t,[]),this.jobs.get(t).push(new function(t,e){this.resolve=t,this.reject=e}(e,i))}):(this.busy.add(t),Promise.resolve(this.unlock(t)))}unlock(t){const e=this;return function i(){if(e.destroyed||!e.busy.has(t))return;e.busy.delete(t);const r=e.jobs.get(t);if(!r)return;0===r.length&&e.jobs.delete(t);const s=r.shift();0===r.length&&e.jobs.delete(t),e.busy.add(t),s.resolve(i)}}destroy(){if(!this.destroyed){this.destroyed=!0;const t=this.jobs;this.busy=new Map,this.jobs=new Map;for(const e of t.values())for(const t of e)t.reject(new Error("MappedLock was destroyed."))}}}},function(t,e,i){"use strict";
/*!
 * TXRecord.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(3),n=i(2),o=i(6),a=i(17),h=i(187);class c{constructor(t,e){this.tx=null,this.hash=null,this.mtime=s.now(),this.height=-1,this.block=null,this.index=-1,this.time=0,t&&this.fromTX(t,e)}fromTX(t,e){return this.tx=t,this.hash=t.hash("hex"),e&&this.setBlock(e),this}static fromTX(t,e){return(new c).fromTX(t,e)}setBlock(t){this.height=t.height,this.block=t.hash,this.time=t.time}unsetBlock(){this.height=-1,this.block=null,this.time=0}getBlock(){return-1===this.height?null:new h(this.block,this.height,this.time)}getDepth(t){return r("number"==typeof t,"Must pass in height."),-1===this.height?0:t<this.height?0:t-this.height+1}getSize(){let t=0;return t+=this.tx.getSize(),t+=4,this.block?(t+=1,t+=32,t+=12):t+=1,t}toRaw(){const t=this.getSize(),e=new o(t);let i=this.index;return this.tx.toWriter(e),e.writeU32(this.mtime),this.block?(-1===i&&(i=2147483647),e.writeU8(1),e.writeHash(this.block),e.writeU32(this.height),e.writeU32(this.time),e.writeU32(i)):e.writeU8(0),e.render()}fromRaw(t){const e=new n(t);return this.tx=new a,this.tx.fromReader(e),this.hash=this.tx.hash("hex"),this.mtime=e.readU32(),1===e.readU8()&&(this.block=e.readHash("hex"),this.height=e.readU32(),this.time=e.readU32(),this.index=e.readU32(),2147483647===this.index&&(this.index=-1)),this}static fromRaw(t){return(new c).fromRaw(t)}}t.exports=c},function(t,e,i){"use strict";t.exports=["ebd41040e4bb3ec742c9e381d31ef2a41a48b6685c96e7cef3c1df6cd4331c99","ca42dd41745fd0b81eb902362cf9d8bf719da1bd1b1efc946f5b4c99f42c1b9e","eb04cf5eb1f39afa762f2bb120f296cba520c1b97db1589565b81cb9a17b7244","6dc47172e01cbcb0bf62580d895fe2b8ac9ad4f873801e0c10b9c837d21eb177","16af57a9f676b0ab126095aa5ebadef22ab31119d644ac95cd4b93dbf3f26aeb","8c7209279ac04e275e16d07fd3b775e80154b5968046e31f52dd25766324e9a7","687fa451382278fff0c8b11f8d43d576671c6eb2bceab413fb83d965d06d2ff2","0791ca0749b20782aad3c7d7bd0cdfc9485835843eb2d7996009ce43ab6c6927","8095210805db4bbc355e4428d8fd6ec2cde3ab5fb97a9942988eb8f4dcd06016","73c176434f1bc6d5adf45b0e76e727287c8de57616c1e6e6141a2b2cbc7d8e4c","af8b6762a1e528228161a95d5c559ee266278f75d79e830189a503506abd6b4c","ff856a2d251dcd88d36656f450126798cfabaade40799c722de4d2b5db36a73a","ca2d82a08677072f8ab6764ff035676cfe3e5e325e012172df3f92096db79b85","a0459b9f63b22559f5fa5d4c6db3f9f72ff19342033578f073bf1d1b46cbb912","a0234f3bc8527ca5628eec81ad5d69895da5680dc91d1cb8477f33f878b95b0b","69fac9bd55fb0ac78d53bbee5cf1d597989fd0aaab20a25151bdf1733ee7d122","d8e0febc1db2e38d00940f37d27d41344d993e734b99d5656d9778d4d8143624","d7a7a0fb5d7e2731d771e9484ebcdef71d5f0c3e0a2948782bc83ee0ea699ef4","bd81ce3b4f6591d11a67b5fc7a47fdef25521bf9aa4e18b9e3df2e34a7803be8","3f06e55681d496f5be169eb5389f9f2b8ff61e1708df6881724849cd5d27cb69","a45ede3bbbf09c8ae15c72efc07268d693a21c996fd51e67ca079460fd6d8873","85a0dd7dd720adb7ff05f83d542b209dc7ff4528f7d677b18389fea5e5c49e86","18f1fc7f205df8adddeb7fe007dd57e3af375a9c4d8d73546bf4f1fed1e18d35","e75e72ed9f560eec6eb4800073a43fc3ad19195a392282017895974a99026b6c","7908b40314c138100b518d0735807ffbfcf8518a0095337105ba386b153dd927","6ea54741d004667eed1b4816634aa3a79e6e4b96950f8279dafc8d9bd8812137","0c258a12a5674aef25f28ba7dcfaeceea348e541e6f5cc4ee63b71b361606ac3","ef3cb417fc8ebf6f97876c9e4ece39de1ea5fe649141d1028b7d11c0b2298ced","cecddc905099d8dadfc5b1d209b737cbe2c18cfb2c10c0ff0bcf0d3286fc1aa2","c3846bf24b9e93ca64274c0ec67c1ecc5e024ffcacd2d74019350e81fe546ae4","1465fa205397b876faa6f0a9958e5590e40fcc7faa4fb7c2c8677521fb5fb658","c766a9bef2d4071c863a31aa4920e813b2d198608cb7b7cfe21143b836df09ea","7600295eefe85b9e1fd624db76062aaaae59818a54d2774cd4c0b2c01131e1b3","21db20123660bb2ed418205da11ee7a85a65e2bc6e55b5af7e7899c8a266d92e","3e9099b5015e8f486c00bcea9d111ee721faba355a89bcf1df69561e3dc6325c","4348a0e9444c78cb265e058d5e8944b4d84f9662bd26db257f8934a443c70161","7431e5f4c3c1ce4690774f0b61e05440883ba9a01ed00ba6abd7806ed3b118cf","0f993c8aef97baaf5687140ed59ad1821bb4afacf0aa9a58b5d57a338a3afbcb","0687260331a72403d909f105e69bcf0d32e1bd2493ffc6d9206d11bcd6770739","767c955a76412c89af688e90a1c70f556cfd6b6025dbea10416d7eb6831f8c40","62dd0be9b9f50a163ea0f8e75c053b1eca57ea55c8688f647c6881f2c8357b95","be6c4da2bbb9ba59b6f3939768374246c3c005993fa98f020d1dedbed48a81d5","37d51006c512eaab626421f1ec8c92013fc5f82ae98ee533eb4619b8deb4d06c","8d722f81a9c113c0791df136a2966db26c950a971db46b4199f4ea54b78bfb9f","9acfab7e43c8d880d06b262a94deeee4b4659989c3d0caf19baf6405e41ab7df","f1c1b50ae5a20dd8030ec9f6bc24823dd367b5255759b4e71b61fce9f7375d73","4200f5043ac8590ebb527d209ed1503029fbcbd41ca1b506ec27f15ade7dac69","0c2cd63df7806fa399ede809116b575bf87989f06518f9808c860503178baf66","15f0ba00a3ac7af3ac884c072b1011a077bd77c097f40164b2f8598abd83860c","a71272aeaaa3cfe8727f7fb39f0fb3d1e5426e9060b06ee6f13e9a3c5833cd43","1793927a0614549789adce2f8f34f7f0b66d0f3ae3a3b84d21ec15dbba4fadc7","b9bea7860a962ea3611dab97ab6da3e21c1068b97d55575ed0e11279c11c8932","a22dba681e97376e2d397d728aae3a9b6296b9fdba60bc2e11f647f2c675fb37","41c923866ab4cad6b7ad578081582e020797a6cbdf4fff78ce8396b38937d7f5","327a3d761abadea034eb998406275cb1a4776efdae2fdf6d0168ea1c4f5567d0","e3b6a2db2ed7ce48842f7ac53241c7b71d54144bfb40c11f3f1d0b42f5eea12d","b6191a50d0c3977f7da99bcdaac86a227daeb9679ec70ba3b0c9d92271c170d3","960adf0063e96356750c2965dd0a0867da0b9cbd6e77714aeafb2349ab393da3","c0a6f4dc63a24bfdcf54ef2a6a082a0a72de35803e2ff5ff527ae5d87206dfd5","e4c73430d7a5b50925df43370a0d216e9a79b9d6db8373a0c69eb1cc31c7c52a","0f4e9cdd264b025550d170806340214fe94434c9b02f697ec710fc5feafb5e38","35ae5bddd8f7ae635cffba5682a8f00b95f48462c7108ee9a0e5292b074aafb2","eaa962c4fa4a6bafebe415196d351ccd888d4f53f3fa8ae6d7c466a94e6042bb","e28393773da845a679f2080cc7fb44a3b7a1c3792cb7eb7729fdcb6a8d99aea7","2d47437de17951215a12f3c58e51c729a58026ef1fcc0a5fb3d9dc012f600d19","b478b812250df878635c2aa7ec7d155eaa625ee82916e2cd294361886cd1fbd4","a4310d50af18a6447190372a86afaf8b951ffb431d837f1e5688b45971ed1557","4b03f45807ad70f21bfc2cae71c9fde4604c064cf5ffb686bae5dbaad7fdd34c","5edb7ac43b82a06a8761e8d7be4979ebf2611f7dd79bf91c1c6b566a219ed766","2399561127a57125de8cefea610ddf2fa078b5c8067f4e828290bfb860e84b3c","69ddd7ea90bb57c93e135dc85ea6fcd5480b603239bdc454fc758b2a26cf7f79","6c61dac3a2def031506be036d2a6fe401994fbd13df9c8d466599274c446ec98","668c83947da63b724bece1743c31a0e6aed0db8ec5b31be377bb784f91b6716f","ecc3e9c3407503bee091aa952f41348ff88baa863b2264befac807901574e939","f9e67d336c51002ac054c632022d66dda2e7e3fff10ad061ed31d8bbb410cfb2","bf0feefb9e3a581ad5f9e9db7589985743d261085c4d314f6f5d7259aa421612","03950fb49a531f3e1991942398dfa9e0ea32d7ba1cdd9bc85db57ed9400b434a","3c5f81fea5fab82c64bfa2eaecafcde8e077fc8620a7cae537163df36edbf378","cbb522d7b7f127ad6a0113865bdf1cd4102e7d0759af635a7cf4720dc963c53b","04048028bf1f2864d48f9ad4d83294366a828856553f3b14303f90147f5d40ef","2530cc8e98321502bad96f9b1fba1b099e2d299e0f4548bb914f363bc0d4531f","063e4afac491dfd332f3089b8542e94617d893d7fe944e10a7937ee29d9693c0","136335439334a7698016a0d324de72284e079d7b5220bb8fbd747816eebebaca","45140b3247eb9cc8c5b4f0d7b53091f73292089e6e5a63e2749dd3aca9198eda","2ce1cb0bf9d2f9e102993fbe215152c3b2dd0cabde1c68e5319b839154dbb7f5","568d6905a2c88708a4b3025190edcfedb1974a606a13c6e5290fcb2ae63edab5","0376ab1d54c5f9803ce4b2e201a0ee7eef7b57b636e8a93c9b8d4860c96f5fa7","0a81ec5a929777f145904af38d5d509f66b5e2c58fcdb531058b0e17f3f0b41b","70a73f7f376b60074248904534b11482d5bf0e698ecc498df52577ebf2e93b9a","bd71fdf6da97e4cf62d1647add2581b07d79adf8397eb4ecba9c5e8488821423","5c58468d55f58e497e743982d2b50010b6d165374acf83a7d4a32db768c4408e","fcbfe2886206f72b27593c8b070297e12d769ed10ed7930705a8098effc14d17","8c4edfd04348f322969e7e29a4cd4dca004655061c16e1b076422ef342ad630e","bfd88fe1101c41ae3e801bf8be56350ee9bad1a6b9bd515edc5c6d5b8711ac44","513b2cecb810d4cde5dd85391adfc6c2dd60d87bb736d2b521484aa47a0ebef6","88497f01602f3154246ae28c4d5aef10f1d87ebb76626f4ae0b7f95ba7968799","bc104f15a48be709dca542a7e1d4b9df6f054527e802eaa92d595444258afe71","55926084ec963a64b96e2abe01ce0ba86a64fbfebcc7aab5afc155b37fd76066","c1b48299aba5208fe9630ace55ca68a03eda5a519c8802a0d3a673be8f8e557d","e17890ee09a3fbf4f48b9c414a17d637b7a50647e9bc752322727fcc1742a911","c7ba6567de93a798ae1faa791e712d378fae1f93c4397fea441bb7cbe6fd5995","9a114025197c5bb95d94e63d55cd43790847b646b23cdf11ada4a00eff15fb48","edf7ebbca27a2a384d387b7d4010c666e2edb4843e4c29b4ae1d5b9332e6b24d","fd73dad31c644ff1b43bef0ccdda96710b9cd9875eca7e31707af3e96d522bbd","3e84ba4342908516e77573c0992f0979ca084e4685681ff195ccba8a229b8a76","978cd966f2faa07ba7aa9500d9c02e9d77f2cdada6ad6ba74af4b91c66593c50","49e7a442acf0ea6287050054b52564b650e4f49e42e348d6aa38e039e957b1c1","eec5496b988ce98625b934092eec2908bed0b0f316c2d4730c84eaf1f3d34881","3cfc3c14d1f684ff17e38c43ca440c00b967ec933e8bfe064ca1d72c90f2adb0","1c01c6f4dbb2fefc22558b2bca32563f49844acfc32b7be4b0ff599f9e8c7af7","f09b122c7114f4a09bd4ea4f4a99d558b46e4c25cd81140d29c05613914c3841","d95fea3ca4eedce74cd76e75fc6d1ff62c441f0fa8bc77f034b19e5db258015d","f96f23f4c3e79c077a46988d5af5900676a0f039cb645dd17549b216c82440ce","e23d4a036d7b70e9f595b1422079d2b91edfbb1fb651a0633eaa8a9dc5f80703","9a6ec012e1a7da9dbe34194d478ad7c0db1822fb071df12981496ed104384113","59769007f7685d0fcd50872f9f95d5755a5b2b457d81f3692b610a98672f0e1b","dd6936fe21f8f077c123a1a521c12224f72255b73e03a7260693e8a24b0fa389","b0bfd52bb0d7d9bd92bf5d4dc13da255c02c542f378365ea893911f55e55f23c","91e2f5788d5810eba7ba58737de1548a8ecacd014598bc0b143e041b17052552","f356bea244b7a91eb35d53ca9ad7864ace018e2d35d5f8f96ddf68a6f41aa474","8a866fd1b276b57e578e921c65828a2bed58e9f2f288054134b7f1f4bfc9cc74","8fe4fb0af93a4d0d67db0bebb23e37c71bf325dcbcdd240ea04daf58b47e1840","88ef81de202eb018452e43f864725cea5fbd1fc2d9d205730709c5d8b8690f46","7d05ebb682339f8c9451ee094eebfefa7953a114edb2f44949452fab7d2fc185","7e37cb8b4c47090cab36551ba6f45db840680fba166a952db100717f43053fc2","cb3ccbb76031e5e0138f8dd39a23f9de47ffc35e43c1144cea27d46a5ab1cb5f","31ad6648f8104138c738f39ea4320133393e3a18cc02296ef97c2ac9ef6731d0","552f7bdcf1a7af9e6ce672017f4f12abf77240c78e761ac203d1d9d20ac89988","4b22d5a6aec99f3cdb79aa5ec06838479cd5ecba7164f7f22dc1d65f63d85708","d6f034bd94aa233f0297eca4245b283973e447aa590f310c77f48fdf83112254","52f0e1c4e58ec629291b60317f074671b85d7ea80d5b07273463534b32b40234","e793c9b02fd8aa13e21c31228accb08119643b749c898964b1746d46c3d4cbd2","4ff460d54b9c86dabfbcfc5712e0400d2bed3fbc4d4fbdaa86e06adcd2a9ad7a","bec94911c2955676db6c0a550986d76e3ba005667c442c9762b4fbb773de228c","179fbc148a3dd00fd24ea13458cc43bfa7f59c8182d783a513f6ebec100c8924","3c4fb0b95ab8b30032f432b86f535fe172c185d0fd39865837cf36187fa6f428","4d2491414cfe956746ec4cefa6cf6f72e28a1329432f9d8a907ac4cb5dadc15a","5d56499be4d2e08bcfcad08a3e38723d50503bde706948e42f55603019e528ae","30d0895a9a448a262091635522d1f52010b5867acae12c78ef958fd4f4389f2f","43df5774b03e7fef5fe40d931a7bedf1bb2e6b42738c4e6d3841103d3aa7f339","02ed0eb28c14da45165c566791700d6451d7fb56f0b2ab1d3b8eb070e56edff5","5cc3d78e4e1d5e45547a04e6873e64f90cf9536d1ccc2ef800f355c4c5fd70fd","49351b903444c185ccdc5c693d24d8555cb208d6a8141307699f4af063199d78","8de78655e1be7f7847800b93f694d21d368cc06e033e7fab04bb5eb99da6b700","2a99f5bc1174b73cbb1d620884e01c34e51ccb3978da125f0e33268883bf4158","6b9c08e86eb0f767cfad65cd98b62149e5494a67f5845e7bd1ed019f27b86bd6","d487a56f83b07482e85e963394c1ecc2c9e51d0903ee946b02c301581ed99e16","8b45da1c06f791eb0cabf26be588f5fb23165c2e614bf885562d0dce50b29b02","a1339d33281a0b56e557d3d32b1ce7f9367eb094bd5fa72a7e5004c8ded7cafe","b676f2eddae8775cd36cb0f63cd1d4603961f49e6265ba013a2f0307b6d0b804"]},function(t,e,i){"use strict";(function(e){
/*!
 * payment.js - bip70 payment for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(28),n=i(17),o=i(20),a=i(127),h=i(131),c=i(250);function u(t){if(!(this instanceof u))return new u(t);this.merchantData=null,this.transactions=[],this.refundTo=[],this.memo=null,t&&this.fromOptions(t)}u.prototype.fromOptions=function(t){if(t.merchantData&&this.setData(t.merchantData),t.transactions){r(Array.isArray(t.transactions));for(const e of t.transactions){const t=new n(e);this.transactions.push(t)}}if(t.refundTo){r(Array.isArray(t.refundTo));for(const e of t.refundTo){const t=new s(e);this.refundTo.push(t)}}return null!=t.memo&&(r("string"==typeof t.memo),this.memo=t.memo),this},u.fromOptions=function(t){return(new u).fromOptions(t)},u.prototype.setData=c.prototype.setData,u.prototype.getData=c.prototype.getData,u.prototype.fromRaw=function(t){const e=new a(t);for(this.merchantData=e.readFieldBytes(1,!0);2===e.nextTag();){const t=n.fromRaw(e.readFieldBytes(2));this.transactions.push(t)}for(;3===e.nextTag();){const t=new a(e.readFieldBytes(3)),i=new s;i.value=t.readFieldU64(1,!0),i.script=o.fromRaw(t.readFieldBytes(2,!0)),this.refundTo.push(i)}return this.memo=e.readFieldString(4,!0),this},u.fromRaw=function(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new u).fromRaw(t)},u.prototype.toRaw=function(){const t=new h;this.merchantData&&t.writeFieldBytes(1,this.merchantData);for(const e of this.transactions)t.writeFieldBytes(2,e.toRaw());for(const e of this.refundTo){const i=new h;i.writeFieldU64(1,e.value),i.writeFieldBytes(2,e.script.toRaw()),t.writeFieldBytes(3,i.render())}return null!=this.memo&&t.writeFieldString(4,this.memo),t.render()},t.exports=u}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t){
/*!
 * x509.js - x509 handling for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(251),n=i(252),o=i(3),a=i(9),h=i(389),c=i(386),u=e;u.trusted=new Set,u.allowUntrusted=!1,u.oid={"1.2.840.10040.4.1":{key:"dsa",hash:null},"1.2.840.10040.4.2":{key:"dsa",hash:null},"1.2.840.10040.4.3":{key:"dsa",hash:"sha1"},"1.2.840.113549.1.1.1":{key:"rsa",hash:null},"1.2.840.113549.1.1.2":{key:"rsa",hash:"md2"},"1.2.840.113549.1.1.3":{key:"rsa",hash:"md4"},"1.2.840.113549.1.1.4":{key:"rsa",hash:"md5"},"1.2.840.113549.1.1.5":{key:"rsa",hash:"sha1"},"1.2.840.113549.1.1.11":{key:"rsa",hash:"sha256"},"1.2.840.113549.1.1.12":{key:"rsa",hash:"sha384"},"1.2.840.113549.1.1.13":{key:"rsa",hash:"sha512"},"1.2.840.113549.1.1.14":{key:"rsa",hash:"sha224"},"1.2.840.10045.2.1":{key:"ecdsa",hash:null},"1.2.840.10045.4.1":{key:"ecdsa",hash:"sha1"},"1.2.840.10045.4.3.1":{key:"ecdsa",hash:"sha224"},"1.2.840.10045.4.3.2":{key:"ecdsa",hash:"sha256"},"1.2.840.10045.4.3.3":{key:"ecdsa",hash:"sha384"},"1.2.840.10045.4.3.4":{key:"ecdsa",hash:"sha512"}},u.curves={"1.3.132.0.33":"p224","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"},u.getSubjectOID=function(t,e){const i=t.tbs.subject;for(const t of i)if(t.type===e)return t.value;return null},u.getCAName=function(t){return u.getSubjectOID(t,"2.5.4.3")||u.getSubjectOID(t,"2.5.4.11")||u.getSubjectOID(t,"2.5.4.10")||"Unknown"},u.isTrusted=function(t){const e=a.sha256(t.raw).toString("hex");return u.trusted.has(e)},u.setTrust=function(e){r(Array.isArray(e),"Certs must be an array.");for(let i of e){if("string"==typeof i){const t=n.decode(i);r("certificate"===t.type,"Must add certificates to trust."),i=t.data}r(t.isBuffer(i),"Certificates must be PEM or DER."),i=u.parse(i);const e=a.sha256(i.raw).toString("hex");u.trusted.add(e)}},u.setFingerprints=function(e){r(Array.isArray(e),"Certs must be an array.");for(let i of e)"string"==typeof i&&(i=t.from(i,"hex")),r(t.isBuffer(i),"Fingerprint must be a buffer."),r(32===i.length,"Fingerprint must be a sha256 hash."),i=i.toString("hex"),u.trusted.add(i)},u.getKeyAlgorithm=function(t){const e=t.tbs.pubkey.alg.alg,i=u.oid[e];if(!i)throw new Error(`Unknown key algorithm: ${e}.`);return i},u.getSigAlgorithm=function(t){const e=t.sigAlg.alg,i=u.oid[e];if(!i||!i.hash)throw new Error(`Unknown signature algorithm: ${e}.`);return i},u.getCurve=function(t){let e;try{e=s.parseOID(t)}catch(t){throw new Error("Could not parse curve OID.")}const i=u.curves[e];if(!i)throw new Error(`Unknown ECDSA curve: ${e}.`);return i},u.parse=function(t){try{return s.parseCert(t)}catch(t){throw new Error("Could not parse DER certificate.")}},u.getPublicKey=function(t){const e=u.getKeyAlgorithm(t),i=t.tbs.pubkey.pubkey,r=t.tbs.pubkey.alg.params;let s=null;if("ecdsa"===e.key){if(!r)throw new Error("No curve selected for ECDSA (cert).");s=u.getCurve(r)}return{alg:e.key,data:i,params:r,curve:s}},u.verifyTime=function(t){const e=t.tbs.validity,i=o.now();return i>e.notBefore&&i<e.notAfter},u.getSigningKey=function(t,e){if(r(0!==e.length,"No chain available."),"string"==typeof t){let e=null;if("ecdsa"===(t=n.decode(t)).alg){if(!t.params)throw new Error("No curve selected for ECDSA (key).");e=u.getCurve(t.params)}t={alg:t.alg,data:t.data,params:t.params,curve:e}}else{const i=u.parse(e[0]),r=u.getPublicKey(i);t={alg:r.alg,data:t,params:r.params,curve:r.curve}}return t},u.signSubject=function(t,e,i,r){const s=u.getSigningKey(i,r);return h.sign(t,e,s)},u.getVerifyKey=function(t){if(0===t.length)throw new Error("No verify key available (cert chain).");const e=u.parse(t[0]);return u.getPublicKey(e)},u.verifySubject=function(t,e,i,r){const s=u.getVerifyKey(r);return h.verify(t,e,i,s)},u.parseChain=function(t){const e=[];for(const i of t){const t=u.parse(i);e.push(t)}return e},u.verifyTimes=function(t){for(const e of t)if(!u.verifyTime(e))return!1;return!0},u.verifyTrust=function(t){if(u.allowUntrusted)return!0;for(const e of t)if(u.isTrusted(e))return!0;return!1},u.verifyChain=function(t){const e=u.parseChain(t);if(!u.verifyTimes(e))throw new Error("Invalid certificate times.");for(let t=1;t<e.length;t++){const i=e[t-1],r=e[t],s=u.getSigAlgorithm(i),n=u.getPublicKey(r),o=i.tbs.raw,a=i.sig;if(!h.verify(s.hash,o,a,n))throw new Error(`${s.key} verification failed for chain.`)}if(!u.verifyTrust(e))throw new Error("Certificate chain is untrusted.");return!0},u.setFingerprints(c)}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * pk.js - public key algorithms for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(390),s=i(391);e.verify=function(t,e,i,n){switch(n.alg){case"rsa":return r.verify(t,e,i,n.data);case"ecdsa":return s.verify(n.curve,t,e,i,n.data);default:throw new Error("Unsupported algorithm.")}},e.sign=function(t,e,i){switch(i.alg){case"rsa":return r.sign(t,e,i.data);case"ecdsa":return s.sign(i.curve,t,e,i.data);default:throw new Error("Unsupported algorithm.")}}},function(t,e,i){"use strict";(function(t){
/*!
 * rsa-browser.js - rsa for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(43),n=i(251),o=i(9),a=i(109),h=e;function c(t,e){let i=255&~(t^e);return i&=i>>>4,1==((i&=i>>>2)&i>>>1)}h.prefixes={md5:t.from("3020300c06082a864886f70d020505000410","hex"),sha1:t.from("3021300906052b0e03021a05000414","hex"),sha224:t.from("302d300d06096086480165030402040500041c","hex"),sha256:t.from("3031300d060960864801650304020105000420","hex"),sha384:t.from("3041300d060960864801650304020205000430","hex"),sha512:t.from("3051300d060960864801650304020305000440","hex"),ripemd160:t.from("30203008060628cf060300310414","hex")},h.verify=function(e,i,u,l){r("string"==typeof e,"No algorithm selected."),r(t.isBuffer(i)),r(t.isBuffer(u)),r(t.isBuffer(l));const f=h.prefixes[e];if(!f)throw new Error("Unknown PKCS prefix.");const d=o.hash(e,i),p=f.length+d.length,g=n.parseRSAPublic(l),m=new s(g.modulus),w=new s(g.publicExponent),y=Math.ceil(m.bitLength()/8);if(y<p+11)throw new Error("Message too long.");const b=function(e,i){let r=e.length;r>i&&(r=i);const s=t.allocUnsafe(i);return s.fill(0),e.copy(s,s.length-r),s}(h.encrypt(m,w,u),y);let v=c(b[0],0);v&=c(b[1],1),v&=a(b.slice(y-d.length,y),d),v&=a(b.slice(y-p,y-d.length),f),v&=c(b[y-p-1],0);for(let t=2;t<y-p-1;t++)v&=c(b[t],255);return 1===v},h.sign=function(e,i,a){r("string"==typeof e,"No algorithm selected."),r(t.isBuffer(i)),r(t.isBuffer(a));const c=h.prefixes[e];if(!c)throw new Error("Unknown PKCS prefix.");const u=o.hash(e,i),l=c.length+u.length,f=n.parseRSAPrivate(a),d=new s(f.modulus),p=new s(f.privateExponent),g=Math.ceil(d.bitLength()/8);if(g<l+11)throw new Error("Message too long.");const m=t.allocUnsafe(g);m.fill(0),m[1]=1;for(let t=2;t<g-l-1;t++)m[t]=255;return c.copy(m,g-l),u.copy(m,g-u.length),h.decrypt(d,p,m)},h.decrypt=function(e,i,r){const n=new s(r);if(n.cmp(e)>0)throw new Error("Cannot decrypt.");return n.toRed(s.red(e)).redPow(i).fromRed().toArrayLike(t,"be")},h.encrypt=function(e,i,r){return new s(r).toRed(s.red(e)).redPow(i).fromRed().toArrayLike(t,"be")}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t){
/*!
 * ecdsa.js - ecdsa for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(21),n=i(9);e.verify=function(e,i,o,a,h){r("string"==typeof e,"No curve selected."),r("string"==typeof i,"No algorithm selected."),r(t.isBuffer(o)),r(t.isBuffer(a)),r(t.isBuffer(h));const c=s.ec(e),u=n.hash(i,o);try{return c.verify(u,a,h)}catch(t){return!1}},e.sign=function(e,i,o,a){r("string"==typeof e,"No curve selected."),r("string"==typeof i,"No algorithm selected."),r(t.isBuffer(o)),r(t.isBuffer(a));const h=s.ec(e),c=n.hash(i,o),u=h.sign(c,a,{canonical:!0});return t.from(u.toDER())}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * lowlevelup.js - LevelUP module for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
var r=i(467),s=i(468);const n=i(1),o=i(34),a=i(35),h=e.from([0]),c=e.from([255]);let u;function l(t,e,i){if(!(this instanceof l))return new l(t,e,i);n("function"==typeof t,"Backend is required."),n("string"==typeof e,"Filename is required."),this.options=new d(i),this.backend=t,this.location=e,this.locker=new o,this.loading=!1,this.closing=!1,this.loaded=!1,this.db=null,this.binding=null,this.init()}function f(t,e){(e=new p(e)).keyAsBuffer=t.options.bufferKeys,this.iter=t.db.iterator(e)}function d(t){this.createIfMissing=!0,this.errorIfExists=!1,this.compression=!0,this.cacheSize=8<<20,this.writeBufferSize=4<<20,this.maxOpenFiles=64,this.maxFileSize=2<<20,this.paranoidChecks=!1,this.memory=!1,this.sync=!1,this.mapSize=274877906944,this.writeMap=!1,this.noSubdir=!0,this.bufferKeys=!0,t&&this.fromOptions(t)}function p(t){this.gte=null,this.lte=null,this.keys=!0,this.values=!1,this.fillCache=!1,this.keyAsBuffer=!0,this.valueAsBuffer=!0,this.reverse=!1,this.highWaterMark=16384,t&&this.fromOptions(t)}l.prototype.init=function(){let t=new(0,this.backend)(this.location),e=t;for(;t.db&&"function"==typeof t.db.put&&t.db!==t;)e=t=t.db;t.binding&&(e=t.binding),this.db=t,this.binding=e},l.prototype.open=async function(){const t=await this.locker.lock();try{return await this._open()}finally{t()}},l.prototype._open=async function(){if(this.loaded)throw new Error("Database is already open.");n(!this.loading),n(!this.closing),this.loading=!0;try{await this.load()}catch(t){throw this.loading=!1,t}this.loading=!1,this.loaded=!0},l.prototype.close=async function(){const t=await this.locker.lock();try{return await this._close()}finally{t()}},l.prototype.isClosed=function(){return!this.loaded},l.prototype.readStream=l.prototype.createReadStream=function(t){return"number"!=typeof(t=r({keys:!0,values:!0},t)).limit&&(t.limit=-1),new s(this.db.iterator(t),t)},l.prototype.keyStream=l.prototype.createKeyStream=function(t){return this.createReadStream(r(t,{keys:!0,values:!1}))},l.prototype.valueStream=l.prototype.createValueStream=function(t){return this.createReadStream(r(t,{keys:!1,values:!0}))},l.prototype._close=async function(){if(!this.loaded)throw new Error("Database is already closed.");n(!this.loading),n(!this.closing),this.loaded=!1,this.closing=!0;try{await this.unload()}catch(t){throw this.loaded=!0,this.closing=!1,t}this.closing=!1},l.prototype.load=function(){return new Promise((t,e)=>{this.binding.open(this.options,a.wrap(t,e))})},l.prototype.unload=function(){return new Promise((t,e)=>{this.binding.close(a.wrap(t,e))})},l.prototype.destroy=function(){return new Promise((t,e)=>{this.loaded||this.closing?e(new Error("Cannot destroy open database.")):this.backend.destroy?this.backend.destroy(this.location,a.wrap(t,e)):e(new Error("Cannot destroy (method not available)."))})},l.prototype.repair=function(){return new Promise((t,e)=>{this.loaded||this.closing?e(new Error("Cannot repair open database.")):this.backend.repair?this.backend.repair(this.location,a.wrap(t,e)):e(new Error("Cannot repair (method not available)."))})},l.prototype.backup=function(t){return this.binding.backup?new Promise((e,i)=>{this.loaded?this.binding.backup(t,a.wrap(e,i)):i(new Error("Database is closed."))}):this.clone(t)},l.prototype.get=function(t){return new Promise((e,i)=>{this.loaded?this.binding.get(t,(t,r)=>{if(t)return function(t){return!!t&&(t.notFound||"NotFoundError"===t.type||/not\s*found/i.test(t.message))}(t)?void e(null):void i(t);e(r)}):i(new Error("Database is closed."))})},l.prototype.put=function(t,e){return e||(e=h),new Promise((i,r)=>{this.loaded?this.binding.put(t,e,a.wrap(i,r)):r(new Error("Database is closed."))})},l.prototype.del=function(t){return new Promise((e,i)=>{this.loaded?this.binding.del(t,a.wrap(e,i)):i(new Error("Database is closed."))})},l.prototype.batch=function(t){if(!t){if(!this.loaded)throw new Error("Database is closed.");return new class{constructor(t){this.batch=t.binding.batch()}put(t,e){return e||(e=h),this.batch.put(t,e),this}del(t){return this.batch.del(t),this}write(){return new Promise((t,e)=>{this.batch.write(a.wrap(t,e))})}clear(){return this.batch.clear(),this}}(this)}return new Promise((e,i)=>{this.loaded?this.binding.batch(t,a.wrap(e,i)):i(new Error("Database is closed."))})},l.prototype.iterator=function(t){if(!this.loaded)throw new Error("Database is closed.");return new f(this,t)},l.prototype.getProperty=function(t){if(!this.loaded)throw new Error("Database is closed.");return this.binding.getProperty?this.binding.getProperty(t):""},l.prototype.approximateSize=function(t,e){return new Promise((i,r)=>{this.loaded?this.binding.approximateSize?this.binding.approximateSize(t,e,a.wrap(i,r)):r(new Error("Cannot get size.")):r(new Error("Database is closed."))})},l.prototype.compactRange=function(t,e){return t||(t=h),e||(e=c),new Promise((i,r)=>{this.loaded?this.binding.compactRange?this.binding.compactRange(t,e,a.wrap(i,r)):i():r(new Error("Database is closed."))})},l.prototype.has=async function(t){return null!=await this.get(t)},l.prototype.range=async function(t){const e=[],i=t.parse,r=this.iterator({gte:t.gte,lte:t.lte,keys:!0,values:!0});for(;;){let s=await r.next();if(!s)break;if(i)try{s=i(s.key,s.value)}catch(t){throw await r.end(),t}s&&e.push(s)}return e},l.prototype.keys=async function(t){const e=[],i=t.parse,r=this.iterator({gte:t.gte,lte:t.lte,keys:!0,values:!1});for(;;){const s=await r.next();if(!s)break;let n=s.key;if(i)try{n=i(n)}catch(t){throw await r.end(),t}n&&e.push(n)}return e},l.prototype.values=async function(t){const e=[],i=t.parse,r=this.iterator({gte:t.gte,lte:t.lte,keys:!1,values:!0});for(;;){const s=await r.next();if(!s)break;let n=s.value;if(i)try{n=i(n)}catch(t){throw await r.end(),t}n&&e.push(n)}return e},l.prototype.dump=async function(){const t=Object.create(null),e=await this.range({gte:h,lte:c});for(const i of e){const e=i.key.toString("hex"),r=i.value.toString("hex");t[e]=r}return t},l.prototype.checkVersion=async function(t,e){let i=await this.get(t.CV);if(!i)return await this.put(t.CV,t.version(e)),"new";if(!t.equalVersion(i,e))throw new Error(u);return"exist"},l.prototype.clone=async function(t){if(!this.loaded)throw new Error("Database is closed.");const e=new d(this.options);e.createIfMissing=!0,e.errorIfExists=!0;const i=new l(this.backend,t,e);await i.open();let r=i.batch(),s=0;const n=this.iterator({keys:!0,values:!0});for(;;){const e=await n.next();if(!e)break;if(r.put(e.key,e.value),(s+=e.value.length)>=256<<20){s=0;try{await r.write()}catch(t){throw await n.end(),await i.close(),t}r=i.batch()}}try{await r.write()}finally{await i.close()}},f.prototype.next=function(){return new Promise((t,e)=>{this.iter.next((i,r,s)=>{i?this.iter.end(()=>e(i)):void 0!==r||void 0!==s?t(new function(t,e){this.key=t,this.value=e}(r,s)):this.iter.end(a.wrap(t,e))})})},f.prototype.seek=function(t){this.iter.seek(t)},f.prototype.end=function(){return new Promise((t,e)=>{this.iter.end(a.wrap(t,e))})},d.prototype.fromOptions=function(t){return n(t,"Options are required."),null!=t.createIfMissing&&(n("boolean"==typeof t.createIfMissing,"`createIfMissing` must be a boolean."),this.createIfMissing=t.createIfMissing),null!=t.errorIfExists&&(n("boolean"==typeof t.errorIfExists,"`errorIfExists` must be a boolean."),this.errorIfExists=t.errorIfExists),null!=t.compression&&(n("boolean"==typeof t.compression,"`compression` must be a boolean."),this.compression=t.compression),null!=t.cacheSize&&(n("number"==typeof t.cacheSize,"`cacheSize` must be a number."),n(t.cacheSize>=0),this.cacheSize=Math.floor(t.cacheSize/2),this.writeBufferSize=Math.floor(t.cacheSize/4)),null!=t.maxFiles&&(n("number"==typeof t.maxFiles,"`maxFiles` must be a number."),n(t.maxFiles>=0),this.maxOpenFiles=t.maxFiles),null!=t.maxFileSize&&(n("number"==typeof t.maxFileSize,"`maxFileSize` must be a number."),n(t.maxFileSize>=0),this.maxFileSize=t.maxFileSize),null!=t.paranoidChecks&&(n("boolean"==typeof t.paranoidChecks,"`paranoidChecks` must be a boolean."),this.paranoidChecks=t.paranoidChecks),null!=t.memory&&(n("boolean"==typeof t.memory,"`memory` must be a boolean."),this.memory=t.memory),null!=t.sync&&(n("boolean"==typeof t.sync,"`sync` must be a boolean."),this.sync=t.sync),null!=t.mapSize&&(n("number"==typeof t.mapSize,"`mapSize` must be a number."),n(t.mapSize>=0),this.mapSize=t.mapSize),null!=t.writeMap&&(n("boolean"==typeof t.writeMap,"`writeMap` must be a boolean."),this.writeMap=t.writeMap),null!=t.noSubdir&&(n("boolean"==typeof t.noSubdir,"`noSubdir` must be a boolean."),this.noSubdir=t.noSubdir),null!=t.bufferKeys&&(n("boolean"==typeof t.bufferKeys,"`bufferKeys` must be a boolean."),this.bufferKeys=t.bufferKeys),this},p.prototype.fromOptions=function(t){if(n(t,"Options are required."),null!=t.gte&&(n(e.isBuffer(t.gte)||"string"==typeof t.gte),this.gte=t.gte),null!=t.lte&&(n(e.isBuffer(t.lte)||"string"==typeof t.lte),this.lte=t.lte),null!=t.keys&&(n("boolean"==typeof t.keys),this.keys=t.keys),null!=t.values&&(n("boolean"==typeof t.values),this.values=t.values),null!=t.fillCache&&(n("boolean"==typeof t.fillCache),this.fillCache=t.fillCache),null!=t.keyAsBuffer&&(n("boolean"==typeof t.keyAsBuffer),this.keyAsBuffer=t.keyAsBuffer),null!=t.valueAsBuffer&&(n("boolean"==typeof t.valueAsBuffer),this.valueAsBuffer=t.valueAsBuffer),null!=t.reverse&&(n("boolean"==typeof t.reverse),this.reverse=t.reverse),null!=t.limit&&(n("number"==typeof t.limit),n(t.limit>=0),this.limit=t.limit),!this.keys&&!this.values)throw new Error("Keys and/or values must be chosen.");return this},u="Warning: Your database does not match the current database version. This is likely because the database layout or serialization format has changed drastically. If you want to dump your data, downgrade to your previous version first. If you do not think you should be seeing this error, post an issue on the repo.",t.exports=l}).call(this,i(0).Buffer)},function(t,e,i){"use strict";const r=i(470),s=i(395);e.get=function(t){return"memory"===t?s:r}},function(t,e,i){(function(e,r){var s=i(473),n=i(474),o=i(475);function a(t){if(!arguments.length||void 0===t)throw new Error("constructor requires at least a location argument");if("string"!=typeof t)throw new Error("constructor requires a location string argument");this.location=t}a.prototype.open=function(t,i){if("function"==typeof t&&(i=t),"function"!=typeof i)throw new Error("open() requires a callback argument");if("object"!=typeof t&&(t={}),"function"==typeof this._open)return this._open(t,i);e.nextTick(i)},a.prototype.close=function(t){if("function"!=typeof t)throw new Error("close() requires a callback argument");if("function"==typeof this._close)return this._close(t);e.nextTick(t)},a.prototype.get=function(t,i,r){var s;if("function"==typeof i&&(r=i),"function"!=typeof r)throw new Error("get() requires a callback argument");return(s=this._checkKeyValue(t,"key",this._isBuffer))?r(s):(this._isBuffer(t)||(t=String(t)),"object"!=typeof i&&(i={}),"function"==typeof this._get?this._get(t,i,r):void e.nextTick(function(){r(new Error("NotFound"))}))},a.prototype.put=function(t,i,r,s){var n;if("function"==typeof r&&(s=r),"function"!=typeof s)throw new Error("put() requires a callback argument");return(n=this._checkKeyValue(t,"key",this._isBuffer))?s(n):(n=this._checkKeyValue(i,"value",this._isBuffer))?s(n):(this._isBuffer(t)||(t=String(t)),this._isBuffer(i)||e.browser||(i=String(i)),"object"!=typeof r&&(r={}),"function"==typeof this._put?this._put(t,i,r,s):void e.nextTick(s))},a.prototype.del=function(t,i,r){var s;if("function"==typeof i&&(r=i),"function"!=typeof r)throw new Error("del() requires a callback argument");return(s=this._checkKeyValue(t,"key",this._isBuffer))?r(s):(this._isBuffer(t)||(t=String(t)),"object"!=typeof i&&(i={}),"function"==typeof this._del?this._del(t,i,r):void e.nextTick(r))},a.prototype.batch=function(t,i,r){if(!arguments.length)return this._chainedBatch();if("function"==typeof i&&(r=i),"function"!=typeof r)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return r(new Error("batch(array) requires an array argument"));"object"!=typeof i&&(i={});for(var s,n,o=0,a=t.length;o<a;o++)if("object"==typeof(s=t[o])){if(n=this._checkKeyValue(s.type,"type",this._isBuffer))return r(n);if(n=this._checkKeyValue(s.key,"key",this._isBuffer))return r(n);if("put"==s.type&&(n=this._checkKeyValue(s.value,"value",this._isBuffer)))return r(n)}if("function"==typeof this._batch)return this._batch(t,i,r);e.nextTick(r)},a.prototype.approximateSize=function(t,i,r){if(null==t||null==i||"function"==typeof t||"function"==typeof i)throw new Error("approximateSize() requires valid `start`, `end` and `callback` arguments");if("function"!=typeof r)throw new Error("approximateSize() requires a callback argument");if(this._isBuffer(t)||(t=String(t)),this._isBuffer(i)||(i=String(i)),"function"==typeof this._approximateSize)return this._approximateSize(t,i,r);e.nextTick(function(){r(null,0)})},a.prototype._setupIteratorOptions=function(t){var e=this;return t=s(t),["start","end","gt","gte","lt","lte"].forEach(function(i){t[i]&&e._isBuffer(t[i])&&0===t[i].length&&delete t[i]}),t.reverse=!!t.reverse,t.reverse&&t.lt&&(t.start=t.lt),t.reverse&&t.lte&&(t.start=t.lte),!t.reverse&&t.gt&&(t.start=t.gt),!t.reverse&&t.gte&&(t.start=t.gte),(t.reverse&&t.lt&&!t.lte||!t.reverse&&t.gt&&!t.gte)&&(t.exclusiveStart=!0),t},a.prototype.iterator=function(t){return"object"!=typeof t&&(t={}),t=this._setupIteratorOptions(t),"function"==typeof this._iterator?this._iterator(t):new n(this)},a.prototype._chainedBatch=function(){return new o(this)},a.prototype._isBuffer=function(t){return r.isBuffer(t)},a.prototype._checkKeyValue=function(t,e){if(null===t||void 0===t)return new Error(e+" cannot be `null` or `undefined`");if(this._isBuffer(t)){if(0===t.length)return new Error(e+" cannot be an empty Buffer")}else if(""===String(t))return new Error(e+" cannot be an empty String")},t.exports.AbstractLevelDOWN=a,t.exports.AbstractIterator=n,t.exports.AbstractChainedBatch=o}).call(this,i(23),i(0).Buffer)},function(t,e,i){"use strict";(function(e,r){
/*!
 * memdb.js - in-memory database for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const s=i(1),n=i(396),o=e.alloc(0);function a(t){if(!(this instanceof a))return new a(t);this.location=t||"memory",this.options={},this.tree=new n(f,!0)}function h(t,e){this.options=e||{},this.ops=[],this.db=t,this.written=!1}function c(t,e,i){this.type=t,this.key=e,this.value=i}function u(t,e){this.db=t,this.options=new l(e),this.iter=null,this.ended=!1,this.total=0,this.init()}function l(t){this.keys=!0,this.values=!0,this.start=null,this.end=null,this.gt=!1,this.lt=!1,this.keyAsBuffer=!0,this.valueAsBuffer=!0,this.reverse=!1,this.limit=-1,t&&this.fromOptions(t)}function f(t,e){return t.compare(e)}a.prototype.search=function(t){"string"==typeof t&&(t=e.from(t,"utf8")),s(e.isBuffer(t),"Key must be a Buffer.");const i=this.tree.search(t);if(i)return i.value},a.prototype.insert=function(t,i){return"string"==typeof t&&(t=e.from(t,"utf8")),"string"==typeof i&&(i=e.from(i,"utf8")),null==i&&(i=o),s(e.isBuffer(t),"Key must be a Buffer."),s(e.isBuffer(i),"Value must be a Buffer."),null!=this.tree.insert(t,i)},a.prototype.remove=function(t){return"string"==typeof t&&(t=e.from(t,"utf8")),s(e.isBuffer(t),"Key must be a Buffer."),null!=this.tree.remove(t)},a.prototype.range=function(t,i){return"string"==typeof t&&(t=e.from(t,"utf8")),"string"==typeof i&&(i=e.from(i,"utf8")),s(!t||e.isBuffer(t),"Key must be a Buffer."),s(!i||e.isBuffer(i),"Key must be a Buffer."),this.tree.range(t,i)},a.prototype.open=function(t,e){e||(e=t,t=null),t||(t={}),this.options=t,r(e)},a.prototype.close=function(t){r(t)},a.prototype.get=function(t,e,i){i||(i=e,e=null),e||(e={});let s=this.search(t);if(!s){const t=new Error("MEMDB_NOTFOUND: Key not found.");return t.notFound=!0,t.type="NotFoundError",void r(()=>i(t))}!1===e.asBuffer&&(s=s.toString("utf8")),r(()=>i(null,s))},a.prototype.put=function(t,e,i,s){s||(s=i,i=null),this.insert(t,e),r(s)},a.prototype.del=function(t,e,i){i||(i=e,e=null),this.remove(t),r(i)},a.prototype.batch=function(t,e,i){i||(i=e,e=null);const r=new h(this,e);return t?(r.ops=t,void r.write(i)):r},a.prototype.iterator=function(t){return new u(this,t)},a.prototype.getProperty=function(t){return""},a.prototype.approximateSize=function(t,e,i){const s=this.range(t,e);let n=0;for(const t of s)n+=t.key.length,n+=t.value.length;r(()=>i(null,n))},a.destroy=function(t,e){r(e)},a.repair=function(t,e){r(e)},h.prototype.put=function(t,e){return s(!this.written,"Already written."),this.ops.push(new c("put",t,e)),this},h.prototype.del=function(t){return s(!this.written,"Already written."),this.ops.push(new c("del",t)),this},h.prototype.write=function(t){if(this.written)return r(()=>t(new Error("Already written."))),this;for(const e of this.ops)switch(e.type){case"put":this.db.insert(e.key,e.value);break;case"del":this.db.remove(e.key);break;default:return r(()=>t(new Error("Bad op."))),this}return this.ops=[],this.written=!0,r(t),this},h.prototype.clear=function(){return s(!this.written,"Already written."),this.ops=[],this},u.prototype.init=function(){const t=this.db.tree.snapshot(),e=this.db.tree.iterator(t);this.options.reverse?this.options.end?(e.seekMax(this.options.end),this.options.lt&&e.valid()&&0===e.compare(this.options.end)&&e.prev()):e.seekLast():this.options.start?(e.seekMin(this.options.start),this.options.gt&&e.valid()&&0===e.compare(this.options.start)&&e.next()):e.seekFirst(),this.iter=e},u.prototype.next=function(t){const e=this.options,i=this.iter;if(!this.iter)return void r(()=>t(new Error("Cannot call next.")));let s;if(e.reverse?(s=i.prev())&&e.start&&(e.gt?i.compare(e.start)<=0&&(s=!1):i.compare(e.start)<0&&(s=!1)):(s=i.next())&&e.end&&(e.lt?i.compare(e.end)>=0&&(s=!1):i.compare(e.end)>0&&(s=!1)),!s)return this.iter=null,void r(t);if(-1!==e.limit){if(this.total>=e.limit)return this.iter=null,void r(t);this.total+=1}let n=i.key,a=i.value;e.keys||(n=o),e.values||(a=o),e.keyAsBuffer||(n=n.toString("utf8")),e.valueAsBuffer||(a=a.toString("utf8")),r(()=>t(null,n,a))},u.prototype.seek=function(t){s(this.iter,"Already ended."),"string"==typeof t&&(t=e.from(t,"utf8")),s(e.isBuffer(t),"Key must be a Buffer."),this.options.reverse?this.iter.seekMax(t):this.iter.seekMin(t)},u.prototype.end=function(t){this.ended?r(()=>t(new Error("Already ended."))):(this.ended=!0,this.iter=null,r(t))},l.prototype.fromOptions=function(t){return null!=t.keys&&(s("boolean"==typeof t.keys),this.keys=t.keys),null!=t.values&&(s("boolean"==typeof t.values),this.values=t.values),null!=t.start&&(this.start=t.start),null!=t.end&&(this.end=t.end),null!=t.gte&&(this.start=t.gte),null!=t.lte&&(this.end=t.lte),null!=t.gt&&(this.gt=!0,this.start=t.gt),null!=t.lt&&(this.lt=!0,this.end=t.lt),null!=this.start&&("string"==typeof this.start&&(this.start=e.from(this.start,"utf8")),s(e.isBuffer(this.start),"`start` must be a Buffer.")),null!=this.end&&("string"==typeof this.end&&(this.end=e.from(this.end,"utf8")),s(e.isBuffer(this.end),"`end` must be a Buffer.")),null!=t.keyAsBuffer&&(s("boolean"==typeof t.keyAsBuffer),this.keyAsBuffer=t.keyAsBuffer),null!=t.valueAsBuffer&&(s("boolean"==typeof t.valueAsBuffer),this.valueAsBuffer=t.valueAsBuffer),null!=t.reverse&&(s("boolean"==typeof t.reverse),this.reverse=t.reverse),null!=t.limit&&(s("number"==typeof t.limit),this.limit=t.limit),this},t.exports=a}).call(this,i(0).Buffer,i(81).setImmediate)},function(t,e,i){"use strict";
/*!
 * rbt.js - iterative red black tree for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=0,n=1;let o;function a(t,e){if(!(this instanceof a))return new a(t,e);r("function"==typeof t),this.root=o,this.compare=t,this.unique=e||!1}function h(t,e){this.tree=t,this.root=e,this.current=e,this.key=null,this.value=null}function c(t,e){this.key=t,this.value=e,this.color=s,this.parent=o,this.left=o,this.right=o}function u(){this.key=null,this.value=null,this.color=n,this.parent=null,this.left=null,this.right=null}function l(t,e){this.key=t,this.value=e}function f(t,e){e.isNull()||(t.left=e.clone(),t.left.parent=t,f(t.left,e.left),d(t.left,e.right))}function d(t,e){e.isNull()||(t.right=e.clone(),t.right.parent=t,f(t.right,e.left),d(t.right,e.right))}a.prototype.reset=function(){this.root=o},a.prototype.search=function(t){let e=this.root;for(;!e.isNull();){const i=this.compare(t,e.key);if(0===i)return e;e=i<0?e.left:e.right}return null},a.prototype.insert=function(t,e){let i,r=this.root,s=!1;for(;!r.isNull();){const n=this.compare(t,r.key);if(this.unique&&0===n)return r.key=t,r.value=e,r;i=r,n<0?(s=!0,r=r.left):(s=!1,r=r.right)}const n=new c(t,e);return i?(n.parent=i,s?i.left=n:i.right=n,this.insertFixup(n),n):(this.root=n,this.insertFixup(n),n)},a.prototype.insertFixup=function(t){for(t.color=s;t!==this.root&&t.parent.color===s;)if(t.parent===t.parent.parent.left){const e=t.parent.parent.right;e.isNull()||e.color!==s?(t===t.parent.right&&(t=t.parent,this.rotl(t)),t.parent.color=n,t.parent.parent.color=s,this.rotr(t.parent.parent)):(t.parent.color=n,e.color=n,t.parent.parent.color=s,t=t.parent.parent)}else{const e=t.parent.parent.left;e.isNull()||e.color!==s?(t===t.parent.left&&(t=t.parent,this.rotr(t)),t.parent.color=n,t.parent.parent.color=s,this.rotl(t.parent.parent)):(t.parent.color=n,e.color=n,t.parent.parent.color=s,t=t.parent.parent)}this.root.color=n},a.prototype.remove=function(t){let e=this.root;for(;!e.isNull();){const i=this.compare(t,e.key);if(0===i)return this.removeNode(e),e;e=i<0?e.left:e.right}return null},a.prototype.removeNode=function(t){let e=t;t.left.isNull()||t.right.isNull()||(e=this.successor(t));const i=e.left.isNull()?e.right:e.left;i.parent=e.parent,e.parent.isNull()?this.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,e!==t&&(t.key=e.key,t.value=e.value),e.color===n&&this.removeFixup(i)},a.prototype.removeFixup=function(t){for(;t!==this.root&&t.color===n;)if(t===t.parent.left){let e=t.parent.right;e.color===s&&(e.color=n,t.parent.color=s,this.rotl(t.parent),e=t.parent.right),e.left.color===n&&e.right.color===n?(e.color=s,t=t.parent):(e.right.color===n&&(e.left.color=n,e.color=s,this.rotr(e),e=t.parent.right),e.color=t.parent.color,t.parent.color=n,e.right.color=n,this.rotl(t.parent),t=this.root)}else{let e=t.parent.left;e.color===s&&(e.color=n,t.parent.color=s,this.rotr(t.parent),e=t.parent.left),e.right.color===n&&e.left.color===n?(e.color=s,t=t.parent):(e.left.color===n&&(e.right.color=n,e.color=s,this.rotl(e),e=t.parent.left),e.color=t.parent.color,t.parent.color=n,e.left.color=n,this.rotr(t.parent),t=this.root)}t.color=n},a.prototype.rotl=function(t){const e=t.right;t.right=e.left,e.left.isNull()||(e.left.parent=t),e.parent=t.parent,t.parent.isNull()?this.root=e:t===t.parent.left?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e},a.prototype.rotr=function(t){const e=t.left;t.left=e.right,e.right.isNull()||(e.right.parent=t),e.parent=t.parent,t.parent.isNull()?this.root=e:t===t.parent.right?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e},a.prototype.min=function(t){if(t.isNull())return t;for(;!t.left.isNull();)t=t.left;return t},a.prototype.max=function(t){if(t.isNull())return t;for(;!t.right.isNull();)t=t.right;return t},a.prototype.successor=function(t){if(!t.right.isNull()){for(t=t.right;!t.left.isNull();)t=t.left;return t}let e=t.parent;for(;!e.isNull()&&t===e.right;)t=e,e=e.parent;return e},a.prototype.predecessor=function(t){if(!t.left.isNull()){for(t=t.left;!t.right.isNull();)t=t.right;return t}let e=t.parent;for(;!e.isNull()&&t===e.left;)t=e,e=e.parent;return e},a.prototype.clone=function(){if(this.root.isNull())return o;const t=[];let e,i,s=this.root,n=!0;for(;;)if(s.isNull()){if(0===t.length)break;e=s=t.pop(),n=!1,s=s.right}else{const r=s.clone();e&&(r.parent=e),n?e?e.left=r:i=r:e?e.right=r:i=r,t.push(r),e=r,n=!0,s=s.left}return r(i),i},a.prototype.snapshot=function(){if(this.root.isNull())return o;const t=this.root.clone();return f(t,t.left),d(t,t.right),t},a.prototype.iterator=function(t){return new h(this,t||this.root)},a.prototype.range=function(t,e){const i=this.iterator(),r=[];for(t?i.seekMin(t):i.seekFirst();i.next()&&!(e&&i.compare(e)>0);)r.push(i.data());return r},h.prototype.compare=function(t){return r(null!=this.key,"No key."),this.tree.compare(this.key,t)},h.prototype.valid=function(){return!this.current.isNull()},h.prototype.reset=function(){this.current=this.root,this.key=null,this.value=null},h.prototype.seekFirst=function(){this.current=this.tree.min(this.root),this.key=this.current.key,this.value=this.current.value},h.prototype.seekLast=function(){this.current=this.tree.max(this.root),this.key=this.current.key,this.value=this.current.value},h.prototype.seek=function(t){return this.seekMin(t)},h.prototype.seekMin=function(t){r(null!=t,"No key passed to seek.");let e=this.current,i=o;for(;!e.isNull();){const r=this.tree.compare(e.key,t);if(0===r){i=e;break}r>0?(i=e,e=e.left):e=e.right}this.current=i,this.key=i.key,this.value=i.value},h.prototype.seekMax=function(t){r(null!=t,"No key passed to seek.");let e=this.current,i=o;for(;!e.isNull();){const r=this.tree.compare(e.key,t);if(0===r){i=e;break}r<0?(i=e,e=e.right):e=e.left}this.current=i,this.key=i.key,this.value=i.value},h.prototype.prev=function(){return this.current.isNull()?(this.key=null,this.value=null,!1):(this.key=this.current.key,this.value=this.current.value,this.current=this.tree.predecessor(this.current),!0)},h.prototype.next=function(){return this.current.isNull()?(this.key=null,this.value=null,!1):(this.key=this.current.key,this.value=this.current.value,this.current=this.tree.successor(this.current),!0)},h.prototype.data=function(){return r(null!=this.key,"No data available."),new l(this.key,this.value)},c.prototype.clone=function(){const t=new c(this.key,this.value);return t.color=this.color,t.parent=this.parent,t.left=this.left,t.right=this.right,t},c.prototype.copy=function(){return new l(this.key,this.value)},c.prototype.inspect=function(){return{key:this.key,value:this.value,color:this.color===s?"red":"black",left:this.left,right:this.right}},c.prototype.isNull=function(){return!1},u.prototype.inspect=function(){return"NIL"},u.prototype.isNull=function(){return!0},l.prototype.inspect=function(){return{key:this.key,value:this.value}},o=new u,t.exports=a},function(t,e,i){"use strict";const r=i(1),s=i(3),n=i(26),o=i(31);function a(t){if(!(this instanceof a))return new a(t);this.address=new n,this.amount=-1,this.label=null,this.message=null,this.request=null,t&&this.fromOptions(t)}function h(t){try{t=(t=decodeURIComponent(t)).replace(/\+/g," ")}catch(t){throw new Error("Malformed URI.")}if(-1!==t.indexOf("\0"))throw new Error("Malformed URI.");return t}function c(t){return(t=encodeURIComponent(t)).replace(/%20/g,"+")}a.prototype.fromOptions=function(t){return"string"==typeof t?this.fromString(t):(t.address&&this.address.fromOptions(t.address),null!=t.amount&&(r(s.isU64(t.amount),"Amount must be a uint64."),this.amount=t.amount),t.label&&(r("string"==typeof t.label,"Label must be a string."),this.label=t.label),t.message&&(r("string"==typeof t.message,"Message must be a string."),this.message=t.message),t.request&&(r("string"==typeof t.request,"Request must be a string."),this.request=t.request),this)},a.fromOptions=function(t){return(new a).fromOptions(t)},a.prototype.fromString=function(t,e){r("string"==typeof t),r(t.length>8,"Not a bitcoin URI.");const i=t.substring(0,8);r("bitcoin:"===i,"Not a bitcoin URI.");const s=(t=t.substring(8)).indexOf("?");let n,a;if(-1===s?n=t:(n=t.substring(0,s),a=t.substring(s+1)),this.address.fromString(n,e),!a)return this;const c=function(t){const e=a.split("&"),i=new function(){this.amount=null,this.label=null,this.message=null,this.r=null};let s=0;for(const t of e){const e=t.indexOf("=");let n,o;if(-1===e?(n=t,o=""):(n=t.substring(0,e),o=t.substring(e+1)),0!==n.length){switch(r(s<4,"Too many keys in querystring."),n){case"amount":r(null==i.amount,"Duplicate key in querystring (amount)."),i.amount=h(o);break;case"label":r(null==i.label,"Duplicate key in querystring (label)."),i.label=h(o);break;case"message":r(null==i.message,"Duplicate key in querystring (message)."),i.message=h(o);break;case"r":r(null==i.r,"Duplicate key in querystring (r)."),i.r=h(o);break;default:r(!1,`Unknown querystring key: ${o}.`)}s++}else r(0===o.length,"Empty key in querystring.")}return i}();return c.amount&&(r(c.amount.length>0,"Value is empty."),r("-"!==c.amount[0],"Value is negative."),this.amount=o.value(c.amount)),c.label&&(this.label=c.label),c.message&&(this.message=c.message),c.r&&(this.request=c.r),this},a.fromString=function(t,e){return(new a).fromString(t,e)},a.prototype.toString=function(){let t="bitcoin:";t+=this.address.toString();const e=[];return-1!==this.amount&&e.push(`amount=${o.btc(this.amount)}`),this.label&&e.push(`label=${c(this.label)}`),this.message&&e.push(`message=${c(this.message)}`),this.request&&e.push(`r=${c(this.request)}`),e.length>0&&(t+="?"+e.join("&")),t},a.prototype.inspect=function(){return`<URI: ${this.toString()}>`},t.exports=a},function(t,e,i){"use strict";(function(e){
/*!
 * aead.js - aead for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(355),n=i(356);function o(){if(!(this instanceof o))return new o;this.chacha20=new s,this.poly1305=new n,this.aadLen=0,this.cipherLen=0,this.polyKey=null}o.prototype.init=function(t,i){const s=e.allocUnsafe(32);s.fill(0),this.chacha20.init(t,i),this.chacha20.encrypt(s),this.poly1305.init(s),this.chacha20.encrypt(e.allocUnsafe(32)),r(1===this.chacha20.getCounter()),this.polyKey=s,this.aadLen=0,this.cipherLen=0},o.prototype.aad=function(t){r(0===this.cipherLen,"Cannot update aad."),this.poly1305.update(t),this.aadLen+=t.length},o.prototype.encrypt=function(t){return 0===this.cipherLen&&this.pad16(this.aadLen),this.chacha20.encrypt(t),this.poly1305.update(t),this.cipherLen+=t.length,t},o.prototype.decrypt=function(t){return 0===this.cipherLen&&this.pad16(this.aadLen),this.cipherLen+=t.length,this.poly1305.update(t),this.chacha20.encrypt(t),t},o.prototype.auth=function(t){return 0===this.cipherLen&&this.pad16(this.aadLen),this.cipherLen+=t.length,this.poly1305.update(t),t},o.prototype.finish=function(){const t=e.allocUnsafe(16);let i,r;return i=this.aadLen%4294967296,r=(this.aadLen-i)/4294967296,t.writeUInt32LE(i,0,!0),t.writeUInt32LE(r,4,!0),i=this.cipherLen%4294967296,r=(this.cipherLen-i)/4294967296,t.writeUInt32LE(i,8,!0),t.writeUInt32LE(r,12,!0),0===this.cipherLen&&this.pad16(this.aadLen),this.pad16(this.cipherLen),this.poly1305.update(t),this.poly1305.finish()},o.prototype.pad16=function(t){if(0==(t%=16))return;const i=e.allocUnsafe(16-t);i.fill(0),this.poly1305.update(i)},t.exports=o}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t){
/*!
 * hkdf.js - hkdf for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(9);e.extract=function(t,e,i){return r.hmac(i,t,e)},e.expand=function(e,i,s,n){const o=r.hash(n,t.alloc(0)).length,a=Math.ceil(s/o);if(a>255)throw new Error("Too many blocks.");const h=t.allocUnsafe(s);if(0===a)return h;const c=t.allocUnsafe(o+i.length+1);i.copy(c,o),c[c.length-1]=1;let u=r.hmac(n,c.slice(o),e);u.copy(h,0);for(let t=1;t<a;t++)u.copy(c,0),c[c.length-1]++,(u=r.hmac(n,c,e)).copy(h,t*o);return h}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * hmac-drbg.js - hmac-drbg implementation for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 * Parts of this software based on hmac-drbg.
 */
const r=i(1),s=i(9),n=32,o=e.allocUnsafe(n+1),a=e.allocUnsafe(2*n+48),h=e.allocUnsafe(o.length+a.length);function c(t,i,r){if(!(this instanceof c))return new c(t,i,r);this.K=e.allocUnsafe(n),this.V=e.allocUnsafe(n),this.rounds=0,this.init(t,i,r)}c.prototype.init=function(t,e,i){for(let t=0;t<this.V.length;t++)this.K[t]=0,this.V[t]=1;this.reseed(t,e,i)},c.prototype.reseed=function(t,i,s){const o=a;r(e.isBuffer(t)),r(e.isBuffer(i)),r(e.isBuffer(s)),r(t.length===n),r(i.length===n),r(48===s.length),t.copy(o,0),i.copy(o,n),s.copy(o,2*n),this.update(o),this.rounds=1},c.prototype.iterate=function(){const t=o;this.V.copy(t,0),t[n]=0,this.K=s.hmac("sha256",t,this.K),this.V=s.hmac("sha256",this.V,this.K)},c.prototype.update=function(t){const i=h;r(e.isBuffer(t)),r(t.length===2*n+48),this.V.copy(i,0),i[n]=0,t.copy(i,n+1),this.K=s.hmac("sha256",i,this.K),this.V=s.hmac("sha256",this.V,this.K),i[n]=1,this.K=s.hmac("sha256",i,this.K),this.V=s.hmac("sha256",this.V,this.K)},c.prototype.generate=function(t){if(this.rounds>281474976710656)throw new Error("Reseed is required.");const i=e.allocUnsafe(t);let r=0;for(;r<t;)this.V=s.hmac("sha256",this.V,this.K),this.V.copy(i,r),r+=n;return this.iterate(),this.rounds++,i},t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t){
/*!
 * schnorr.js - schnorr signatures for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(21),n=i(106),o=i(43),a=i(400),h=i(9).sha256,c=s.ec("secp256k1").curve,u=t.allocUnsafe(64),l=e;l.hash=function(e,i){const r=i.toArrayLike(t,"be",32),s=u;return r.copy(s,0),e.copy(s,32),new o(h(s))},l.trySign=function(t,e,i,r){if(e.isZero())throw new Error("Bad private key.");if(e.gte(c.n))throw new Error("Bad private key.");if(i.isZero())return null;if(i.gte(c.n))return null;let s=c.g.mul(i);r&&(s=s.add(r)),s.y.isOdd()&&(i=i.umod(c.n),i=c.n.sub(i));const o=l.hash(t,s.getX());if(o.isZero())return null;if(o.gte(c.n))return null;let a=o.imul(e);return(a=(a=i.isub(a)).umod(c.n)).isZero()?null:new n({r:s.getX(),s:a})},l.sign=function(t,e,i){const r=new o(e),s=l.drbg(t,e,i),n=c.n.byteLength();let a,h;for(i&&(a=c.decodePoint(i));!h;){const e=new o(s.generate(n));h=l.trySign(t,r,e,a)}return h},l.verify=function(t,e,i){const r=new n(e),s=l.hash(t,r.r);if(s.gte(c.n))throw new Error("Invalid hash.");if(s.isZero())throw new Error("Invalid hash.");if(r.s.gte(c.n))throw new Error("Invalid S value.");if(r.r.gt(c.p))throw new Error("Invalid R value.");const o=c.decodePoint(i).mul(s),a=c.g.mul(r.s),h=o.add(a);if(h.y.isOdd())throw new Error("Odd R value.");return h.getX().eq(r.r)},l.recover=function(e,i){const r=new n(e),s=l.hash(i,r.r);if(s.gte(c.n))throw new Error("Invalid hash.");if(s.isZero())throw new Error("Invalid hash.");if(r.s.gte(c.n))throw new Error("Invalid S value.");if(r.r.gt(c.p))throw new Error("Invalid R value.");let o=s.invm(c.n);o=o.umod(c.n);let a=r.s;a=(a=(a=(a=c.n.sub(a)).umod(c.n)).imul(o)).umod(c.n);let h=c.pointFromX(r.r,!1).mul(o),u=c.g.mul(a);const f=h.add(u);h=f.mul(s),u=c.g.mul(r.s);const d=h.add(u);if(d.y.isOdd())throw new Error("Odd R value.");if(!d.getX().eq(r.r))throw new Error("Could not recover pubkey.");return t.from(f.encode("array",!0))},l.combineSigs=function(t){let e,i,r=new o(0);for(let s=0;s<t.length;s++){const o=new n(t[s]);if(o.s.isZero())throw new Error("Bad S value.");if(o.s.gte(c.n))throw new Error("Bad S value.");if(e||(e=o.r),i&&!i.r.eq(o.r))throw new Error("Bad signature combination.");r=(r=r.iadd(o.s)).umod(c.n),i=o}if(r.isZero())throw new Error("Bad combined signature.");return new n({r:e,s:r})},l.combineKeys=function(e){if(0===e.length)throw new Error;if(1===e.length)return e[0];let i=c.decodePoint(e[0]);for(let t=1;t<e.length;t++){const r=c.decodePoint(e[t]);i=i.add(r)}return t.from(i.encode("array",!0))},l.partialSign=function(t,e,i,r){const s=new o(e),n=new o(i),a=c.decodePoint(r),h=l.trySign(t,s,n,a);if(!h)throw new Error("Bad K value.");return h},l.alg=t.from("Schnorr+SHA256  ","ascii"),l.drbg=function(e,i,s){const n=t.allocUnsafe(48);return n.fill(0),s&&(r(32===s.length),s.copy(n,0)),l.alg.copy(n,32),new a(i,e,n)},l.generateNoncePair=function(e,i,r){const s=l.drbg(e,i,r),n=c.n.byteLength();let a;for(;(a=new o(s.generate(n))).isZero()||a.gte(c.n););return t.from(c.g.mul(a).encode("array",!0))}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * wordlist.js - wordlists for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(494),{languages:s,languageEnum:n}=i(403);e.get=function(t){switch(t){case n.Chinese:return r.chinese.simplified;case n.ChineseTraditional:return r.chinese.traditional;case n.English:return r.english;case n.French:return r.french;case n.Italian:return r.italian;case n.Japanese:return r.japanese;case n.Spanish:return r.spanish;default:throw new Error(`Unknown language: ${t}.`)}}},function(t,e){e.languages=["simplified chinese","traditional chinese","english","french","italian","japanese","spanish"],e.languageEnum={Chinese:"simplified chinese",ChineseTraditional:"traditional chinese",English:"english",French:"french",Italian:"italian",Japanese:"japanese",Spanish:"spanish"}},function(t,e,i){"use strict";
/*!
 * nfkd-browser.js - unicode normalization for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(502);t.exports=function(t){return t.normalize?t.normalize("NFKD"):r.nfkd(t)}},function(t,e,i){"use strict";(function(e){
/*!
 * public.js - hd public keys for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(9),o=i(120),a=i(30),h=i(16),c=i(6),u=i(2),l=i(56),f=i(4),d=i(201);function p(t){if(!(this instanceof p))return new p(t);this.network=h.primary,this.depth=0,this.parentFingerPrint=0,this.childIndex=0,this.chainCode=f.ZERO_HASH,this.publicKey=f.ZERO_KEY,this.fingerPrint=-1,this._xpubkey=null,t&&this.fromOptions(t)}p.prototype.fromOptions=function(t){return r(t,"No options for HDPublicKey"),r(s.isU8(t.depth)),r(s.isU32(t.parentFingerPrint)),r(s.isU32(t.childIndex)),r(e.isBuffer(t.chainCode)),r(e.isBuffer(t.publicKey)),t.network&&(this.network=h.get(t.network)),this.depth=t.depth,this.parentFingerPrint=t.parentFingerPrint,this.childIndex=t.childIndex,this.chainCode=t.chainCode,this.publicKey=t.publicKey,this},p.fromOptions=function(t){return(new p).fromOptions(t)},p.prototype.toPublic=function(){return this},p.prototype.xprivkey=function(){return null},p.prototype.xpubkey=function(){return this._xpubkey||(this._xpubkey=this.toBase58()),this._xpubkey},p.prototype.destroy=function(){this.depth=0,this.childIndex=0,this.parentFingerPrint=0,o(this.chainCode),o(this.publicKey),this.fingerPrint=-1,this._xpubkey=null},p.prototype.derive=function(t,e){if(r("number"==typeof t),t>>>0!==t)throw new Error("Index out of range.");if(t&d.HARDENED||e)throw new Error("Cannot derive hardened.");if(this.depth>=255)throw new Error("Depth too high.");const i=this.getID(t),s=d.cache.get(i);if(s)return s;const o=c.pool(37);o.writeBytes(this.publicKey),o.writeU32BE(t);const h=o.render(),u=n.hmac("sha512",h,this.chainCode),l=u.slice(0,32),f=u.slice(32,64);let g;try{g=a.publicKeyTweakAdd(this.publicKey,l,!0)}catch(e){return this.derive(t+1)}if(-1===this.fingerPrint){const t=n.hash160(this.publicKey);this.fingerPrint=t.readUInt32BE(0,!0)}const m=new p;return m.network=this.network,m.depth=this.depth+1,m.parentFingerPrint=this.fingerPrint,m.childIndex=t,m.chainCode=f,m.publicKey=g,d.cache.set(i,m),m},p.prototype.getID=function(t){return this.network.keyPrefix.xpubkey58+this.publicKey.toString("hex")+t},p.prototype.deriveAccount=function(t,e){return r(s.isU32(t)),r(s.isU32(e)),r(this.isAccount(e),"Cannot derive account index."),this},p.prototype.isMaster=function(){return d.isMaster(this)},p.prototype.isAccount=function(t){return d.isAccount(this,t)},p.isValidPath=function(t){try{return d.parsePath(t,!1),!0}catch(t){return!1}},p.prototype.derivePath=function(t){const e=d.parsePath(t,!1);let i=this;for(const t of e)i=i.derive(t);return i},p.prototype.equals=function(t){return r(p.isHDPublicKey(t)),this.network===t.network&&this.depth===t.depth&&this.parentFingerPrint===t.parentFingerPrint&&this.childIndex===t.childIndex&&this.chainCode.equals(t.chainCode)&&this.publicKey.equals(t.publicKey)},p.prototype.compare=function(t){r(p.isHDPublicKey(t));let e=this.depth-t.depth;return 0!==e?e:0!=(e=this.parentFingerPrint-t.parentFingerPrint)?e:0!=(e=this.childIndex-t.childIndex)?e:0!==(e=this.chainCode.compare(t.chainCode))?e:0!==(e=this.publicKey.compare(t.publicKey))?e:0},p.prototype.toJSON=function(){return{xpubkey:this.xpubkey()}},p.prototype.fromJSON=function(t,e){return r(t.xpubkey,"Could not handle HD key JSON."),this.fromBase58(t.xpubkey,e),this},p.fromJSON=function(t,e){return(new p).fromJSON(t,e)},p.isBase58=function(t,e){if("string"!=typeof t)return!1;if(t.length<4)return!1;const i=t.substring(0,4);try{return h.fromPublic58(i,e),!0}catch(t){return!1}},p.isRaw=function(t,i){if(!e.isBuffer(t))return!1;if(t.length<4)return!1;const r=t.readUInt32BE(0,!0);try{return h.fromPublic(r,i),!0}catch(t){return!1}},p.prototype.fromBase58=function(t,e){return r("string"==typeof t),this._xpubkey=t,this.fromRaw(l.decode(t),e)},p.prototype.fromReader=function(t,e){const i=t.readU32BE();return this.network=h.fromPublic(i,e),this.depth=t.readU8(),this.parentFingerPrint=t.readU32BE(),this.childIndex=t.readU32BE(),this.chainCode=t.readBytes(32),this.publicKey=t.readBytes(33),t.verifyChecksum(),this},p.prototype.fromRaw=function(t,e){return this.fromReader(new u(t),e)},p.prototype.toBase58=function(t){return l.encode(this.toRaw(t))},p.prototype.toWriter=function(t,e){return e||(e=this.network),e=h.get(e),t.writeU32BE(e.keyPrefix.xpubkey),t.writeU8(this.depth),t.writeU32BE(this.parentFingerPrint),t.writeU32BE(this.childIndex),t.writeBytes(this.chainCode),t.writeBytes(this.publicKey),t.writeChecksum(),t},p.prototype.getSize=function(){return 82},p.prototype.toRaw=function(t){return this.toWriter(new c(82),t).render()},p.fromBase58=function(t,e){return(new p).fromBase58(t,e)},p.fromReader=function(t,e){return(new p).fromReader(t,e)},p.fromRaw=function(t,e){return(new p).fromRaw(t,e)},p.isHDPublicKey=function(t){return t instanceof p},t.exports=p}).call(this,i(0).Buffer)},function(t,e,i){"use strict";e.unsupported=!0},function(t,e,i){"use strict";t.exports=class{constructor(t){this.root=t.str("root")||"xxxxxxxx-game-gold-root-xxxxxxxxxxxx",this.groupPrefix={},this.groupSuffix={}}addGroupPrefix(t,e){this.groupPrefix[t]||(this.groupPrefix[t]=[]),-1==this.groupPrefix[t].indexOf(e)&&this.groupPrefix[t].push(e)}addGroupSuffix(t,e){this.groupSuffix[t]||(this.groupSuffix[t]=[]),-1==this.groupSuffix[t].indexOf(e)&&this.groupSuffix[t].push(e)}isRoot(t){return!!t&&this.root===t}canAccess(t,e){if("string"!=typeof t||!e)return!1;if(!this.isRoot(e)&&t){let i=t.split(".");if(this.groupPrefix[i[0]]&&!this.groupPrefix[i[0]][e])return!1;if(i.length>=2&&this.groupSuffix[i[1]]&&!this.groupSuffix[i[1]][e])return!1}return!0}}},function(t,e,i){"use strict";
/*!
 * cpuminer.js - inefficient cpu miner for gamegold (because we can)
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(3),n=i(35),o=i(59),a=i(174),h=i(34),c=i(409);class u extends o{constructor(t){super(),this.miner=t,this.network=this.miner.network,this.logger=this.miner.logger.context("cpuminer"),this.workers=this.miner.workers,this.chain=this.miner.chain,this.locker=new h,this.running=!1,this.stopping=!1,this.job=null,this.stopJob=null,this._init()}_init(){this.chain.on("tip",t=>{this.job&&this.job.attempt.prevBlock===t.prevBlock&&this.job.destroy()})}async _open(){}async _close(){await this.stop()}start(){r(!this.running,"Miner is already running."),this._start().catch(()=>{})}async _start(){for(r(!this.running,"Miner is already running."),this.running=!0,this.stopping=!1;;){if(!this.chain.isFull()||!this.miner.tokenAddress&&(this.chain.height+1)%100!=0){await n.timeout(1e3);continue}this.job=null;try{const e=await this.miner.createBlock();this.job=new c(this,e)}catch(t){this.stopping||this.emit("error",t);continue}if(this.stopping)break;let e,i;try{e=await this.job.mineAsync()}catch(t){if(this.stopping)break;this.emit("error",t);break}if(this.stopping)break;if(e){try{i=await this.chain.add(e)}catch(t){if(!this.stopping){if("VerifyError"===t.type){this.logger.warning("Mined an invalid block!"),this.logger.error(t);continue}this.emit("error",t)}break}if(i){if(this.stopping)break;this.logger.info("Found block: %d (%s).",i.height,i.rhash()),this.logger.debug("Raw: %s",e.toRaw().toString("hex")),this.emit("block",e,i)}else this.logger.warning("Mined a bad-prevblk (race condition?)")}}const t=this.stopJob;t&&(this.stopJob=null,t.resolve())}async stop(){const t=await this.locker.lock();try{return await this._stop()}finally{t()}}async _stop(){this.running&&(r(this.running,"Miner is not running."),r(!this.stopping,"Miner is already stopping."),this.stopping=!0,this.job&&(this.job.destroy(),this.job=null),await this.wait(),this.running=!1,this.stopping=!1,this.job=null)}wait(){return new Promise((t,e)=>{r(!this.stopJob),this.stopJob=n.job(t,e)})}notifyEntry(){this.running&&this.job&&s.now()-this.job.start>10&&(this.job.destroy(),this.job=null)}findNonce(t){const e=t.getHeader(),i=t.attempt.target,r=u.INTERVAL;let s,n=0,o=r;for(;o<=4294967295&&-1===(s=a(e,i,n,o));)this.sendStatus(t,o),n+=r,o+=r;return s}async findNonceAsync(t){if(!this.workers)return this.findNonce(t);const e=t.getHeader(),i=t.attempt.target,r=u.INTERVAL;let s,n=0,o=r;for(;o<=4294967295&&-1===(s=await this.workers.mine(e,i,n,o));){if(t.destroyed)return s;this.sendStatus(t,o),n+=r,o+=r}return s}mine(t){let e;for(t.start=s.now();-1===(e=this.findNonce(t));)t.updateNonce(),this.sendStatus(t,0);return t.commit(e)}async mineAsync(t){let e;for(t.start=s.now();-1===(e=await this.findNonceAsync(t));){if(t.destroyed)return null;t.updateNonce(),this.sendStatus(t,0)}return t.commit(e)}sendStatus(t,e){const i=t.attempt,r=s.revHex(i.prevBlock),n=t.getHashes(e),o=t.getRate(e);this.logger.info("Status: hashrate=%dkhs hashes=%d target=%d height=%d tip=%s",Math.floor(o/1e3),n,i.bits,i.height,r),this.emit("status",t,n,o)}}u.INTERVAL=2863311,t.exports=u},function(t,e,i){"use strict";
/*!
 * cpujob.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(3);i(205),t.exports=class{constructor(t,e){this.miner=t,this.attempt=e,this.destroyed=!1,this.committed=!1,this.start=s.now(),this.nonce1=0,this.nonce2=0,this.refresh()}getHeader(){const t=this.attempt,e=this.nonce1,i=this.nonce2,r=t.time,s=t.getRoot(e,i);return t.getHeader(s,r,0)}commit(t){const e=this.attempt,i=this.nonce1,s=this.nonce2,n=e.time;r(!this.committed,"Job already committed."),this.committed=!0;const o=e.getProof(i,s,n,t);return e.commit(o)}mine(){return this.miner.mine(this)}mineAsync(){return this.miner.mineAsync(this)}refresh(){return this.attempt.refresh()}updateNonce(){4294967296==++this.nonce2&&(this.nonce2=0,this.nonce1++)}destroy(){this.destroyed=!0}getHashes(t){return 4294967295*(4294967296*this.nonce1+this.nonce2)+t}getRate(t){const e=this.getHashes(t),i=s.now()-this.start;return Math.floor(e/Math.max(1,i))}addTX(t,e){return this.attempt.addTX(t,e)}addTXS(t){for(let[e,i]of t)if(!this.attempt.addTX(e,i))throw new Error("error on add tx");return this.refresh(),!0}pushTX(t,e){return this.attempt.pushTX(t,e)}}},function(t,e,i){
/*!
 * BlockEntry.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
i(17);const r=i(33);i(44);class s{constructor(t){this.tx=t,this.hash=t.hash("hex"),this.fee=0,this.rate=0,this.priority=0,this.free=!1,this.sigops=0,this.descRate=0,this.depCount=0}static fromTX(t,e,i){const r=new s(t);return r.fee=t.getFee(e),r.rate=t.getRate(e),r.priority=t.getPriority(e,i.height),r.free=!1,r.sigops=t.getSigopsCost(e,i.flags),r.descRate=r.rate,r}static fromEntry(t,e){const i=new s(t.tx);return i.fee=t.getFee(),i.rate=t.getDeltaRate(),i.priority=t.getPriority(e.height),i.free=t.getDeltaFee()<r.getMinFee(t.size),i.sigops=t.sigops,i.descRate=t.getDescRate(),i}}t.exports=s},function(t,e,i){"use strict";(function(e){
/*!
 * UnknownPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(25),n=i(22);i(2),i(13),i(18),i(19);class o extends s{constructor(t,e=n.UNKNOWN){super(e),this.data=t}getSize(){return this.data.length}toWriter(t){return t.writeBytes(this.data),t}toRaw(){return this.data}fromRaw(t){return r(e.isBuffer(t)),this.data=t,this}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new o).fromRaw(t)}async poolHandle(t,e){e.logger.warning("Unknown packet: %s (%s).",this.cmd,t.hostname())}}t.exports=o}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * parser.js - packet parser for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(24),n=i(16),o=i(3),a=i(9),h=i(60),c=i(94);function u(t){if(!(this instanceof u))return new u(t);s.call(this),this.network=n.get(t),this.pending=[],this.total=0,this.waiting=24,this.header=null}Object.setPrototypeOf(u.prototype,s.prototype),u.prototype.error=function(){const t=o.fmt.apply(o,arguments);this.emit("error",new Error(t))},u.prototype.feed=function(t){for(this.total+=t.length,this.pending.push(t);this.total>=this.waiting;){const t=e.allocUnsafe(this.waiting);let i=0;for(;i<t.length;){const e=this.pending[0].copy(t,i);e===this.pending[0].length?this.pending.shift():this.pending[0]=this.pending[0].slice(e),i+=e}r.strictEqual(i,t.length),this.total-=t.length,this.parse(t)}},u.prototype.parse=function(t){if(r(t.length<=h.MAX_MESSAGE),!this.header)return void(this.header=this.parseHeader(t));const e=a.hash256(t).readUInt32LE(0,!0);if(e!==this.header.checksum)return this.waiting=24,this.header=null,void this.error("Invalid checksum: %s.",o.hex32(e));let i;try{i=this.parsePayload(this.header.cmd,t)}catch(t){return this.waiting=24,this.header=null,void this.emit("error",t)}this.waiting=24,this.header=null,this.emit("packet",i)},u.prototype.parseHeader=function(t){const e=t.readUInt32LE(0,!0);if(e!==this.network.magic)return this.error("Invalid magic value: %s.",o.hex32(e)),null;let i=0;for(;0!==t[i+4]&&i<12;i++);if(12===i)return this.error("Non NULL-terminated command."),null;const r=t.toString("ascii",4,4+i),s=t.readUInt32LE(16,!0);return s>h.MAX_MESSAGE?(this.waiting=24,this.error("Packet length too large: %dmb.",o.mb(s)),null):(this.waiting=s,new function(t,e,i){this.cmd=t,this.size=e,this.checksum=i}(r,s,t.readUInt32LE(20,!0)))},u.prototype.parsePayload=function(t,e){return c.fromRaw(t,e)},t.exports=u}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * framer.js - packet framer for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(16),n=i(9);function o(t){if(!(this instanceof o))return new o(t);this.network=s.get(t)}o.prototype.packet=function(t,i,s){r(i,"No payload."),r(t.length<12),r(i.length<=4294967295);const o=e.allocUnsafe(24+i.length);o.writeUInt32LE(this.network.magic,0,!0),o.write(t,4,"ascii");for(let e=4+t.length;e<16;e++)o[e]=0;return o.writeUInt32LE(i.length,16,!0),s||(s=n.hash256(i)),s.copy(o,20,0,4),i.copy(o,24),o},t.exports=o}).call(this,i(0).Buffer)},function(t,e,i){
/*!
 * TXRequest.js - BIP152 related
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(2),n=i(6),o=i(4);function a(t){if(!(this instanceof a))return new a(t);this.hash=o.NULL_HASH,this.indexes=[],t&&this.fromOptions(t)}a.prototype.fromOptions=function(t){return this.hash=t.hash,t.indexes&&(this.indexes=t.indexes),this},a.fromOptions=function(t){return(new a).fromOptions(t)},a.prototype.fromCompact=function(t){this.hash=t.hash("hex");for(let e=0;e<t.available.length;e++)t.available[e]||this.indexes.push(e);return this},a.fromCompact=function(t){return(new a).fromCompact(t)},a.prototype.fromReader=function(t){this.hash=t.readHash("hex");const e=t.readVarint();for(let i=0;i<e;i++){const e=t.readVarint();r(e<=65535),this.indexes.push(e)}let i=0;for(let t=0;t<e;t++){let e=this.indexes[t];r((e+=i)<=65535),this.indexes[t]=e,i=e+1}return this},a.prototype.fromRaw=function(t){return this.fromReader(new s(t))},a.fromReader=function(t){return(new a).fromReader(t)},a.fromRaw=function(t){return(new a).fromRaw(t)},a.prototype.getSize=function(){let t=0;t+=32,t+=o.sizeVarint(this.indexes.length);for(let e=0;e<this.indexes.length;e++){let i=this.indexes[e];e>0&&(i-=this.indexes[e-1]+1),t+=o.sizeVarint(i)}return t},a.prototype.toWriter=function(t){t.writeHash(this.hash),t.writeVarint(this.indexes.length);for(let e=0;e<this.indexes.length;e++){let i=this.indexes[e];e>0&&(i-=this.indexes[e-1]+1),t.writeVarint(i)}return t},a.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new n(t)).render()},t.exports=a},function(t,e,i){var r=i(530),s=i(370),n=i(419),o=i(209)("socket.io-client");t.exports=e=h;var a=e.managers={};function h(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,s=r(t),h=s.source,c=s.id,u=s.path,l=a[c]&&u in a[c].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||l?(o("ignoring socket cache for %s",h),i=n(h,e)):(a[c]||(o("new io instance for %s",h),a[c]=n(h,e)),i=a[c]),s.query&&!e.query&&(e.query=s.query),i.socket(s.path,e)}e.protocol=s.protocol,e.connect=h,e.Manager=i(419),e.Socket=i(424)},function(t,e){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,s=t.indexOf("["),n=t.indexOf("]");-1!=s&&-1!=n&&(t=t.substring(0,s)+t.substring(s,n).replace(/:/g,";")+t.substring(n,t.length));for(var o=i.exec(t||""),a={},h=14;h--;)a[r[h]]=o[h]||"";return-1!=s&&-1!=n&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e,i){(function(e){t.exports=function(t){return i&&e.Buffer.isBuffer(t)||r&&(t instanceof e.ArrayBuffer||s(t))};var i="function"==typeof e.Buffer&&"function"==typeof e.Buffer.isBuffer,r="function"==typeof e.ArrayBuffer,s=r&&"function"==typeof e.ArrayBuffer.isView?e.ArrayBuffer.isView:function(t){return t.buffer instanceof e.ArrayBuffer}}).call(this,i(12))},function(t,e,i){var r=i(535),s=i(424),n=i(122),o=i(370),a=i(425),h=i(426),c=i(209)("socket.io-client:manager"),u=i(164),l=i(551),f=Object.prototype.hasOwnProperty;function d(t,e){if(!(this instanceof d))return new d(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var i=e.parser||o;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}t.exports=d,d.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},d.prototype.updateSocketIds=function(){for(var t in this.nsps)f.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},d.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},n(d.prototype),d.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},d.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},d.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(t,e){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);var i=this.engine,s=this;this.readyState="opening",this.skipReconnect=!1;var n=a(i,"open",function(){s.onopen(),t&&t()}),o=a(i,"error",function(e){if(c("connect_error"),s.cleanup(),s.readyState="closed",s.emitAll("connect_error",e),t){var i=new Error("Connection error");i.data=e,t(i)}else s.maybeReconnectOnOpen()});if(!1!==this._timeout){var h=this._timeout;c("connect attempt will timeout after %d",h);var u=setTimeout(function(){c("connect attempt timed out after %d",h),n.destroy(),i.close(),i.emit("error","timeout"),s.emitAll("connect_timeout",h)},h);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(n),this.subs.push(o),this},d.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(a(t,"data",h(this,"ondata"))),this.subs.push(a(t,"ping",h(this,"onping"))),this.subs.push(a(t,"pong",h(this,"onpong"))),this.subs.push(a(t,"error",h(this,"onerror"))),this.subs.push(a(t,"close",h(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",h(this,"ondecoded")))},d.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},d.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},d.prototype.ondata=function(t){this.decoder.add(t)},d.prototype.ondecoded=function(t){this.emit("packet",t)},d.prototype.onerror=function(t){c("error",t),this.emitAll("error",t)},d.prototype.socket=function(t,e){var i=this.nsps[t];if(!i){i=new s(this,t,e),this.nsps[t]=i;var r=this;i.on("connecting",n),i.on("connect",function(){i.id=r.generateId(t)}),this.autoConnect&&n()}function n(){~u(r.connecting,i)||r.connecting.push(i)}return i},d.prototype.destroy=function(t){var e=u(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},d.prototype.packet=function(t){c("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(i){for(var r=0;r<i.length;r++)e.engine.write(i[r],t.options);e.encoding=!1,e.processPacketQueue()}))},d.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},d.prototype.cleanup=function(){c("cleanup");for(var t=this.subs.length,e=0;e<t;e++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(t){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();c("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var i=setTimeout(function(){t.skipReconnect||(c("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(c("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(c("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(i)}})}},d.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,i){(function(t){var r=i(371),s=i(538),n=i(547),o=i(548);e.polling=function(e){var i=!1,o=!1,a=!1!==e.jsonp;if(t.location){var h="https:"===location.protocol,c=location.port;c||(c=h?443:80),i=e.hostname!==location.hostname||c!==e.port,o=e.secure!==h}if(e.xdomain=i,e.xscheme=o,"open"in new r(e)&&!e.forceJSONP)return new s(e);if(!a)throw new Error("JSONP disabled");return new n(e)},e.websocket=o}).call(this,i(12))},function(t,e,i){var r=i(372),s=i(210),n=i(123),o=i(211),a=i(423),h=i(212)("engine.io-client:polling");t.exports=u;var c=null!=new(i(371))({xdomain:!1}).responseType;function u(t){var e=t&&t.forceBase64;c&&!e||(this.supportsBinary=!1),r.call(this,t)}o(u,r),u.prototype.name="polling",u.prototype.doOpen=function(){this.poll()},u.prototype.pause=function(t){var e=this;function i(){h("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(h("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){h("pre-pause polling complete"),--r||i()})),this.writable||(h("we are currently writing - waiting to pause"),r++,this.once("drain",function(){h("pre-pause writing complete"),--r||i()}))}else i()},u.prototype.poll=function(){h("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},u.prototype.onData=function(t){var e=this;h("polling got data %s",t),n.decodePayload(t,this.socket.binaryType,function(t,i,r){if("opening"===e.readyState&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():h('ignoring poll - transport state "%s"',this.readyState))},u.prototype.doClose=function(){var t=this;function e(){h("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(h("transport open - closing"),e()):(h("transport not open - deferring close"),this.once("open",e))},u.prototype.write=function(t){var e=this;this.writable=!1;var i=function(){e.writable=!0,e.emit("drain")};n.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,i)})},u.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(t[this.timestampParam]=a()),this.supportsBinary||t.sid||(t.b64=1),t=s.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(i=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t}},function(t,e,i){(function(e){var r=i(540),s=Object.prototype.toString,n="function"==typeof e.Blob||"[object BlobConstructor]"===s.call(e.Blob),o="function"==typeof e.File||"[object FileConstructor]"===s.call(e.File);t.exports=function t(i){if(!i||"object"!=typeof i)return!1;if(r(i)){for(var s=0,a=i.length;s<a;s++)if(t(i[s]))return!0;return!1}if("function"==typeof e.Buffer&&e.Buffer.isBuffer&&e.Buffer.isBuffer(i)||"function"==typeof e.ArrayBuffer&&i instanceof ArrayBuffer||n&&i instanceof Blob||o&&i instanceof File)return!0;if(i.toJSON&&"function"==typeof i.toJSON&&1===arguments.length)return t(i.toJSON(),!0);for(var h in i)if(Object.prototype.hasOwnProperty.call(i,h)&&t(i[h]))return!0;return!1}}).call(this,i(12))},function(t,e,i){"use strict";var r,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),n=64,o={},a=0,h=0;function c(t){var e="";do{e=s[t%n]+e,t=Math.floor(t/n)}while(t>0);return e}function u(){var t=c(+new Date);return t!==r?(a=0,r=t):t+"."+c(a++)}for(;h<n;h++)o[s[h]]=h;u.encode=c,u.decode=function(t){var e=0;for(h=0;h<t.length;h++)e=e*n+o[t.charAt(h)];return e},t.exports=u},function(t,e,i){var r=i(370),s=i(122),n=i(550),o=i(425),a=i(426),h=i(209)("socket.io-client:socket"),c=i(210),u=i(422);t.exports=d;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=s.prototype.emit;function d(t,e,i){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.query&&(this.query=i.query),this.io.autoConnect&&this.open()}s(d.prototype),d.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[o(t,"open",a(this,"onopen")),o(t,"packet",a(this,"onpacket")),o(t,"close",a(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},d.prototype.send=function(){var t=n(arguments);return t.unshift("message"),this.emit.apply(this,t),this},d.prototype.emit=function(t){if(l.hasOwnProperty(t))return f.apply(this,arguments),this;var e=n(arguments),i={type:(void 0!==this.flags.binary?this.flags.binary:u(e))?r.BINARY_EVENT:r.EVENT,data:e,options:{}};return i.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(h("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this},d.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},d.prototype.onopen=function(){if(h("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?c.encode(this.query):this.query;h("sending connect packet with query %s",t),this.packet({type:r.CONNECT,query:t})}else this.packet({type:r.CONNECT})},d.prototype.onclose=function(t){h("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},d.prototype.onpacket=function(t){var e=t.nsp===this.nsp,i=t.type===r.ERROR&&"/"===t.nsp;if(e||i)switch(t.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(t);break;case r.ACK:case r.BINARY_ACK:this.onack(t);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",t.data)}},d.prototype.onevent=function(t){var e=t.data||[];h("emitting event %j",e),null!=t.id&&(h("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?f.apply(this,e):this.receiveBuffer.push(e)},d.prototype.ack=function(t){var e=this,i=!1;return function(){if(!i){i=!0;var s=n(arguments);h("sending ack %j",s),e.packet({type:u(s)?r.BINARY_ACK:r.ACK,id:t,data:s})}}},d.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(h("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):h("bad ack %s",t.id)},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},d.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)f.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){h("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(h("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},d.prototype.compress=function(t){return this.flags.compress=t,this},d.prototype.binary=function(t){return this.flags.binary=t,this}},function(t,e){t.exports=function(t,e,i){return t.on(e,i),{destroy:function(){t.removeListener(e,i)}}}},function(t,e){var i=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var r=i.call(arguments,2);return function(){return e.apply(t,r.concat(i.call(arguments)))}}},function(t,e,i){"use strict";
/*!
 * external.js - external ip address discovery for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=e;r.getIPv4=async function(){throw new Error("Could not find IP.")},r.getIPv6=async function(){throw new Error("Could not find IP.")}},function(t,e,i){"use strict";(function(e){
/*!
 * hostlist.js - address management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(553);t.exports=class extends r{constructor(t){super(t)}async loadFile(){if(!this.options.persistent)return;let t;try{(t=await this.options.node.readHostList())&&e.isBuffer(t)&&this.fromJSON(JSON.parse(t.toString()))}catch(t){return}}async flush(){if(this.options.persistent&&this.needsFlush){this.needsFlush=!1;try{const t=e.from(JSON.stringify(this.toJSON()));await this.options.node.writeHostList(t),this.logger.debug("Writing hosts to node db.")}catch(t){this.logger.warning("Writing hosts failed."),this.logger.error(t)}}}}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * upnp-browser.js - upnp for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */function r(t,e,i){throw new Error("UPNP not supported.")}r.discover=function(t,e,i,r){return new Promise((t,e)=>{e(new Error("UPNP not supported."))})},t.exports=r},function(t,e){t.exports=function(t,e){this.hash=t,this.height=e,this.prev=null,this.next=null}},function(t,e,i){"use strict";(function(e){
/*!
 * FilterLoadPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=(i(2),i(13),i(79));i(18),i(19);class o extends r{constructor(t,e=s.FILTERLOAD){super(e),this.filter=t||new n}getSize(){return this.filter.getSize()}toWriter(t){return this.filter.toWriter(t)}toRaw(){return this.filter.toRaw()}fromReader(t){return this.filter.fromReader(t),this}fromRaw(t){return this.filter.fromRaw(t),this}isWithinConstraints(){return this.filter.isWithinConstraints()}static fromReader(t){return(new o).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new o).fromRaw(t)}async poolHandle(t,e){}async peerHandle(t){this.isWithinConstraints()?(t.spvFilter=this.filter,t.noRelay=!1):t.increaseBan(100)}}t.exports=o}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * VersionPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(25),n=i(22),o=i(2),a=(i(13),i(6)),h=i(4),c=i(60),u=i(3),l=i(82),f=(i(18),i(19),i(376));class d extends s{constructor(t,e=n.VERSION){super(e),this.version=c.PROTOCOL_VERSION,this.services=c.LOCAL_SERVICES,this.time=u.now(),this.remote=new l,this.local=new l,this.nonce=h.ZERO_U64,this.agent=c.USER_AGENT,this.height=0,this.noRelay=!1,t&&this.fromOptions(t)}fromOptions(t){return null!=t.version&&(this.version=t.version),null!=t.services&&(this.services=t.services),null!=t.time&&(this.time=t.time),t.remote&&this.remote.fromOptions(t.remote),t.local&&this.local.fromOptions(t.local),t.nonce&&(this.nonce=t.nonce),t.agent&&(this.agent=t.agent),null!=t.height&&(this.height=t.height),null!=t.noRelay&&(this.noRelay=t.noRelay),this}static fromOptions(t){return(new d).fromOptions(t)}getSize(){let t=0;return t+=20,t+=this.remote.getSize(!1),t+=this.local.getSize(!1),t+=8,(t+=h.sizeVarString(this.agent,"ascii"))+5}toWriter(t){return t.writeI32(this.version),t.writeU32(this.services),t.writeU32(0),t.writeI64(this.time),this.remote.toWriter(t,!1),this.local.toWriter(t,!1),t.writeBytes(this.nonce),t.writeVarString(this.agent,"ascii"),t.writeI32(this.height),t.writeU8(this.noRelay?0:1),t}toRaw(){const t=this.getSize();return this.toWriter(new a(t)).render()}fromReader(t){return this.version=t.readI32(),this.services=t.readU32(),t.readU32(),this.time=t.readI64(),this.remote.fromReader(t,!1),t.left()>0&&(this.local.fromReader(t,!1),this.nonce=t.readBytes(8)),t.left()>0&&(this.agent=t.readVarString("ascii",256)),t.left()>0&&(this.height=t.readI32()),t.left()>0&&(this.noRelay=0===t.readU8()),10300===this.version&&(this.version=300),r(this.version>=0,"Version is negative."),r(this.time>=0,"Timestamp is negative."),this.height<0&&(this.height=0),this}static fromReader(t){return(new d).fromReader(t)}fromRaw(t){return this.fromReader(new o(t))}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new d).fromRaw(t,i)}async poolHandle(t,e){e.logger.info("Received version (%s): version=%d height=%d services=%s agent=%s",t.hostname(),this.version,this.height,this.services.toString(2),this.agent),e.network.time.add(t.hostname(),this.time),e.nonces.remove(t.hostname()),!t.outbound&&this.remote.isRoutable()&&e.hosts.markLocal(this.remote)}async peerHandle(t){if(-1!==t.version)throw new Error("Peer sent a duplicate version.");if(t.version=this.version,t.services=this.services,t.height=this.height,t.agent=this.agent,t.noRelay=this.noRelay,t.local=this.remote,!t.network.selfConnect&&t.options.hasNonce(this.nonce))throw new Error("We connected to ourself. Oops.");if(t.version<c.MIN_VERSION)throw new Error("Peer does not support required protocol version.");if(t.outbound){if(!(t.services&c.services.NETWORK))throw new Error("Peer does not support network services.");if(t.options.headers&&t.version<c.HEADERS_VERSION)throw new Error("Peer does not support getheaders.");if(t.options.spv){if(!(t.services&c.services.BLOOM))throw new Error("Peer does not support BIP37: does not support BLOOM");if(t.version<c.BLOOM_VERSION)throw new Error("Peer does not support BIP37: low version")}if(t.options.hasWitness()&&!(t.services&c.services.WITNESS))throw new Error("Peer does not support segregated witness.");t.options.compact&&(t.hasCompactSupport()||t.logger.debug("Peer does not support compact blocks (%s).",t.hostname()))}t.send(new f)}}t.exports=d}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * PingPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=i(2),o=(i(13),i(6)),a=(i(18),i(19),i(377));class h extends r{constructor(t,e=s.PING){super(e),this.nonce=t||null}getSize(){return this.nonce?8:0}toRaw(){const t=this.getSize();return this.toWriter(new o(t)).render()}toWriter(t){return this.nonce&&t.writeBytes(this.nonce),t}fromReader(t){return t.left()>=8&&(this.nonce=t.readBytes(8)),this}fromRaw(t){return this.fromReader(new n(t))}static fromReader(t){return(new h).fromRaw(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new h).fromRaw(t)}async poolHandle(t,e){}async peerHandle(t){this.nonce&&t.send(new a(this.nonce))}}t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * GetAddrPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=(i(2),i(13),i(18),i(19),i(378));class o extends r{constructor(t=s.GETADDR){super(t)}static fromReader(t){return(new o).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new o).fromRaw(t)}async poolHandle(t,e){if(e.options.selfish)return;if(t.sentAddr)return void e.logger.debug("Ignoring repeated getaddr (%s).",t.hostname());t.sentAddr=!0;const i=e.hosts.toArray(),r=[];for(const e of i)if(t.addrFilter.added(e.hostname,"ascii")&&(r.push(e),1e3===r.length))break;0!==r.length&&(e.logger.debug("Sending %d addrs to peer (%s)",r.length,t.hostname()),t.send(new n(r)))}}t.exports=o}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * GetDataPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(214),s=i(22),n=(i(2),i(13),i(39)),o=(i(18),i(19),i(379)),a=i(380),h=i(213);class c extends r{constructor(t,e=s.GETDATA){super(t,e)}static fromReader(t){return(new c).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new c).fromRaw(t)}async poolHandle(t,e){const i=this.items;if(i.length>5e4)return e.logger.warning("Peer sent inv with >50k items (%s).",t.hostname()),t.increaseBan(100),void t.destroy();const r=[];let s=0,c=0,u=0,l=-1;for(const a of i)if(a.isTX()){const i=await e.getItem(t,a);if(!i){r.push(a);continue}if(i.isCoinbase()){r.push(a),e.logger.warning("Failsafe: tried to relay a coinbase.");continue}t.send(new o(i,a.hasWitness())),s++}else{switch(a.type){case n.types.BLOCK:case n.types.WITNESS_BLOCK:if(!await e.sendBlock(t,a,a.hasWitness())){r.push(a);continue}c++;break;case n.types.FILTERED_BLOCK:case n.types.WITNESS_FILTERED_BLOCK:{if(!e.options.bip37)return e.logger.debug("Peer requested a merkleblock without bip37 enabled (%s).",t.hostname()),void t.destroy();if(!t.spvFilter){r.push(a);continue}const i=await e.getItem(t,a);if(!i){r.push(a);continue}const n=i.toMerkle(t.spvFilter);t.send(new h(n));for(const e of n.txs)t.send(new o(e,a.hasWitness())),s++;c++;break}case n.types.CMPCT_BLOCK:{if(await e.chain.getHeight(a.hash)<e.chain.tip.height-10){if(!await e.sendBlock(t,a,t.compactWitness)){r.push(a);continue}c++;break}const i=await e.getItem(t,a);if(!i){r.push(a);continue}t.sendCompactBlock(i),c++,u++;break}default:l=a.type,r.push(a);continue}a.hash===t.hashContinue&&(t.sendInv([new n(n.types.BLOCK,e.chain.tip.hash)]),t.hashContinue=null),await t.drain()}r.length>0&&t.send(new a(r)),s>0&&e.logger.debug("Served %d txs with getdata (notfound=%d) (%s).",s,r.length,t.hostname()),c>0&&e.logger.debug("Served %d blocks with getdata (notfound=%d, cmpct=%d) (%s).",c,r.length,u,t.hostname()),-1!==l&&e.logger.warning("Peer sent an unknown getdata type: %s (%d).",l,t.hostname())}}t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * GetHeadersPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(381),s=i(22);i(2),i(13),i(18),i(19);class n extends r{constructor(t,e,i=s.GETHEADERS){super(t,e,i)}static fromReader(t){return(new n).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new n).fromRaw(t)}async poolHandle(t,e){if(!e.chain.synced)return;if(e.options.selfish)return;if(e.chain.options.spv)return;if(e.chain.options.prune)return;let i,r;this.locator.length>0?(i=await e.chain.findLocator(this.locator))&&(i=await e.chain.getNextHash(i)):i=this.stop,i&&(r=await e.chain.getEntry(i));const s=[];for(;r&&(s.push(r.toHeaders()),r.hash!==this.stop)&&2e3!==s.length;)r=await e.chain.getNext(r);t.sendHeaders(s)}}t.exports=n}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * HeadersPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(25),n=i(22),o=i(2),a=(i(13),i(6)),h=i(69),c=i(4),u=(i(18),i(19),i(430)),l=i(3),{broadcast:f}=i(202);class d extends s{constructor(t,e=n.HEADERS){super(e),this.items=t||[]}getSize(){let t=0;t+=c.sizeVarint(this.items.length);for(const e of this.items)t+=e.getSize();return t}toWriter(t){r(this.items.length<=2e3,"Too many headers."),t.writeVarint(this.items.length);for(const e of this.items)e.toWriter(t);return t}formatInsight(){return this.items.map(t=>t.formatInsight())}toRaw(){const t=this.getSize();return this.toWriter(new a(t)).render()}fromReader(t){const e=t.readVarint();r(e<=2e3,"Too many headers.");for(let i=0;i<e;i++)this.items.push(h.fromReader(t));return this}fromRaw(t){return this.fromReader(new o(t))}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new d).fromRaw(t)}async poolHandle(t,e){const i=await e.locker.lock();try{return await this._poolHandle(t,e)}finally{i()}}async _poolHandle(t,e){const i=this.items;if(!e.checkpoints)return;if(!e.syncing)return;if(!t.loader)return;if(0===i.length)return;if(i.length>2e3)return void t.increaseBan(100);r(e.headerChain.size>0),f("p2p/headers",this.formatInsight());let s=!1,n=null;for(const r of i){const i=e.headerChain.tail,o=i.height+1,a=r.hash("hex");if(!r.verify())return e.logger.warning("Peer sent an invalid header (%s).",t.hostname()),t.increaseBan(100),void t.destroy();if(r.prevBlock!==i.hash)return e.logger.warning("Peer sent a bad header chain (%s).",t.hostname()),void t.destroy();if((n=new u(a,o)).height===e.headerTip.height){if(n.hash!==e.headerTip.hash)return e.logger.warning("Peer sent an invalid checkpoint (%s).",t.hostname()),void t.destroy();s=!0}e.headerNext||(e.headerNext=n),e.headerChain.push(n)}e.logger.debug("Received %s headers from peer (%s).",i.length,t.hostname()),t.blockTime=l.ms(),s?(e.headerChain.shift(),e.resolveHeaders(t)):t.sendGetHeaders([n.hash],e.headerTip.hash)}}t.exports=d}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * SendHeadersPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22);i(207),i(2),i(13),i(18),i(19);class n extends r{constructor(t=s.SENDHEADERS){super(t)}static fromReader(t){return(new n).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new n).fromRaw(t)}async poolHandle(t,e){}async peerHandle(t){t.preferHeaders?t.logger.debug("Peer sent a duplicate SENDHEADERS (%s).",t.hostname()):t.preferHeaders=!0}}t.exports=n}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * BlockPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=(i(2),i(13),i(440)),o=(i(18),i(19),i(65)),{broadcast:a}=i(202);class h extends r{constructor(t,e,i=s.BLOCK){super(i),this.block=t||new n,this.witness=e||!1}getSize(){return this.witness?this.block.getSize():this.block.getBaseSize()}toWriter(t){return this.witness?this.block.toWriter(t):this.block.toNormalWriter(t)}toRaw(){return this.witness?this.block.toRaw():this.block.toNormal()}fromReader(t){return this.block.fromReader(t),this}fromRaw(t){return this.block.fromRaw(t),this}static fromReader(t){return(new h).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new h).fromRaw(t)}async poolHandle(t,e){const i=o.flags.DEFAULT_FLAGS;e.options.spv?e.logger.warning("Peer sent unsolicited block (%s).",t.hostname()):(a("p2p/block",this.block.toBlock().formatInsight()),await e.addBlock(t,this.block,i))}}t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * memblock.js - memblock block object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(110),s=i(52),n=i(69),o=i(20),a=i(2),h=e.alloc(0);class c extends r{constructor(){super(),this._raw=h}isMemory(){return!0}toHead(){return this._raw.slice(0,80)}getSize(){return this._raw.length}verifyBody(){return!0}getCoinbaseHeight(){if(this.version<2)return-1;try{return this.parseCoinbaseHeight()}catch(t){return-1}}parseCoinbaseHeight(){const t=new a(this._raw,!0);if(t.seek(80),0===t.readVarint())return-1;t.seek(4);let e=t.readVarint();if(0===e&&0!==t.readU8()&&(e=t.readVarint()),0===e)return-1;t.seek(36);const i=t.readVarBytes();return o.getCoinbaseHeight(i)}fromRaw(t){const e=new a(t,!0);return this.readHead(e),this._raw=e.data,this}static fromRaw(t){return(new c).fromRaw(t)}toRaw(){return this._raw}toNormal(){return this._raw}toBlock(){const t=s.fromRaw(this._raw);return t._hash=this._hash,t._hhash=this._hhash,t}formatInsight(){return this.toBlock().formatInsight()}toHeaders(){return n.fromBlock(this)}static isMemBlock(t){return t instanceof c}}t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * RejectPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(25),n=i(22),o=i(2),a=(i(13),i(6)),h=i(3),c=(i(17),i(4));i(18),i(19);class u extends s{constructor(t,e=n.REJECT){super(e),this.message="",this.code=u.codes.INVALID,this.reason="",this.hash=null,t&&this.fromOptions(t)}fromOptions(t){let e=t.code;return t.message&&(this.message=t.message),null!=e&&("string"==typeof e&&(e=u.codes[e.toUpperCase()]),e>=u.codes.INTERNAL&&(e=u.codes.INVALID),this.code=e),t.reason&&(this.reason=t.reason),t.hash&&(this.hash=t.hash),this}static fromOptions(t){return(new u).fromOptions(t)}rhash(){return this.hash?h.revHex(this.hash):null}getCode(){const t=u.codesByVal[this.code];return t?t.toLowerCase():this.code.toString(10)}getSize(){let t=0;return t+=c.sizeVarString(this.message,"ascii"),t+=1,t+=c.sizeVarString(this.reason,"ascii"),this.hash&&(t+=32),t}toWriter(t){return r(this.message.length<=12),r(this.reason.length<=111),t.writeVarString(this.message,"ascii"),t.writeU8(this.code),t.writeVarString(this.reason,"ascii"),this.hash&&t.writeHash(this.hash),t}toRaw(){const t=this.getSize();return this.toWriter(new a(t)).render()}fromReader(t){switch(this.message=t.readVarString("ascii",12),this.code=t.readU8(),this.reason=t.readVarString("ascii",111),this.message.toLowerCase()){case"block":case"tx":this.hash=t.readHash("hex");break;default:this.hash=null}return this}fromRaw(t){return this.fromReader(new o(t))}static fromReader(t){return(new u).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new u).fromRaw(t,i)}fromReason(t,e,i,s){return"string"==typeof t&&(t=u.codes[t.toUpperCase()]),t||(t=u.codes.INVALID),t>=u.codes.INTERNAL&&(t=u.codes.INVALID),this.message="",this.code=t,this.reason=e,i&&(r(s),this.message=i,this.hash=s),this}static fromReason(t,e,i,r){return(new u).fromReason(t,e,i,r)}static fromError(t,e){return u.fromReason(t.code,t.reason,e)}inspect(){const t=u.codesByVal[this.code]||this.code,e=this.hash?h.revHex(this.hash):null;return"<Reject:"+` msg=${this.message}`+` code=${t}`+` reason=${this.reason}`+` hash=${e}`+">"}async poolHandle(t,e){if(e.logger.warning("Received reject (%s): msg=%s code=%s reason=%s hash=%s.",t.hostname(),this.message,this.getCode(),this.reason,this.rhash()),!this.hash)return;const i=e.getInv(this.hash);i&&i.handleReject(t)}}u.codes={MALFORMED:1,INVALID:16,OBSOLETE:17,DUPLICATE:18,NONSTANDARD:64,DUST:65,INSUFFICIENTFEE:66,CHECKPOINT:67,INTERNAL:256,HIGHFEE:256,ALREADYKNOWN:257,CONFLICT:258},u.codesByVal=h.reverse(u.codes),t.exports=u}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * MempoolPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=(i(2),i(13),i(39));i(18),i(19);class o extends r{constructor(t=s.MEMPOOL){super(t)}static fromReader(t){return(new o).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new o).fromRaw(t)}async poolHandle(t,e){if(!e.mempool)return;if(!e.chain.synced)return;if(e.options.selfish)return;if(!e.options.bip37)return e.logger.debug("Peer requested mempool without bip37 enabled (%s).",t.hostname()),void t.destroy();const i=[];for(const t of e.mempool.map.keys())i.push(new n(n.types.TX,t));e.logger.debug("Sending mempool snapshot (%s).",t.hostname()),t.queueInv(i)}}t.exports=o}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * FilterAddPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=i(2),o=(i(13),i(6)),a=i(4),h=i(10),c=e.alloc(0);i(18),i(19);class u extends r{constructor(t=s.FILTERADD){super(t),this.data=data||c}getSize(){return a.sizeVarBytes(this.data)}toWriter(t){return t.writeVarBytes(this.data),t}toRaw(){const t=this.getSize();return this.toWriter(new o(t)).render()}fromReader(t){return this.data=t.readVarBytes(),this}fromRaw(t){return this.fromReader(new n(t))}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new u).fromRaw(t)}async poolHandle(t,e){}async peerHandle(t){const e=this.data;e.length>h.MAX_SCRIPT_PUSH?t.increaseBan(100):(t.spvFilter&&t.spvFilter.add(e),t.noRelay=!1)}}t.exports=u}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * FilterClearPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22);i(2),i(13),i(18),i(19);class n extends r{constructor(t=s.FILTERCLEAR){super(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new n).fromRaw(t)}async poolHandle(t,e){}async peerHandle(t){t.spvFilter&&t.spvFilter.reset(),t.noRelay=!1}}t.exports=n}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * FeeFilterPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=i(2),o=(i(13),i(6)),a=i(10);i(18),i(19);class h extends r{constructor(t,e=s.FEEFILTER){super(e),this.rate=t||0}getSize(){return 8}toWriter(t){return t.writeI64(this.rate),t}toRaw(){return this.toWriter(new o(8)).render()}fromReader(t){return this.rate=t.readI64(),this}fromRaw(t){return this.fromReader(new n(t))}static fromReader(t){return(new h).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new h).fromRaw(t)}async peerHandle(t){const e=this.rate;e<0||e>a.MAX_MONEY?t.increaseBan(100):t.feeRate=e}async poolHandle(t,e){}}t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * SendCmpctPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=i(2),o=(i(13),i(6));i(18),i(19);class a extends r{constructor(t,e,i=s.SENDCMPCT){super(i),this.mode=t||0,this.version=e||1}getSize(){return 9}toWriter(t){return t.writeU8(this.mode),t.writeU64(this.version),t}toRaw(){return this.toWriter(new o(9)).render()}fromReader(t){return this.mode=t.readU8(),this.version=t.readU64(),this}fromRaw(t){return this.fromReader(new n(t))}static fromReader(t){return(new a).fromReader(t)}static fromReader(t){return(new a).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new a).fromRaw(t)}async poolHandle(t,e){}async peerHandle(t){-1===t.compactMode?this.version>2?t.logger.info("Peer request compact blocks version %d (%s).",this.version,t.hostname()):this.mode>1?t.logger.info("Peer request compact blocks mode %d (%s).",this.mode,t.hostname()):(t.logger.info("Peer initialized compact blocks (mode=%d, version=%d) (%s).",this.mode,this.version,t.hostname()),t.compactMode=this.mode,t.compactWitness=2===this.version):t.logger.debug("Peer sent a duplicate sendcmpct (%s).",t.hostname())}}t.exports=a}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * CmpctBlockPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=(i(2),i(13),i(184)),o=i(3),a=i(1),h=(i(18),i(19),i(65)),c=i(382);class u extends r{constructor(t,e,i=s.CMPCTBLOCK){super(i),this.block=t||new n.CompactBlock,this.witness=e||!1}getSize(){return this.witness?this.block.getSize(!0):this.block.getSize(!1)}toWriter(t){return this.witness?this.block.toWriter(t):this.block.toNormalWriter(t)}toRaw(){return this.witness?this.block.toRaw():this.block.toNormal()}fromReader(t){return this.block.fromReader(t),this}fromRaw(t){return this.block.fromRaw(t),this}static fromReader(t){return(new u).fromRaw(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new u).fromRaw(t)}async poolHandle(t,e){const i=this.block,r=i.hash("hex"),s=t.compactWitness;if(!e.syncing)return;if(!e.options.compact)return e.logger.info("Peer sent unsolicited CMPCTBLOCK (%s).",t.hostname()),void e.destroy();if(!t.hasCompactSupport()||!t.hasCompact())return e.logger.info("Peer sent unsolicited CMPCTBLOCK (%s).",t.hostname()),void e.destroy();if(t.compactBlocks.has(r))return void e.logger.debug("Peer sent us a duplicate compact block (%s).",t.hostname());if(e.compactBlocks.has(r))return void e.logger.debug("Already waiting for compact block %s (%s).",r,t.hostname());if(!t.blockMap.has(r)){if(1!==e.options.blockMode)return e.logger.warning("Peer sent us an unrequested compact block (%s).",t.hostname()),void t.destroy();t.blockMap.set(r,o.ms()),a(!e.blockMap.has(r)),e.blockMap.add(r)}if(!e.mempool)return void e.logger.warning("Requesting compact blocks without a mempool!");if(!i.verify())return e.logger.debug("Peer sent an invalid compact block (%s).",t.hostname()),void t.increaseBan(100);let n;try{n=i.init()}catch(i){return e.logger.debug("Peer sent an invalid compact block (%s).",t.hostname()),void t.increaseBan(100)}if(!n)return e.logger.warning("Siphash collision for %s. Requesting full block (%s).",i.rhash(),t.hostname()),t.getFullBlock(r),void t.increaseBan(10);if(i.fillMempool(s,e.mempool)){e.logger.debug("Received full compact block %s (%s).",i.rhash(),t.hostname());const r=h.flags.VERIFY_BODY;await e.addBlock(t,i.toBlock(),r)}else{if(1===e.options.blockMode&&t.compactBlocks.size>=15)return e.logger.warning("Compact block DoS attempt (%s).",t.hostname()),void t.destroy();i.now=o.ms(),a(!t.compactBlocks.has(r)),t.compactBlocks.set(r,i),e.compactBlocks.add(r),e.logger.debug("Received non-full compact block %s tx=%d/%d (%s).",i.rhash(),i.count,i.totalTX,t.hostname()),t.send(new c(i.toRequest()))}}}t.exports=u}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * EncinitPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=i(2),o=(i(13),i(6)),a=i(4);i(18),i(19);class h extends r{constructor(t,e,i=s.ENCINIT){super(i),this.publicKey=t||a.ZERO_KEY,this.cipher=e||0}getSize(){return 34}toWriter(t){return t.writeBytes(this.publicKey),t.writeU8(this.cipher),t}toRaw(){return this.toWriter(new o(34)).render()}fromReader(t){return this.publicKey=t.readBytes(33),this.cipher=t.readU8(),this}fromRaw(t){return this.fromReader(new n(t))}static fromReader(t){return(new h).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new h).fromRaw(t)}async poolHandle(t,e){}async peerHandle(t){t.bip151&&(t.bip151.encinit(this.publicKey,this.cipher),t.send(t.bip151.toEncack()))}}t.exports=h}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * EncackPacket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(25),s=i(22),n=i(2),o=(i(13),i(4));i(18),i(19);class a extends r{constructor(t,e=s.ENCACK){super(e),this.publicKey=t||o.ZERO_KEY}getSize(){return 33}toWriter(t){return t.writeBytes(this.publicKey),t}toRaw(){return this.publicKey}fromReader(t){return this.publicKey=t.readBytes(33),this}fromRaw(t){return this.fromReader(new n(t))}static fromReader(t){return(new a).fromReader(t)}static fromRaw(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new a).fromRaw(t)}async poolHandle(t,e){}async peerHandle(t){t.bip151&&t.bip151.encack(this.publicKey)}}t.exports=a}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * node/index.js - node for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.Config=i(361),e.FullNode=i(451),e.Logger=i(45),e.Node=i(180),e.SPVNode=i(453)},function(t,e,i){"use strict";
/*!
 * fullnode.js - full node for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(177),n=i(203),o=i(364),a=i(19),h=i(366),c=i(359),u=i(360),l=i(180),{operatorType:f}=i(8),{opcodes:d}=i(27),p=i(452),g=i(145);i(41),t.exports=class extends l{constructor(t){super(t),this.spv=!1,this.MiddleHash=new Set,this.MiddleHashDb=new Set,this.saleList=new g,this.cpList=new p,this.chain=new s({node:this,network:this.network,logger:this.logger,workers:this.workers,db:this.config.str("db"),prefix:this.config.prefix,maxFiles:this.config.uint("max-files"),cacheSize:this.config.mb("cache-size"),forceFlags:this.config.bool("force-flags"),prune:this.config.bool("prune"),checkpoints:this.config.bool("checkpoints"),coinCache:this.config.mb("coin-cache"),entryCache:this.config.uint("entry-cache"),indexTX:this.config.bool("index-tx"),indexAddress:this.config.bool("index-address")}),this.fees=new n(this.logger),this.fees.init(),this.mempool=new o({node:this,network:this.network,logger:this.logger,workers:this.workers,fees:this.fees,db:this.config.str("db"),prefix:this.config.prefix,persistent:this.config.bool("persistent-mempool"),maxSize:this.config.mb("mempool-size"),limitFree:this.config.bool("limit-free"),limitFreeRelay:this.config.uint("limit-free-relay"),requireStandard:this.config.bool("require-standard"),rejectAbsurdFees:this.config.bool("reject-absurd-fees"),replaceByFee:this.config.bool("replace-by-fee"),indexAddress:this.config.bool("index-address")}),this.pool=new a({node:this,network:this.network,logger:this.logger,prefix:this.config.prefix,selfish:this.config.bool("selfish"),compact:this.config.bool("compact"),bip37:this.config.bool("bip37"),bip151:this.config.bool("bip151"),bip150:this.config.bool("bip150"),identityKey:this.config.buf("identity-key"),maxOutbound:this.config.uint("max-outbound"),maxInbound:this.config.uint("max-inbound"),proxy:this.config.str("proxy"),onion:this.config.bool("onion"),upnp:this.config.bool("upnp"),seeds:this.config.array("seeds"),nodes:this.config.array("nodes"),only:this.config.array("only"),publicHost:this.config.str("public-host"),publicPort:this.config.uint("public-port"),host:this.config.str("host"),port:this.config.uint("port"),wsport:this.config.uint("wsport"),listen:this.config.bool("listen"),persistent:this.config.bool("persistent")}),this.miner=new h({node:this,network:this.network,logger:this.logger,workers:this.workers,address:this.config.array("coinbase-address"),tokenAddress:this.config.str("coinbase-token-address"),coinbaseFlags:this.config.str("coinbase-flags"),preverify:this.config.bool("preverify"),maxWeight:this.config.uint("max-weight"),reservedWeight:this.config.uint("reserved-weight"),reservedSigops:this.config.uint("reserved-sigops")}),this.rpc=new u(this),this._init(),c.unsupported||(this.http=new c({network:this.network,logger:this.logger,node:this,prefix:this.config.prefix,ssl:this.config.bool("ssl"),keyFile:this.config.path("ssl-key"),certFile:this.config.path("ssl-cert"),host:this.config.str("http-host"),apiKey:this.config.str("api-key")}),this.http.on("error",t=>this.error(t)),this.http.init())}_init(){this.chain.on("error",t=>this.error(t)),this.mempool.on("error",t=>this.error(t)),this.pool.on("error",t=>this.error(t)),this.miner.on("error",t=>this.error(t)),this.mempool.on("tx",t=>{this.miner.cpu.notifyEntry(),this.emit("tx",t)}),this.mempool.on("entry.remove",t=>{this.miner.cpu.notifyEntry(),this.emit("entry.remove",t)}),this.chain.hook("chain.connect",async(t,e)=>{try{await this.mempool._addBlock(t,e.txs)}catch(t){this.error(t)}this.emit("block",e),this.emit("chain.connect",t,e)}),this.chain.hook("chain.disconnect",async(t,e)=>{try{await this.mempool._removeBlock(t,e.txs)}catch(t){this.error(t)}this.emit("chain.disconnect",t,e)}),this.chain.hook("chain.reorganize",async(t,e)=>{try{await this.mempool._handleReorg()}catch(t){this.error(t)}this.emit("chain.reorganize",t,e)}),this.chain.hook("chain.reset",async t=>{try{await this.mempool._reset()}catch(t){this.error(t)}this.emit("chain.reset",t)}),this.loadPlugins()}async _open(){await this.chain.open(),await this.mempool.open(),await this.miner.open(),await this.pool.open(),await this.openPlugins(),this.http&&await this.http.open(),this.logger.info("Node is loaded.")}async _close(){this.http&&await this.http.close(),await this.closePlugins(),await this.pool.close(),await this.miner.close(),await this.mempool.close(),await this.chain.close(),this.logger.info("Node is closed.")}scan(t,e,i){return this.chain.scan(t,e,i)}middleHash(t){return t==f.Mem?this.MiddleHash:this.MiddleHashDb}async broadcast(t){try{await this.pool.broadcast(t)}catch(t){this.emit("error",t)}}async getVpPublish(t){return await this.chain.db.getVpp(t)}async addSaleOrder(t){r(t),r(t.pid);let e=await this.getVpPublish(t.pid);r(e),t.cid=e.cid,t.gold=e.gold,this.saleList.set(t.pid,t)}delSaleOrder(t,e=!1){e?this.saleList.delete(t):this.saleList.expired(t)}recoverSaleOrder(t){this.saleList.unexpired(t)}async queryProps(t,e){let i=[],r=await this.getCoinsByAddress(e);for(let e of r)if(e.script.code[0].value==d.OP_PROPEXCHANGE||e.script.code[0].value==d.OP_PROPCREATE)try{let r=e.getReturnData();r.current={hash:e.hash,index:e.index},r.gold=e.value,r.confirm=e.height>0?this.chain.height-e.height+1:0;let s=await this.getVpPublish(r.pid);s.cid===t&&(r.root={hash:s.current.hash,index:s.current.index},i.push(r))}catch(t){}return i}async addCpItem(t){this.cpList.addItem(t)}getCpItem(t){return this.cpList.get(t)}async delCpItem(t,e=!1){e?this.cpList.delete(t):this.cpList.expired(t)}checkCpItem(t){return!!this.cpList.has(t)&&this.cpList.get(t).immutable}async sendTX(t){let e;try{e=await this.mempool.addTX(t)}catch(e){if("VerifyError"===e.type&&0===e.score)return this.error(e),void this.logger.warning("Verification failed for tx: %s.",t.txid());throw e}if(e)return this.logger.warning("TX was orphaned in mempool: %s.",t.txid()),this.logger.warning("Attempting to broadcast anyway..."),void this.broadcast(t);this.pool.options.selfish&&this.pool.broadcast(t)}async relay(t){try{await this.sendTX(t)}catch(t){this.error(t)}}async removeTX(t){try{await this.mempool.removeTX(t)}catch(t){throw t}}connect(){return this.pool.connect()}disconnect(){return this.pool.disconnect()}startSync(){return this.pool.startSync()}stopSync(){return this.pool.stopSync()}getBlock(t){return this.chain.getBlock(t)}async getCoin(t,e){return this.mempool.getCoin(t,e)||(this.mempool.isSpent(t,e)?null:await this.chain.getCoin(t,e))}async getCoinsByAddress(t){const e=this.mempool.getCoinsByAddress(t),i=await this.chain.getCoinsByAddress(t),r=[];for(const t of i)this.mempool.isSpent(t.hash,t.index)||r.push(t);for(const t of e)r.push(t);return r}async getMetaByAddress(t){const e=this.mempool.getMetaByAddress(t);return(await this.chain.getMetaByAddress(t)).concat(e)}async getMeta(t){if(this.mempool){const e=this.mempool.getMeta(t);if(e)return e}return await this.chain.getMeta(t)}async getMetaView(t){return-1===t.height?this.mempool.getSpentView(t.tx):this.chain.getSpentView(t.tx)}async getTXByAddress(t){const e=await this.getMetaByAddress(t),i=[];for(const t of e)i.push(t.tx);return i}async getTX(t){const e=await this.getMeta(t);return e?e.tx:null}async hasTX(t){return!!this.mempool.hasEntry(t)||await this.chain.hasTX(t)}}},function(t,e,i){const r=i(70),{OperType:s}=i(8);t.exports=class extends r{constructor(){super(),this.cpNameMap=new Map}addItem(t){this.set(t.cid,t),this.cpNameMap.set(t.name,t)}delItem(t){this.delete(t.cid),this.removeNameIndex(t.name)}getItemByName(t){return this.cpNameMap.get(t)}getRecord(t){let e=this.get(t);return e?{cid:e.cid,cls:e.cls,name:e.name,url:e.url,ip:e.ip,grate:e.grate}:null}removeNameIndex(t){this.cpNameMap.delete(t)}canExecute(t,e){switch(e){case s.cpRegister:return this.canRegister(t,0);case s.cpChange:return this.canUseName(t,0)}return!1}canRegister(t){return!this.has(t.cid)&&!this.cpNameMap.has(t.name)}canUseName(t){let e=this.cpNameMap.get(t.cid);return!e||e.cid===t.cid}getCPList(t,e){let i=["cid","cls","name","url","ip","grate","current"];if(t.length>0)return this.where([["cid","include",t]]).paginate(50,1).records(i);{e.pageSize=e.pageSize||10;let t=(e.cls?this.where([["cls",e.cls]]):this).paginate(e.pageSize,e.page).records(i);return e.pageCount=this.pageNum,e.page=Math.min(e.page,e.pageCount),t}}getCPListByName(t,e){let i=["cid","cls","name","url","ip","grate","current"];if(t.length>0)return this.where([["name","include",t]]).paginate(50,1).records(i);{let t=this.paginate(10,page).records(i);return e.pageCount=this.pageNum,e.page=Math.min(e.page,e.pageCount),t}}}},function(t,e,i){"use strict";
/*!
 * spvnode.js - spv node for gamegold
 * Copyright (c) 2017-2020, Bookman Software (MIT License).
 */const r=i(34),s=i(177),n=i(19),o=i(359),a=i(360),h=i(180);t.exports=class extends h{constructor(t){super(t),this.spv=!0,this.chain=new s({node:this,network:this.network,logger:this.logger,db:this.config.str("db"),prefix:this.config.prefix,maxFiles:this.config.uint("max-files"),cacheSize:this.config.mb("cache-size"),entryCache:this.config.uint("entry-cache"),forceFlags:this.config.bool("force-flags"),checkpoints:this.config.bool("checkpoints"),spv:!0}),this.pool=new n({node:this,network:this.network,logger:this.logger,prefix:this.config.prefix,proxy:this.config.str("proxy"),onion:this.config.bool("onion"),upnp:this.config.bool("upnp"),seeds:this.config.array("seeds"),nodes:this.config.array("nodes"),only:this.config.array("only"),bip151:this.config.bool("bip151"),bip150:this.config.bool("bip150"),identityKey:this.config.buf("identity-key"),maxOutbound:this.config.uint("max-outbound"),persistent:this.config.bool("persistent"),selfish:!0,listen:!1}),this._init(),this.rpc=new a(this),o.unsupported||(this.http=new o({network:this.network,logger:this.logger,node:this,prefix:this.config.prefix,ssl:this.config.bool("ssl"),keyFile:this.config.path("ssl-key"),certFile:this.config.path("ssl-cert"),host:this.config.str("http-host"),apiKey:this.config.str("api-key")})),this.rescanJob=null,this.scanLock=new r,this.watchLock=new r,this.http&&this.http.init()}_init(){this.chain.on("error",t=>this.error(t)),this.pool.on("error",t=>this.error(t)),this.http&&this.http.on("error",t=>this.error(t)),this.pool.on("tx",t=>{this.rescanJob||this.emit("tx",t)}),this.chain.on("block",(t,e)=>{this.emit("block",t,e)}),this.chain.on("chain.connect",async(t,e)=>{if(this.rescanJob)try{await this.watchBlock(t,e)}catch(t){this.error(t)}else this.emit("chain.connect",t,e)}),this.chain.on("chain.disconnect",(t,e)=>{this.emit("chain.disconnect",t,e)}),this.chain.on("chain.reorganize",(t,e)=>{this.emit("chain.reorganize",t,e)}),this.chain.on("chain.reset",t=>{this.emit("chain.reset",t)}),this.loadPlugins()}async _open(t){await this.chain.open(),await this.pool.open(),await this.openPlugins(),this.http&&await this.http.open(),this.logger.info("Node is loaded.")}async _close(){this.http&&await this.http.close(),await this.closePlugins(),await this.pool.close(),await this.chain.close()}async scan(t,e,i){const r=await this.scanLock.lock();this.chain.height;try{await this.chain.replay(t),this.chain.height}finally{r()}}watchUntil(t,e){return new Promise((i,r)=>{this.rescanJob=new function(t,e,i,r){this.resolve=t,this.reject=e,this.height=i,this.iter=r}(i,r,t,e)})}async watchBlock(t,e){const i=await this.watchLock.lock();try{if(t.height<this.rescanJob.height)return void await this.rescanJob.iter(t,e.txs);this.rescanJob.resolve(),this.rescanJob=null}catch(t){this.rescanJob.reject(t),this.rescanJob=null}finally{i()}}async broadcast(t){try{await this.pool.broadcast(t)}catch(t){this.emit("error",t)}}async sendTX(t){return this.emit("tx",t),await this.broadcast(t)}async relay(t){try{await this.sendTX(t)}catch(t){this.error(t)}}connect(){return this.pool.connect()}disconnect(){return this.pool.disconnect()}startSync(){return this.pool.startSync()}stopSync(){return this.pool.stopSync()}}},function(t,e,i){"use strict";(function(e){
/*!
 * sigcache.js - signature cache for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(30);function o(t){if(!(this instanceof o))return new o(t);null==t&&(t=1e4),r(s.isU32(t)),this.size=t,this.keys=[],this.valid=new Map}function a(t,i){this.sig=e.from(t),this.key=e.from(i)}o.prototype.resize=function(t){r(s.isU32(t)),this.size=t,this.keys.length=0,this.valid.clear()},o.prototype.add=function(t,e,i){if(0!==this.size)if(this.valid.set(t,new a(e,i)),this.keys.length>=this.size){const e=Math.floor(Math.random()*this.keys.length),i=this.keys[e];this.valid.delete(i),this.keys[e]=t}else this.keys.push(t)},o.prototype.has=function(t,e,i){const r=this.valid.get(t);return!!r&&r.equals(e,i)},o.prototype.verify=function(t,e,i){if(0===this.size)return n.verify(t,e,i);const r=t.toString("hex");return!!this.has(r,e,i)||!!n.verify(t,e,i)&&(this.add(r,e,i),!0)},a.prototype.equals=function(t,e){return this.sig.equals(t)&&this.key.equals(e)},t.exports=o}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * masterkey.js - master bip32 key object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(34),o=i(93),a=i(120),h=i(199),c=i(117),u=i(173),l=i(2),f=i(6),d=i(4),p=i(200),g=p.Mnemonic;class m{constructor(t){this.encrypted=!1,this.iv=null,this.ciphertext=null,this.key=null,this.mnemonic=null,this.alg=m.alg.PBKDF2,this.N=5e4,this.r=0,this.p=0,this.aesKey=null,this.timer=null,this.until=0,this._onTimeout=this.lock.bind(this),this.locker=new n,t&&this.fromOptions(t)}fromOptions(t){return r(t),null!=t.encrypted&&(r("boolean"==typeof t.encrypted),this.encrypted=t.encrypted),t.iv&&(r(e.isBuffer(t.iv)),this.iv=t.iv),t.ciphertext&&(r(e.isBuffer(t.ciphertext)),this.ciphertext=t.ciphertext),t.key&&(r(p.isPrivate(t.key)),this.key=t.key),t.mnemonic&&(r(t.mnemonic instanceof g),this.mnemonic=t.mnemonic),null!=t.alg&&("string"==typeof t.alg?(this.alg=m.alg[t.alg.toUpperCase()],r(null!=this.alg,"Unknown algorithm.")):(r("number"==typeof t.alg),r(m.algByVal[t.alg]),this.alg=t.alg)),null!=t.rounds&&(r(s.isU32(t.rounds)),this.N=t.rounds),null!=t.N&&(r(s.isU32(t.N)),this.N=t.N),null!=t.r&&(r(s.isU32(t.r)),this.r=t.r),null!=t.p&&(r(s.isU32(t.p)),this.p=t.p),r(this.encrypted?!this.key:this.key),this}static fromOptions(t){return(new m).fromOptions(t)}async unlock(t,e){const i=await this.locker.lock();try{return await this._unlock(t,e)}finally{i()}}async _unlock(t,e){if(this.key)this.encrypted&&e>0&&this.start(e);else{if(!t)throw new Error("No passphrase.");r(this.encrypted);const i=await this.derive(t),s=h.decipher(this.ciphertext,i,this.iv);this.fromKeyRaw(s),e>0&&this.start(e),this.aesKey=i}return this.key}start(t){t||(t=60),this.stop(),-1!==t&&(this.until=s.now()+t,this.timer=setTimeout(this._onTimeout,1e3*t))}stop(){null!=this.timer&&(clearTimeout(this.timer),this.timer=null,this.until=0)}async derive(t){const i=m.SALT,r=this.N,s=this.r,n=this.p;switch("string"==typeof t&&(t=e.from(t,"utf8")),this.alg){case m.alg.PBKDF2:return await c.deriveAsync(t,i,r,32,"sha256");case m.alg.SCRYPT:return await u.deriveAsync(t,i,r,s,n,32);default:throw new Error(`Unknown algorithm: ${this.alg}.`)}}encipher(t,i){return this.aesKey?("string"==typeof i&&(i=e.from(i,"hex")),h.encipher(t,this.aesKey,i.slice(0,16))):null}decipher(t,i){return this.aesKey?("string"==typeof i&&(i=e.from(i,"hex")),h.decipher(t,this.aesKey,i.slice(0,16))):null}async lock(){const t=await this.locker.lock();try{return await this._lock()}finally{t()}}_lock(){if(!this.encrypted)return r(null==this.timer),void r(this.key);this.stop(),this.key&&(this.key.destroy(!0),this.key=null),this.aesKey&&(a(this.aesKey),this.aesKey=null)}async destroy(){await this.lock(),this.locker.destroy()}async decrypt(t,e){const i=await this.locker.lock();try{return await this._decrypt(t,e)}finally{i()}}async _decrypt(t,e){if(!this.encrypted)throw new Error("Master key is not encrypted.");if(!t)throw new Error("No passphrase provided.");this._lock();const i=await this.derive(t),r=h.decipher(this.ciphertext,i,this.iv);return this.fromKeyRaw(r),this.encrypted=!1,this.iv=null,this.ciphertext=null,e?i:(a(i),null)}async encrypt(t,e){const i=await this.locker.lock();try{return await this._encrypt(t,e)}finally{i()}}async _encrypt(t,e){if(this.encrypted)throw new Error("Master key is already encrypted.");if(!t)throw new Error("No passphrase provided.");const i=this.toKeyRaw(),r=o.randomBytes(16);this.stop();const s=await this.derive(t),n=h.encipher(i,s,r);return this.key&&(this.key.destroy(!0),this.key=null),this.aesKey&&(a(this.aesKey),this.aesKey=null),this.mnemonic=null,this.encrypted=!0,this.iv=r,this.ciphertext=n,e?s:(a(s),null)}getKeySize(){let t=0;return t+=this.key.getSize(),t+=1,this.mnemonic&&(t+=this.mnemonic.getSize()),t}toKeyRaw(){const t=new f(this.getKeySize());return this.key.toWriter(t),this.mnemonic?(t.writeU8(1),this.mnemonic.toWriter(t)):t.writeU8(0),t.render()}fromKeyRaw(t){const e=new l(t);return this.key=p.PrivateKey.fromReader(e),1===e.readU8()&&(this.mnemonic=g.fromReader(e)),this}getSize(){let t=0;return this.encrypted?(t+=1,t+=d.sizeVarBytes(this.iv),t+=d.sizeVarBytes(this.ciphertext),t+=13):(t+=1,t+=d.sizeVarlen(this.getKeySize()))}toRaw(){const t=new f(this.getSize());if(this.encrypted)return t.writeU8(1),t.writeVarBytes(this.iv),t.writeVarBytes(this.ciphertext),t.writeU8(this.alg),t.writeU32(this.N),t.writeU32(this.r),t.writeU32(this.p),t.render();t.writeU8(0);const e=this.getKeySize();return t.writeVarint(e),t.writeBytes(this.key.toRaw()),this.mnemonic?(t.writeU8(1),this.mnemonic.toWriter(t)):t.writeU8(0),t.render()}fromRaw(t){const e=new l(t);return this.encrypted=1===e.readU8(),this.encrypted?(this.iv=e.readVarBytes(),this.ciphertext=e.readVarBytes(),this.alg=e.readU8(),r(m.algByVal[this.alg]),this.N=e.readU32(),this.r=e.readU32(),this.p=e.readU32(),this):(e.readVarint(),this.key=p.PrivateKey.fromRaw(e.readBytes(82)),1===e.readU8()&&(this.mnemonic=g.fromReader(e)),this)}static fromRaw(t){return(new m).fromRaw(t)}fromKey(t,e){return this.encrypted=!1,this.iv=null,this.ciphertext=null,this.key=t,this.mnemonic=e||null,this}static fromKey(t,e){return(new m).fromKey(t,e)}toJSON(t){return this.encrypted?{encrypted:!0,until:this.until,iv:this.iv.toString("hex"),ciphertext:t?this.ciphertext.toString("hex"):void 0,algorithm:m.algByVal[this.alg].toLowerCase(),N:this.N,r:this.r,p:this.p}:{encrypted:!1,key:t?this.key.toJSON():void 0,mnemonic:t&&this.mnemonic?this.mnemonic.toJSON():void 0}}inspect(){const t=this.toJSON(!0);return this.key&&(t.key=this.key.toJSON()),this.mnemonic&&(t.mnemonic=this.mnemonic.toJSON()),t}}m.SALT=e.from("Bitcoin seed","ascii"),m.alg={PBKDF2:0,SCRYPT:1},m.algByVal={0:"PBKDF2",1:"SCRYPT"},t.exports=m}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * txdb.js - persistent transaction pool
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(3),s=i(98),n=i(1),o=i(31),a=i(44),h=i(41),c=i(37),u=i(457),l=i(121).txdb,f=i(4),d=i(33),p=i(20),g=i(458),m=i(385),w=i(459),y=i(572),b=i(573),v=(i(218),i(187),i(574)),k=(i(17),i(53)),{operatorType:S}=i(8);class x{constructor(t){this.wallet=t,this.walletdb=t.db,this.logger=this.walletdb.logger,this.network=this.walletdb.network,this.options=this.walletdb.options,this.coinCache=new s(1e4),this.locked=new Set,this.state=null,this.pending=null,this.events=[]}async open(){const t=await this.getState();t?(this.state=t,this.logger.info("TXDB loaded for %s.",this.wallet.id)):(this.state=new y(this.wallet.wid,this.wallet.id),this.logger.info("TXDB created for %s.",this.wallet.id)),this.logger.info("TXDB State: tx=%d coin=%s.",this.state.tx,this.state.coin),this.logger.info("Balance: unconfirmed=%s confirmed=%s.",o.btc(this.state.unconfirmed),o.btc(this.state.confirmed))}start(){return this.pending=this.state.clone(),this.coinCache.start(),this.wallet.start()}drop(){return this.pending=null,this.events.length=0,this.coinCache.drop(),this.wallet.drop()}clear(){return this.pending=this.state.clone(),this.events.length=0,this.coinCache.clear(),this.wallet.clear()}async commit(){try{await this.wallet.commit()}catch(t){throw this.pending=null,this.events.length=0,this.coinCache.drop(),t}if(this.pending.committed){this.state=this.pending;for(const[t,e,i]of this.events)this.walletdb.emit(t,this.wallet.id,e,i),this.wallet.emit(t,e,i)}this.pending=null,this.events.length=0,this.coinCache.commit()}emit(t,e,i){this.events.push([t,e,i])}prefix(t){return n(this.wallet.wid),l.prefix(this.wallet.wid,t)}put(t,e){n(this.wallet.current),this.wallet.current.put(this.prefix(t),e)}del(t){n(this.wallet.current),this.wallet.current.del(this.prefix(t))}get(t){return this.walletdb.db.get(this.prefix(t))}has(t){return this.walletdb.db.has(this.prefix(t))}range(t){return t.gte&&(t.gte=this.prefix(t.gte)),t.lte&&(t.lte=this.prefix(t.lte)),this.walletdb.db.range(t)}keys(t){return t.gte&&(t.gte=this.prefix(t.gte)),t.lte&&(t.lte=this.prefix(t.lte)),this.walletdb.db.keys(t)}values(t){return t.gte&&(t.gte=this.prefix(t.gte)),t.lte&&(t.lte=this.prefix(t.lte)),this.walletdb.db.values(t)}async getPath(t){const e=t.getAddress();return e?await this.wallet.getPath(e):null}async hasPath(t){const e=t.getAddress();return!!e&&await this.wallet.hasPath(e)}async saveCredit(t,e){const i=t.coin,r=i.toKey(),s=t.toRaw();let n=await this.walletdb.getOutpointMap(i.hash,i.index);n||(n=new u(i.hash,i.index)),n.add(this.wallet.wid)&&this.walletdb.writeOutpointMap(this.wallet,i.hash,i.index,n),this.put(l.c(i.hash,i.index),s),this.put(l.C(e.account,i.hash,i.index),null),this.coinCache.push(r,s)}async removeCredit(t,e){const i=t.coin,r=i.toKey();await this.removeOutpointMap(i.hash,i.index),this.del(l.c(i.hash,i.index)),this.del(l.C(e.account,i.hash,i.index)),this.coinCache.unpush(r)}spendCredit(t,e,i){const r=e.inputs[i].prevout,s=c.fromTX(e,i);this.put(l.s(r.hash,r.index),s.toRaw()),this.put(l.d(s.hash,s.index),t.coin.toRaw())}unspendCredit(t,e){const i=t.inputs[e].prevout,r=c.fromTX(t,e);this.del(l.s(i.hash,i.index)),this.del(l.d(r.hash,r.index))}writeInput(t,e){const i=t.inputs[e].prevout,r=c.fromTX(t,e);this.put(l.s(i.hash,i.index),r.toRaw())}removeInput(t,e){const i=t.inputs[e].prevout;this.del(l.s(i.hash,i.index))}async resolveInput(t,e,i,r,s){const o=t.hash("hex"),a=await this.getSpender(o,e);if(!a)return!1;if(await this.hasSpentCoin(a))return!1;const h=await this.getTX(a.hash);n(h);const c=b.fromTX(t,e,i);return c.own=s,this.spendCredit(c,h.tx,a.index),-1===h.height&&(c.spent=!0,await this.saveCredit(c,r),-1!==i&&this.changeConfirmed(this.pending,c.coin,1)),!0}async isDoubleSpend(t){for(const{prevout:e}of t.inputs)if(await this.isSpent(e.hash,e.index))return!0;return!1}async isRBF(t){if(t.isRBF())return!0;for(const{prevout:e}of t.inputs){const t=l.r(e.hash);if(await this.has(t))return!0}return!1}async getSpender(t,e){const i=await this.get(l.s(t,e));return i?c.fromRaw(i):null}isSpent(t,e){return this.has(l.s(t,e))}async removeOutpointMap(t,e){const i=await this.walletdb.getOutpointMap(t,e);i&&i.remove(this.wallet.wid)&&(0!==i.wids.size?this.walletdb.writeOutpointMap(this.wallet,t,e,i):this.walletdb.unwriteOutpointMap(this.wallet,t,e))}async addBlockMap(t,e){let i=await this.walletdb.getBlockMap(e);i||(i=new g(e)),i.add(t,this.wallet.wid)&&this.walletdb.writeBlockMap(this.wallet,e,i)}async removeBlockMap(t,e){const i=await this.walletdb.getBlockMap(e);i&&i.remove(t,this.wallet.wid)&&(0!==i.txs.size?this.walletdb.writeBlockMap(this.wallet,e,i):this.walletdb.unwriteBlockMap(this.wallet,e))}getBlocks(){return this.keys({gte:l.b(0),lte:l.b(4294967295),parse:t=>l.bb(t)})}async getBlock(t){const e=await this.get(l.b(t));return e?v.fromRaw(e):null}async addBlock(t,i){const r=l.b(i.height);let s,n=await this.get(r);n||(n=(s=v.fromMeta(i)).toRaw()),s=e.allocUnsafe(n.length+32),n.copy(s,0);const o=s.readUInt32LE(40,!0);s.writeUInt32LE(o+1,40,!0),t.copy(s,n.length),this.put(r,s)}async removeBlock(t,e){const i=l.b(e),r=await this.get(i);if(!r)return;const s=r.readUInt32LE(40,!0);if(n(s>0),n(r.slice(-32).equals(t)),1===s)return void this.del(i);const o=r.slice(0,-32);o.writeUInt32LE(s-1,40,!0),this.put(i,o)}async addBlockSlow(t,e){let i=await this.getBlock(e.height);i||(i=v.fromMeta(e)),i.add(t)&&this.put(l.b(e.height),i.toRaw())}async removeBlockSlow(t,e){const i=await this.getBlock(e);i&&i.remove(t)&&(0!==i.hashes.length?this.put(l.b(e),i.toRaw()):this.del(l.b(e)))}async add(t,e){let i;this.start();try{i=await this._add(t,e)}catch(t){throw this.drop(),t}return await this.commit(),i}async _add(t,e){n(!t.mutable,"Cannot add mutable TX to wallet.");const i=t.hash("hex"),r=await this.getTX(i);if(e){if(r)return-1!==r.height?null:await this._confirm(r,e);await this.removeConflicts(t,!1),this.del(l.r(i))}else{if(r)return null;if(await this.isRBF(t))return this.put(l.r(i),null),null;if(!await this.removeConflicts(t,!0))return null}const s=m.fromTX(t,e);return await this.insert(s,e)}async insert(t,e){const i=t.tx,r=t.hash,s=e?e.height:-1,o=new E(this,t,e),a=new Set;let h=!1,c=!1;if(!i.isCoinbase())for(let t=0;t<i.inputs.length;t++){const r=i.inputs[t].prevout,s=await this.getCredit(r.hash,r.index);if(!s){this.writeInput(i,t);continue}const u=s.coin;if(!e&&!await this.verifyInput(i,t,u))return this.clear(),null;const l=await this.getPath(u);n(l),o.setInput(t,l,u),a.add(l.account),this.spendCredit(s,i,t),this.pending.coin--,this.changeUnconfirmed(this.pending,u,0),e?(this.changeConfirmed(this.pending,u,0),await this.removeCredit(s,l)):(s.spent=!0,await this.saveCredit(s,l)),c=!0,h=!0}for(let t=0;t<i.outputs.length;t++){const r=i.outputs[t],n=await this.getPath(r);if(!n)continue;if(o.setOutput(t,n),a.add(n.account),await this.resolveInput(i,t,s,n,h)){c=!0;continue}const u=b.fromTX(i,t,s);u.own=h,this.pending.coin++,this.changeUnconfirmed(this.pending,r,1),e&&this.changeConfirmed(this.pending,r,1),await this.saveCredit(u,n),c=!0}if(!c)return this.clear(),null;this.put(l.t(r),t.toRaw()),this.put(l.m(t.mtime,r),null),e?this.put(l.h(s,r),null):this.put(l.p(r),null);for(const i of a)this.put(l.T(i,r),null),this.put(l.M(i,t.mtime,r),null),e?this.put(l.H(i,s,r),null):this.put(l.P(i,r),null);return e&&(await this.addBlockMap(r,s),await this.addBlock(i.hash(),e)),this.pending.tx++,this.put(l.R,this.pending.commit()),this.unlockTX(i),this.emit("tx",i,o),this.emit("balance",this.pending.toBalance(),o),o}async confirm(t,e){const i=await this.getTX(t);if(!i)return null;if(-1!==i.height)throw new Error("TX is already confirmed.");let r;n(e),this.start();try{r=await this._confirm(i,e)}catch(t){throw this.drop(),t}return await this.commit(),r}async _confirm(t,e){const i=t.tx,r=t.hash,s=e.height,o=new E(this,t,e),a=new Set;if(t.setBlock(e),!i.isCoinbase()){const t=await this.getSpentCredits(i);for(let e=0;e<i.inputs.length;e++){const r=i.inputs[e].prevout;let s=t[e];if(!s){if(!(s=await this.getCredit(r.hash,r.index)))continue;this.spendCredit(s,i,e),this.pending.coin--,this.changeUnconfirmed(this.pending,s.coin,0)}const h=s.coin;n(-1!==h.height);const c=await this.getPath(h);n(c),o.setInput(e,c,h),a.add(c.account),this.changeConfirmed(this.pending,h,0),await this.removeCredit(s,c)}}for(let t=0;t<i.outputs.length;t++){const e=i.outputs[t],h=await this.getPath(e);if(!h)continue;o.setOutput(t,h),a.add(h.account);const c=await this.getCredit(r,t);n(c),c.spent&&await this.updateSpentCoin(i,t,s),this.changeConfirmed(this.pending,e,1),c.coin.height=s,await this.saveCredit(c,h)}this.del(l.r(r)),this.put(l.t(r),t.toRaw()),this.del(l.p(r)),this.put(l.h(s,r),null);for(const t of a)this.del(l.P(t,r)),this.put(l.H(t,s,r),null);return e&&(await this.addBlockMap(r,s),await this.addBlock(i.hash(),e)),this.put(l.R,this.pending.commit()),this.unlockTX(i),this.emit("confirmed",i,o),this.emit("balance",this.pending.toBalance(),o),o}async remove(t){const e=await this.getTX(t);return e?await this.removeRecursive(e):null}changeUnconfirmed(t,e,i){if(!e.isColored)switch(i){case 0:t.unconfirmed-=e.value;break;case 1:t.unconfirmed+=e.value}}changeConfirmed(t,e,i){if(!e.isColored)switch(i){case 0:t.confirmed-=e.value;break;case 1:t.confirmed+=e.value}}async removeRecursive(t){n(t);const e=t.tx,i=t.hash;for(let t=0;t<e.outputs.length;t++){const e=await this.getSpender(i,t);if(!e)continue;const r=await this.getTX(e.hash);await this.removeRecursive(r)}this.start();const r=await this.erase(t,t.getBlock());return n(r),await this.commit(),r}async unconfirm(t){let e;this.start();try{e=await this._unconfirm(t)}catch(t){throw this.drop(),t}return await this.commit(),e}async _unconfirm(t){const e=await this.getTX(t);return e?-1===e.height?null:await this.disconnect(e,e.getBlock()):null}async disconnect(t,e){const i=t.tx,r=t.hash,s=e.height,o=new E(this,t,e),a=new Set;if(n(e),t.unsetBlock(),!i.isCoinbase()){const t=await this.getSpentCredits(i);for(let e=0;e<i.inputs.length;e++){const i=t[e];if(!i)continue;const r=i.coin;n(-1!==r.height);const s=await this.getPath(r);n(s),o.setInput(e,s,r),a.add(s.account),this.changeConfirmed(this.pending,r,1),i.spent=!0,await this.saveCredit(i,s)}}for(let t=0;t<i.outputs.length;t++){const e=i.outputs[t],n=await this.getPath(e);if(!n)continue;const h=await this.getCredit(r,t);h?(h.spent&&await this.updateSpentCoin(i,t,s),o.setOutput(t,n),a.add(n.account),this.changeConfirmed(this.pending,e,0),h.coin.height=-1,await this.saveCredit(h,n)):await this.updateSpentCoin(i,t,s)}await this.removeBlockMap(r,s),await this.removeBlock(i.hash(),s),this.put(l.t(r),t.toRaw()),this.put(l.p(r),null),this.del(l.h(s,r));for(const t of a)this.put(l.P(t,r),null),this.del(l.H(t,s,r));return this.put(l.R,this.pending.commit()),this.emit("unconfirmed",i,o),this.emit("balance",this.pending.toBalance(),o),o}async erase(t,e){const i=t.tx,r=t.hash,s=e?e.height:-1,o=new E(this,t,e),a=new Set;if(!i.isCoinbase()){const t=await this.getSpentCredits(i);for(let r=0;r<i.inputs.length;r++){const s=t[r];if(!s){this.removeInput(i,r);continue}const h=s.coin,c=await this.getPath(h);n(c),o.setInput(r,c,h),a.add(c.account),this.pending.coin++,this.changeUnconfirmed(this.pending,h,1),e&&this.changeConfirmed(this.pending,h,1),this.unspendCredit(i,r),await this.saveCredit(s,c)}}for(let t=0;t<i.outputs.length;t++){const r=i.outputs[t],n=await this.getPath(r);if(!n)continue;o.setOutput(t,n),a.add(n.account);const h=b.fromTX(i,t,s);this.pending.coin--,this.changeUnconfirmed(this.pending,r,0),e&&this.changeConfirmed(this.pending,r,0),await this.removeCredit(h,n)}this.del(l.r(r)),this.del(l.t(r)),this.del(l.m(t.mtime,r)),e?this.del(l.h(s,r)):this.del(l.p(r));for(const i of a)this.del(l.T(i,r)),this.del(l.M(i,t.mtime,r)),e?this.del(l.H(i,s,r)):this.del(l.P(i,r));e&&(await this.removeBlockMap(r,s),await this.removeBlockSlow(r,s)),this.pending.tx--,this.put(l.R,this.pending.commit());let h=await k.FactoryOfContract(S.Wallet,i,{env:this.walletdb,finder:this.walletdb.getTXFromDb.bind(this.walletdb)});return await h.cancel(),this.emit("tx.remove",i,o),this.emit("balance",this.pending.toBalance(),o),o}async removeConflict(t){if(!t)return Promise.resolve();const e=t.tx;this.logger.warning("Handling conflicting tx: %s.",e.txid()),this.drop();const i=await this.removeRecursive(t);return this.start(),this.logger.warning("Removed conflict: %s.",e.txid()),this.emit("conflict",e,i),i}async removeConflicts(t,e){const i=t.hash("hex"),r=[];if(t.isCoinbase())return!0;for(let s=0;s<t.inputs.length;s++){const o=t.inputs[s].prevout;if(o.hash===f.NULL_HASH)continue;const a=await this.getSpender(o.hash,o.index);if(!a)continue;if(a.hash===i)continue;const h=await this.getTX(a.hash);n(h);const c=h.getBlock();if(e&&c)return!1;r[s]=h}for(const t of r)await this.removeConflict(t);return!0}async verifyInput(t,e,i){const r=p.flags.MANDATORY_VERIFY_FLAGS;return!this.options.verify||await t.verifyInput(e,i,r)}lockTX(t){if(!t.isCoinbase())for(const e of t.inputs)this.lockCoin(e.prevout)}unlockTX(t){if(!t.isCoinbase())for(const e of t.inputs)this.unlockCoin(e.prevout)}lockCoin(t){const e=t.toKey();this.locked.add(e)}unlockCoin(t){const e=t.toKey();return this.locked.delete(e)}isLocked(t){const e=t.toKey();return this.locked.has(e)}filterLocked(t){const e=[];for(const i of t)this.isLocked(i)||e.push(i);return e}getLocked(){const t=[];for(const e of this.locked.keys())t.push(c.fromKey(e));return t}getAccountHistoryHashes(t){return this.keys({gte:l.T(t,f.NULL_HASH),lte:l.T(t,f.HIGH_HASH),parse:t=>{const[,e]=l.Tt(t);return e}})}getHistoryHashes(t){return null!=t?this.getAccountHistoryHashes(t):this.keys({gte:l.t(f.NULL_HASH),lte:l.t(f.HIGH_HASH),parse:t=>l.tt(t)})}getAccountPendingHashes(t){return this.keys({gte:l.P(t,f.NULL_HASH),lte:l.P(t,f.HIGH_HASH),parse:t=>{const[,e]=l.Pp(t);return e}})}getPendingHashes(t){return null!=t?this.getAccountPendingHashes(t):this.keys({gte:l.p(f.NULL_HASH),lte:l.p(f.HIGH_HASH),parse:t=>l.pp(t)})}getAccountOutpoints(t){return this.keys({gte:l.C(t,f.NULL_HASH,0),lte:l.C(t,f.HIGH_HASH,4294967295),parse:t=>{const[,e,i]=l.Cc(t);return new c(e,i)}})}getOutpoints(t){return null!=t?this.getAccountOutpoints(t):this.keys({gte:l.c(f.NULL_HASH,0),lte:l.c(f.HIGH_HASH,4294967295),parse:t=>{const[e,i]=l.cc(t);return new c(e,i)}})}getAccountHeightRangeHashes(t,e){const i=e.start||0,r=e.end||4294967295;return this.keys({gte:l.H(t,i,f.NULL_HASH),lte:l.H(t,r,f.HIGH_HASH),limit:e.limit,reverse:e.reverse,parse:t=>{const[,,e]=l.Hh(t);return e}})}getHeightRangeHashes(t,e){if(t&&"object"==typeof t&&(e=t,t=null),null!=t)return this.getAccountHeightRangeHashes(t,e);const i=e.start||0,r=e.end||4294967295;return this.keys({gte:l.h(i,f.NULL_HASH),lte:l.h(r,f.HIGH_HASH),limit:e.limit,reverse:e.reverse,parse:t=>{const[,e]=l.hh(t);return e}})}getHeightHashes(t){return this.getHeightRangeHashes({start:t,end:t})}getAccountRangeHashes(t,e){const i=e.start||0,r=e.end||4294967295;return this.keys({gte:l.M(t,i,f.NULL_HASH),lte:l.M(t,r,f.HIGH_HASH),limit:e.limit,reverse:e.reverse,parse:t=>{const[,,e]=l.Mm(t);return e}})}getRangeHashes(t,e){if(t&&"object"==typeof t&&(e=t,t=null),null!=t)return this.getAccountRangeHashes(t,e);const i=e.start||0,r=e.end||4294967295;return this.keys({gte:l.m(i,f.NULL_HASH),lte:l.m(r,f.HIGH_HASH),limit:e.limit,reverse:e.reverse,parse:t=>{const[,e]=l.mm(t);return e}})}async getRange(t,e){const i=[];t&&"object"==typeof t&&(e=t,t=null);const r=await this.getRangeHashes(t,e);for(const t of r){const e=await this.getTX(t);n(e),i.push(e)}return i}getLast(t,e){return this.getRange(t,{start:0,end:4294967295,reverse:!0,limit:e||10})}getHistory(t){return null!=t?this.getAccountHistory(t):this.values({gte:l.t(f.NULL_HASH),lte:l.t(f.HIGH_HASH),parse:m.fromRaw})}async getAccountHistory(t){const e=await this.getHistoryHashes(t),i=[];for(const t of e){const e=await this.getTX(t);n(e),i.push(e)}return i}async getPending(t){const e=await this.getPendingHashes(t),i=[];for(const t of e){const e=await this.getTX(t);n(e),i.push(e)}return i}getCredits(t){return null!=t?this.getAccountCredits(t):this.range({gte:l.c(f.NULL_HASH,0),lte:l.c(f.HIGH_HASH,4294967295),parse:(t,e)=>{const[i,r]=l.cc(t),s=b.fromRaw(e),n=c.toKey(i,r);return s.coin.hash=i,s.coin.index=r,this.coinCache.set(n,e),s}})}async getAccountCredits(t){const e=await this.getOutpoints(t),i=[];for(const t of e){const e=await this.getCredit(t.hash,t.index);n(e),i.push(e)}return i}async getSpentCredits(t){if(t.isCoinbase())return[];const e=t.hash("hex"),i=[];for(let e=0;e<t.inputs.length;e++)i.push(null);return await this.range({gte:l.d(e,0),lte:l.d(e,4294967295),parse:(e,r)=>{const[,s]=l.dd(e),o=h.fromRaw(r),a=t.inputs[s];n(a),o.hash=a.prevout.hash,o.index=a.prevout.index,i[s]=new b(o)}}),i}async getCoins(t){const e=await this.getCredits(t),i=[];for(const t of e)t.spent||i.push(t.coin);return i}async getAccountCoins(t){const e=await this.getAccountCredits(t),i=[];for(const t of e)t.spent||i.push(t.coin);return i}async getSpentCoins(t){if(t.isCoinbase())return[];const e=await this.getSpentCredits(t),i=[];for(const t of e)t?i.push(t.coin):i.push(null);return i}async getCoinView(t){const e=new a;if(t.isCoinbase())return e;for(const i of t.inputs){const t=i.prevout,r=await this.getCoin(t.hash,t.index);r&&e.addCoin(r)}return e}async getSpentView(t){const e=new a;if(t.isCoinbase())return e;const i=await this.getSpentCoins(t);for(const t of i)t&&e.addCoin(t);return e}async getState(){const t=await this.get(l.R);return t?y.fromRaw(this.wallet.wid,this.wallet.id,t):null}async getTX(t){const e=await this.get(l.t(t));return e?m.fromRaw(e):null}async getDetails(t){const e=await this.getTX(t);return e?await this.toDetails(e):null}async toDetails(t){const e=[];if(!Array.isArray(t))return await this._toDetails(t);for(const i of t){const t=await this._toDetails(i);t&&e.push(t)}return e}async _toDetails(t){const e=t.tx,i=t.getBlock(),r=new E(this,t,i),s=await this.getSpentCoins(e);for(let t=0;t<e.inputs.length;t++){const e=s[t];let i=null;e&&(i=await this.getPath(e)),r.setInput(t,i,e)}for(let t=0;t<e.outputs.length;t++){const i=e.outputs[t],s=await this.getPath(i);r.setOutput(t,s)}return r}hasTX(t){return this.has(l.t(t))}async getCoin(t,e){const i=await this.getCredit(t,e);return i?i.coin:null}async getCredit(t,e){const i=this.state,r=c.toKey(t,e),s=this.coinCache.get(r);if(s){const i=b.fromRaw(s);return i.coin.hash=t,i.coin.index=e,i}const n=await this.get(l.c(t,e));if(!n)return null;const o=b.fromRaw(n);return o.coin.hash=t,o.coin.index=e,i===this.state&&this.coinCache.set(r,n),o}async getSpentCoin(t,e){const i=await this.get(l.d(t.hash,t.index));if(!i)return null;const r=h.fromRaw(i);return r.hash=e.hash,r.index=e.index,r}hasSpentCoin(t){return this.has(l.d(t.hash,t.index))}async updateSpentCoin(t,e,i){const r=c.fromTX(t,e),s=await this.getSpender(r.hash,r.index);if(!s)return;const n=await this.getSpentCoin(s,r);n&&(n.height=i,this.put(l.d(s.hash,s.index),n.toRaw()))}async hasCoin(t,e){const i=c.toKey(t,e);return!!this.coinCache.has(i)||await this.has(l.c(t,e))}async getBalance(t){return null!=t?await this.getAccountBalance(t):this.state.toBalance()}async getWalletBalance(){const t=await this.getCredits(),e=new w(this.wallet.wid,this.wallet.id,-1);for(const i of t){const t=i.coin;-1!==t.height&&this.changeConfirmed(e,t,1),i.spent||this.changeUnconfirmed(e,t,1)}return e}async getAccountBalance(t){const e=await this.getAccountCredits(t),i=new w(this.wallet.wid,this.wallet.id,t);for(const t of e){const e=t.coin;-1!==e.height&&this.changeConfirmed(i,e,1),t.spent||this.changeUnconfirmed(i,e,1)}return i}async zap(t,e){n(r.isU32(e));const i=r.now(),s=await this.getRange(t,{start:0,end:i-e}),o=[];for(const t of s)-1===t.height&&(n(i-t.mtime>=e),this.logger.debug("Zapping TX: %s (%s)",t.tx.txid(),this.wallet.id),await this.remove(t.hash),o.push(t.hash));return o}async abandon(t){if(!await this.has(l.p(t)))throw new Error("TX not eligible.");return await this.remove(t)}}x.layout=l;class E{constructor(t,e,i){this.wallet=t.wallet,this.network=this.wallet.network,this.wid=this.wallet.wid,this.id=this.wallet.id,this.chainHeight=t.walletdb.state.height,this.hash=e.hash,this.tx=e.tx,this.mtime=e.mtime,this.size=this.tx.getSize(),this.vsize=this.tx.getVirtualSize(),this.block=null,this.height=-1,this.time=0,i&&(this.block=i.hash,this.height=i.height,this.time=i.time),this.inputs=[],this.outputs=[],this.init()}init(){for(const t of this.tx.inputs){const e=new R;e.address=t.getAddress(),this.inputs.push(e)}for(const t of this.tx.outputs){const e=new R;e.value=t.value,e.address=t.getAddress(),this.outputs.push(e)}}setInput(t,e,i){const r=this.inputs[t];i&&(r.value=i.value,r.address=i.getAddress()),e&&(r.path=e)}setOutput(t,e){const i=this.outputs[t];e&&(i.path=e)}getDepth(){if(-1===this.height)return 0;const t=this.chainHeight-this.height;return t<0?0:t+1}getFee(){let t=0,e=0;for(const e of this.inputs){if(!e.path)return 0;t+=e.value}for(const t of this.outputs)e+=t.value;return t-e}getRate(t){return d.getRate(this.vsize,t)}toJSON(){const t=this.getFee();let e=this.getRate(t);return Number.isSafeInteger(e)||(e=0),{wid:this.wid,id:this.id,hash:r.revHex(this.hash),height:this.height,block:this.block?r.revHex(this.block):null,time:this.time,mtime:this.mtime,date:r.date(this.time||this.mtime),size:this.size,virtualSize:this.vsize,fee:t,rate:e,confirmations:this.getDepth(),inputs:this.inputs.map(t=>t.getJSON(this.network)),outputs:this.outputs.map(t=>t.getJSON(this.network)),tx:this.tx.toRaw().toString("hex")}}}class R{constructor(){this.value=0,this.address=null,this.path=null}toJSON(){return this.getJSON()}getJSON(t){return{value:this.value,address:this.address?this.address.toString(t):null,path:this.path?this.path.toJSON():null}}}t.exports=x}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * OutpointMapWids.js - walletdb records
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */i(1),i(3);const r=i(4),s=i(2),n=i(6),o=(i(17),i(95));class a{constructor(t,e,i){this.hash=t||r.NULL_HASH,this.index=null!=e?e:-1,this.wids=i||new Set}add(t){return!this.wids.has(t)&&(this.wids.add(t),!0)}remove(t){return this.wids.delete(t)}toWriter(t){return o.serializeWallets(t,this.wids)}getSize(){return o.sizeWallets(this.wids)}toRaw(){const t=this.getSize();return this.toWriter(new n(t)).render()}fromReader(t){return this.wids=o.parseWallets(t),this}fromRaw(t){return this.fromReader(new s(t))}static fromReader(t,e,i){return new a(t,e).fromReader(i)}static fromRaw(t,e,i){return new a(t,e).fromRaw(i)}}t.exports=a},function(t,e,i){"use strict";
/*!
 * BlockMapTxs.js - walletdb records
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(2),s=i(6),n=i(571);class o{constructor(t){this.height=null!=t?t:-1,this.txs=new Map}fromRaw(t){const e=new r(t),i=e.readU32();for(let t=0;t<i;t++){const t=e.readHash("hex"),i=n.fromReader(t,e);this.txs.set(i.hash,i)}return this}static fromRaw(t,e){return new o(t).fromRaw(e)}getSize(){let t=0;t+=4;for(const e of this.txs.values())t+=32,t+=e.getSize();return t}toRaw(){const t=this.getSize(),e=new s(t);e.writeU32(this.txs.size);for(const[t,i]of this.txs)e.writeHash(t),i.toWriter(e);return e.render()}add(t,e){let i=this.txs.get(t);return i||(i=new n(t),this.txs.set(t,i)),i.add(e)}remove(t,e){const i=this.txs.get(t);return!!i&&!!i.remove(e)&&(0===i.wids.size&&this.txs.delete(i.hash),!0)}toArray(){const t=[];for(const e of this.txs.values())t.push(e);return t}}t.exports=o},function(t,e,i){"use strict";
/*!
 * Balance.js - Balance object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(31);t.exports=class{constructor(t,e,i){this.wid=t,this.id=e,this.account=i,this.unconfirmed=0,this.confirmed=0}equal(t){return this.wid===t.wid&&this.confirmed===t.confirmed&&this.unconfirmed===t.unconfirmed}toJSON(t){return{wid:t?void 0:this.wid,id:t?void 0:this.id,account:t?void 0:this.account,unconfirmed:this.unconfirmed,confirmed:this.confirmed}}toString(){return"<Balance"+` unconfirmed=${r.btc(this.unconfirmed)}`+` confirmed=${r.btc(this.confirmed)}`+">"}inspect(){return this.toString()}}},function(t,e,i){const r=i(70);t.exports=class extends r{constructor(){super()}getPropListByOid(t){return t?this.where([["oid","==",t]]):this}}},function(t,e,i){"use strict";(function(e){const r=i(1),s=i(24),n=i(185),o=i(9),a=i(109),h=i(3),c=i(48),u=i(186),l=i(34),f=i(581),d=i(583),p=i(584),g=i(585),m=i(586),w=i(587),y=i(589),{ACTIVE_TIME:b,NONCE_SIZE:v,MAX_JOBS:k,BAN_TIME:S,isJob:x,isSID:E,isUsername:R,isPassword:_,isAgent:A,hex32:I}=i(125);class O extends s{constructor(t){super(),this.options=new y(t),this.node=this.options.node,this.chain=this.options.chain,this.network=this.options.network,this.logger=this.options.logger.context("stratum"),this.difficulty=this.options.difficulty,this.server=n.createServer(),this.sharedb=new m(this.options),this.userdb=new f(this.options),this.locker=new l,this.jobMap=new Map,this.banned=new Map,this.jobs=new u,this.current=null,this.inbound=new u,this.lastActive=0,this.subscribed=!1,this.uid=0,this.suid=0,this._init()}static init(t){const e=t.config;return new O({node:t,prefix:e.prefix,logger:t.logger,host:e.str("stratum-host"),port:e.uint("stratum-port"),publicHost:e.str("stratum-public-host"),publicPort:e.uint("stratum-public-port"),maxInbound:e.uint("stratum-max-inbound"),difficulty:e.uint("stratum-difficulty"),dynamic:e.bool("stratum-dynamic"),password:e.str("stratum-password")})}sid(){const t=this.suid;return this.suid+=1,this.suid>>>=0,t}jid(){const t=h.now(),e=this.uid;return this.uid+=1,this.uid>>>=0,`${t}:${e}`}_init(){this.server.on("connection",t=>{this.handleSocket(t)}),this.node.on("chain.connect",async()=>{try{await this.handleBlock()}catch(t){this.emit("error",t)}}),this.node.on("tx",async()=>{try{await this.handleTX()}catch(t){this.emit("error",t)}})}async handleBlock(){const t=await this.locker.lock();try{return await this._handleBlock()}finally{t()}}async _handleBlock(){const t=h.now();this.subscribed?(this.current=null,this.lastActive=t,await this.notifyAll()):this.lastActive=t}async handleTX(){const t=await this.locker.lock();try{return await this._handleTX()}finally{t()}}async _handleTX(){const t=h.now();this.subscribed?t>this.lastActive+b&&(this.current=null,this.lastActive=t,await this.notifyAll()):this.lastActive=t}async handleSocket(t){if(!t.remoteAddress)return this.logger.debug("Ignoring disconnected client."),void t.destroy();const e=c.normalize(t.remoteAddress);return this.inbound.size>=this.options.maxInbound?(this.logger.debug("Ignoring client: too many inbound (%s).",e),void t.destroy()):this.isBanned(e)?(this.logger.debug("Ignoring banned client (%s).",e),void t.destroy()):(t.setKeepAlive(!0),t.setNoDelay(!0),void this.addClient(t))}addClient(t){const e=new w(this,t);e.on("error",t=>{this.emit("error",t)}),e.on("close",()=>{r(this.inbound.remove(e))}),e.on("ban",()=>{this.handleBan(e)}),this.inbound.push(e)}handleBan(t){this.logger.warning("Banning client (%s).",t.id()),this.banned.set(t.host,h.now()),t.destroy()}isBanned(t){const e=this.banned.get(t);return!(null==e||h.now()-e>S&&(this.banned.delete(t),1))}async listen(){this.server.maxConnections=this.options.maxInbound,await this.server.listen(this.options.port,this.options.host),this.logger.info("Server listening on %d.",this.options.port)}async open(){if(0===this.node.miner.addresses.length)throw new Error("No addresses available for coinbase.");await this.userdb.open(),await this.sharedb.open(),await this.listen(),this.options.password&&(this.userdb.get("admin")||this.userdb.add({username:"admin",hash:this.options.password})),this.lastActive=h.now()}async close(){let t,e;for(t=this.inbound.head;t;t=e)e=t.next,t.destroy();await this.server.close(),await this.userdb.close(),await this.sharedb.close()}async notifyAll(){const t=await this.getJob();let e;for(this.logger.debug("Notifying all clients of new job: %s.",t.id),e=this.inbound.head;e;e=e.next)-1!==e.sid&&e.sendJob(t)}addJob(t){this.jobs.size>=k&&this.removeJob(this.jobs.head),r(this.jobs.push(t)),r(!this.jobMap.has(t.id)),this.jobMap.set(t.id,t),this.current=t}removeJob(t){r(this.jobs.remove(t)),r(this.jobMap.has(t.id)),this.jobMap.delete(t.id),t===this.current&&(this.current=null)}async getJob(){if(!this.current){if(0===this.node.miner.addresses.length)throw new Error("No addresses available for coinbase.");const t=await this.node.miner.createBlock(),e=g.fromTemplate(this.jid(),t);this.addJob(e),this.logger.debug("New job (id=%s, prev=%s).",e.id,h.revHex(e.attempt.prevBlock))}return this.current}async tryCommit(t,e){try{await this.sharedb.commit(t,e)}catch(t){this.emit("error",t)}}auth(t,i){const r=this.userdb.get(t);if(!r)return!1;const s=e.from(i,"utf8"),n=o.hash256(s);return!!a(n,r.password)}authAdmin(t){if(!this.options.password)return!1;const i=e.from(t,"utf8"),r=o.hash256(i);return!!a(r,this.options.password)}async addBlock(t,e){let i;this.node.broadcast(e);try{i=await this.chain.add(e)}catch(t){if("VerifyError"===t.type){switch(t.reason){case"high-hash":return new p(23,"high-hash");case"duplicate":return new p(22,"duplicate")}return new p(20,t.reason)}throw t}return i?i.hash!==this.chain.tip.hash?new p(21,"stale-work"):(this.tryCommit(i,e),this.logger.info("Client found block %s (%d) (%s).",i.rhash(),i.height,t.id()),null):new p(21,"stale-prevblk")}async handlePacket(t,e){const i=await this.locker.lock();try{return await this._handlePacket(t,e)}finally{i()}}async _handlePacket(t,e){switch(e.method){case"mining.authorize":return this.handleAuthorize(t,e);case"mining.subscribe":return this.handleSubscribe(t,e);case"mining.submit":return this.handleSubmit(t,e);case"mining.get_transactions":return this.handleTransactions(t,e);case"mining.authorize_admin":return this.handleAuthAdmin(t,e);case"mining.add_user":return this.handleAddUser(t,e);default:return this.handleUnknown(t,e)}}async handleAuthorize(t,e){if(typeof e.params.length<2)return void t.sendError(e,0,"invalid params");const i=e.params[0],r=e.params[1];if(R(i)&&_(r)){if(!this.auth(i,r))return this.logger.debug("Client failed auth for user %s (%s).",i,t.id()),void t.sendResponse(e,!1);this.logger.debug("Client successfully authd for %s (%s).",i,t.id()),t.addUser(i),t.sendResponse(e,!0)}else t.sendError(e,0,"invalid params")}async handleSubscribe(t,e){if(!this.chain.synced)return void t.sendError(e,0,"not up to date");if(!t.agent&&e.params.length>0){if(!A(e.params[0]))return void t.sendError(e,0,"invalid params");t.agent=e.params[0]}if(e.params.length>1){if(!E(e.params[1]))return void t.sendError(e,0,"invalid params");t.sid=this.sid()}else t.sid=this.sid();this.subscribed||(this.logger.debug("First subscriber (%s).",t.id()),this.subscribed=!0);const i=I(t.sid);this.logger.debug("Client is subscribing with sid=%s (%s).",i,t.id()),t.sendResponse(e,[[["mining.notify",i]],i,v]);const r=await this.getJob();t.setDifficulty(this.difficulty),t.sendJob(r)}async handleSubmit(t,e){const i=this.network.now();let r;try{r=d.fromPacket(e)}catch(i){return void t.sendError(e,0,"invalid params")}if(this.logger.spam("Client submitted job %s (%s).",r.job,t.id()),!t.hasUser(r.username))return void t.sendError(e,24,"unauthorized user");if(-1===t.sid)return void t.sendError(e,25,"not subscribed");const s=this.jobMap.get(r.job);if(!s||s.committed)return void t.sendError(e,21,"job not found");if(s!==this.current&&this.logger.warning("Client is submitting a stale job %s (%s).",s.id,t.id()),r.ts<i-7200)return void t.sendError(e,20,"time too old");if(r.ts>i+7200)return void t.sendError(e,20,"time too new");const n=s.check(t.sid,r),o=n.getDifficulty();if(o<t.difficulty-1)return this.logger.debug("Client submitted a low share of %d, hash=%s, ban=%d (%s).",o,n.rhash(),t.banScore,t.id()),t.increaseBan(1),t.sendError(e,23,"high-hash"),void t.sendDifficulty(t.difficulty);if(!s.insert(n.hash))return this.logger.debug("Client submitted a duplicate share: %s (%s).",n.rhash(),t.id()),t.increaseBan(10),void t.sendError(e,22,"duplicate");let a;if(this.sharedb.add(r.username,o),this.logger.debug("Client submitted share of %d, hash=%s (%s).",o,n.rhash(),t.id()),n.verify(s.target)){const e=s.commit(n);a=await this.addBlock(t,e)}a?(this.logger.warning("Client found an invalid block: %s (%s).",a.reason,t.id()),t.sendError(e,a.code,a.reason)):t.sendResponse(e,!0),this.options.dynamic&&t.retarget(s.difficulty)&&this.logger.debug("Retargeted client to %d (%s).",t.nextDifficulty,t.id())}async handleTransactions(t,e){if(-1===t.sid)return void t.sendError(e,25,"not subscribed");if(e.params.length<1)return void t.sendError(e,21,"job not found");const i=e.params[0];if(!x(i))return void t.sendError(e,21,"job not found");const r=this.jobMap.get(i);if(!r||r.committed)return void t.sendError(e,21,"job not found");this.logger.debug("Sending tx list (%s).",t.id());const s=r.attempt,n=[];for(const t of s.items)n.push(t.tx.hash("hex"));t.sendResponse(e,n)}async handleAuthAdmin(t,e){if(typeof e.params.length<1)return void t.sendError(e,0,"invalid params");const i=e.params[0];if(_(i)){if(!this.authAdmin(i))return this.logger.debug("Client sent bad admin password (%s).",t.id()),t.increaseBan(10),void t.sendError(e,0,"invalid password");t.admin=!0,t.sendResponse(e,!0)}else t.sendError(e,0,"invalid params")}async handleAddUser(t,e){if(typeof e.params.length<3)return void t.sendError(e,0,"invalid params");const i=e.params[0],r=e.params[1];if(R(i)&&_(r)){if(!t.admin)return this.logger.debug("Client is not an admin (%s).",t.id()),void t.sendError(e,0,"invalid password");try{this.userdb.add({username:i,password:r})}catch(i){return void t.sendError(e,0,i.message)}t.sendResponse(e,!0)}else t.sendError(e,0,"invalid params")}async handleUnknown(t,e){this.logger.debug("Client sent an unknown message (%s):",t.id()),this.logger.debug(e),t.send({id:e.id,result:null,error:!0})}}O.id="GameGoldSTM",t.exports=O}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(t){
/*!
 * gamegold.js - a javascript bitcoin library.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=e;r.set=function(t){return r.network.set(t),r},r.cache=function(){},r.bip70=i(463),r.blockchain=i(466),r.chain=i(177),r.chaindb=i(190),r.chainentry=i(144),r.btc=i(489),r.amount=i(31),r.uri=i(397),r.coins=i(490),r.coinview=i(44),r.crypto=i(491),r.bn=i(43),r.secp256k1=i(30),r.schnorr=i(401),r.db=i(492),r.ldb=i(138),r.hd=i(493),r.http=i(504),r.accessWallet=i(406),r.rpc=i(360),r.txmempool=i(517),r.fees=i(203),r.mempool=i(364),r.mempoolentry=i(182),r.mining=i(525),r.miner=i(366),r.template=i(205),r.net=i(528),r.bip150=i(206),r.bip151=i(208),r.bip152=i(184),r.dns=i(183),r.packets=i(94),r.peer=i(18),r.pool=i(19),r.tcp=i(185),r.startproxy=i(562),r.AddrPacket=i(378),r.AuthChallengePacket=i(374),r.AuthProposePacket=i(373),r.AuthReplyPacket=i(375),r.BlockPacket=i(439),r.BlockTxnPacket=i(383),r.CmpctBlockPacket=i(447),r.EncackPacket=i(449),r.EncinitPacket=i(448),r.FeeFilterPacket=i(445),r.FilterAddPacket=i(443),r.FilterClearPacket=i(444),r.FilterLoadPacket=i(431),r.GetAddrPacket=i(434),r.GetBlocksPacket=i(381),r.GetBlockTxnPacket=i(382),r.GetDataPacket=i(435),r.GetHeadersPacket=i(436),r.HeadersPacket=i(437),r.InvPacket=i(214),r.MempoolPacket=i(442),r.MerkleBlockPacket=i(213),r.NotFoundPacket=i(380),r.packetType=i(22),r.packetCmd=i(207),r.PingPacket=i(433),r.PongPacket=i(377),r.RejectPacket=i(441),r.SendCmpctPacket=i(446),r.SendHeadersPacket=i(438),r.TXPacket=i(379),r.UnknownPacket=i(411),r.VerackPacket=i(376),r.VersionPacket=i(432),r.node=i(450),r.config=i(361),r.fullnode=i(451),r.logger=i(45),r.spvnode=i(453),r.primitives=i(563),r.address=i(26),r.block=i(52),r.coin=i(41),r.headers=i(69),r.input=i(68),r.invitem=i(39),r.keyring=i(46),r.merkleblock=i(111),r.mtx=i(51),r.netaddress=i(82),r.outpoint=i(37),r.output=i(28),r.tx=i(17),r.protocol=i(564),r.consensus=i(10),r.errors=i(36),r.network=i(16),r.networks=i(132),r.policy=i(33),r.timedata=i(133),r.txscript=i(565),r.opcode=i(107),r.program=i(134),r.script=i(20),r.scriptnum=i(57),r.sigcache=i(454),r.stack=i(77),r.witness=i(78),r.utils=i(566),r.base32=i(146),r.base58=i(56),r.bloom=i(79),r.co=i(35),r.encoding=i(4),r.int64=i(87),r.lock=i(34),r.reader=i(2),r.staticwriter=i(6),r.util=i(3),r.writer=i(13),r.wallet=i(569),r.path=i(124),r.walletkey=i(216),r.walletdb=i(217),r.stratum=i(580),r.workers=i(590),r.workerpool=i(116),r.pkg=i(114),t.gamegold=r}).call(this,i(12))},function(t,e,i){"use strict";
/*!
 * bip70/index.js - bip70 for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */e.certs=i(386),e.PaymentACK=i(464),e.PaymentDetails=i(250),e.Payment=i(387),e.PaymentRequest=i(465),e.pk=i(389),e.x509=i(388)},function(t,e,i){"use strict";(function(e){
/*!
 * paymentack.js - bip70 paymentack for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(127),n=i(131),o=i(387);function a(t){if(!(this instanceof a))return new a(t);this.payment=new o,this.memo=null,t&&this.fromOptions(t)}a.prototype.fromOptions=function(t){return t.payment&&this.payment.fromOptions(t.payment),null!=t.memo&&(r("string"==typeof t.memo),this.memo=t.memo),this},a.fromOptions=function(t){return(new a).fromOptions(t)},a.prototype.fromRaw=function(t){const e=new s(t);return this.payment.fromRaw(e.readFieldBytes(1)),this.memo=e.readFieldString(2,!0),this},a.fromRaw=function(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new a).fromRaw(t)},a.prototype.toRaw=function(){const t=new n;return t.writeFieldBytes(1,this.payment.toRaw()),null!=this.memo&&t.writeFieldString(2,this.memo),t.render()},t.exports=a}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * paymentrequest.js - bip70 paymentrequest for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(3),n=i(9),o=i(388),a=i(252),h=i(127),c=i(131),u=i(250);function l(t){if(!(this instanceof l))return new l(t);this.version=-1,this.pkiType=null,this.pkiData=null,this.paymentDetails=new u,this.signature=null,t&&this.fromOptions(t)}l.prototype.fromOptions=function(t){return null!=t.version&&(r(s.isInt(t.version)),this.version=t.version),null!=t.pkiType&&(r("string"==typeof t.pkiType),this.pkiType=t.pkiType),t.pkiData&&(r(e.isBuffer(t.pkiData)),this.pkiData=t.pkiData),t.paymentDetails&&this.paymentDetails.fromOptions(t.paymentDetails),t.signature&&(r(e.isBuffer(t.signature)),this.signature=t.signature),t.chain&&this.setChain(t.chain),this},l.fromOptions=function(t){return(new l).fromOptions(t)},l.prototype.fromRaw=function(t){const e=new h(t);return this.version=e.readFieldU32(1,!0),this.pkiType=e.readFieldString(2,!0),this.pkiData=e.readFieldBytes(3,!0),this.paymentDetails.fromRaw(e.readFieldBytes(4)),this.signature=e.readFieldBytes(5,!0),this},l.fromRaw=function(t,i){return"string"==typeof t&&(t=e.from(t,i)),(new l).fromRaw(t)},l.prototype.toRaw=function(){const t=new c;return-1!==this.version&&t.writeFieldU32(1,this.version),null!=this.pkiType&&t.writeFieldString(2,this.pkiType),this.pkiData&&t.writeFieldBytes(3,this.pkiData),t.writeFieldBytes(4,this.paymentDetails.toRaw()),this.signature&&t.writeFieldBytes(5,this.signature),t.render()},l.prototype.getAlgorithm=function(){if(!this.pkiType)throw new Error("No PKI type available.");const t=this.pkiType.split("+");if(2!==t.length)throw new Error("Could not parse PKI algorithm.");if("x509"!==t[0])throw new Error(`Unknown PKI type: ${t[0]}.`);if("sha1"!==t[1]&&"sha256"!==t[1])throw new Error(`Unknown hash algorithm: ${t[1]}.`);return new function(t,e){this.key=t,this.hash=e}(t[0],t[1])},l.prototype.signatureData=function(){const t=this.signature;this.signature=e.alloc(0);const i=this.toRaw();return this.signature=t,i},l.prototype.signatureHash=function(){const t=this.getAlgorithm();return n.hash(t.hash,this.signatureData())},l.prototype.setChain=function(t){const i=new c;r(Array.isArray(t),"Chain must be an array.");for(let s of t){if("string"==typeof s){const t=a.decode(s);r("certificate"===t.type,"Bad certificate PEM."),s=t.data}r(e.isBuffer(s),"Certificates must be PEM or DER."),i.writeFieldBytes(1,s)}this.pkiData=i.render()},l.prototype.getChain=function(){const t=[];if(!this.pkiData)return t;const e=new h(this.pkiData);for(;1===e.nextTag();)t.push(e.readFieldBytes(1));return t},l.prototype.sign=function(t,e){e&&this.setChain(e),this.pkiType||(this.pkiType="x509+sha256");const i=this.getAlgorithm(),r=this.signatureData(),s=this.getChain();this.signature=o.signSubject(i.hash,r,t,s)},l.prototype.verify=function(){if(!this.pkiType||"none"===this.pkiType)return!1;if(!this.signature)return!1;let t;try{t=this.getAlgorithm()}catch(t){return!1}const e=this.signatureData(),i=this.signature,r=this.getChain();try{return o.verifySubject(t.hash,e,i,r)}catch(t){return!1}},l.prototype.verifyChain=function(){if(!this.pkiType||"none"===this.pkiType)return!1;try{return o.verifyChain(this.getChain())}catch(t){return!1}},l.prototype.getCA=function(){if(!this.pkiType||"none"===this.pkiType)throw new Error("No CA found (pkiType).");const t=this.getChain();if(0===t.length)throw new Error("No CA found (chain).");return new function(t){this.name=o.getCAName(t),this.trusted=o.isTrusted(t),this.cert=t}(o.parse(t[t.length-1]))},t.exports=l}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * blockchain/index.js - blockchain for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */e.ChainDB=i(190),e.ChainEntry=i(144),e.Chain=i(177),e.common=i(65),e.layout=i(143)},function(t,e){t.exports=function(){for(var t={},e=0;e<arguments.length;e++){var r=arguments[e];for(var s in r)i.call(r,s)&&(t[s]=r[s])}return t};var i=Object.prototype.hasOwnProperty},function(t,e,i){var r=i(5),s=i(89).Readable,n=i(469);function o(t,e){if(!(this instanceof o))return new o(t,e);e=e||{},s.call(this,n(e,{objectMode:!0})),this._iterator=t,this._destroyed=!1,this._options=e,this.on("end",this._cleanup.bind(this))}t.exports=o,r(o,s),o.prototype._read=function(){var t=this,e=this._options;this._destroyed||this._iterator.next(function(i,r,s){if(!t._destroyed)return i?t.emit("error",i):void(void 0===r&&void 0===s?t.push(null):!1!==e.keys&&!1===e.values?t.push(r):!1===e.keys&&!1!==e.values?t.push(s):t.push({key:r,value:s}))})},o.prototype.destroy=o.prototype._cleanup=function(){var t=this;this._destroyed||(this._destroyed=!0,this._iterator.end(function(e){if(e)return t.emit("error",e);t.emit("close")}))}},function(t,e){t.exports=function(){for(var t={},e=0;e<arguments.length;e++){var r=arguments[e];for(var s in r)i.call(r,s)&&(t[s]=r[s])}return t};var i=Object.prototype.hasOwnProperty},function(t,e,i){"use strict";(function(e){const r=i(471);function s(t){this.level=new r(t),this.bufferKeys=!1}function n(t){this.db=t,this.batch=t.level.batch(),this.hasOps=!1}function o(t,i){t.bufferKeys&&(e.isBuffer(i.gt)&&(i.gt=i.gt.toString("hex")),e.isBuffer(i.gte)&&(i.gte=i.gte.toString("hex")),e.isBuffer(i.lt)&&(i.lt=i.lt.toString("hex")),e.isBuffer(i.lte)&&(i.lte=i.lte.toString("hex"))),i.keyAsBuffer=!1,this.db=t,this.iter=t.level.iterator(i),this._end=!1}s.prototype.open=function(t,e){this.bufferKeys=!0===t.bufferKeys,this.level.open(t,e)},s.prototype.close=function(t){this.level.close(t)},s.prototype.get=function(t,i,r){this.bufferKeys&&e.isBuffer(t)&&(t=t.toString("hex")),this.level.get(t,i,r)},s.prototype.put=function(t,i,r,s){this.bufferKeys&&e.isBuffer(t)&&(t=t.toString("hex")),this.level.put(t,i,r,s)},s.prototype.del=function(t,i,r){this.bufferKeys&&e.isBuffer(t)&&(t=t.toString("hex")),this.level.del(t,i,r)},s.prototype.batch=function(t,i,r){if(!t)return new n(this);if(this.bufferKeys)for(const i of t)e.isBuffer(i.key)&&(i.key=i.key.toString("hex"));this.level.batch(t,i,r)},s.prototype.iterator=function(t){return new o(this,t)},s.destroy=function(t,e){r.destroy(t,e)},n.prototype.put=function(t,i){return this.db.bufferKeys&&e.isBuffer(t)&&(t=t.toString("hex")),this.batch.put(t,i),this.hasOps=!0,this},n.prototype.del=function(t){return this.db.bufferKeys&&e.isBuffer(t)&&(t=t.toString("hex")),this.batch.del(t),this.hasOps=!0,this},n.prototype.write=function(t){return this.hasOps?(this.batch.write(t),this):t()},n.prototype.clear=function(){return this.batch.clear(),this},o.prototype.next=function(t){this.iter.next((i,r,s)=>{this._end||(i?t(i):void 0!==r||void 0!==s?(r&&this.db.bufferKeys&&(r=e.from(r,"hex")),s&&!e.isBuffer(s)&&s.buffer&&(s=e.from(s.buffer)),t(i,r,s)):t(i,r,s))})},o.prototype.seek=function(t){this.db.bufferKeys&&e.isBuffer(t)&&(t=t.toString("hex")),this.iter.seek(t)},o.prototype.end=function(t){this._end?t(new Error("end() already called on iterator.")):(this._end=!0,this.iter.end(t))},t.exports=s}).call(this,i(0).Buffer)},function(t,e,i){(function(e){t.exports=u;var r=i(472),s=i(394).AbstractLevelDOWN,n=i(66),o=i(476),a=i(478),h=i(479),c=i(485);function u(t){if(!(this instanceof u))return new u(t);if(!t)throw new Error("constructor requires at least a location argument");this.IDBOptions={},this.location=t}n.inherits(u,s),u.prototype._open=function(t,e){var i=this,s={storeName:this.location,autoIncrement:!1,keyPath:null,onStoreReady:function(){e&&e(null,i.idb)},onError:function(t){e&&e(t)}};h(s,t),this.IDBOptions=s,this.idb=new r(s)},u.prototype._get=function(t,i,r){this.idb.get(t,function(s){if(void 0===s)return r(new Error("NotFound"));var n=!0;return!1===i.asBuffer&&(n=!1),i.raw&&(n=!1),n&&(s=s instanceof Uint8Array?c(s):new e(String(s))),r(null,s,t)},r)},u.prototype._del=function(t,e,i){this.idb.remove(t,i,i)},u.prototype._put=function(t,i,r,s){i instanceof ArrayBuffer&&(i=c(new Uint8Array(i)));var n=this.convertEncoding(t,i,r);e.isBuffer(n.value)&&("function"==typeof i.toArrayBuffer?n.value=new Uint8Array(i.toArrayBuffer()):n.value=new Uint8Array(i)),this.idb.put(n.key,n.value,function(){s()},s)},u.prototype.convertEncoding=function(t,e,i){if(i.raw)return{key:t,value:e};if(e){var r=e.toString();"NaN"===r&&(e="NaN")}var s=i.valueEncoding,n={key:t,value:e};return!e||s&&"binary"===s||"object"!=typeof n.value&&(n.value=r),n},u.prototype.iterator=function(t){return"object"!=typeof t&&(t={}),new o(this.idb,t)},u.prototype._batch=function(t,e,i){var r,s,n,o,a=[];if(0===t.length)return setTimeout(i,0);for(r=0;r<t.length;r++){n={},o=t[r],a[r]=n;var h=this.convertEncoding(o.key,o.value,e);for(s in o.key=h.key,o.value=h.value,o)"type"===s&&"del"==o[s]?n[s]="remove":n[s]=o[s]}return this.idb.batch(a,function(){i()},i)},u.prototype._close=function(t){this.idb.db.close(),t()},u.prototype._approximateSize=function(t,e,i){var r=new Error("Not implemented");if(i)return i(r);throw r},u.prototype._isBuffer=function(t){return e.isBuffer(t)},u.destroy=function(t,e){if("object"==typeof t)var i=t.IDBOptions.storePrefix||"IDBWrapper-",r=t.location;else i="IDBWrapper-",r=t;var s=indexedDB.deleteDatabase(i+r);s.onsuccess=function(){e()},s.onerror=function(t){e(t)}},u.prototype._checkKeyValue=function(t,e){return null===t||void 0===t?new Error(e+" cannot be `null` or `undefined`"):null===t||void 0===t?new Error(e+" cannot be `null` or `undefined`"):a(t)&&0===t.byteLength?new Error(e+" cannot be an empty ArrayBuffer"):""===String(t)?new Error(e+" cannot be an empty String"):0===t.length?new Error(e+" cannot be an empty Array"):void 0}}).call(this,i(0).Buffer)},function(t,e,i){var r,s;
/**
 * @license IDBWrapper - A cross-browser wrapper for IndexedDB
 * Version 1.7.2
 * Copyright (c) 2011 - 2017 Jens Arps
 * http://jensarps.de/
 *
 * Licensed under the MIT license
 */
/**
 * @license IDBWrapper - A cross-browser wrapper for IndexedDB
 * Version 1.7.2
 * Copyright (c) 2011 - 2017 Jens Arps
 * http://jensarps.de/
 *
 * Licensed under the MIT license
 */!function(n,o,a){"use strict";void 0===(s="function"==typeof(r=function(){var t=function(t){throw t},e=function(){},i={storeName:"Store",storePrefix:"IDBWrapper-",dbVersion:1,keyPath:"id",autoIncrement:!0,onStoreReady:function(){},onError:t,indexes:[],implementationPreference:["indexedDB","webkitIndexedDB","mozIndexedDB","shimIndexedDB"]},r=function(t,e){for(var r in void 0===e&&"function"==typeof t&&(e=t),"[object Object]"!=Object.prototype.toString.call(t)&&(t={}),i)this[r]=void 0!==t[r]?t[r]:i[r];this.dbName=this.storePrefix+this.storeName,this.dbVersion=parseInt(this.dbVersion,10)||1,e&&(this.onStoreReady=e);var s="object"==typeof window?window:self,n=this.implementationPreference.filter(function(t){return t in s});this.implementation=n[0],this.idb=s[this.implementation],this.keyRange=s.IDBKeyRange||s.webkitIDBKeyRange||s.mozIDBKeyRange,this.consts={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange",NEXT:"next",NEXT_NO_DUPLICATE:"nextunique",PREV:"prev",PREV_NO_DUPLICATE:"prevunique"},this.openDB()},s={constructor:r,version:"1.7.2",db:null,dbName:null,dbVersion:null,store:null,storeName:null,storePrefix:null,keyPath:null,autoIncrement:null,indexes:null,implementationPreference:null,implementation:"",onStoreReady:null,onError:null,_insertIdCount:0,openDB:function(){var t=this.idb.open(this.dbName,this.dbVersion),e=!1;t.onerror=function(t){if(function(t){return"error"in t.target?"VersionError"==t.target.error.name:"errorCode"in t.target&&12==t.target.errorCode}(t))this.onError(new Error("The version number provided is lower than the existing one."));else{var e;if(t.target.error)e=t.target.error;else{var i="IndexedDB unknown error occurred when opening DB "+this.dbName+" version "+this.dbVersion;"errorCode"in t.target&&(i+=" with error code "+t.target.errorCode),e=new Error(i)}this.onError(e)}}.bind(this),t.onsuccess=function(t){if(!e)if(this.db)this.onStoreReady();else if(this.db=t.target.result,"string"!=typeof this.db.version)if(this.db.objectStoreNames.contains(this.storeName)){var i=this.db.transaction([this.storeName],this.consts.READ_ONLY);this.store=i.objectStore(this.storeName);var r=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(t){var i=t.name;if(!i)return e=!0,void this.onError(new Error("Cannot create index: No index name given."));if(this.normalizeIndexData(t),this.hasIndex(i)){var s=this.store.index(i);this.indexComplies(s,t)||(e=!0,this.onError(new Error('Cannot modify index "'+i+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),r.splice(r.indexOf(i),1)}else e=!0,this.onError(new Error('Cannot create new index "'+i+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))},this),r.length&&(e=!0,this.onError(new Error('Cannot delete index(es) "'+r.toString()+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),e||this.onStoreReady()}else this.onError(new Error("Object store couldn't be created."));else this.onError(new Error("The IndexedDB implementation in this browser is outdated. Please upgrade your browser."))}.bind(this),t.onupgradeneeded=function(t){if(this.db=t.target.result,this.db.objectStoreNames.contains(this.storeName))this.store=t.target.transaction.objectStore(this.storeName);else{var i={autoIncrement:this.autoIncrement};null!==this.keyPath&&(i.keyPath=this.keyPath),this.store=this.db.createObjectStore(this.storeName,i)}var r=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(t){var i=t.name;if(i||(e=!0,this.onError(new Error("Cannot create index: No index name given."))),this.normalizeIndexData(t),this.hasIndex(i)){var s=this.store.index(i);this.indexComplies(s,t)||(this.store.deleteIndex(i),this.store.createIndex(i,t.keyPath,{unique:t.unique,multiEntry:t.multiEntry})),r.splice(r.indexOf(i),1)}else this.store.createIndex(i,t.keyPath,{unique:t.unique,multiEntry:t.multiEntry})},this),r.length&&r.forEach(function(t){this.store.deleteIndex(t)},this)}.bind(this)},deleteDatabase:function(t,e){if(this.idb.deleteDatabase){this.db.close();var i=this.idb.deleteDatabase(this.dbName);i.onsuccess=t,i.onerror=e}else e(new Error("Browser does not support IndexedDB deleteDatabase!"))},put:function(i,r,s,n){null!==this.keyPath&&(n=s,s=r,r=i),n||(n=t),s||(s=e);var o,a=!1,h=null,c=this.db.transaction([this.storeName],this.consts.READ_WRITE);return c.oncomplete=function(){(a?s:n)(h)},c.onabort=n,c.onerror=n,null!==this.keyPath?(this._addIdPropertyIfNeeded(r),o=c.objectStore(this.storeName).put(r)):o=c.objectStore(this.storeName).put(r,i),o.onsuccess=function(t){a=!0,h=t.target.result},o.onerror=n,c},get:function(i,r,s){s||(s=t),r||(r=e);var n=!1,o=null,a=this.db.transaction([this.storeName],this.consts.READ_ONLY);a.oncomplete=function(){(n?r:s)(o)},a.onabort=s,a.onerror=s;var h=a.objectStore(this.storeName).get(i);return h.onsuccess=function(t){n=!0,o=t.target.result},h.onerror=s,a},remove:function(i,r,s){s||(s=t),r||(r=e);var n=!1,o=null,a=this.db.transaction([this.storeName],this.consts.READ_WRITE);a.oncomplete=function(){(n?r:s)(o)},a.onabort=s,a.onerror=s;var h=a.objectStore(this.storeName).delete(i);return h.onsuccess=function(t){n=!0,o=t.target.result},h.onerror=s,a},batch:function(i,r,s){if(s||(s=t),r||(r=e),"[object Array]"!=Object.prototype.toString.call(i))s(new Error("dataArray argument must be of type Array."));else if(0===i.length)return r(!0);var n=i.length,o=!1,a=!1,h=this.db.transaction([this.storeName],this.consts.READ_WRITE);h.oncomplete=function(){(a?r:s)(a)},h.onabort=s,h.onerror=s;var c=function(){0!=--n||o||(o=!0,a=!0)};return i.forEach(function(t){var e=t.type,i=t.key,r=t.value,n=function(t){h.abort(),o||(o=!0,s(t,e,i))};if("remove"==e){var a=h.objectStore(this.storeName).delete(i);a.onsuccess=c,a.onerror=n}else if("put"==e){var u;null!==this.keyPath?(this._addIdPropertyIfNeeded(r),u=h.objectStore(this.storeName).put(r)):u=h.objectStore(this.storeName).put(r,i),u.onsuccess=c,u.onerror=n}},this),h},putBatch:function(t,e,i){var r=t.map(function(t){return{type:"put",value:t}});return this.batch(r,e,i)},upsertBatch:function(i,r,s,n){"function"==typeof r&&(n=s=r,r={}),n||(n=t),s||(s=e),r||(r={}),"[object Array]"!=Object.prototype.toString.call(i)&&n(new Error("dataArray argument must be of type Array."));var o=r.keyField||this.keyPath,a=i.length,h=!1,c=!1,u=0,l=this.db.transaction([this.storeName],this.consts.READ_WRITE);l.oncomplete=function(){c?s(i):n(!1)},l.onabort=n,l.onerror=n;var f=function(t){i[u++][o]=t.target.result,0!=--a||h||(h=!0,c=!0)};return i.forEach(function(t){var e,i=t.key;null!==this.keyPath?(this._addIdPropertyIfNeeded(t),e=l.objectStore(this.storeName).put(t)):e=l.objectStore(this.storeName).put(t,i),e.onsuccess=f,e.onerror=function(t){l.abort(),h||(h=!0,n(t))}},this),l},removeBatch:function(t,e,i){var r=t.map(function(t){return{type:"remove",key:t}});return this.batch(r,e,i)},getBatch:function(i,r,s,n){if(s||(s=t),r||(r=e),n||(n="sparse"),"[object Array]"!=Object.prototype.toString.call(i))s(new Error("keyArray argument must be of type Array."));else if(0===i.length)return r([]);var o=[],a=i.length,h=!1,c=null,u=this.db.transaction([this.storeName],this.consts.READ_ONLY);u.oncomplete=function(){(h?r:s)(c)},u.onabort=s,u.onerror=s;var l=function(t){t.target.result||"dense"==n?o.push(t.target.result):"sparse"==n&&o.length++,0==--a&&(h=!0,c=o)};return i.forEach(function(t){var e=u.objectStore(this.storeName).get(t);e.onsuccess=l,e.onerror=function(t){c=t,s(t),u.abort()}},this),u},getAll:function(i,r){r||(r=t),i||(i=e);var s=this.db.transaction([this.storeName],this.consts.READ_ONLY),n=s.objectStore(this.storeName);return n.getAll?this._getAllNative(s,n,i,r):this._getAllCursor(s,n,i,r),s},_getAllNative:function(t,e,i,r){var s=!1,n=null;t.oncomplete=function(){(s?i:r)(n)},t.onabort=r,t.onerror=r;var o=e.getAll();o.onsuccess=function(t){s=!0,n=t.target.result},o.onerror=r},_getAllCursor:function(t,e,i,r){var s=[],n=!1,o=null;t.oncomplete=function(){(n?i:r)(o)},t.onabort=r,t.onerror=r;var a=e.openCursor();a.onsuccess=function(t){var e=t.target.result;e?(s.push(e.value),e.continue()):(n=!0,o=s)},a.onError=r},clear:function(i,r){r||(r=t),i||(i=e);var s=!1,n=null,o=this.db.transaction([this.storeName],this.consts.READ_WRITE);o.oncomplete=function(){(s?i:r)(n)},o.onabort=r,o.onerror=r;var a=o.objectStore(this.storeName).clear();return a.onsuccess=function(t){s=!0,n=t.target.result},a.onerror=r,o},_addIdPropertyIfNeeded:function(t){void 0===t[this.keyPath]&&(t[this.keyPath]=this._insertIdCount+++Date.now())},getIndexList:function(){return this.store.indexNames},hasIndex:function(t){return this.store.indexNames.contains(t)},normalizeIndexData:function(t){t.keyPath=t.keyPath||t.name,t.unique=!!t.unique,t.multiEntry=!!t.multiEntry},indexComplies:function(t,e){return["keyPath","unique","multiEntry"].every(function(i){if("multiEntry"==i&&void 0===t[i]&&!1===e[i])return!0;if("keyPath"==i&&"[object Array]"==Object.prototype.toString.call(e[i])){var r=e.keyPath,s=t.keyPath;if("string"==typeof s)return r.toString()==s;if("function"!=typeof s.contains&&"function"!=typeof s.indexOf)return!1;if(s.length!==r.length)return!1;for(var n=0,o=r.length;n<o;n++)if(!(s.contains&&s.contains(r[n])||s.indexOf(-1!==r[n])))return!1;return!0}return e[i]==t[i]})},iterate:function(e,i){var r="desc"==(i=o({index:null,order:"ASC",autoContinue:!0,filterDuplicates:!1,keyRange:null,writeAccess:!1,onEnd:null,onError:t,limit:1/0,offset:0,allowItemRejection:!1},i||{})).order.toLowerCase()?"PREV":"NEXT";i.filterDuplicates&&(r+="_NO_DUPLICATE");var s=!1,n=this.db.transaction([this.storeName],this.consts[i.writeAccess?"READ_WRITE":"READ_ONLY"]),a=n.objectStore(this.storeName);i.index&&(a=a.index(i.index));var h=0;n.oncomplete=function(){s?i.onEnd?i.onEnd():e(null):i.onError(null)},n.onabort=i.onError,n.onerror=i.onError;var c=a.openCursor(i.keyRange,this.consts[r]);return c.onerror=i.onError,c.onsuccess=function(t){var r=t.target.result;if(r)if(i.offset)r.advance(i.offset),i.offset=0;else{var o=e(r.value,r,n);i.allowItemRejection&&!1===o||h++,i.autoContinue&&(h+i.offset<i.limit?r.continue():s=!0)}else s=!0},n},query:function(t,e){var i=[],r=0;return(e=e||{}).autoContinue=!0,e.writeAccess=!1,e.allowItemRejection=!!e.filter,e.onEnd=function(){t(i,r)},this.iterate(function(t){r++;var s=!e.filter||e.filter(t);return!1!==s&&i.push(t),s},e)},count:function(e,i){var r=(i=o({index:null,keyRange:null},i||{})).onError||t,s=!1,n=null,a=this.db.transaction([this.storeName],this.consts.READ_ONLY);a.oncomplete=function(){(s?e:r)(n)},a.onabort=r,a.onerror=r;var h=a.objectStore(this.storeName);i.index&&(h=h.index(i.index));var c=h.count(i.keyRange);return c.onsuccess=function(t){s=!0,n=t.target.result},c.onError=r,a},makeKeyRange:function(t){var e,i=void 0!==t.lower,r=void 0!==t.upper;switch(!0){case void 0!==t.only:e=this.keyRange.only(t.only);break;case i&&r:e=this.keyRange.bound(t.lower,t.upper,t.excludeLower,t.excludeUpper);break;case i:e=this.keyRange.lowerBound(t.lower,t.excludeLower);break;case r:e=this.keyRange.upperBound(t.upper,t.excludeUpper);break;default:throw new Error('Cannot create KeyRange. Provide one or both of "lower" or "upper" value, or an "only" value.')}return e}},n={};function o(t,e){var i,r;for(i in e)(r=e[i])!==n[i]&&r!==t[i]&&(t[i]=r);return t}return r.prototype=s,r.version=s.version,r})?r.call(e,i,e,t):r)||(t.exports=s)}()},function(t,e){t.exports=function(){for(var t={},e=0;e<arguments.length;e++){var i=arguments[e];for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t}},function(t,e,i){(function(e){function i(t){this.db=t,this._ended=!1,this._nexting=!1}i.prototype.next=function(t){var i=this;if("function"!=typeof t)throw new Error("next() requires a callback argument");return i._ended?t(new Error("cannot call next() after end()")):i._nexting?t(new Error("cannot call next() before previous next() has completed")):(i._nexting=!0,"function"==typeof i._next?i._next(function(){i._nexting=!1,t.apply(null,arguments)}):void e.nextTick(function(){i._nexting=!1,t()}))},i.prototype.end=function(t){if("function"!=typeof t)throw new Error("end() requires a callback argument");return this._ended?t(new Error("end() already called on iterator")):(this._ended=!0,"function"==typeof this._end?this._end(t):void e.nextTick(t))},t.exports=i}).call(this,i(23))},function(t,e,i){(function(e){function i(t){this._db=t,this._operations=[],this._written=!1}i.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},i.prototype.put=function(t,e){this._checkWritten();var i=this._db._checkKeyValue(t,"key",this._db._isBuffer);if(i)throw i;if(i=this._db._checkKeyValue(e,"value",this._db._isBuffer))throw i;return this._db._isBuffer(t)||(t=String(t)),this._db._isBuffer(e)||(e=String(e)),"function"==typeof this._put?this._put(t,e):this._operations.push({type:"put",key:t,value:e}),this},i.prototype.del=function(t){this._checkWritten();var e=this._db._checkKeyValue(t,"key",this._db._isBuffer);if(e)throw e;return this._db._isBuffer(t)||(t=String(t)),"function"==typeof this._del?this._del(t):this._operations.push({type:"del",key:t}),this},i.prototype.clear=function(){return this._checkWritten(),this._operations=[],"function"==typeof this._clear&&this._clear(),this},i.prototype.write=function(t,i){if(this._checkWritten(),"function"==typeof t&&(i=t),"function"!=typeof i)throw new Error("write() requires a callback argument");return"object"!=typeof t&&(t={}),this._written=!0,"function"==typeof this._write?this._write(i):"function"==typeof this._db._batch?this._db._batch(this._operations,t,i):void e.nextTick(i)},t.exports=i}).call(this,i(23))},function(t,e,i){var r=i(66),s=i(394).AbstractIterator,n=i(477);function o(t,e){e||(e={}),this.options=e,s.call(this,t),this._order=e.reverse?"DESC":"ASC",this._limit=e.limit,this._count=0,this._done=!1;var i=n.lowerBound(e),r=n.upperBound(e);try{this._keyRange=i||r?this.db.makeKeyRange({lower:i,upper:r,excludeLower:n.lowerBoundExclusive(e),excludeUpper:n.upperBoundExclusive(e)}):null}catch(t){this._keyRangeError=!0}this.callback=null}t.exports=o,r.inherits(o,s),o.prototype.createIterator=function(){var t=this;t.iterator=t.db.iterate(function(){t.onItem.apply(t,arguments)},{keyRange:t._keyRange,autoContinue:!1,order:t._order,onError:function(t){console.log("horrible error",t)}})},o.prototype.onItem=function(t,e,i){if(!e&&this.callback)return this.callback(),void(this.callback=!1);var r=!0;this._limit&&this._limit>0&&this._count++>=this._limit&&(r=!1),r&&this.callback(!1,e.key,e.value),e&&e.continue()},o.prototype._next=function(t){return t?this._keyRangeError?t():(this._started||(this.createIterator(),this._started=!0),void(this.callback=t)):new Error("next() requires a callback argument")}},function(t,e,i){(function(t){function i(t,e){return Object.hasOwnProperty.call(t,e)}function r(t){return void 0!==t&&""!==t}function i(t,e){return Object.hasOwnProperty.call(t,e)}function s(t,e){return Object.hasOwnProperty.call(t,e)&&e}e.compare=function(e,i){if(t.isBuffer(e)){for(var r=Math.min(e.length,i.length),s=0;s<r;s++){var n=e[s]-i[s];if(n)return n}return e.length-i.length}return e<i?-1:e>i?1:0};var n=e.lowerBoundKey=function(t){return s(t,"gt")||s(t,"gte")||s(t,"min")||(t.reverse?s(t,"end"):s(t,"start"))||void 0},o=e.lowerBound=function(t,e){var i=n(t);return i?t[i]:e},a=e.lowerBoundInclusive=function(t){return!i(t,"gt")},h=e.upperBoundInclusive=function(t){return!i(t,"lt")},c=e.lowerBoundExclusive=function(t){return!a(t)},u=e.upperBoundExclusive=function(t){return!h(t)},l=e.upperBoundKey=function(t){return s(t,"lt")||s(t,"lte")||s(t,"max")||(t.reverse?s(t,"start"):s(t,"end"))||void 0},f=e.upperBound=function(t,e){var i=l(t);return i?t[i]:e};function d(t){return t}e.start=function(t,e){return t.reverse?f(t,e):o(t,e)},e.end=function(t,e){return t.reverse?o(t,e):f(t,e)},e.startInclusive=function(t){return t.reverse?h(t):a(t)},e.endInclusive=function(t){return t.reverse?a(t):h(t)},e.toLtgt=function(t,r,s,n,o){r=r||{},s=s||d;var a=arguments.length>3,h=e.lowerBoundKey(t),c=e.upperBoundKey(t);return h?"gt"===h?r.gt=s(t.gt,!1):r.gte=s(t[h],!1):a&&(r.gte=s(n,!1)),c?"lt"===c?r.lt=s(t.lt,!0):r.lte=s(t[c],!0):a&&(r.lte=s(o,!0)),null!=t.reverse&&(r.reverse=!!t.reverse),i(r,"max")&&delete r.max,i(r,"min")&&delete r.min,i(r,"start")&&delete r.start,i(r,"end")&&delete r.end,r},e.contains=function(t,i,s){s=s||e.compare;var n=o(t);if(r(n)&&((a=s(i,n))<0||0===a&&c(t)))return!1;var a,h=f(t);return!r(h)||!((a=s(i,h))>0||0===a&&u(t))},e.filter=function(t,i){return function(r){return e.contains(t,r,i)}}}).call(this,i(0).Buffer)},function(t,e,i){var r=i(0).Buffer;t.exports=function(t){return r.isBuffer(t)||/\[object (.+Array|Array.+)\]/.test(Object.prototype.toString.call(t))}},function(t,e,i){var r=i(480),s=i(484);t.exports=function(){for(var t={},e=0;e<arguments.length;e++){var i=arguments[e];if(s(i))for(var n=r(i),o=0;o<n.length;o++){var a=n[o];t[a]=i[a]}}return t}},function(t,e,i){t.exports=Object.keys||i(481)},function(t,e,i){!function(){"use strict";var e,r=Object.prototype.hasOwnProperty,s=Object.prototype.toString,n=i(482),o=i(483),a=!{toString:null}.propertyIsEnumerable("toString"),h=function(){}.propertyIsEnumerable("prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];e=function(t){var e=null!==t&&"object"==typeof t,i="[object Function]"===s.call(t),u=o(t),l=[];if(!e&&!i&&!u)throw new TypeError("Object.keys called on a non-object");if(u)n(t,function(t){l.push(t)});else{var f,d=h&&i;for(f in t)d&&"prototype"===f||!r.call(t,f)||l.push(f)}if(a){var p=t.constructor,g=p&&p.prototype===t;n(c,function(e){g&&"constructor"===e||!r.call(t,e)||l.push(e)})}return l},t.exports=e}()},function(t,e){var i=Object.prototype.hasOwnProperty,r=Object.prototype.toString;t.exports=function(t,e){if(!function(t){var e="function"==typeof t&&!(t instanceof RegExp)||"[object Function]"===r.call(t);return e||"undefined"==typeof window||(e=t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt),e}(e))throw new TypeError("iterator must be a function");var s,n,o="string"==typeof t,a=t.length,h=arguments.length>2?arguments[2]:null;if(a===+a)for(s=0;s<a;s++)null===h?e(o?t.charAt(s):t[s],s,t):e.call(h,o?t.charAt(s):t[s],s,t);else for(n in t)i.call(t,n)&&(null===h?e(t[n],n,t):e.call(h,t[n],n,t))}},function(t,e){var i=Object.prototype.toString;t.exports=function(t){var e=i.call(t),r="[object Arguments]"===e;return r||(r="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===i.call(t.callee)),r}},function(t,e){t.exports=function(t){return null!==t&&("object"==typeof t||"function"==typeof t)}},function(t,e,i){(function(e){t.exports=function(t){return"function"==typeof e._augment&&e.TYPED_ARRAY_SUPPORT?e._augment(t):new e(t)}}).call(this,i(0).Buffer)},function(t,e,i){const r=i(6),s=i(2),n=i(4);i(3),i(13);class o{constructor(t){t=t||[],this.cid=t.cid,this.name=t.name,this.url=t.url,this.ip=t.ip,this.current=t.current,this.raw=null}getSize(){if(this.raw)return this.raw.length;let t=0;return t+=n.sizeVarString(this.cid,"utf8"),t+=n.sizeVarString(this.name,"utf8"),t+=n.sizeVarString(this.url,"utf8"),t+=n.sizeVarString(this.ip,"utf8"),(t+=n.sizeVarString(this.current.hash,"utf8"))+4}toWriter(t){return t.writeVarString(this.cid,"utf8"),t.writeVarString(this.name,"utf8"),t.writeVarString(this.url,"utf8"),t.writeVarString(this.ip,"utf8"),this.current||(this.current={hash:"",index:0}),t.writeVarString(this.current.hash,"utf8"),t.writeU32(this.current.index),t}toRaw(){const t=this.getSize();return this.toWriter(new r(t)).render()}fromReader(t){return this.cid=t.readVarString("utf8"),this.name=t.readVarString("utf8"),this.url=t.readVarString("utf8"),this.ip=t.readVarString("utf8"),this.current={},this.current.hash=t.readVarString("utf8"),this.current.index=t.readU32(),this}fromRaw(t){return this.fromReader(new s(t))}static fromReader(t){return(new o).fromReader(t)}static fromRaw(t){return(new o).fromRaw(t)}}t.exports=o},function(t,e,i){"use strict";
/*!
 * ChainOptions.js - blockchain management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(1),s=i(74),n=i(16),o=i(45),a=i(190),h=i(3);class c{constructor(t){this.node=null,this.network=n.primary,this.logger=o.global,this.workers=null,this.prefix=null,this.location=null,this.db="memory",this.maxFiles=64,this.cacheSize=32<<20,this.compression=!0,this.bufferKeys=a.layout.binary,this.spv=!1,this.prune=!1,this.indexTX=!0,this.indexAddress=!1,this.forceFlags=!1,this.coinCache=0,this.entryCache=5e3,this.maxOrphans=20,this.checkpoints=!0,t&&this.fromOptions(t)}fromOptions(t){return null!=t.node&&(r("object"==typeof t.node),this.node=t.node),null!=t.network&&(this.network=n.get(t.network)),null!=t.logger&&(r("object"==typeof t.logger),this.logger=t.logger),null!=t.workers&&(r("object"==typeof t.workers),this.workers=t.workers),null!=t.spv&&(r("boolean"==typeof t.spv),this.spv=t.spv),null!=t.prefix&&(r("string"==typeof t.prefix),this.prefix=t.prefix,this.location=this.spv?s.join(this.prefix,"spvchain"):s.join(this.prefix,"chain")),null!=t.location&&(r("string"==typeof t.location),this.location=t.location),null!=t.db&&(r("string"==typeof t.db),this.db=t.db),null!=t.maxFiles&&(r(h.isU32(t.maxFiles)),this.maxFiles=t.maxFiles),null!=t.cacheSize&&(r(h.isU64(t.cacheSize)),this.cacheSize=t.cacheSize),null!=t.compression&&(r("boolean"==typeof t.compression),this.compression=t.compression),null!=t.prune&&(r("boolean"==typeof t.prune),this.prune=t.prune),null!=t.indexTX&&(r("boolean"==typeof t.indexTX),this.indexTX=t.indexTX),null!=t.indexAddress&&(r("boolean"==typeof t.indexAddress),this.indexAddress=t.indexAddress),null!=t.forceFlags&&(r("boolean"==typeof t.forceFlags),this.forceFlags=t.forceFlags),null!=t.coinCache&&(r(h.isU64(t.coinCache)),this.coinCache=t.coinCache),null!=t.entryCache&&(r(h.isU32(t.entryCache)),this.entryCache=t.entryCache),null!=t.maxOrphans&&(r(h.isU32(t.maxOrphans)),this.maxOrphans=t.maxOrphans),null!=t.checkpoints&&(r("boolean"==typeof t.checkpoints),this.checkpoints=t.checkpoints),this}static fromOptions(t){return(new c).fromOptions(t)}}t.exports=c},function(t,e,i){"use strict";
/*!
 * DeploymentState.js - blockchain management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(65),s=i(20);function n(){if(!(this instanceof n))return new n;this.flags=s.flags.MANDATORY_VERIFY_FLAGS,this.flags&=~s.flags.VERIFY_P2SH,this.lockFlags=r.lockFlags.MANDATORY_LOCKTIME_FLAGS}i(35),n.prototype.hasP2SH=function(){return 0!=(this.flags&s.flags.VERIFY_P2SH)},n.prototype.hasBIP66=function(){return 0!=(this.flags&s.flags.VERIFY_DERSIG)},n.prototype.hasMTP=function(){return 0!=(this.lockFlags&r.lockFlags.MEDIAN_TIME_PAST)},n.prototype.hasCSV=function(){return 0!=(this.flags&s.flags.VERIFY_CHECKSEQUENCEVERIFY)},n.prototype.hasWitness=function(){return 0!=(this.flags&s.flags.VERIFY_WITNESS)},t.exports=n},function(t,e,i){"use strict";
/*!
 * btc/index.js - high-level btc objects for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */e.Amount=i(31),e.URI=i(397)},function(t,e,i){"use strict";
/*!
 * coins/index.js - utxo management for gamegold
 */e.Coins=i(191),e.CoinView=i(44),e.compress=i(192),e.UndoCoins=i(137)},function(t,e,i){"use strict";
/*!
 * crypto/index.js - crypto for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(9),s=i(93),n=i(199);e.aes=i(199),e.AEAD=i(398),e.BN=i(43),e.ccmp=i(109),e.ChaCha20=i(355),e.cleanse=i(120),e.digest=i(9),e.ecdsa=i(391),e.hkdf=i(399),e.HmacDRBG=i(400),e.merkle=i(96),e.pbkdf2=i(117),e.Poly1305=i(356),e.random=i(93),e.rsa=i(390),e.schnorr=i(401),e.scrypt=i(173),e.secp256k1=i(30),e.siphash=i(357),e.hash=r.hash,e.ripemd160=r.ripemd160,e.sha1=r.sha1,e.sha256=r.sha256,e.hash160=r.hash160,e.hash256=r.hash256,e.root256=r.root256,e.hmac=r.hmac,e.encipher=n.encipher,e.decipher=n.decipher,e.randomBytes=s.randomBytes,e.randomInt=s.randomInt,e.randomRange=s.randomRange},function(t,e,i){"use strict";
/*!
 * db/index.js - data management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.backends=i(393),e.LDB=i(138),e.LowlevelUp=i(392),e.MemDB=i(395)},function(t,e,i){"use strict";
/*!
 * hd/index.js - hd keys for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */t.exports=i(200)},function(t,e,i){"use strict";
/*!
 * index.js - wordlists for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.chinese={simplified:i(495),traditional:i(496)},e.english=i(497),e.french=i(498),e.italian=i(499),e.japanese=i(500),e.spanish=i(501)},function(t,e,i){"use strict";t.exports=["的","一","是","在","不","了","有","和","人","这","中","大","为","上","个","国","我","以","要","他","时","来","用","们","生","到","作","地","于","出","就","分","对","成","会","可","主","发","年","动","同","工","也","能","下","过","子","说","产","种","面","而","方","后","多","定","行","学","法","所","民","得","经","十","三","之","进","着","等","部","度","家","电","力","里","如","水","化","高","自","二","理","起","小","物","现","实","加","量","都","两","体","制","机","当","使","点","从","业","本","去","把","性","好","应","开","它","合","还","因","由","其","些","然","前","外","天","政","四","日","那","社","义","事","平","形","相","全","表","间","样","与","关","各","重","新","线","内","数","正","心","反","你","明","看","原","又","么","利","比","或","但","质","气","第","向","道","命","此","变","条","只","没","结","解","问","意","建","月","公","无","系","军","很","情","者","最","立","代","想","已","通","并","提","直","题","党","程","展","五","果","料","象","员","革","位","入","常","文","总","次","品","式","活","设","及","管","特","件","长","求","老","头","基","资","边","流","路","级","少","图","山","统","接","知","较","将","组","见","计","别","她","手","角","期","根","论","运","农","指","几","九","区","强","放","决","西","被","干","做","必","战","先","回","则","任","取","据","处","队","南","给","色","光","门","即","保","治","北","造","百","规","热","领","七","海","口","东","导","器","压","志","世","金","增","争","济","阶","油","思","术","极","交","受","联","什","认","六","共","权","收","证","改","清","美","再","采","转","更","单","风","切","打","白","教","速","花","带","安","场","身","车","例","真","务","具","万","每","目","至","达","走","积","示","议","声","报","斗","完","类","八","离","华","名","确","才","科","张","信","马","节","话","米","整","空","元","况","今","集","温","传","土","许","步","群","广","石","记","需","段","研","界","拉","林","律","叫","且","究","观","越","织","装","影","算","低","持","音","众","书","布","复","容","儿","须","际","商","非","验","连","断","深","难","近","矿","千","周","委","素","技","备","半","办","青","省","列","习","响","约","支","般","史","感","劳","便","团","往","酸","历","市","克","何","除","消","构","府","称","太","准","精","值","号","率","族","维","划","选","标","写","存","候","毛","亲","快","效","斯","院","查","江","型","眼","王","按","格","养","易","置","派","层","片","始","却","专","状","育","厂","京","识","适","属","圆","包","火","住","调","满","县","局","照","参","红","细","引","听","该","铁","价","严","首","底","液","官","德","随","病","苏","失","尔","死","讲","配","女","黄","推","显","谈","罪","神","艺","呢","席","含","企","望","密","批","营","项","防","举","球","英","氧","势","告","李","台","落","木","帮","轮","破","亚","师","围","注","远","字","材","排","供","河","态","封","另","施","减","树","溶","怎","止","案","言","士","均","武","固","叶","鱼","波","视","仅","费","紧","爱","左","章","早","朝","害","续","轻","服","试","食","充","兵","源","判","护","司","足","某","练","差","致","板","田","降","黑","犯","负","击","范","继","兴","似","余","坚","曲","输","修","故","城","夫","够","送","笔","船","占","右","财","吃","富","春","职","觉","汉","画","功","巴","跟","虽","杂","飞","检","吸","助","升","阳","互","初","创","抗","考","投","坏","策","古","径","换","未","跑","留","钢","曾","端","责","站","简","述","钱","副","尽","帝","射","草","冲","承","独","令","限","阿","宣","环","双","请","超","微","让","控","州","良","轴","找","否","纪","益","依","优","顶","础","载","倒","房","突","坐","粉","敌","略","客","袁","冷","胜","绝","析","块","剂","测","丝","协","诉","念","陈","仍","罗","盐","友","洋","错","苦","夜","刑","移","频","逐","靠","混","母","短","皮","终","聚","汽","村","云","哪","既","距","卫","停","烈","央","察","烧","迅","境","若","印","洲","刻","括","激","孔","搞","甚","室","待","核","校","散","侵","吧","甲","游","久","菜","味","旧","模","湖","货","损","预","阻","毫","普","稳","乙","妈","植","息","扩","银","语","挥","酒","守","拿","序","纸","医","缺","雨","吗","针","刘","啊","急","唱","误","训","愿","审","附","获","茶","鲜","粮","斤","孩","脱","硫","肥","善","龙","演","父","渐","血","欢","械","掌","歌","沙","刚","攻","谓","盾","讨","晚","粒","乱","燃","矛","乎","杀","药","宁","鲁","贵","钟","煤","读","班","伯","香","介","迫","句","丰","培","握","兰","担","弦","蛋","沉","假","穿","执","答","乐","谁","顺","烟","缩","征","脸","喜","松","脚","困","异","免","背","星","福","买","染","井","概","慢","怕","磁","倍","祖","皇","促","静","补","评","翻","肉","践","尼","衣","宽","扬","棉","希","伤","操","垂","秋","宜","氢","套","督","振","架","亮","末","宪","庆","编","牛","触","映","雷","销","诗","座","居","抓","裂","胞","呼","娘","景","威","绿","晶","厚","盟","衡","鸡","孙","延","危","胶","屋","乡","临","陆","顾","掉","呀","灯","岁","措","束","耐","剧","玉","赵","跳","哥","季","课","凯","胡","额","款","绍","卷","齐","伟","蒸","殖","永","宗","苗","川","炉","岩","弱","零","杨","奏","沿","露","杆","探","滑","镇","饭","浓","航","怀","赶","库","夺","伊","灵","税","途","灭","赛","归","召","鼓","播","盘","裁","险","康","唯","录","菌","纯","借","糖","盖","横","符","私","努","堂","域","枪","润","幅","哈","竟","熟","虫","泽","脑","壤","碳","欧","遍","侧","寨","敢","彻","虑","斜","薄","庭","纳","弹","饲","伸","折","麦","湿","暗","荷","瓦","塞","床","筑","恶","户","访","塔","奇","透","梁","刀","旋","迹","卡","氯","遇","份","毒","泥","退","洗","摆","灰","彩","卖","耗","夏","择","忙","铜","献","硬","予","繁","圈","雪","函","亦","抽","篇","阵","阴","丁","尺","追","堆","雄","迎","泛","爸","楼","避","谋","吨","野","猪","旗","累","偏","典","馆","索","秦","脂","潮","爷","豆","忽","托","惊","塑","遗","愈","朱","替","纤","粗","倾","尚","痛","楚","谢","奋","购","磨","君","池","旁","碎","骨","监","捕","弟","暴","割","贯","殊","释","词","亡","壁","顿","宝","午","尘","闻","揭","炮","残","冬","桥","妇","警","综","招","吴","付","浮","遭","徐","您","摇","谷","赞","箱","隔","订","男","吹","园","纷","唐","败","宋","玻","巨","耕","坦","荣","闭","湾","键","凡","驻","锅","救","恩","剥","凝","碱","齿","截","炼","麻","纺","禁","废","盛","版","缓","净","睛","昌","婚","涉","筒","嘴","插","岸","朗","庄","街","藏","姑","贸","腐","奴","啦","惯","乘","伙","恢","匀","纱","扎","辩","耳","彪","臣","亿","璃","抵","脉","秀","萨","俄","网","舞","店","喷","纵","寸","汗","挂","洪","贺","闪","柬","爆","烯","津","稻","墙","软","勇","像","滚","厘","蒙","芳","肯","坡","柱","荡","腿","仪","旅","尾","轧","冰","贡","登","黎","削","钻","勒","逃","障","氨","郭","峰","币","港","伏","轨","亩","毕","擦","莫","刺","浪","秘","援","株","健","售","股","岛","甘","泡","睡","童","铸","汤","阀","休","汇","舍","牧","绕","炸","哲","磷","绩","朋","淡","尖","启","陷","柴","呈","徒","颜","泪","稍","忘","泵","蓝","拖","洞","授","镜","辛","壮","锋","贫","虚","弯","摩","泰","幼","廷","尊","窗","纲","弄","隶","疑","氏","宫","姐","震","瑞","怪","尤","琴","循","描","膜","违","夹","腰","缘","珠","穷","森","枝","竹","沟","催","绳","忆","邦","剩","幸","浆","栏","拥","牙","贮","礼","滤","钠","纹","罢","拍","咱","喊","袖","埃","勤","罚","焦","潜","伍","墨","欲","缝","姓","刊","饱","仿","奖","铝","鬼","丽","跨","默","挖","链","扫","喝","袋","炭","污","幕","诸","弧","励","梅","奶","洁","灾","舟","鉴","苯","讼","抱","毁","懂","寒","智","埔","寄","届","跃","渡","挑","丹","艰","贝","碰","拔","爹","戴","码","梦","芽","熔","赤","渔","哭","敬","颗","奔","铅","仲","虎","稀","妹","乏","珍","申","桌","遵","允","隆","螺","仓","魏","锐","晓","氮","兼","隐","碍","赫","拨","忠","肃","缸","牵","抢","博","巧","壳","兄","杜","讯","诚","碧","祥","柯","页","巡","矩","悲","灌","龄","伦","票","寻","桂","铺","圣","恐","恰","郑","趣","抬","荒","腾","贴","柔","滴","猛","阔","辆","妻","填","撤","储","签","闹","扰","紫","砂","递","戏","吊","陶","伐","喂","疗","瓶","婆","抚","臂","摸","忍","虾","蜡","邻","胸","巩","挤","偶","弃","槽","劲","乳","邓","吉","仁","烂","砖","租","乌","舰","伴","瓜","浅","丙","暂","燥","橡","柳","迷","暖","牌","秧","胆","详","簧","踏","瓷","谱","呆","宾","糊","洛","辉","愤","竞","隙","怒","粘","乃","绪","肩","籍","敏","涂","熙","皆","侦","悬","掘","享","纠","醒","狂","锁","淀","恨","牲","霸","爬","赏","逆","玩","陵","祝","秒","浙","貌","役","彼","悉","鸭","趋","凤","晨","畜","辈","秩","卵","署","梯","炎","滩","棋","驱","筛","峡","冒","啥","寿","译","浸","泉","帽","迟","硅","疆","贷","漏","稿","冠","嫩","胁","芯","牢","叛","蚀","奥","鸣","岭","羊","凭","串","塘","绘","酵","融","盆","锡","庙","筹","冻","辅","摄","袭","筋","拒","僚","旱","钾","鸟","漆","沈","眉","疏","添","棒","穗","硝","韩","逼","扭","侨","凉","挺","碗","栽","炒","杯","患","馏","劝","豪","辽","勃","鸿","旦","吏","拜","狗","埋","辊","掩","饮","搬","骂","辞","勾","扣","估","蒋","绒","雾","丈","朵","姆","拟","宇","辑","陕","雕","偿","蓄","崇","剪","倡","厅","咬","驶","薯","刷","斥","番","赋","奉","佛","浇","漫","曼","扇","钙","桃","扶","仔","返","俗","亏","腔","鞋","棱","覆","框","悄","叔","撞","骗","勘","旺","沸","孤","吐","孟","渠","屈","疾","妙","惜","仰","狠","胀","谐","抛","霉","桑","岗","嘛","衰","盗","渗","脏","赖","涌","甜","曹","阅","肌","哩","厉","烃","纬","毅","昨","伪","症","煮","叹","钉","搭","茎","笼","酷","偷","弓","锥","恒","杰","坑","鼻","翼","纶","叙","狱","逮","罐","络","棚","抑","膨","蔬","寺","骤","穆","冶","枯","册","尸","凸","绅","坯","牺","焰","轰","欣","晋","瘦","御","锭","锦","丧","旬","锻","垄","搜","扑","邀","亭","酯","迈","舒","脆","酶","闲","忧","酚","顽","羽","涨","卸","仗","陪","辟","惩","杭","姚","肚","捉","飘","漂","昆","欺","吾","郎","烷","汁","呵","饰","萧","雅","邮","迁","燕","撒","姻","赴","宴","烦","债","帐","斑","铃","旨","醇","董","饼","雏","姿","拌","傅","腹","妥","揉","贤","拆","歪","葡","胺","丢","浩","徽","昂","垫","挡","览","贪","慰","缴","汪","慌","冯","诺","姜","谊","凶","劣","诬","耀","昏","躺","盈","骑","乔","溪","丛","卢","抹","闷","咨","刮","驾","缆","悟","摘","铒","掷","颇","幻","柄","惠","惨","佳","仇","腊","窝","涤","剑","瞧","堡","泼","葱","罩","霍","捞","胎","苍","滨","俩","捅","湘","砍","霞","邵","萄","疯","淮","遂","熊","粪","烘","宿","档","戈","驳","嫂","裕","徙","箭","捐","肠","撑","晒","辨","殿","莲","摊","搅","酱","屏","疫","哀","蔡","堵","沫","皱","畅","叠","阁","莱","敲","辖","钩","痕","坝","巷","饿","祸","丘","玄","溜","曰","逻","彭","尝","卿","妨","艇","吞","韦","怨","矮","歇"]},function(t,e,i){"use strict";t.exports=["的","一","是","在","不","了","有","和","人","這","中","大","為","上","個","國","我","以","要","他","時","來","用","們","生","到","作","地","於","出","就","分","對","成","會","可","主","發","年","動","同","工","也","能","下","過","子","說","產","種","面","而","方","後","多","定","行","學","法","所","民","得","經","十","三","之","進","著","等","部","度","家","電","力","裡","如","水","化","高","自","二","理","起","小","物","現","實","加","量","都","兩","體","制","機","當","使","點","從","業","本","去","把","性","好","應","開","它","合","還","因","由","其","些","然","前","外","天","政","四","日","那","社","義","事","平","形","相","全","表","間","樣","與","關","各","重","新","線","內","數","正","心","反","你","明","看","原","又","麼","利","比","或","但","質","氣","第","向","道","命","此","變","條","只","沒","結","解","問","意","建","月","公","無","系","軍","很","情","者","最","立","代","想","已","通","並","提","直","題","黨","程","展","五","果","料","象","員","革","位","入","常","文","總","次","品","式","活","設","及","管","特","件","長","求","老","頭","基","資","邊","流","路","級","少","圖","山","統","接","知","較","將","組","見","計","別","她","手","角","期","根","論","運","農","指","幾","九","區","強","放","決","西","被","幹","做","必","戰","先","回","則","任","取","據","處","隊","南","給","色","光","門","即","保","治","北","造","百","規","熱","領","七","海","口","東","導","器","壓","志","世","金","增","爭","濟","階","油","思","術","極","交","受","聯","什","認","六","共","權","收","證","改","清","美","再","採","轉","更","單","風","切","打","白","教","速","花","帶","安","場","身","車","例","真","務","具","萬","每","目","至","達","走","積","示","議","聲","報","鬥","完","類","八","離","華","名","確","才","科","張","信","馬","節","話","米","整","空","元","況","今","集","溫","傳","土","許","步","群","廣","石","記","需","段","研","界","拉","林","律","叫","且","究","觀","越","織","裝","影","算","低","持","音","眾","書","布","复","容","兒","須","際","商","非","驗","連","斷","深","難","近","礦","千","週","委","素","技","備","半","辦","青","省","列","習","響","約","支","般","史","感","勞","便","團","往","酸","歷","市","克","何","除","消","構","府","稱","太","準","精","值","號","率","族","維","劃","選","標","寫","存","候","毛","親","快","效","斯","院","查","江","型","眼","王","按","格","養","易","置","派","層","片","始","卻","專","狀","育","廠","京","識","適","屬","圓","包","火","住","調","滿","縣","局","照","參","紅","細","引","聽","該","鐵","價","嚴","首","底","液","官","德","隨","病","蘇","失","爾","死","講","配","女","黃","推","顯","談","罪","神","藝","呢","席","含","企","望","密","批","營","項","防","舉","球","英","氧","勢","告","李","台","落","木","幫","輪","破","亞","師","圍","注","遠","字","材","排","供","河","態","封","另","施","減","樹","溶","怎","止","案","言","士","均","武","固","葉","魚","波","視","僅","費","緊","愛","左","章","早","朝","害","續","輕","服","試","食","充","兵","源","判","護","司","足","某","練","差","致","板","田","降","黑","犯","負","擊","范","繼","興","似","餘","堅","曲","輸","修","故","城","夫","夠","送","筆","船","佔","右","財","吃","富","春","職","覺","漢","畫","功","巴","跟","雖","雜","飛","檢","吸","助","昇","陽","互","初","創","抗","考","投","壞","策","古","徑","換","未","跑","留","鋼","曾","端","責","站","簡","述","錢","副","盡","帝","射","草","衝","承","獨","令","限","阿","宣","環","雙","請","超","微","讓","控","州","良","軸","找","否","紀","益","依","優","頂","礎","載","倒","房","突","坐","粉","敵","略","客","袁","冷","勝","絕","析","塊","劑","測","絲","協","訴","念","陳","仍","羅","鹽","友","洋","錯","苦","夜","刑","移","頻","逐","靠","混","母","短","皮","終","聚","汽","村","雲","哪","既","距","衛","停","烈","央","察","燒","迅","境","若","印","洲","刻","括","激","孔","搞","甚","室","待","核","校","散","侵","吧","甲","遊","久","菜","味","舊","模","湖","貨","損","預","阻","毫","普","穩","乙","媽","植","息","擴","銀","語","揮","酒","守","拿","序","紙","醫","缺","雨","嗎","針","劉","啊","急","唱","誤","訓","願","審","附","獲","茶","鮮","糧","斤","孩","脫","硫","肥","善","龍","演","父","漸","血","歡","械","掌","歌","沙","剛","攻","謂","盾","討","晚","粒","亂","燃","矛","乎","殺","藥","寧","魯","貴","鐘","煤","讀","班","伯","香","介","迫","句","豐","培","握","蘭","擔","弦","蛋","沉","假","穿","執","答","樂","誰","順","煙","縮","徵","臉","喜","松","腳","困","異","免","背","星","福","買","染","井","概","慢","怕","磁","倍","祖","皇","促","靜","補","評","翻","肉","踐","尼","衣","寬","揚","棉","希","傷","操","垂","秋","宜","氫","套","督","振","架","亮","末","憲","慶","編","牛","觸","映","雷","銷","詩","座","居","抓","裂","胞","呼","娘","景","威","綠","晶","厚","盟","衡","雞","孫","延","危","膠","屋","鄉","臨","陸","顧","掉","呀","燈","歲","措","束","耐","劇","玉","趙","跳","哥","季","課","凱","胡","額","款","紹","卷","齊","偉","蒸","殖","永","宗","苗","川","爐","岩","弱","零","楊","奏","沿","露","桿","探","滑","鎮","飯","濃","航","懷","趕","庫","奪","伊","靈","稅","途","滅","賽","歸","召","鼓","播","盤","裁","險","康","唯","錄","菌","純","借","糖","蓋","橫","符","私","努","堂","域","槍","潤","幅","哈","竟","熟","蟲","澤","腦","壤","碳","歐","遍","側","寨","敢","徹","慮","斜","薄","庭","納","彈","飼","伸","折","麥","濕","暗","荷","瓦","塞","床","築","惡","戶","訪","塔","奇","透","梁","刀","旋","跡","卡","氯","遇","份","毒","泥","退","洗","擺","灰","彩","賣","耗","夏","擇","忙","銅","獻","硬","予","繁","圈","雪","函","亦","抽","篇","陣","陰","丁","尺","追","堆","雄","迎","泛","爸","樓","避","謀","噸","野","豬","旗","累","偏","典","館","索","秦","脂","潮","爺","豆","忽","托","驚","塑","遺","愈","朱","替","纖","粗","傾","尚","痛","楚","謝","奮","購","磨","君","池","旁","碎","骨","監","捕","弟","暴","割","貫","殊","釋","詞","亡","壁","頓","寶","午","塵","聞","揭","炮","殘","冬","橋","婦","警","綜","招","吳","付","浮","遭","徐","您","搖","谷","贊","箱","隔","訂","男","吹","園","紛","唐","敗","宋","玻","巨","耕","坦","榮","閉","灣","鍵","凡","駐","鍋","救","恩","剝","凝","鹼","齒","截","煉","麻","紡","禁","廢","盛","版","緩","淨","睛","昌","婚","涉","筒","嘴","插","岸","朗","莊","街","藏","姑","貿","腐","奴","啦","慣","乘","夥","恢","勻","紗","扎","辯","耳","彪","臣","億","璃","抵","脈","秀","薩","俄","網","舞","店","噴","縱","寸","汗","掛","洪","賀","閃","柬","爆","烯","津","稻","牆","軟","勇","像","滾","厘","蒙","芳","肯","坡","柱","盪","腿","儀","旅","尾","軋","冰","貢","登","黎","削","鑽","勒","逃","障","氨","郭","峰","幣","港","伏","軌","畝","畢","擦","莫","刺","浪","秘","援","株","健","售","股","島","甘","泡","睡","童","鑄","湯","閥","休","匯","舍","牧","繞","炸","哲","磷","績","朋","淡","尖","啟","陷","柴","呈","徒","顏","淚","稍","忘","泵","藍","拖","洞","授","鏡","辛","壯","鋒","貧","虛","彎","摩","泰","幼","廷","尊","窗","綱","弄","隸","疑","氏","宮","姐","震","瑞","怪","尤","琴","循","描","膜","違","夾","腰","緣","珠","窮","森","枝","竹","溝","催","繩","憶","邦","剩","幸","漿","欄","擁","牙","貯","禮","濾","鈉","紋","罷","拍","咱","喊","袖","埃","勤","罰","焦","潛","伍","墨","欲","縫","姓","刊","飽","仿","獎","鋁","鬼","麗","跨","默","挖","鏈","掃","喝","袋","炭","污","幕","諸","弧","勵","梅","奶","潔","災","舟","鑑","苯","訟","抱","毀","懂","寒","智","埔","寄","屆","躍","渡","挑","丹","艱","貝","碰","拔","爹","戴","碼","夢","芽","熔","赤","漁","哭","敬","顆","奔","鉛","仲","虎","稀","妹","乏","珍","申","桌","遵","允","隆","螺","倉","魏","銳","曉","氮","兼","隱","礙","赫","撥","忠","肅","缸","牽","搶","博","巧","殼","兄","杜","訊","誠","碧","祥","柯","頁","巡","矩","悲","灌","齡","倫","票","尋","桂","鋪","聖","恐","恰","鄭","趣","抬","荒","騰","貼","柔","滴","猛","闊","輛","妻","填","撤","儲","簽","鬧","擾","紫","砂","遞","戲","吊","陶","伐","餵","療","瓶","婆","撫","臂","摸","忍","蝦","蠟","鄰","胸","鞏","擠","偶","棄","槽","勁","乳","鄧","吉","仁","爛","磚","租","烏","艦","伴","瓜","淺","丙","暫","燥","橡","柳","迷","暖","牌","秧","膽","詳","簧","踏","瓷","譜","呆","賓","糊","洛","輝","憤","競","隙","怒","粘","乃","緒","肩","籍","敏","塗","熙","皆","偵","懸","掘","享","糾","醒","狂","鎖","淀","恨","牲","霸","爬","賞","逆","玩","陵","祝","秒","浙","貌","役","彼","悉","鴨","趨","鳳","晨","畜","輩","秩","卵","署","梯","炎","灘","棋","驅","篩","峽","冒","啥","壽","譯","浸","泉","帽","遲","矽","疆","貸","漏","稿","冠","嫩","脅","芯","牢","叛","蝕","奧","鳴","嶺","羊","憑","串","塘","繪","酵","融","盆","錫","廟","籌","凍","輔","攝","襲","筋","拒","僚","旱","鉀","鳥","漆","沈","眉","疏","添","棒","穗","硝","韓","逼","扭","僑","涼","挺","碗","栽","炒","杯","患","餾","勸","豪","遼","勃","鴻","旦","吏","拜","狗","埋","輥","掩","飲","搬","罵","辭","勾","扣","估","蔣","絨","霧","丈","朵","姆","擬","宇","輯","陝","雕","償","蓄","崇","剪","倡","廳","咬","駛","薯","刷","斥","番","賦","奉","佛","澆","漫","曼","扇","鈣","桃","扶","仔","返","俗","虧","腔","鞋","棱","覆","框","悄","叔","撞","騙","勘","旺","沸","孤","吐","孟","渠","屈","疾","妙","惜","仰","狠","脹","諧","拋","黴","桑","崗","嘛","衰","盜","滲","臟","賴","湧","甜","曹","閱","肌","哩","厲","烴","緯","毅","昨","偽","症","煮","嘆","釘","搭","莖","籠","酷","偷","弓","錐","恆","傑","坑","鼻","翼","綸","敘","獄","逮","罐","絡","棚","抑","膨","蔬","寺","驟","穆","冶","枯","冊","屍","凸","紳","坯","犧","焰","轟","欣","晉","瘦","禦","錠","錦","喪","旬","鍛","壟","搜","撲","邀","亭","酯","邁","舒","脆","酶","閒","憂","酚","頑","羽","漲","卸","仗","陪","闢","懲","杭","姚","肚","捉","飄","漂","昆","欺","吾","郎","烷","汁","呵","飾","蕭","雅","郵","遷","燕","撒","姻","赴","宴","煩","債","帳","斑","鈴","旨","醇","董","餅","雛","姿","拌","傅","腹","妥","揉","賢","拆","歪","葡","胺","丟","浩","徽","昂","墊","擋","覽","貪","慰","繳","汪","慌","馮","諾","姜","誼","兇","劣","誣","耀","昏","躺","盈","騎","喬","溪","叢","盧","抹","悶","諮","刮","駕","纜","悟","摘","鉺","擲","頗","幻","柄","惠","慘","佳","仇","臘","窩","滌","劍","瞧","堡","潑","蔥","罩","霍","撈","胎","蒼","濱","倆","捅","湘","砍","霞","邵","萄","瘋","淮","遂","熊","糞","烘","宿","檔","戈","駁","嫂","裕","徙","箭","捐","腸","撐","曬","辨","殿","蓮","攤","攪","醬","屏","疫","哀","蔡","堵","沫","皺","暢","疊","閣","萊","敲","轄","鉤","痕","壩","巷","餓","禍","丘","玄","溜","曰","邏","彭","嘗","卿","妨","艇","吞","韋","怨","矮","歇"]},function(t,e,i){"use strict";t.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]},function(t,e,i){"use strict";t.exports=["abaisser","abandon","abdiquer","abeille","abolir","aborder","aboutir","aboyer","abrasif","abreuver","abriter","abroger","abrupt","absence","absolu","absurde","abusif","abyssal","académie","acajou","acarien","accabler","accepter","acclamer","accolade","accroche","accuser","acerbe","achat","acheter","aciduler","acier","acompte","acquérir","acronyme","acteur","actif","actuel","adepte","adéquat","adhésif","adjectif","adjuger","admettre","admirer","adopter","adorer","adoucir","adresse","adroit","adulte","adverbe","aérer","aéronef","affaire","affecter","affiche","affreux","affubler","agacer","agencer","agile","agiter","agrafer","agréable","agrume","aider","aiguille","ailier","aimable","aisance","ajouter","ajuster","alarmer","alchimie","alerte","algèbre","algue","aliéner","aliment","alléger","alliage","allouer","allumer","alourdir","alpaga","altesse","alvéole","amateur","ambigu","ambre","aménager","amertume","amidon","amiral","amorcer","amour","amovible","amphibie","ampleur","amusant","analyse","anaphore","anarchie","anatomie","ancien","anéantir","angle","angoisse","anguleux","animal","annexer","annonce","annuel","anodin","anomalie","anonyme","anormal","antenne","antidote","anxieux","apaiser","apéritif","aplanir","apologie","appareil","appeler","apporter","appuyer","aquarium","aqueduc","arbitre","arbuste","ardeur","ardoise","argent","arlequin","armature","armement","armoire","armure","arpenter","arracher","arriver","arroser","arsenic","artériel","article","aspect","asphalte","aspirer","assaut","asservir","assiette","associer","assurer","asticot","astre","astuce","atelier","atome","atrium","atroce","attaque","attentif","attirer","attraper","aubaine","auberge","audace","audible","augurer","aurore","automne","autruche","avaler","avancer","avarice","avenir","averse","aveugle","aviateur","avide","avion","aviser","avoine","avouer","avril","axial","axiome","badge","bafouer","bagage","baguette","baignade","balancer","balcon","baleine","balisage","bambin","bancaire","bandage","banlieue","bannière","banquier","barbier","baril","baron","barque","barrage","bassin","bastion","bataille","bateau","batterie","baudrier","bavarder","belette","bélier","belote","bénéfice","berceau","berger","berline","bermuda","besace","besogne","bétail","beurre","biberon","bicycle","bidule","bijou","bilan","bilingue","billard","binaire","biologie","biopsie","biotype","biscuit","bison","bistouri","bitume","bizarre","blafard","blague","blanchir","blessant","blinder","blond","bloquer","blouson","bobard","bobine","boire","boiser","bolide","bonbon","bondir","bonheur","bonifier","bonus","bordure","borne","botte","boucle","boueux","bougie","boulon","bouquin","bourse","boussole","boutique","boxeur","branche","brasier","brave","brebis","brèche","breuvage","bricoler","brigade","brillant","brioche","brique","brochure","broder","bronzer","brousse","broyeur","brume","brusque","brutal","bruyant","buffle","buisson","bulletin","bureau","burin","bustier","butiner","butoir","buvable","buvette","cabanon","cabine","cachette","cadeau","cadre","caféine","caillou","caisson","calculer","calepin","calibre","calmer","calomnie","calvaire","camarade","caméra","camion","campagne","canal","caneton","canon","cantine","canular","capable","caporal","caprice","capsule","capter","capuche","carabine","carbone","caresser","caribou","carnage","carotte","carreau","carton","cascade","casier","casque","cassure","causer","caution","cavalier","caverne","caviar","cédille","ceinture","céleste","cellule","cendrier","censurer","central","cercle","cérébral","cerise","cerner","cerveau","cesser","chagrin","chaise","chaleur","chambre","chance","chapitre","charbon","chasseur","chaton","chausson","chavirer","chemise","chenille","chéquier","chercher","cheval","chien","chiffre","chignon","chimère","chiot","chlorure","chocolat","choisir","chose","chouette","chrome","chute","cigare","cigogne","cimenter","cinéma","cintrer","circuler","cirer","cirque","citerne","citoyen","citron","civil","clairon","clameur","claquer","classe","clavier","client","cligner","climat","clivage","cloche","clonage","cloporte","cobalt","cobra","cocasse","cocotier","coder","codifier","coffre","cogner","cohésion","coiffer","coincer","colère","colibri","colline","colmater","colonel","combat","comédie","commande","compact","concert","conduire","confier","congeler","connoter","consonne","contact","convexe","copain","copie","corail","corbeau","cordage","corniche","corpus","correct","cortège","cosmique","costume","coton","coude","coupure","courage","couteau","couvrir","coyote","crabe","crainte","cravate","crayon","créature","créditer","crémeux","creuser","crevette","cribler","crier","cristal","critère","croire","croquer","crotale","crucial","cruel","crypter","cubique","cueillir","cuillère","cuisine","cuivre","culminer","cultiver","cumuler","cupide","curatif","curseur","cyanure","cycle","cylindre","cynique","daigner","damier","danger","danseur","dauphin","débattre","débiter","déborder","débrider","débutant","décaler","décembre","déchirer","décider","déclarer","décorer","décrire","décupler","dédale","déductif","déesse","défensif","défiler","défrayer","dégager","dégivrer","déglutir","dégrafer","déjeuner","délice","déloger","demander","demeurer","démolir","dénicher","dénouer","dentelle","dénuder","départ","dépenser","déphaser","déplacer","déposer","déranger","dérober","désastre","descente","désert","désigner","désobéir","dessiner","destrier","détacher","détester","détourer","détresse","devancer","devenir","deviner","devoir","diable","dialogue","diamant","dicter","différer","digérer","digital","digne","diluer","dimanche","diminuer","dioxyde","directif","diriger","discuter","disposer","dissiper","distance","divertir","diviser","docile","docteur","dogme","doigt","domaine","domicile","dompter","donateur","donjon","donner","dopamine","dortoir","dorure","dosage","doseur","dossier","dotation","douanier","double","douceur","douter","doyen","dragon","draper","dresser","dribbler","droiture","duperie","duplexe","durable","durcir","dynastie","éblouir","écarter","écharpe","échelle","éclairer","éclipse","éclore","écluse","école","économie","écorce","écouter","écraser","écrémer","écrivain","écrou","écume","écureuil","édifier","éduquer","effacer","effectif","effigie","effort","effrayer","effusion","égaliser","égarer","éjecter","élaborer","élargir","électron","élégant","éléphant","élève","éligible","élitisme","éloge","élucider","éluder","emballer","embellir","embryon","émeraude","émission","emmener","émotion","émouvoir","empereur","employer","emporter","emprise","émulsion","encadrer","enchère","enclave","encoche","endiguer","endosser","endroit","enduire","énergie","enfance","enfermer","enfouir","engager","engin","englober","énigme","enjamber","enjeu","enlever","ennemi","ennuyeux","enrichir","enrobage","enseigne","entasser","entendre","entier","entourer","entraver","énumérer","envahir","enviable","envoyer","enzyme","éolien","épaissir","épargne","épatant","épaule","épicerie","épidémie","épier","épilogue","épine","épisode","épitaphe","époque","épreuve","éprouver","épuisant","équerre","équipe","ériger","érosion","erreur","éruption","escalier","espadon","espèce","espiègle","espoir","esprit","esquiver","essayer","essence","essieu","essorer","estime","estomac","estrade","étagère","étaler","étanche","étatique","éteindre","étendoir","éternel","éthanol","éthique","ethnie","étirer","étoffer","étoile","étonnant","étourdir","étrange","étroit","étude","euphorie","évaluer","évasion","éventail","évidence","éviter","évolutif","évoquer","exact","exagérer","exaucer","exceller","excitant","exclusif","excuse","exécuter","exemple","exercer","exhaler","exhorter","exigence","exiler","exister","exotique","expédier","explorer","exposer","exprimer","exquis","extensif","extraire","exulter","fable","fabuleux","facette","facile","facture","faiblir","falaise","fameux","famille","farceur","farfelu","farine","farouche","fasciner","fatal","fatigue","faucon","fautif","faveur","favori","fébrile","féconder","fédérer","félin","femme","fémur","fendoir","féodal","fermer","féroce","ferveur","festival","feuille","feutre","février","fiasco","ficeler","fictif","fidèle","figure","filature","filetage","filière","filleul","filmer","filou","filtrer","financer","finir","fiole","firme","fissure","fixer","flairer","flamme","flasque","flatteur","fléau","flèche","fleur","flexion","flocon","flore","fluctuer","fluide","fluvial","folie","fonderie","fongible","fontaine","forcer","forgeron","formuler","fortune","fossile","foudre","fougère","fouiller","foulure","fourmi","fragile","fraise","franchir","frapper","frayeur","frégate","freiner","frelon","frémir","frénésie","frère","friable","friction","frisson","frivole","froid","fromage","frontal","frotter","fruit","fugitif","fuite","fureur","furieux","furtif","fusion","futur","gagner","galaxie","galerie","gambader","garantir","gardien","garnir","garrigue","gazelle","gazon","géant","gélatine","gélule","gendarme","général","génie","genou","gentil","géologie","géomètre","géranium","germe","gestuel","geyser","gibier","gicler","girafe","givre","glace","glaive","glisser","globe","gloire","glorieux","golfeur","gomme","gonfler","gorge","gorille","goudron","gouffre","goulot","goupille","gourmand","goutte","graduel","graffiti","graine","grand","grappin","gratuit","gravir","grenat","griffure","griller","grimper","grogner","gronder","grotte","groupe","gruger","grutier","gruyère","guépard","guerrier","guide","guimauve","guitare","gustatif","gymnaste","gyrostat","habitude","hachoir","halte","hameau","hangar","hanneton","haricot","harmonie","harpon","hasard","hélium","hématome","herbe","hérisson","hermine","héron","hésiter","heureux","hiberner","hibou","hilarant","histoire","hiver","homard","hommage","homogène","honneur","honorer","honteux","horde","horizon","horloge","hormone","horrible","houleux","housse","hublot","huileux","humain","humble","humide","humour","hurler","hydromel","hygiène","hymne","hypnose","idylle","ignorer","iguane","illicite","illusion","image","imbiber","imiter","immense","immobile","immuable","impact","impérial","implorer","imposer","imprimer","imputer","incarner","incendie","incident","incliner","incolore","indexer","indice","inductif","inédit","ineptie","inexact","infini","infliger","informer","infusion","ingérer","inhaler","inhiber","injecter","injure","innocent","inoculer","inonder","inscrire","insecte","insigne","insolite","inspirer","instinct","insulter","intact","intense","intime","intrigue","intuitif","inutile","invasion","inventer","inviter","invoquer","ironique","irradier","irréel","irriter","isoler","ivoire","ivresse","jaguar","jaillir","jambe","janvier","jardin","jauger","jaune","javelot","jetable","jeton","jeudi","jeunesse","joindre","joncher","jongler","joueur","jouissif","journal","jovial","joyau","joyeux","jubiler","jugement","junior","jupon","juriste","justice","juteux","juvénile","kayak","kimono","kiosque","label","labial","labourer","lacérer","lactose","lagune","laine","laisser","laitier","lambeau","lamelle","lampe","lanceur","langage","lanterne","lapin","largeur","larme","laurier","lavabo","lavoir","lecture","légal","léger","légume","lessive","lettre","levier","lexique","lézard","liasse","libérer","libre","licence","licorne","liège","lièvre","ligature","ligoter","ligue","limer","limite","limonade","limpide","linéaire","lingot","lionceau","liquide","lisière","lister","lithium","litige","littoral","livreur","logique","lointain","loisir","lombric","loterie","louer","lourd","loutre","louve","loyal","lubie","lucide","lucratif","lueur","lugubre","luisant","lumière","lunaire","lundi","luron","lutter","luxueux","machine","magasin","magenta","magique","maigre","maillon","maintien","mairie","maison","majorer","malaxer","maléfice","malheur","malice","mallette","mammouth","mandater","maniable","manquant","manteau","manuel","marathon","marbre","marchand","mardi","maritime","marqueur","marron","marteler","mascotte","massif","matériel","matière","matraque","maudire","maussade","mauve","maximal","méchant","méconnu","médaille","médecin","méditer","méduse","meilleur","mélange","mélodie","membre","mémoire","menacer","mener","menhir","mensonge","mentor","mercredi","mérite","merle","messager","mesure","métal","météore","méthode","métier","meuble","miauler","microbe","miette","mignon","migrer","milieu","million","mimique","mince","minéral","minimal","minorer","minute","miracle","miroiter","missile","mixte","mobile","moderne","moelleux","mondial","moniteur","monnaie","monotone","monstre","montagne","monument","moqueur","morceau","morsure","mortier","moteur","motif","mouche","moufle","moulin","mousson","mouton","mouvant","multiple","munition","muraille","murène","murmure","muscle","muséum","musicien","mutation","muter","mutuel","myriade","myrtille","mystère","mythique","nageur","nappe","narquois","narrer","natation","nation","nature","naufrage","nautique","navire","nébuleux","nectar","néfaste","négation","négliger","négocier","neige","nerveux","nettoyer","neurone","neutron","neveu","niche","nickel","nitrate","niveau","noble","nocif","nocturne","noirceur","noisette","nomade","nombreux","nommer","normatif","notable","notifier","notoire","nourrir","nouveau","novateur","novembre","novice","nuage","nuancer","nuire","nuisible","numéro","nuptial","nuque","nutritif","obéir","objectif","obliger","obscur","observer","obstacle","obtenir","obturer","occasion","occuper","océan","octobre","octroyer","octupler","oculaire","odeur","odorant","offenser","officier","offrir","ogive","oiseau","oisillon","olfactif","olivier","ombrage","omettre","onctueux","onduler","onéreux","onirique","opale","opaque","opérer","opinion","opportun","opprimer","opter","optique","orageux","orange","orbite","ordonner","oreille","organe","orgueil","orifice","ornement","orque","ortie","osciller","osmose","ossature","otarie","ouragan","ourson","outil","outrager","ouvrage","ovation","oxyde","oxygène","ozone","paisible","palace","palmarès","palourde","palper","panache","panda","pangolin","paniquer","panneau","panorama","pantalon","papaye","papier","papoter","papyrus","paradoxe","parcelle","paresse","parfumer","parler","parole","parrain","parsemer","partager","parure","parvenir","passion","pastèque","paternel","patience","patron","pavillon","pavoiser","payer","paysage","peigne","peintre","pelage","pélican","pelle","pelouse","peluche","pendule","pénétrer","pénible","pensif","pénurie","pépite","péplum","perdrix","perforer","période","permuter","perplexe","persil","perte","peser","pétale","petit","pétrir","peuple","pharaon","phobie","phoque","photon","phrase","physique","piano","pictural","pièce","pierre","pieuvre","pilote","pinceau","pipette","piquer","pirogue","piscine","piston","pivoter","pixel","pizza","placard","plafond","plaisir","planer","plaque","plastron","plateau","pleurer","plexus","pliage","plomb","plonger","pluie","plumage","pochette","poésie","poète","pointe","poirier","poisson","poivre","polaire","policier","pollen","polygone","pommade","pompier","ponctuel","pondérer","poney","portique","position","posséder","posture","potager","poteau","potion","pouce","poulain","poumon","pourpre","poussin","pouvoir","prairie","pratique","précieux","prédire","préfixe","prélude","prénom","présence","prétexte","prévoir","primitif","prince","prison","priver","problème","procéder","prodige","profond","progrès","proie","projeter","prologue","promener","propre","prospère","protéger","prouesse","proverbe","prudence","pruneau","psychose","public","puceron","puiser","pulpe","pulsar","punaise","punitif","pupitre","purifier","puzzle","pyramide","quasar","querelle","question","quiétude","quitter","quotient","racine","raconter","radieux","ragondin","raideur","raisin","ralentir","rallonge","ramasser","rapide","rasage","ratisser","ravager","ravin","rayonner","réactif","réagir","réaliser","réanimer","recevoir","réciter","réclamer","récolter","recruter","reculer","recycler","rédiger","redouter","refaire","réflexe","réformer","refrain","refuge","régalien","région","réglage","régulier","réitérer","rejeter","rejouer","relatif","relever","relief","remarque","remède","remise","remonter","remplir","remuer","renard","renfort","renifler","renoncer","rentrer","renvoi","replier","reporter","reprise","reptile","requin","réserve","résineux","résoudre","respect","rester","résultat","rétablir","retenir","réticule","retomber","retracer","réunion","réussir","revanche","revivre","révolte","révulsif","richesse","rideau","rieur","rigide","rigoler","rincer","riposter","risible","risque","rituel","rival","rivière","rocheux","romance","rompre","ronce","rondin","roseau","rosier","rotatif","rotor","rotule","rouge","rouille","rouleau","routine","royaume","ruban","rubis","ruche","ruelle","rugueux","ruiner","ruisseau","ruser","rustique","rythme","sabler","saboter","sabre","sacoche","safari","sagesse","saisir","salade","salive","salon","saluer","samedi","sanction","sanglier","sarcasme","sardine","saturer","saugrenu","saumon","sauter","sauvage","savant","savonner","scalpel","scandale","scélérat","scénario","sceptre","schéma","science","scinder","score","scrutin","sculpter","séance","sécable","sécher","secouer","sécréter","sédatif","séduire","seigneur","séjour","sélectif","semaine","sembler","semence","séminal","sénateur","sensible","sentence","séparer","séquence","serein","sergent","sérieux","serrure","sérum","service","sésame","sévir","sevrage","sextuple","sidéral","siècle","siéger","siffler","sigle","signal","silence","silicium","simple","sincère","sinistre","siphon","sirop","sismique","situer","skier","social","socle","sodium","soigneux","soldat","soleil","solitude","soluble","sombre","sommeil","somnoler","sonde","songeur","sonnette","sonore","sorcier","sortir","sosie","sottise","soucieux","soudure","souffle","soulever","soupape","source","soutirer","souvenir","spacieux","spatial","spécial","sphère","spiral","stable","station","sternum","stimulus","stipuler","strict","studieux","stupeur","styliste","sublime","substrat","subtil","subvenir","succès","sucre","suffixe","suggérer","suiveur","sulfate","superbe","supplier","surface","suricate","surmener","surprise","sursaut","survie","suspect","syllabe","symbole","symétrie","synapse","syntaxe","système","tabac","tablier","tactile","tailler","talent","talisman","talonner","tambour","tamiser","tangible","tapis","taquiner","tarder","tarif","tartine","tasse","tatami","tatouage","taupe","taureau","taxer","témoin","temporel","tenaille","tendre","teneur","tenir","tension","terminer","terne","terrible","tétine","texte","thème","théorie","thérapie","thorax","tibia","tiède","timide","tirelire","tiroir","tissu","titane","titre","tituber","toboggan","tolérant","tomate","tonique","tonneau","toponyme","torche","tordre","tornade","torpille","torrent","torse","tortue","totem","toucher","tournage","tousser","toxine","traction","trafic","tragique","trahir","train","trancher","travail","trèfle","tremper","trésor","treuil","triage","tribunal","tricoter","trilogie","triomphe","tripler","triturer","trivial","trombone","tronc","tropical","troupeau","tuile","tulipe","tumulte","tunnel","turbine","tuteur","tutoyer","tuyau","tympan","typhon","typique","tyran","ubuesque","ultime","ultrason","unanime","unifier","union","unique","unitaire","univers","uranium","urbain","urticant","usage","usine","usuel","usure","utile","utopie","vacarme","vaccin","vagabond","vague","vaillant","vaincre","vaisseau","valable","valise","vallon","valve","vampire","vanille","vapeur","varier","vaseux","vassal","vaste","vecteur","vedette","végétal","véhicule","veinard","véloce","vendredi","vénérer","venger","venimeux","ventouse","verdure","vérin","vernir","verrou","verser","vertu","veston","vétéran","vétuste","vexant","vexer","viaduc","viande","victoire","vidange","vidéo","vignette","vigueur","vilain","village","vinaigre","violon","vipère","virement","virtuose","virus","visage","viseur","vision","visqueux","visuel","vital","vitesse","viticole","vitrine","vivace","vivipare","vocation","voguer","voile","voisin","voiture","volaille","volcan","voltiger","volume","vorace","vortex","voter","vouloir","voyage","voyelle","wagon","xénon","yacht","zèbre","zénith","zeste","zoologie"]},function(t,e,i){"use strict";t.exports=["abaco","abbaglio","abbinato","abete","abisso","abolire","abrasivo","abrogato","accadere","accenno","accusato","acetone","achille","acido","acqua","acre","acrilico","acrobata","acuto","adagio","addebito","addome","adeguato","aderire","adipe","adottare","adulare","affabile","affetto","affisso","affranto","aforisma","afoso","africano","agave","agente","agevole","aggancio","agire","agitare","agonismo","agricolo","agrumeto","aguzzo","alabarda","alato","albatro","alberato","albo","albume","alce","alcolico","alettone","alfa","algebra","aliante","alibi","alimento","allagato","allegro","allievo","allodola","allusivo","almeno","alogeno","alpaca","alpestre","altalena","alterno","alticcio","altrove","alunno","alveolo","alzare","amalgama","amanita","amarena","ambito","ambrato","ameba","america","ametista","amico","ammasso","ammenda","ammirare","ammonito","amore","ampio","ampliare","amuleto","anacardo","anagrafe","analista","anarchia","anatra","anca","ancella","ancora","andare","andrea","anello","angelo","angolare","angusto","anima","annegare","annidato","anno","annuncio","anonimo","anticipo","anzi","apatico","apertura","apode","apparire","appetito","appoggio","approdo","appunto","aprile","arabica","arachide","aragosta","araldica","arancio","aratura","arazzo","arbitro","archivio","ardito","arenile","argento","argine","arguto","aria","armonia","arnese","arredato","arringa","arrosto","arsenico","arso","artefice","arzillo","asciutto","ascolto","asepsi","asettico","asfalto","asino","asola","aspirato","aspro","assaggio","asse","assoluto","assurdo","asta","astenuto","astice","astratto","atavico","ateismo","atomico","atono","attesa","attivare","attorno","attrito","attuale","ausilio","austria","autista","autonomo","autunno","avanzato","avere","avvenire","avviso","avvolgere","azione","azoto","azzimo","azzurro","babele","baccano","bacino","baco","badessa","badilata","bagnato","baita","balcone","baldo","balena","ballata","balzano","bambino","bandire","baraonda","barbaro","barca","baritono","barlume","barocco","basilico","basso","batosta","battuto","baule","bava","bavosa","becco","beffa","belgio","belva","benda","benevole","benigno","benzina","bere","berlina","beta","bibita","bici","bidone","bifido","biga","bilancia","bimbo","binocolo","biologo","bipede","bipolare","birbante","birra","biscotto","bisesto","bisnonno","bisonte","bisturi","bizzarro","blando","blatta","bollito","bonifico","bordo","bosco","botanico","bottino","bozzolo","braccio","bradipo","brama","branca","bravura","bretella","brevetto","brezza","briglia","brillante","brindare","broccolo","brodo","bronzina","brullo","bruno","bubbone","buca","budino","buffone","buio","bulbo","buono","burlone","burrasca","bussola","busta","cadetto","caduco","calamaro","calcolo","calesse","calibro","calmo","caloria","cambusa","camerata","camicia","cammino","camola","campale","canapa","candela","cane","canino","canotto","cantina","capace","capello","capitolo","capogiro","cappero","capra","capsula","carapace","carcassa","cardo","carisma","carovana","carretto","cartolina","casaccio","cascata","caserma","caso","cassone","castello","casuale","catasta","catena","catrame","cauto","cavillo","cedibile","cedrata","cefalo","celebre","cellulare","cena","cenone","centesimo","ceramica","cercare","certo","cerume","cervello","cesoia","cespo","ceto","chela","chiaro","chicca","chiedere","chimera","china","chirurgo","chitarra","ciao","ciclismo","cifrare","cigno","cilindro","ciottolo","circa","cirrosi","citrico","cittadino","ciuffo","civetta","civile","classico","clinica","cloro","cocco","codardo","codice","coerente","cognome","collare","colmato","colore","colposo","coltivato","colza","coma","cometa","commando","comodo","computer","comune","conciso","condurre","conferma","congelare","coniuge","connesso","conoscere","consumo","continuo","convegno","coperto","copione","coppia","copricapo","corazza","cordata","coricato","cornice","corolla","corpo","corredo","corsia","cortese","cosmico","costante","cottura","covato","cratere","cravatta","creato","credere","cremoso","crescita","creta","criceto","crinale","crisi","critico","croce","cronaca","crostata","cruciale","crusca","cucire","cuculo","cugino","cullato","cupola","curatore","cursore","curvo","cuscino","custode","dado","daino","dalmata","damerino","daniela","dannoso","danzare","datato","davanti","davvero","debutto","decennio","deciso","declino","decollo","decreto","dedicato","definito","deforme","degno","delegare","delfino","delirio","delta","demenza","denotato","dentro","deposito","derapata","derivare","deroga","descritto","deserto","desiderio","desumere","detersivo","devoto","diametro","dicembre","diedro","difeso","diffuso","digerire","digitale","diluvio","dinamico","dinnanzi","dipinto","diploma","dipolo","diradare","dire","dirotto","dirupo","disagio","discreto","disfare","disgelo","disposto","distanza","disumano","dito","divano","divelto","dividere","divorato","doblone","docente","doganale","dogma","dolce","domato","domenica","dominare","dondolo","dono","dormire","dote","dottore","dovuto","dozzina","drago","druido","dubbio","dubitare","ducale","duna","duomo","duplice","duraturo","ebano","eccesso","ecco","eclissi","economia","edera","edicola","edile","editoria","educare","egemonia","egli","egoismo","egregio","elaborato","elargire","elegante","elencato","eletto","elevare","elfico","elica","elmo","elsa","eluso","emanato","emblema","emesso","emiro","emotivo","emozione","empirico","emulo","endemico","enduro","energia","enfasi","enoteca","entrare","enzima","epatite","epilogo","episodio","epocale","eppure","equatore","erario","erba","erboso","erede","eremita","erigere","ermetico","eroe","erosivo","errante","esagono","esame","esanime","esaudire","esca","esempio","esercito","esibito","esigente","esistere","esito","esofago","esortato","esoso","espanso","espresso","essenza","esso","esteso","estimare","estonia","estroso","esultare","etilico","etnico","etrusco","etto","euclideo","europa","evaso","evidenza","evitato","evoluto","evviva","fabbrica","faccenda","fachiro","falco","famiglia","fanale","fanfara","fango","fantasma","fare","farfalla","farinoso","farmaco","fascia","fastoso","fasullo","faticare","fato","favoloso","febbre","fecola","fede","fegato","felpa","feltro","femmina","fendere","fenomeno","fermento","ferro","fertile","fessura","festivo","fetta","feudo","fiaba","fiducia","fifa","figurato","filo","finanza","finestra","finire","fiore","fiscale","fisico","fiume","flacone","flamenco","flebo","flemma","florido","fluente","fluoro","fobico","focaccia","focoso","foderato","foglio","folata","folclore","folgore","fondente","fonetico","fonia","fontana","forbito","forchetta","foresta","formica","fornaio","foro","fortezza","forzare","fosfato","fosso","fracasso","frana","frassino","fratello","freccetta","frenata","fresco","frigo","frollino","fronde","frugale","frutta","fucilata","fucsia","fuggente","fulmine","fulvo","fumante","fumetto","fumoso","fune","funzione","fuoco","furbo","furgone","furore","fuso","futile","gabbiano","gaffe","galateo","gallina","galoppo","gambero","gamma","garanzia","garbo","garofano","garzone","gasdotto","gasolio","gastrico","gatto","gaudio","gazebo","gazzella","geco","gelatina","gelso","gemello","gemmato","gene","genitore","gennaio","genotipo","gergo","ghepardo","ghiaccio","ghisa","giallo","gilda","ginepro","giocare","gioiello","giorno","giove","girato","girone","gittata","giudizio","giurato","giusto","globulo","glutine","gnomo","gobba","golf","gomito","gommone","gonfio","gonna","governo","gracile","grado","grafico","grammo","grande","grattare","gravoso","grazia","greca","gregge","grifone","grigio","grinza","grotta","gruppo","guadagno","guaio","guanto","guardare","gufo","guidare","ibernato","icona","identico","idillio","idolo","idra","idrico","idrogeno","igiene","ignaro","ignorato","ilare","illeso","illogico","illudere","imballo","imbevuto","imbocco","imbuto","immane","immerso","immolato","impacco","impeto","impiego","importo","impronta","inalare","inarcare","inattivo","incanto","incendio","inchino","incisivo","incluso","incontro","incrocio","incubo","indagine","india","indole","inedito","infatti","infilare","inflitto","ingaggio","ingegno","inglese","ingordo","ingrosso","innesco","inodore","inoltrare","inondato","insano","insetto","insieme","insonnia","insulina","intasato","intero","intonaco","intuito","inumidire","invalido","invece","invito","iperbole","ipnotico","ipotesi","ippica","iride","irlanda","ironico","irrigato","irrorare","isolato","isotopo","isterico","istituto","istrice","italia","iterare","labbro","labirinto","lacca","lacerato","lacrima","lacuna","laddove","lago","lampo","lancetta","lanterna","lardoso","larga","laringe","lastra","latenza","latino","lattuga","lavagna","lavoro","legale","leggero","lembo","lentezza","lenza","leone","lepre","lesivo","lessato","lesto","letterale","leva","levigato","libero","lido","lievito","lilla","limatura","limitare","limpido","lineare","lingua","liquido","lira","lirica","lisca","lite","litigio","livrea","locanda","lode","logica","lombare","londra","longevo","loquace","lorenzo","loto","lotteria","luce","lucidato","lumaca","luminoso","lungo","lupo","luppolo","lusinga","lusso","lutto","macabro","macchina","macero","macinato","madama","magico","maglia","magnete","magro","maiolica","malafede","malgrado","malinteso","malsano","malto","malumore","mana","mancia","mandorla","mangiare","manifesto","mannaro","manovra","mansarda","mantide","manubrio","mappa","maratona","marcire","maretta","marmo","marsupio","maschera","massaia","mastino","materasso","matricola","mattone","maturo","mazurca","meandro","meccanico","mecenate","medesimo","meditare","mega","melassa","melis","melodia","meninge","meno","mensola","mercurio","merenda","merlo","meschino","mese","messere","mestolo","metallo","metodo","mettere","miagolare","mica","micelio","michele","microbo","midollo","miele","migliore","milano","milite","mimosa","minerale","mini","minore","mirino","mirtillo","miscela","missiva","misto","misurare","mitezza","mitigare","mitra","mittente","mnemonico","modello","modifica","modulo","mogano","mogio","mole","molosso","monastero","monco","mondina","monetario","monile","monotono","monsone","montato","monviso","mora","mordere","morsicato","mostro","motivato","motosega","motto","movenza","movimento","mozzo","mucca","mucosa","muffa","mughetto","mugnaio","mulatto","mulinello","multiplo","mummia","munto","muovere","murale","musa","muscolo","musica","mutevole","muto","nababbo","nafta","nanometro","narciso","narice","narrato","nascere","nastrare","naturale","nautica","naviglio","nebulosa","necrosi","negativo","negozio","nemmeno","neofita","neretto","nervo","nessuno","nettuno","neutrale","neve","nevrotico","nicchia","ninfa","nitido","nobile","nocivo","nodo","nome","nomina","nordico","normale","norvegese","nostrano","notare","notizia","notturno","novella","nucleo","nulla","numero","nuovo","nutrire","nuvola","nuziale","oasi","obbedire","obbligo","obelisco","oblio","obolo","obsoleto","occasione","occhio","occidente","occorrere","occultare","ocra","oculato","odierno","odorare","offerta","offrire","offuscato","oggetto","oggi","ognuno","olandese","olfatto","oliato","oliva","ologramma","oltre","omaggio","ombelico","ombra","omega","omissione","ondoso","onere","onice","onnivoro","onorevole","onta","operato","opinione","opposto","oracolo","orafo","ordine","orecchino","orefice","orfano","organico","origine","orizzonte","orma","ormeggio","ornativo","orologio","orrendo","orribile","ortensia","ortica","orzata","orzo","osare","oscurare","osmosi","ospedale","ospite","ossa","ossidare","ostacolo","oste","otite","otre","ottagono","ottimo","ottobre","ovale","ovest","ovino","oviparo","ovocito","ovunque","ovviare","ozio","pacchetto","pace","pacifico","padella","padrone","paese","paga","pagina","palazzina","palesare","pallido","palo","palude","pandoro","pannello","paolo","paonazzo","paprica","parabola","parcella","parere","pargolo","pari","parlato","parola","partire","parvenza","parziale","passivo","pasticca","patacca","patologia","pattume","pavone","peccato","pedalare","pedonale","peggio","peloso","penare","pendice","penisola","pennuto","penombra","pensare","pentola","pepe","pepita","perbene","percorso","perdonato","perforare","pergamena","periodo","permesso","perno","perplesso","persuaso","pertugio","pervaso","pesatore","pesista","peso","pestifero","petalo","pettine","petulante","pezzo","piacere","pianta","piattino","piccino","picozza","piega","pietra","piffero","pigiama","pigolio","pigro","pila","pilifero","pillola","pilota","pimpante","pineta","pinna","pinolo","pioggia","piombo","piramide","piretico","pirite","pirolisi","pitone","pizzico","placebo","planare","plasma","platano","plenario","pochezza","poderoso","podismo","poesia","poggiare","polenta","poligono","pollice","polmonite","polpetta","polso","poltrona","polvere","pomice","pomodoro","ponte","popoloso","porfido","poroso","porpora","porre","portata","posa","positivo","possesso","postulato","potassio","potere","pranzo","prassi","pratica","precluso","predica","prefisso","pregiato","prelievo","premere","prenotare","preparato","presenza","pretesto","prevalso","prima","principe","privato","problema","procura","produrre","profumo","progetto","prolunga","promessa","pronome","proposta","proroga","proteso","prova","prudente","prugna","prurito","psiche","pubblico","pudica","pugilato","pugno","pulce","pulito","pulsante","puntare","pupazzo","pupilla","puro","quadro","qualcosa","quasi","querela","quota","raccolto","raddoppio","radicale","radunato","raffica","ragazzo","ragione","ragno","ramarro","ramingo","ramo","randagio","rantolare","rapato","rapina","rappreso","rasatura","raschiato","rasente","rassegna","rastrello","rata","ravveduto","reale","recepire","recinto","recluta","recondito","recupero","reddito","redimere","regalato","registro","regola","regresso","relazione","remare","remoto","renna","replica","reprimere","reputare","resa","residente","responso","restauro","rete","retina","retorica","rettifica","revocato","riassunto","ribadire","ribelle","ribrezzo","ricarica","ricco","ricevere","riciclato","ricordo","ricreduto","ridicolo","ridurre","rifasare","riflesso","riforma","rifugio","rigare","rigettato","righello","rilassato","rilevato","rimanere","rimbalzo","rimedio","rimorchio","rinascita","rincaro","rinforzo","rinnovo","rinomato","rinsavito","rintocco","rinuncia","rinvenire","riparato","ripetuto","ripieno","riportare","ripresa","ripulire","risata","rischio","riserva","risibile","riso","rispetto","ristoro","risultato","risvolto","ritardo","ritegno","ritmico","ritrovo","riunione","riva","riverso","rivincita","rivolto","rizoma","roba","robotico","robusto","roccia","roco","rodaggio","rodere","roditore","rogito","rollio","romantico","rompere","ronzio","rosolare","rospo","rotante","rotondo","rotula","rovescio","rubizzo","rubrica","ruga","rullino","rumine","rumoroso","ruolo","rupe","russare","rustico","sabato","sabbiare","sabotato","sagoma","salasso","saldatura","salgemma","salivare","salmone","salone","saltare","saluto","salvo","sapere","sapido","saporito","saraceno","sarcasmo","sarto","sassoso","satellite","satira","satollo","saturno","savana","savio","saziato","sbadiglio","sbalzo","sbancato","sbarra","sbattere","sbavare","sbendare","sbirciare","sbloccato","sbocciato","sbrinare","sbruffone","sbuffare","scabroso","scadenza","scala","scambiare","scandalo","scapola","scarso","scatenare","scavato","scelto","scenico","scettro","scheda","schiena","sciarpa","scienza","scindere","scippo","sciroppo","scivolo","sclerare","scodella","scolpito","scomparto","sconforto","scoprire","scorta","scossone","scozzese","scriba","scrollare","scrutinio","scuderia","scultore","scuola","scuro","scusare","sdebitare","sdoganare","seccatura","secondo","sedano","seggiola","segnalato","segregato","seguito","selciato","selettivo","sella","selvaggio","semaforo","sembrare","seme","seminato","sempre","senso","sentire","sepolto","sequenza","serata","serbato","sereno","serio","serpente","serraglio","servire","sestina","setola","settimana","sfacelo","sfaldare","sfamato","sfarzoso","sfaticato","sfera","sfida","sfilato","sfinge","sfocato","sfoderare","sfogo","sfoltire","sforzato","sfratto","sfruttato","sfuggito","sfumare","sfuso","sgabello","sgarbato","sgonfiare","sgorbio","sgrassato","sguardo","sibilo","siccome","sierra","sigla","signore","silenzio","sillaba","simbolo","simpatico","simulato","sinfonia","singolo","sinistro","sino","sintesi","sinusoide","sipario","sisma","sistole","situato","slitta","slogatura","sloveno","smarrito","smemorato","smentito","smeraldo","smilzo","smontare","smottato","smussato","snellire","snervato","snodo","sobbalzo","sobrio","soccorso","sociale","sodale","soffitto","sogno","soldato","solenne","solido","sollazzo","solo","solubile","solvente","somatico","somma","sonda","sonetto","sonnifero","sopire","soppeso","sopra","sorgere","sorpasso","sorriso","sorso","sorteggio","sorvolato","sospiro","sosta","sottile","spada","spalla","spargere","spatola","spavento","spazzola","specie","spedire","spegnere","spelatura","speranza","spessore","spettrale","spezzato","spia","spigoloso","spillato","spinoso","spirale","splendido","sportivo","sposo","spranga","sprecare","spronato","spruzzo","spuntino","squillo","sradicare","srotolato","stabile","stacco","staffa","stagnare","stampato","stantio","starnuto","stasera","statuto","stelo","steppa","sterzo","stiletto","stima","stirpe","stivale","stizzoso","stonato","storico","strappo","stregato","stridulo","strozzare","strutto","stuccare","stufo","stupendo","subentro","succoso","sudore","suggerito","sugo","sultano","suonare","superbo","supporto","surgelato","surrogato","sussurro","sutura","svagare","svedese","sveglio","svelare","svenuto","svezia","sviluppo","svista","svizzera","svolta","svuotare","tabacco","tabulato","tacciare","taciturno","tale","talismano","tampone","tannino","tara","tardivo","targato","tariffa","tarpare","tartaruga","tasto","tattico","taverna","tavolata","tazza","teca","tecnico","telefono","temerario","tempo","temuto","tendone","tenero","tensione","tentacolo","teorema","terme","terrazzo","terzetto","tesi","tesserato","testato","tetro","tettoia","tifare","tigella","timbro","tinto","tipico","tipografo","tiraggio","tiro","titanio","titolo","titubante","tizio","tizzone","toccare","tollerare","tolto","tombola","tomo","tonfo","tonsilla","topazio","topologia","toppa","torba","tornare","torrone","tortora","toscano","tossire","tostatura","totano","trabocco","trachea","trafila","tragedia","tralcio","tramonto","transito","trapano","trarre","trasloco","trattato","trave","treccia","tremolio","trespolo","tributo","tricheco","trifoglio","trillo","trincea","trio","tristezza","triturato","trivella","tromba","trono","troppo","trottola","trovare","truccato","tubatura","tuffato","tulipano","tumulto","tunisia","turbare","turchino","tuta","tutela","ubicato","uccello","uccisore","udire","uditivo","uffa","ufficio","uguale","ulisse","ultimato","umano","umile","umorismo","uncinetto","ungere","ungherese","unicorno","unificato","unisono","unitario","unte","uovo","upupa","uragano","urgenza","urlo","usanza","usato","uscito","usignolo","usuraio","utensile","utilizzo","utopia","vacante","vaccinato","vagabondo","vagliato","valanga","valgo","valico","valletta","valoroso","valutare","valvola","vampata","vangare","vanitoso","vano","vantaggio","vanvera","vapore","varano","varcato","variante","vasca","vedetta","vedova","veduto","vegetale","veicolo","velcro","velina","velluto","veloce","venato","vendemmia","vento","verace","verbale","vergogna","verifica","vero","verruca","verticale","vescica","vessillo","vestale","veterano","vetrina","vetusto","viandante","vibrante","vicenda","vichingo","vicinanza","vidimare","vigilia","vigneto","vigore","vile","villano","vimini","vincitore","viola","vipera","virgola","virologo","virulento","viscoso","visione","vispo","vissuto","visura","vita","vitello","vittima","vivanda","vivido","viziare","voce","voga","volatile","volere","volpe","voragine","vulcano","zampogna","zanna","zappato","zattera","zavorra","zefiro","zelante","zelo","zenzero","zerbino","zibetto","zinco","zircone","zitto","zolla","zotico","zucchero","zufolo","zulu","zuppa"]},function(t,e,i){"use strict";t.exports=["あいこくしん","あいさつ","あいだ","あおぞら","あかちゃん","あきる","あけがた","あける","あこがれる","あさい","あさひ","あしあと","あじわう","あずかる","あずき","あそぶ","あたえる","あたためる","あたりまえ","あたる","あつい","あつかう","あっしゅく","あつまり","あつめる","あてな","あてはまる","あひる","あぶら","あぶる","あふれる","あまい","あまど","あまやかす","あまり","あみもの","あめりか","あやまる","あゆむ","あらいぐま","あらし","あらすじ","あらためる","あらゆる","あらわす","ありがとう","あわせる","あわてる","あんい","あんがい","あんこ","あんぜん","あんてい","あんない","あんまり","いいだす","いおん","いがい","いがく","いきおい","いきなり","いきもの","いきる","いくじ","いくぶん","いけばな","いけん","いこう","いこく","いこつ","いさましい","いさん","いしき","いじゅう","いじょう","いじわる","いずみ","いずれ","いせい","いせえび","いせかい","いせき","いぜん","いそうろう","いそがしい","いだい","いだく","いたずら","いたみ","いたりあ","いちおう","いちじ","いちど","いちば","いちぶ","いちりゅう","いつか","いっしゅん","いっせい","いっそう","いったん","いっち","いってい","いっぽう","いてざ","いてん","いどう","いとこ","いない","いなか","いねむり","いのち","いのる","いはつ","いばる","いはん","いびき","いひん","いふく","いへん","いほう","いみん","いもうと","いもたれ","いもり","いやがる","いやす","いよかん","いよく","いらい","いらすと","いりぐち","いりょう","いれい","いれもの","いれる","いろえんぴつ","いわい","いわう","いわかん","いわば","いわゆる","いんげんまめ","いんさつ","いんしょう","いんよう","うえき","うえる","うおざ","うがい","うかぶ","うかべる","うきわ","うくらいな","うくれれ","うけたまわる","うけつけ","うけとる","うけもつ","うける","うごかす","うごく","うこん","うさぎ","うしなう","うしろがみ","うすい","うすぎ","うすぐらい","うすめる","うせつ","うちあわせ","うちがわ","うちき","うちゅう","うっかり","うつくしい","うったえる","うつる","うどん","うなぎ","うなじ","うなずく","うなる","うねる","うのう","うぶげ","うぶごえ","うまれる","うめる","うもう","うやまう","うよく","うらがえす","うらぐち","うらない","うりあげ","うりきれ","うるさい","うれしい","うれゆき","うれる","うろこ","うわき","うわさ","うんこう","うんちん","うんてん","うんどう","えいえん","えいが","えいきょう","えいご","えいせい","えいぶん","えいよう","えいわ","えおり","えがお","えがく","えきたい","えくせる","えしゃく","えすて","えつらん","えのぐ","えほうまき","えほん","えまき","えもじ","えもの","えらい","えらぶ","えりあ","えんえん","えんかい","えんぎ","えんげき","えんしゅう","えんぜつ","えんそく","えんちょう","えんとつ","おいかける","おいこす","おいしい","おいつく","おうえん","おうさま","おうじ","おうせつ","おうたい","おうふく","おうべい","おうよう","おえる","おおい","おおう","おおどおり","おおや","おおよそ","おかえり","おかず","おがむ","おかわり","おぎなう","おきる","おくさま","おくじょう","おくりがな","おくる","おくれる","おこす","おこなう","おこる","おさえる","おさない","おさめる","おしいれ","おしえる","おじぎ","おじさん","おしゃれ","おそらく","おそわる","おたがい","おたく","おだやか","おちつく","おっと","おつり","おでかけ","おとしもの","おとなしい","おどり","おどろかす","おばさん","おまいり","おめでとう","おもいで","おもう","おもたい","おもちゃ","おやつ","おやゆび","およぼす","おらんだ","おろす","おんがく","おんけい","おんしゃ","おんせん","おんだん","おんちゅう","おんどけい","かあつ","かいが","がいき","がいけん","がいこう","かいさつ","かいしゃ","かいすいよく","かいぜん","かいぞうど","かいつう","かいてん","かいとう","かいふく","がいへき","かいほう","かいよう","がいらい","かいわ","かえる","かおり","かかえる","かがく","かがし","かがみ","かくご","かくとく","かざる","がぞう","かたい","かたち","がちょう","がっきゅう","がっこう","がっさん","がっしょう","かなざわし","かのう","がはく","かぶか","かほう","かほご","かまう","かまぼこ","かめれおん","かゆい","かようび","からい","かるい","かろう","かわく","かわら","がんか","かんけい","かんこう","かんしゃ","かんそう","かんたん","かんち","がんばる","きあい","きあつ","きいろ","ぎいん","きうい","きうん","きえる","きおう","きおく","きおち","きおん","きかい","きかく","きかんしゃ","ききて","きくばり","きくらげ","きけんせい","きこう","きこえる","きこく","きさい","きさく","きさま","きさらぎ","ぎじかがく","ぎしき","ぎじたいけん","ぎじにってい","ぎじゅつしゃ","きすう","きせい","きせき","きせつ","きそう","きぞく","きぞん","きたえる","きちょう","きつえん","ぎっちり","きつつき","きつね","きてい","きどう","きどく","きない","きなが","きなこ","きぬごし","きねん","きのう","きのした","きはく","きびしい","きひん","きふく","きぶん","きぼう","きほん","きまる","きみつ","きむずかしい","きめる","きもだめし","きもち","きもの","きゃく","きやく","ぎゅうにく","きよう","きょうりゅう","きらい","きらく","きりん","きれい","きれつ","きろく","ぎろん","きわめる","ぎんいろ","きんかくじ","きんじょ","きんようび","ぐあい","くいず","くうかん","くうき","くうぐん","くうこう","ぐうせい","くうそう","ぐうたら","くうふく","くうぼ","くかん","くきょう","くげん","ぐこう","くさい","くさき","くさばな","くさる","くしゃみ","くしょう","くすのき","くすりゆび","くせげ","くせん","ぐたいてき","くださる","くたびれる","くちこみ","くちさき","くつした","ぐっすり","くつろぐ","くとうてん","くどく","くなん","くねくね","くのう","くふう","くみあわせ","くみたてる","くめる","くやくしょ","くらす","くらべる","くるま","くれる","くろう","くわしい","ぐんかん","ぐんしょく","ぐんたい","ぐんて","けあな","けいかく","けいけん","けいこ","けいさつ","げいじゅつ","けいたい","げいのうじん","けいれき","けいろ","けおとす","けおりもの","げきか","げきげん","げきだん","げきちん","げきとつ","げきは","げきやく","げこう","げこくじょう","げざい","けさき","げざん","けしき","けしごむ","けしょう","げすと","けたば","けちゃっぷ","けちらす","けつあつ","けつい","けつえき","けっこん","けつじょ","けっせき","けってい","けつまつ","げつようび","げつれい","けつろん","げどく","けとばす","けとる","けなげ","けなす","けなみ","けぬき","げねつ","けねん","けはい","げひん","けぶかい","げぼく","けまり","けみかる","けむし","けむり","けもの","けらい","けろけろ","けわしい","けんい","けんえつ","けんお","けんか","げんき","けんげん","けんこう","けんさく","けんしゅう","けんすう","げんそう","けんちく","けんてい","けんとう","けんない","けんにん","げんぶつ","けんま","けんみん","けんめい","けんらん","けんり","こあくま","こいぬ","こいびと","ごうい","こうえん","こうおん","こうかん","ごうきゅう","ごうけい","こうこう","こうさい","こうじ","こうすい","ごうせい","こうそく","こうたい","こうちゃ","こうつう","こうてい","こうどう","こうない","こうはい","ごうほう","ごうまん","こうもく","こうりつ","こえる","こおり","ごかい","ごがつ","ごかん","こくご","こくさい","こくとう","こくない","こくはく","こぐま","こけい","こける","ここのか","こころ","こさめ","こしつ","こすう","こせい","こせき","こぜん","こそだて","こたい","こたえる","こたつ","こちょう","こっか","こつこつ","こつばん","こつぶ","こてい","こてん","ことがら","ことし","ことば","ことり","こなごな","こねこね","このまま","このみ","このよ","ごはん","こひつじ","こふう","こふん","こぼれる","ごまあぶら","こまかい","ごますり","こまつな","こまる","こむぎこ","こもじ","こもち","こもの","こもん","こやく","こやま","こゆう","こゆび","こよい","こよう","こりる","これくしょん","ころっけ","こわもて","こわれる","こんいん","こんかい","こんき","こんしゅう","こんすい","こんだて","こんとん","こんなん","こんびに","こんぽん","こんまけ","こんや","こんれい","こんわく","ざいえき","さいかい","さいきん","ざいげん","ざいこ","さいしょ","さいせい","ざいたく","ざいちゅう","さいてき","ざいりょう","さうな","さかいし","さがす","さかな","さかみち","さがる","さぎょう","さくし","さくひん","さくら","さこく","さこつ","さずかる","ざせき","さたん","さつえい","ざつおん","ざっか","ざつがく","さっきょく","ざっし","さつじん","ざっそう","さつたば","さつまいも","さてい","さといも","さとう","さとおや","さとし","さとる","さのう","さばく","さびしい","さべつ","さほう","さほど","さます","さみしい","さみだれ","さむけ","さめる","さやえんどう","さゆう","さよう","さよく","さらだ","ざるそば","さわやか","さわる","さんいん","さんか","さんきゃく","さんこう","さんさい","ざんしょ","さんすう","さんせい","さんそ","さんち","さんま","さんみ","さんらん","しあい","しあげ","しあさって","しあわせ","しいく","しいん","しうち","しえい","しおけ","しかい","しかく","じかん","しごと","しすう","じだい","したうけ","したぎ","したて","したみ","しちょう","しちりん","しっかり","しつじ","しつもん","してい","してき","してつ","じてん","じどう","しなぎれ","しなもの","しなん","しねま","しねん","しのぐ","しのぶ","しはい","しばかり","しはつ","しはらい","しはん","しひょう","しふく","じぶん","しへい","しほう","しほん","しまう","しまる","しみん","しむける","じむしょ","しめい","しめる","しもん","しゃいん","しゃうん","しゃおん","じゃがいも","しやくしょ","しゃくほう","しゃけん","しゃこ","しゃざい","しゃしん","しゃせん","しゃそう","しゃたい","しゃちょう","しゃっきん","じゃま","しゃりん","しゃれい","じゆう","じゅうしょ","しゅくはく","じゅしん","しゅっせき","しゅみ","しゅらば","じゅんばん","しょうかい","しょくたく","しょっけん","しょどう","しょもつ","しらせる","しらべる","しんか","しんこう","じんじゃ","しんせいじ","しんちく","しんりん","すあげ","すあし","すあな","ずあん","すいえい","すいか","すいとう","ずいぶん","すいようび","すうがく","すうじつ","すうせん","すおどり","すきま","すくう","すくない","すける","すごい","すこし","ずさん","すずしい","すすむ","すすめる","すっかり","ずっしり","ずっと","すてき","すてる","すねる","すのこ","すはだ","すばらしい","ずひょう","ずぶぬれ","すぶり","すふれ","すべて","すべる","ずほう","すぼん","すまい","すめし","すもう","すやき","すらすら","するめ","すれちがう","すろっと","すわる","すんぜん","すんぽう","せあぶら","せいかつ","せいげん","せいじ","せいよう","せおう","せかいかん","せきにん","せきむ","せきゆ","せきらんうん","せけん","せこう","せすじ","せたい","せたけ","せっかく","せっきゃく","ぜっく","せっけん","せっこつ","せっさたくま","せつぞく","せつだん","せつでん","せっぱん","せつび","せつぶん","せつめい","せつりつ","せなか","せのび","せはば","せびろ","せぼね","せまい","せまる","せめる","せもたれ","せりふ","ぜんあく","せんい","せんえい","せんか","せんきょ","せんく","せんげん","ぜんご","せんさい","せんしゅ","せんすい","せんせい","せんぞ","せんたく","せんちょう","せんてい","せんとう","せんぬき","せんねん","せんぱい","ぜんぶ","ぜんぽう","せんむ","せんめんじょ","せんもん","せんやく","せんゆう","せんよう","ぜんら","ぜんりゃく","せんれい","せんろ","そあく","そいとげる","そいね","そうがんきょう","そうき","そうご","そうしん","そうだん","そうなん","そうび","そうめん","そうり","そえもの","そえん","そがい","そげき","そこう","そこそこ","そざい","そしな","そせい","そせん","そそぐ","そだてる","そつう","そつえん","そっかん","そつぎょう","そっけつ","そっこう","そっせん","そっと","そとがわ","そとづら","そなえる","そなた","そふぼ","そぼく","そぼろ","そまつ","そまる","そむく","そむりえ","そめる","そもそも","そよかぜ","そらまめ","そろう","そんかい","そんけい","そんざい","そんしつ","そんぞく","そんちょう","ぞんび","ぞんぶん","そんみん","たあい","たいいん","たいうん","たいえき","たいおう","だいがく","たいき","たいぐう","たいけん","たいこ","たいざい","だいじょうぶ","だいすき","たいせつ","たいそう","だいたい","たいちょう","たいてい","だいどころ","たいない","たいねつ","たいのう","たいはん","だいひょう","たいふう","たいへん","たいほ","たいまつばな","たいみんぐ","たいむ","たいめん","たいやき","たいよう","たいら","たいりょく","たいる","たいわん","たうえ","たえる","たおす","たおる","たおれる","たかい","たかね","たきび","たくさん","たこく","たこやき","たさい","たしざん","だじゃれ","たすける","たずさわる","たそがれ","たたかう","たたく","ただしい","たたみ","たちばな","だっかい","だっきゃく","だっこ","だっしゅつ","だったい","たてる","たとえる","たなばた","たにん","たぬき","たのしみ","たはつ","たぶん","たべる","たぼう","たまご","たまる","だむる","ためいき","ためす","ためる","たもつ","たやすい","たよる","たらす","たりきほんがん","たりょう","たりる","たると","たれる","たれんと","たろっと","たわむれる","だんあつ","たんい","たんおん","たんか","たんき","たんけん","たんご","たんさん","たんじょうび","だんせい","たんそく","たんたい","だんち","たんてい","たんとう","だんな","たんにん","だんねつ","たんのう","たんぴん","だんぼう","たんまつ","たんめい","だんれつ","だんろ","だんわ","ちあい","ちあん","ちいき","ちいさい","ちえん","ちかい","ちから","ちきゅう","ちきん","ちけいず","ちけん","ちこく","ちさい","ちしき","ちしりょう","ちせい","ちそう","ちたい","ちたん","ちちおや","ちつじょ","ちてき","ちてん","ちぬき","ちぬり","ちのう","ちひょう","ちへいせん","ちほう","ちまた","ちみつ","ちみどろ","ちめいど","ちゃんこなべ","ちゅうい","ちゆりょく","ちょうし","ちょさくけん","ちらし","ちらみ","ちりがみ","ちりょう","ちるど","ちわわ","ちんたい","ちんもく","ついか","ついたち","つうか","つうじょう","つうはん","つうわ","つかう","つかれる","つくね","つくる","つけね","つける","つごう","つたえる","つづく","つつじ","つつむ","つとめる","つながる","つなみ","つねづね","つのる","つぶす","つまらない","つまる","つみき","つめたい","つもり","つもる","つよい","つるぼ","つるみく","つわもの","つわり","てあし","てあて","てあみ","ていおん","ていか","ていき","ていけい","ていこく","ていさつ","ていし","ていせい","ていたい","ていど","ていねい","ていひょう","ていへん","ていぼう","てうち","ておくれ","てきとう","てくび","でこぼこ","てさぎょう","てさげ","てすり","てそう","てちがい","てちょう","てつがく","てつづき","でっぱ","てつぼう","てつや","でぬかえ","てぬき","てぬぐい","てのひら","てはい","てぶくろ","てふだ","てほどき","てほん","てまえ","てまきずし","てみじか","てみやげ","てらす","てれび","てわけ","てわたし","でんあつ","てんいん","てんかい","てんき","てんぐ","てんけん","てんごく","てんさい","てんし","てんすう","でんち","てんてき","てんとう","てんない","てんぷら","てんぼうだい","てんめつ","てんらんかい","でんりょく","でんわ","どあい","といれ","どうかん","とうきゅう","どうぐ","とうし","とうむぎ","とおい","とおか","とおく","とおす","とおる","とかい","とかす","ときおり","ときどき","とくい","とくしゅう","とくてん","とくに","とくべつ","とけい","とける","とこや","とさか","としょかん","とそう","とたん","とちゅう","とっきゅう","とっくん","とつぜん","とつにゅう","とどける","ととのえる","とない","となえる","となり","とのさま","とばす","どぶがわ","とほう","とまる","とめる","ともだち","ともる","どようび","とらえる","とんかつ","どんぶり","ないかく","ないこう","ないしょ","ないす","ないせん","ないそう","なおす","ながい","なくす","なげる","なこうど","なさけ","なたでここ","なっとう","なつやすみ","ななおし","なにごと","なにもの","なにわ","なのか","なふだ","なまいき","なまえ","なまみ","なみだ","なめらか","なめる","なやむ","ならう","ならび","ならぶ","なれる","なわとび","なわばり","にあう","にいがた","にうけ","におい","にかい","にがて","にきび","にくしみ","にくまん","にげる","にさんかたんそ","にしき","にせもの","にちじょう","にちようび","にっか","にっき","にっけい","にっこう","にっさん","にっしょく","にっすう","にっせき","にってい","になう","にほん","にまめ","にもつ","にやり","にゅういん","にりんしゃ","にわとり","にんい","にんか","にんき","にんげん","にんしき","にんずう","にんそう","にんたい","にんち","にんてい","にんにく","にんぷ","にんまり","にんむ","にんめい","にんよう","ぬいくぎ","ぬかす","ぬぐいとる","ぬぐう","ぬくもり","ぬすむ","ぬまえび","ぬめり","ぬらす","ぬんちゃく","ねあげ","ねいき","ねいる","ねいろ","ねぐせ","ねくたい","ねくら","ねこぜ","ねこむ","ねさげ","ねすごす","ねそべる","ねだん","ねつい","ねっしん","ねつぞう","ねったいぎょ","ねぶそく","ねふだ","ねぼう","ねほりはほり","ねまき","ねまわし","ねみみ","ねむい","ねむたい","ねもと","ねらう","ねわざ","ねんいり","ねんおし","ねんかん","ねんきん","ねんぐ","ねんざ","ねんし","ねんちゃく","ねんど","ねんぴ","ねんぶつ","ねんまつ","ねんりょう","ねんれい","のいず","のおづま","のがす","のきなみ","のこぎり","のこす","のこる","のせる","のぞく","のぞむ","のたまう","のちほど","のっく","のばす","のはら","のべる","のぼる","のみもの","のやま","のらいぬ","のらねこ","のりもの","のりゆき","のれん","のんき","ばあい","はあく","ばあさん","ばいか","ばいく","はいけん","はいご","はいしん","はいすい","はいせん","はいそう","はいち","ばいばい","はいれつ","はえる","はおる","はかい","ばかり","はかる","はくしゅ","はけん","はこぶ","はさみ","はさん","はしご","ばしょ","はしる","はせる","ぱそこん","はそん","はたん","はちみつ","はつおん","はっかく","はづき","はっきり","はっくつ","はっけん","はっこう","はっさん","はっしん","はったつ","はっちゅう","はってん","はっぴょう","はっぽう","はなす","はなび","はにかむ","はぶらし","はみがき","はむかう","はめつ","はやい","はやし","はらう","はろうぃん","はわい","はんい","はんえい","はんおん","はんかく","はんきょう","ばんぐみ","はんこ","はんしゃ","はんすう","はんだん","ぱんち","ぱんつ","はんてい","はんとし","はんのう","はんぱ","はんぶん","はんぺん","はんぼうき","はんめい","はんらん","はんろん","ひいき","ひうん","ひえる","ひかく","ひかり","ひかる","ひかん","ひくい","ひけつ","ひこうき","ひこく","ひさい","ひさしぶり","ひさん","びじゅつかん","ひしょ","ひそか","ひそむ","ひたむき","ひだり","ひたる","ひつぎ","ひっこし","ひっし","ひつじゅひん","ひっす","ひつぜん","ぴったり","ぴっちり","ひつよう","ひてい","ひとごみ","ひなまつり","ひなん","ひねる","ひはん","ひびく","ひひょう","ひほう","ひまわり","ひまん","ひみつ","ひめい","ひめじし","ひやけ","ひやす","ひよう","びょうき","ひらがな","ひらく","ひりつ","ひりょう","ひるま","ひるやすみ","ひれい","ひろい","ひろう","ひろき","ひろゆき","ひんかく","ひんけつ","ひんこん","ひんしゅ","ひんそう","ぴんち","ひんぱん","びんぼう","ふあん","ふいうち","ふうけい","ふうせん","ぷうたろう","ふうとう","ふうふ","ふえる","ふおん","ふかい","ふきん","ふくざつ","ふくぶくろ","ふこう","ふさい","ふしぎ","ふじみ","ふすま","ふせい","ふせぐ","ふそく","ぶたにく","ふたん","ふちょう","ふつう","ふつか","ふっかつ","ふっき","ふっこく","ぶどう","ふとる","ふとん","ふのう","ふはい","ふひょう","ふへん","ふまん","ふみん","ふめつ","ふめん","ふよう","ふりこ","ふりる","ふるい","ふんいき","ぶんがく","ぶんぐ","ふんしつ","ぶんせき","ふんそう","ぶんぽう","へいあん","へいおん","へいがい","へいき","へいげん","へいこう","へいさ","へいしゃ","へいせつ","へいそ","へいたく","へいてん","へいねつ","へいわ","へきが","へこむ","べにいろ","べにしょうが","へらす","へんかん","べんきょう","べんごし","へんさい","へんたい","べんり","ほあん","ほいく","ぼうぎょ","ほうこく","ほうそう","ほうほう","ほうもん","ほうりつ","ほえる","ほおん","ほかん","ほきょう","ぼきん","ほくろ","ほけつ","ほけん","ほこう","ほこる","ほしい","ほしつ","ほしゅ","ほしょう","ほせい","ほそい","ほそく","ほたて","ほたる","ぽちぶくろ","ほっきょく","ほっさ","ほったん","ほとんど","ほめる","ほんい","ほんき","ほんけ","ほんしつ","ほんやく","まいにち","まかい","まかせる","まがる","まける","まこと","まさつ","まじめ","ますく","まぜる","まつり","まとめ","まなぶ","まぬけ","まねく","まほう","まもる","まゆげ","まよう","まろやか","まわす","まわり","まわる","まんが","まんきつ","まんぞく","まんなか","みいら","みうち","みえる","みがく","みかた","みかん","みけん","みこん","みじかい","みすい","みすえる","みせる","みっか","みつかる","みつける","みてい","みとめる","みなと","みなみかさい","みねらる","みのう","みのがす","みほん","みもと","みやげ","みらい","みりょく","みわく","みんか","みんぞく","むいか","むえき","むえん","むかい","むかう","むかえ","むかし","むぎちゃ","むける","むげん","むさぼる","むしあつい","むしば","むじゅん","むしろ","むすう","むすこ","むすぶ","むすめ","むせる","むせん","むちゅう","むなしい","むのう","むやみ","むよう","むらさき","むりょう","むろん","めいあん","めいうん","めいえん","めいかく","めいきょく","めいさい","めいし","めいそう","めいぶつ","めいれい","めいわく","めぐまれる","めざす","めした","めずらしい","めだつ","めまい","めやす","めんきょ","めんせき","めんどう","もうしあげる","もうどうけん","もえる","もくし","もくてき","もくようび","もちろん","もどる","もらう","もんく","もんだい","やおや","やける","やさい","やさしい","やすい","やすたろう","やすみ","やせる","やそう","やたい","やちん","やっと","やっぱり","やぶる","やめる","ややこしい","やよい","やわらかい","ゆうき","ゆうびんきょく","ゆうべ","ゆうめい","ゆけつ","ゆしゅつ","ゆせん","ゆそう","ゆたか","ゆちゃく","ゆでる","ゆにゅう","ゆびわ","ゆらい","ゆれる","ようい","ようか","ようきゅう","ようじ","ようす","ようちえん","よかぜ","よかん","よきん","よくせい","よくぼう","よけい","よごれる","よさん","よしゅう","よそう","よそく","よっか","よてい","よどがわく","よねつ","よやく","よゆう","よろこぶ","よろしい","らいう","らくがき","らくご","らくさつ","らくだ","らしんばん","らせん","らぞく","らたい","らっか","られつ","りえき","りかい","りきさく","りきせつ","りくぐん","りくつ","りけん","りこう","りせい","りそう","りそく","りてん","りねん","りゆう","りゅうがく","りよう","りょうり","りょかん","りょくちゃ","りょこう","りりく","りれき","りろん","りんご","るいけい","るいさい","るいじ","るいせき","るすばん","るりがわら","れいかん","れいぎ","れいせい","れいぞうこ","れいとう","れいぼう","れきし","れきだい","れんあい","れんけい","れんこん","れんさい","れんしゅう","れんぞく","れんらく","ろうか","ろうご","ろうじん","ろうそく","ろくが","ろこつ","ろじうら","ろしゅつ","ろせん","ろてん","ろめん","ろれつ","ろんぎ","ろんぱ","ろんぶん","ろんり","わかす","わかめ","わかやま","わかれる","わしつ","わじまし","わすれもの","わらう","われる"]},function(t,e,i){"use strict";t.exports=["ábaco","abdomen","abeja","abierto","abogado","abono","aborto","abrazo","abrir","abuelo","abuso","acabar","academia","acceso","acción","aceite","acelga","acento","aceptar","ácido","aclarar","acné","acoger","acoso","activo","acto","actriz","actuar","acudir","acuerdo","acusar","adicto","admitir","adoptar","adorno","aduana","adulto","aéreo","afectar","afición","afinar","afirmar","ágil","agitar","agonía","agosto","agotar","agregar","agrio","agua","agudo","águila","aguja","ahogo","ahorro","aire","aislar","ajedrez","ajeno","ajuste","alacrán","alambre","alarma","alba","álbum","alcalde","aldea","alegre","alejar","alerta","aleta","alfiler","alga","algodón","aliado","aliento","alivio","alma","almeja","almíbar","altar","alteza","altivo","alto","altura","alumno","alzar","amable","amante","amapola","amargo","amasar","ámbar","ámbito","ameno","amigo","amistad","amor","amparo","amplio","ancho","anciano","ancla","andar","andén","anemia","ángulo","anillo","ánimo","anís","anotar","antena","antiguo","antojo","anual","anular","anuncio","añadir","añejo","año","apagar","aparato","apetito","apio","aplicar","apodo","aporte","apoyo","aprender","aprobar","apuesta","apuro","arado","araña","arar","árbitro","árbol","arbusto","archivo","arco","arder","ardilla","arduo","área","árido","aries","armonía","arnés","aroma","arpa","arpón","arreglo","arroz","arruga","arte","artista","asa","asado","asalto","ascenso","asegurar","aseo","asesor","asiento","asilo","asistir","asno","asombro","áspero","astilla","astro","astuto","asumir","asunto","atajo","ataque","atar","atento","ateo","ático","atleta","átomo","atraer","atroz","atún","audaz","audio","auge","aula","aumento","ausente","autor","aval","avance","avaro","ave","avellana","avena","avestruz","avión","aviso","ayer","ayuda","ayuno","azafrán","azar","azote","azúcar","azufre","azul","baba","babor","bache","bahía","baile","bajar","balanza","balcón","balde","bambú","banco","banda","baño","barba","barco","barniz","barro","báscula","bastón","basura","batalla","batería","batir","batuta","baúl","bazar","bebé","bebida","bello","besar","beso","bestia","bicho","bien","bingo","blanco","bloque","blusa","boa","bobina","bobo","boca","bocina","boda","bodega","boina","bola","bolero","bolsa","bomba","bondad","bonito","bono","bonsái","borde","borrar","bosque","bote","botín","bóveda","bozal","bravo","brazo","brecha","breve","brillo","brinco","brisa","broca","broma","bronce","brote","bruja","brusco","bruto","buceo","bucle","bueno","buey","bufanda","bufón","búho","buitre","bulto","burbuja","burla","burro","buscar","butaca","buzón","caballo","cabeza","cabina","cabra","cacao","cadáver","cadena","caer","café","caída","caimán","caja","cajón","cal","calamar","calcio","caldo","calidad","calle","calma","calor","calvo","cama","cambio","camello","camino","campo","cáncer","candil","canela","canguro","canica","canto","caña","cañón","caoba","caos","capaz","capitán","capote","captar","capucha","cara","carbón","cárcel","careta","carga","cariño","carne","carpeta","carro","carta","casa","casco","casero","caspa","castor","catorce","catre","caudal","causa","cazo","cebolla","ceder","cedro","celda","célebre","celoso","célula","cemento","ceniza","centro","cerca","cerdo","cereza","cero","cerrar","certeza","césped","cetro","chacal","chaleco","champú","chancla","chapa","charla","chico","chiste","chivo","choque","choza","chuleta","chupar","ciclón","ciego","cielo","cien","cierto","cifra","cigarro","cima","cinco","cine","cinta","ciprés","circo","ciruela","cisne","cita","ciudad","clamor","clan","claro","clase","clave","cliente","clima","clínica","cobre","cocción","cochino","cocina","coco","código","codo","cofre","coger","cohete","cojín","cojo","cola","colcha","colegio","colgar","colina","collar","colmo","columna","combate","comer","comida","cómodo","compra","conde","conejo","conga","conocer","consejo","contar","copa","copia","corazón","corbata","corcho","cordón","corona","correr","coser","cosmos","costa","cráneo","cráter","crear","crecer","creído","crema","cría","crimen","cripta","crisis","cromo","crónica","croqueta","crudo","cruz","cuadro","cuarto","cuatro","cubo","cubrir","cuchara","cuello","cuento","cuerda","cuesta","cueva","cuidar","culebra","culpa","culto","cumbre","cumplir","cuna","cuneta","cuota","cupón","cúpula","curar","curioso","curso","curva","cutis","dama","danza","dar","dardo","dátil","deber","débil","década","decir","dedo","defensa","definir","dejar","delfín","delgado","delito","demora","denso","dental","deporte","derecho","derrota","desayuno","deseo","desfile","desnudo","destino","desvío","detalle","detener","deuda","día","diablo","diadema","diamante","diana","diario","dibujo","dictar","diente","dieta","diez","difícil","digno","dilema","diluir","dinero","directo","dirigir","disco","diseño","disfraz","diva","divino","doble","doce","dolor","domingo","don","donar","dorado","dormir","dorso","dos","dosis","dragón","droga","ducha","duda","duelo","dueño","dulce","dúo","duque","durar","dureza","duro","ébano","ebrio","echar","eco","ecuador","edad","edición","edificio","editor","educar","efecto","eficaz","eje","ejemplo","elefante","elegir","elemento","elevar","elipse","élite","elixir","elogio","eludir","embudo","emitir","emoción","empate","empeño","empleo","empresa","enano","encargo","enchufe","encía","enemigo","enero","enfado","enfermo","engaño","enigma","enlace","enorme","enredo","ensayo","enseñar","entero","entrar","envase","envío","época","equipo","erizo","escala","escena","escolar","escribir","escudo","esencia","esfera","esfuerzo","espada","espejo","espía","esposa","espuma","esquí","estar","este","estilo","estufa","etapa","eterno","ética","etnia","evadir","evaluar","evento","evitar","exacto","examen","exceso","excusa","exento","exigir","exilio","existir","éxito","experto","explicar","exponer","extremo","fábrica","fábula","fachada","fácil","factor","faena","faja","falda","fallo","falso","faltar","fama","familia","famoso","faraón","farmacia","farol","farsa","fase","fatiga","fauna","favor","fax","febrero","fecha","feliz","feo","feria","feroz","fértil","fervor","festín","fiable","fianza","fiar","fibra","ficción","ficha","fideo","fiebre","fiel","fiera","fiesta","figura","fijar","fijo","fila","filete","filial","filtro","fin","finca","fingir","finito","firma","flaco","flauta","flecha","flor","flota","fluir","flujo","flúor","fobia","foca","fogata","fogón","folio","folleto","fondo","forma","forro","fortuna","forzar","fosa","foto","fracaso","frágil","franja","frase","fraude","freír","freno","fresa","frío","frito","fruta","fuego","fuente","fuerza","fuga","fumar","función","funda","furgón","furia","fusil","fútbol","futuro","gacela","gafas","gaita","gajo","gala","galería","gallo","gamba","ganar","gancho","ganga","ganso","garaje","garza","gasolina","gastar","gato","gavilán","gemelo","gemir","gen","género","genio","gente","geranio","gerente","germen","gesto","gigante","gimnasio","girar","giro","glaciar","globo","gloria","gol","golfo","goloso","golpe","goma","gordo","gorila","gorra","gota","goteo","gozar","grada","gráfico","grano","grasa","gratis","grave","grieta","grillo","gripe","gris","grito","grosor","grúa","grueso","grumo","grupo","guante","guapo","guardia","guerra","guía","guiño","guion","guiso","guitarra","gusano","gustar","haber","hábil","hablar","hacer","hacha","hada","hallar","hamaca","harina","haz","hazaña","hebilla","hebra","hecho","helado","helio","hembra","herir","hermano","héroe","hervir","hielo","hierro","hígado","higiene","hijo","himno","historia","hocico","hogar","hoguera","hoja","hombre","hongo","honor","honra","hora","hormiga","horno","hostil","hoyo","hueco","huelga","huerta","hueso","huevo","huida","huir","humano","húmedo","humilde","humo","hundir","huracán","hurto","icono","ideal","idioma","ídolo","iglesia","iglú","igual","ilegal","ilusión","imagen","imán","imitar","impar","imperio","imponer","impulso","incapaz","índice","inerte","infiel","informe","ingenio","inicio","inmenso","inmune","innato","insecto","instante","interés","íntimo","intuir","inútil","invierno","ira","iris","ironía","isla","islote","jabalí","jabón","jamón","jarabe","jardín","jarra","jaula","jazmín","jefe","jeringa","jinete","jornada","joroba","joven","joya","juerga","jueves","juez","jugador","jugo","juguete","juicio","junco","jungla","junio","juntar","júpiter","jurar","justo","juvenil","juzgar","kilo","koala","labio","lacio","lacra","lado","ladrón","lagarto","lágrima","laguna","laico","lamer","lámina","lámpara","lana","lancha","langosta","lanza","lápiz","largo","larva","lástima","lata","látex","latir","laurel","lavar","lazo","leal","lección","leche","lector","leer","legión","legumbre","lejano","lengua","lento","leña","león","leopardo","lesión","letal","letra","leve","leyenda","libertad","libro","licor","líder","lidiar","lienzo","liga","ligero","lima","límite","limón","limpio","lince","lindo","línea","lingote","lino","linterna","líquido","liso","lista","litera","litio","litro","llaga","llama","llanto","llave","llegar","llenar","llevar","llorar","llover","lluvia","lobo","loción","loco","locura","lógica","logro","lombriz","lomo","lonja","lote","lucha","lucir","lugar","lujo","luna","lunes","lupa","lustro","luto","luz","maceta","macho","madera","madre","maduro","maestro","mafia","magia","mago","maíz","maldad","maleta","malla","malo","mamá","mambo","mamut","manco","mando","manejar","manga","maniquí","manjar","mano","manso","manta","mañana","mapa","máquina","mar","marco","marea","marfil","margen","marido","mármol","marrón","martes","marzo","masa","máscara","masivo","matar","materia","matiz","matriz","máximo","mayor","mazorca","mecha","medalla","medio","médula","mejilla","mejor","melena","melón","memoria","menor","mensaje","mente","menú","mercado","merengue","mérito","mes","mesón","meta","meter","método","metro","mezcla","miedo","miel","miembro","miga","mil","milagro","militar","millón","mimo","mina","minero","mínimo","minuto","miope","mirar","misa","miseria","misil","mismo","mitad","mito","mochila","moción","moda","modelo","moho","mojar","molde","moler","molino","momento","momia","monarca","moneda","monja","monto","moño","morada","morder","moreno","morir","morro","morsa","mortal","mosca","mostrar","motivo","mover","móvil","mozo","mucho","mudar","mueble","muela","muerte","muestra","mugre","mujer","mula","muleta","multa","mundo","muñeca","mural","muro","músculo","museo","musgo","música","muslo","nácar","nación","nadar","naipe","naranja","nariz","narrar","nasal","natal","nativo","natural","náusea","naval","nave","navidad","necio","néctar","negar","negocio","negro","neón","nervio","neto","neutro","nevar","nevera","nicho","nido","niebla","nieto","niñez","niño","nítido","nivel","nobleza","noche","nómina","noria","norma","norte","nota","noticia","novato","novela","novio","nube","nuca","núcleo","nudillo","nudo","nuera","nueve","nuez","nulo","número","nutria","oasis","obeso","obispo","objeto","obra","obrero","observar","obtener","obvio","oca","ocaso","océano","ochenta","ocho","ocio","ocre","octavo","octubre","oculto","ocupar","ocurrir","odiar","odio","odisea","oeste","ofensa","oferta","oficio","ofrecer","ogro","oído","oír","ojo","ola","oleada","olfato","olivo","olla","olmo","olor","olvido","ombligo","onda","onza","opaco","opción","ópera","opinar","oponer","optar","óptica","opuesto","oración","orador","oral","órbita","orca","orden","oreja","órgano","orgía","orgullo","oriente","origen","orilla","oro","orquesta","oruga","osadía","oscuro","osezno","oso","ostra","otoño","otro","oveja","óvulo","óxido","oxígeno","oyente","ozono","pacto","padre","paella","página","pago","país","pájaro","palabra","palco","paleta","pálido","palma","paloma","palpar","pan","panal","pánico","pantera","pañuelo","papá","papel","papilla","paquete","parar","parcela","pared","parir","paro","párpado","parque","párrafo","parte","pasar","paseo","pasión","paso","pasta","pata","patio","patria","pausa","pauta","pavo","payaso","peatón","pecado","pecera","pecho","pedal","pedir","pegar","peine","pelar","peldaño","pelea","peligro","pellejo","pelo","peluca","pena","pensar","peñón","peón","peor","pepino","pequeño","pera","percha","perder","pereza","perfil","perico","perla","permiso","perro","persona","pesa","pesca","pésimo","pestaña","pétalo","petróleo","pez","pezuña","picar","pichón","pie","piedra","pierna","pieza","pijama","pilar","piloto","pimienta","pino","pintor","pinza","piña","piojo","pipa","pirata","pisar","piscina","piso","pista","pitón","pizca","placa","plan","plata","playa","plaza","pleito","pleno","plomo","pluma","plural","pobre","poco","poder","podio","poema","poesía","poeta","polen","policía","pollo","polvo","pomada","pomelo","pomo","pompa","poner","porción","portal","posada","poseer","posible","poste","potencia","potro","pozo","prado","precoz","pregunta","premio","prensa","preso","previo","primo","príncipe","prisión","privar","proa","probar","proceso","producto","proeza","profesor","programa","prole","promesa","pronto","propio","próximo","prueba","público","puchero","pudor","pueblo","puerta","puesto","pulga","pulir","pulmón","pulpo","pulso","puma","punto","puñal","puño","pupa","pupila","puré","quedar","queja","quemar","querer","queso","quieto","química","quince","quitar","rábano","rabia","rabo","ración","radical","raíz","rama","rampa","rancho","rango","rapaz","rápido","rapto","rasgo","raspa","rato","rayo","raza","razón","reacción","realidad","rebaño","rebote","recaer","receta","rechazo","recoger","recreo","recto","recurso","red","redondo","reducir","reflejo","reforma","refrán","refugio","regalo","regir","regla","regreso","rehén","reino","reír","reja","relato","relevo","relieve","relleno","reloj","remar","remedio","remo","rencor","rendir","renta","reparto","repetir","reposo","reptil","res","rescate","resina","respeto","resto","resumen","retiro","retorno","retrato","reunir","revés","revista","rey","rezar","rico","riego","rienda","riesgo","rifa","rígido","rigor","rincón","riñón","río","riqueza","risa","ritmo","rito","rizo","roble","roce","rociar","rodar","rodeo","rodilla","roer","rojizo","rojo","romero","romper","ron","ronco","ronda","ropa","ropero","rosa","rosca","rostro","rotar","rubí","rubor","rudo","rueda","rugir","ruido","ruina","ruleta","rulo","rumbo","rumor","ruptura","ruta","rutina","sábado","saber","sabio","sable","sacar","sagaz","sagrado","sala","saldo","salero","salir","salmón","salón","salsa","salto","salud","salvar","samba","sanción","sandía","sanear","sangre","sanidad","sano","santo","sapo","saque","sardina","sartén","sastre","satán","sauna","saxofón","sección","seco","secreto","secta","sed","seguir","seis","sello","selva","semana","semilla","senda","sensor","señal","señor","separar","sepia","sequía","ser","serie","sermón","servir","sesenta","sesión","seta","setenta","severo","sexo","sexto","sidra","siesta","siete","siglo","signo","sílaba","silbar","silencio","silla","símbolo","simio","sirena","sistema","sitio","situar","sobre","socio","sodio","sol","solapa","soldado","soledad","sólido","soltar","solución","sombra","sondeo","sonido","sonoro","sonrisa","sopa","soplar","soporte","sordo","sorpresa","sorteo","sostén","sótano","suave","subir","suceso","sudor","suegra","suelo","sueño","suerte","sufrir","sujeto","sultán","sumar","superar","suplir","suponer","supremo","sur","surco","sureño","surgir","susto","sutil","tabaco","tabique","tabla","tabú","taco","tacto","tajo","talar","talco","talento","talla","talón","tamaño","tambor","tango","tanque","tapa","tapete","tapia","tapón","taquilla","tarde","tarea","tarifa","tarjeta","tarot","tarro","tarta","tatuaje","tauro","taza","tazón","teatro","techo","tecla","técnica","tejado","tejer","tejido","tela","teléfono","tema","temor","templo","tenaz","tender","tener","tenis","tenso","teoría","terapia","terco","término","ternura","terror","tesis","tesoro","testigo","tetera","texto","tez","tibio","tiburón","tiempo","tienda","tierra","tieso","tigre","tijera","tilde","timbre","tímido","timo","tinta","tío","típico","tipo","tira","tirón","titán","títere","título","tiza","toalla","tobillo","tocar","tocino","todo","toga","toldo","tomar","tono","tonto","topar","tope","toque","tórax","torero","tormenta","torneo","toro","torpedo","torre","torso","tortuga","tos","tosco","toser","tóxico","trabajo","tractor","traer","tráfico","trago","traje","tramo","trance","trato","trauma","trazar","trébol","tregua","treinta","tren","trepar","tres","tribu","trigo","tripa","triste","triunfo","trofeo","trompa","tronco","tropa","trote","trozo","truco","trueno","trufa","tubería","tubo","tuerto","tumba","tumor","túnel","túnica","turbina","turismo","turno","tutor","ubicar","úlcera","umbral","unidad","unir","universo","uno","untar","uña","urbano","urbe","urgente","urna","usar","usuario","útil","utopía","uva","vaca","vacío","vacuna","vagar","vago","vaina","vajilla","vale","válido","valle","valor","válvula","vampiro","vara","variar","varón","vaso","vecino","vector","vehículo","veinte","vejez","vela","velero","veloz","vena","vencer","venda","veneno","vengar","venir","venta","venus","ver","verano","verbo","verde","vereda","verja","verso","verter","vía","viaje","vibrar","vicio","víctima","vida","vídeo","vidrio","viejo","viernes","vigor","vil","villa","vinagre","vino","viñedo","violín","viral","virgo","virtud","visor","víspera","vista","vitamina","viudo","vivaz","vivero","vivir","vivo","volcán","volumen","volver","voraz","votar","voto","voz","vuelo","vulgar","yacer","yate","yegua","yema","yerno","yeso","yodo","yoga","yogur","zafiro","zanja","zapato","zarza","zona","zorro","zumo","zurdo"]},function(t,e){
/*!
https://github.com/walling/unorm
The software dual licensed under the MIT and GPL licenses. MIT license:

    Copyright (c) 2008-2013 Matsuza <matsuza@gmail.com>, Bjarke Walling <bwp@bwp.dk>

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.

GPL notice (please read the [full GPL license] online):

    Copyright (C) 2008-2013 Matsuza <matsuza@gmail.com>, Bjarke Walling <bwp@bwp.dk>

    This program is free software; you can redistribute it and/or
    modify it under the terms of the GNU General Public License
    as published by the Free Software Foundation; either version 2
    of the License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.


[full GPL license]: http://www.gnu.org/licenses/gpl-2.0-standalone.html
*/
!function(e){"use strict";for(var i=[null,0,{}],r=44032,s=4352,n=function(t,e){this.codepoint=t,this.feature=e},o={},a=[],h=0;h<=255;++h)a[h]=0;n.fromCharCode=[function(t,e,r){return e<60||13311<e&&e<42607?new n(e,i):t(e,r)},function(t,e,i){var r=o[e];return r||(r=t(e,i)).feature&&++a[e>>8&255]>10&&(o[e]=r),r},function(t,e,i){return i?t(e,i):new n(e,null)},function(t,e,i){var o;if(e<s||4371<=e&&e<r||55204<e)return t(e,i);if(s<=e&&e<4371){var a={},h=21*(e-s);for(o=0;o<21;++o)a[4449+o]=r+28*(o+h);return new n(e,[,,a])}var c=e-r,u=c%28,l=[];if(0!==u)l[0]=[r+c-u,4519+u];else for(l[0]=[s+Math.floor(c/588),4449+Math.floor(c%588/28)],l[2]={},o=1;o<28;++o)l[2][4519+o]=e+o;return new n(e,l)},function(t,e,r){var s=(n.udata[65280&e]||{})[e];return new n(e,s||i)}].reduceRight(function(t,e){return function(i,r){return e(t,i,r)}},null),n.isHighSurrogate=function(t){return t>=55296&&t<=56319},n.isLowSurrogate=function(t){return t>=56320&&t<=57343},n.prototype.prepFeature=function(){this.feature||(this.feature=n.fromCharCode(this.codepoint,!0).feature)},n.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var t=this.codepoint-65536;return String.fromCharCode(Math.floor(t/1024)+55296,t%1024+56320)},n.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},n.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&256&this.feature[1]},n.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&512&this.feature[1]},n.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?255&this.feature[1]:0},n.prototype.getComposite=function(t){if(this.prepFeature(),!this.feature[2])return null;var e=this.feature[2][t.codepoint];return e?n.fromCharCode(e):null};var c=function(t){this.str=t,this.cursor=0};c.prototype.next=function(){if(this.str&&this.cursor<this.str.length){var t,e=this.str.charCodeAt(this.cursor++);return n.isHighSurrogate(e)&&this.cursor<this.str.length&&n.isLowSurrogate(t=this.str.charCodeAt(this.cursor))&&(e=1024*(e-55296)+(t-56320)+65536,++this.cursor),n.fromCharCode(e)}return this.str=null,null};var u=function(t,e){this.it=t,this.canonical=e,this.resBuf=[]};u.prototype.next=function(){if(0===this.resBuf.length){var t=this.it.next();if(!t)return null;this.resBuf=function t(e,i){var r=i.getDecomp();if(!r||e&&i.isCompatibility())return[i];for(var s=[],o=0;o<r.length;++o){var a=t(e,n.fromCharCode(r[o]));s=s.concat(a)}return s}(this.canonical,t)}return this.resBuf.shift()};var l=function(t){this.it=t,this.resBuf=[]};l.prototype.next=function(){var t;if(0===this.resBuf.length)do{var e=this.it.next();if(!e)break;t=e.getCanonicalClass();var i=this.resBuf.length;if(0!==t)for(;i>0&&!(this.resBuf[i-1].getCanonicalClass()<=t);--i);this.resBuf.splice(i,0,e)}while(0!==t);return this.resBuf.shift()};var f=function(t){this.it=t,this.procBuf=[],this.resBuf=[],this.lastClass=null};f.prototype.next=function(){for(;0===this.resBuf.length;){var t=this.it.next();if(!t){this.resBuf=this.procBuf,this.procBuf=[];break}if(0===this.procBuf.length)this.lastClass=t.getCanonicalClass(),this.procBuf.push(t);else{var e=this.procBuf[0].getComposite(t),i=t.getCanonicalClass();e&&(this.lastClass<i||0===this.lastClass)?this.procBuf[0]=e:(0===i&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=i,this.procBuf.push(t))}}return this.resBuf.shift()};var d=function(t,e){for(var i,r=function(t,e){switch(t){case"NFD":return new l(new u(new c(e),!0));case"NFKD":return new l(new u(new c(e),!1));case"NFC":return new f(new l(new u(new c(e),!0)));case"NFKC":return new f(new l(new u(new c(e),!1)))}throw t+" is invalid"}(t,e),s="";i=r.next();)s+=i.toString();return s};n.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8000:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13000:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43000:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],120000:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195000:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64000:{64000:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var p={nfc:function(t){return d("NFC",t)},nfd:function(t){return d("NFD",t)},nfkc:function(t){return d("NFKC",t)},nfkd:function(t){return d("NFKD",t)}};t.exports=p}()},function(t,e,i){"use strict";(function(e){var i=4294967296,r=624,s=397,n=2147483648,o=2147483647,a=2567483615,h=null;class c{constructor(t){void 0===t&&(t=(new Date).getTime()),this.mt=new Array(r),this.mti=r+1,this.seed(t)}seed(t){var e;for(this.mt[0]=t>>>0,this.mti=1;this.mti<r;this.mti++)e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}seedArray(t){var e,i=1,s=0,n=r>t.length?r:t.length;for(this.seed(19650218);n>0;n--)e=this.mt[i-1]^this.mt[i-1]>>>30,this.mt[i]=(this.mt[i]^(1664525*((4294901760&e)>>>16)<<16)+1664525*(65535&e))+t[s]+s,this.mt[i]>>>=0,s++,++i>=r&&(this.mt[0]=this.mt[r-1],i=1),s>=t.length&&(s=0);for(n=r-1;n;n--)e=this.mt[i-1]^this.mt[i-1]>>>30,this.mt[i]=(this.mt[i]^(1566083941*((4294901760&e)>>>16)<<16)+1566083941*(65535&e))-i,this.mt[i]>>>=0,++i>=r&&(this.mt[0]=this.mt[r-1],i=1);this.mt[0]=2147483648}int(){var t,e,i=new Array(0,a);if(this.mti>=r){for(this.mti===r+1&&this.seed(5489),e=0;e<r-s;e++)t=this.mt[e]&n|this.mt[e+1]&o,this.mt[e]=this.mt[e+s]^t>>>1^i[1&t];for(;e<r-1;e++)t=this.mt[e]&n|this.mt[e+1]&o,this.mt[e]=this.mt[e+(s-r)]^t>>>1^i[1&t];t=this.mt[r-1]&n|this.mt[0]&o,this.mt[r-1]=this.mt[s-1]^t>>>1^i[1&t],this.mti=0}return t=this.mt[this.mti++],t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,(t^=t>>>18)>>>0}randomBytes(t){let i=e.alloc(t);for(let e=0;e<t;e+=4)i.writeUInt32LE(this.int(),e);return i}int31(){return this.int()>>>1}real(){return this.int()*(1/(i-1))}realx(){return(this.int()+.5)*(1/i)}random(){return this.int()*(1/i)}rndHiRes(){return(67108864*(this.int()>>>5)+(this.int()>>>6))*(1/9007199254740992)}static random(){return h||(h=new c),h.random()}}t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * http/index.js - http for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.Base=i(505),e.conn_c2s=i(506),e.request=i(507),e.Server=i(359),e.accessWallet=i(406)},function(t,e,i){"use strict";e.unsupported=!0},function(t,e,i){"use strict";e.unsupported=!0},function(t,e,i){"use strict";e.unsupported=!0},function(t,e,i){"use strict";
/*!
 * conn_s2local.js - 为实现关注点分离而设定的模拟客户端，实现钱包和主节点间的交互功能
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(59),{openapi:s}=i(362);t.exports=class extends r{constructor(t){super(),this.node=t,this.network=t.network,this.filter=null,this.listen=!1,this._init()}_init(){this.node.on("chain.connect",(t,e)=>{this.listen&&this.emit("block.connect",t,e.txs)}),this.node.on("chain.disconnect",(t,e)=>{this.listen&&this.emit("block.disconnect",t)}),this.node.on("chain.full",()=>{this.listen&&this.emit("chain.full")}),this.node.on("tx",t=>{this.listen&&this.emit("tx",t)}),this.node.on("entry.remove",t=>{this.emit("entry.remove",t)}),this.node.on("chain.reset",t=>{this.listen&&this.emit("chain.reset",t)})}_open(t){return this.listen=!0,Promise.resolve()}_close(){return this.listen=!1,Promise.resolve()}getTip(){return Promise.resolve(this.node.chain.tip)}async getEntry(t){const e=await this.node.chain.getEntry(t);return e&&await this.node.chain.isMainChain(e)?e:null}async getTX(t){if(!this.node||!this.node.chain)return null;let e=null;return this.node.mempool&&(e=await this.node.mempool.getTX(t)),e||(e=await this.node.chain.getTX(t)),e}watchOutpoint(t){this.node.pool.watchOutpoint(t)}async execute(t,e,i){e=e||[],Array.isArray(e)||(e=[e]);let r=s[t];if(r){let t=null;if(this.node.spv)t=await this.node.$remoteCall(r,e,i);else if(t=await this.node.$localCall(r,e,i),r.remoteCb){let e=this.node.require("walletdb");t=await r.remoteCb.call({wdb:e},t)}return t}}async send(t){return await this.node.relay(t),Promise.resolve()}async removeTX(t){return await this.node.removeTX(t),Promise.resolve()}setFilter(t){return this.filter=t,this.node.pool.setFilter(t),Promise.resolve()}addFilter(t){return this.node.pool.watch(t),Promise.resolve()}resetFilter(){return this.node.pool.queueFilterLoad(),Promise.resolve()}async estimateFee(t){return this.node.fees?this.node.fees.estimateFee(t):this.network.feeRate}async verifyCPRegister(t){return{}}async verifyCPChange(t){return{}}rescan(t){return this.node.chain.scan(t,this.filter,(t,e)=>this.fire("block.rescan",t,e))}}},function(t,e,i){const r=i(179);t.exports=[{name:"cp.flush",method:"jsonp",path:"/",callback:async function(t,e){const i=new r([e]);let s=i.array(0,[]),n=i.uint(1,1);return t.cpList.getCPList(s,{page:n})},remoteCb:async function(t){for(let e of t)await this.wdb.addCpItem(e)}},{name:"cps",method:"get",path:"/public/cps",callback:async function(t,e){let i={page:t.valid().u32("page",1),pageCount:0},r=this.node.cpList.getCPList([],i);return JSON.stringify({list:r,page:i.page,total:i.pageCount})}},{name:"cp.list",method:"jsonp",path:"/",callback:async function(t,e){const i=new r([e]);let s={page:i.uint(0,1),pageSize:i.uint(1,10),pageCount:0};return{list:t.cpList.getCPList([],s),page:s.page,total:s.pageCount}},remoteCb:async function(t){for(let e of t.list)await this.wdb.addCpItem(e);return t}},{name:"cpById",method:"get",path:"/public/cp/:id",callback:async function(t,e){const i=t.valid(),r=i.u32("page",1),s=i.str("id");let n=s?[s]:[],o=this.node.cpList.getCPList(n,{page:r});return o&&o.length>0?o[0]:null}},{name:"cpByName",method:"get",path:"/public/cp/name/:name",callback:async function(t,e){const i=t.valid(),r=i.u32("page",1),s=decodeURIComponent(i.str("name"));let n=s?[s]:[],o=this.node.cpList.getCPListByName(n,{page:r});return o&&o.length>0?o[0]:null}}]},function(t,e){t.exports=[{name:"queryProps",method:"post",path:"/public/prop/query",callback:async function(t,e){const i=t.valid(),r=i.u32("game_id"),s=i.u32("user_addr");return await this.node.queryProps(r,s)}}]},function(t,e,i){const r=i(179),s=i(3),n=i(70),o=i(53),{contractStatus:a}=i(8),h=i(121).txdb,c=i(79),{broadcast:u}=i(202),l=i(178),f=i(4);t.exports=[{name:"token.random",method:"jsonp",path:"/",callback:async function(t,e,i){if(1!==e.length)throw new RPCError(errs.MISC_ERROR,"token.random clientNo: 生成令牌随机量 终端编码");let n=new r([e]).str(0);const{random:o}=await l.fromKey(f.ONE_HASH,t.hmacSalt).getHMAC(s.hashInt(n));return o}},{name:"mempool.watch",method:"jsonp",path:"/",callback:async function(t,e,i){i.join("mempool")}},{name:"mempool.unwatch",method:"jsonp",path:"/",callback:async function(t,e,i){i.leave("mempool")}},{name:"chain.watch",method:"jsonp",path:"/",callback:async function(t,e,i){i.join("chain")}},{name:"chain.unwatch",method:"jsonp",path:"/",callback:async function(t,e,i){i.leave("chain")}},{name:"chain.rescan",method:"jsonp",path:"/",callback:async function(t,e,i){const s=new r([e]).numhash(0);if(null==s)throw new Error("Invalid parameter.");return t.scan(i,s)}},{name:"subscribe",method:"jsonp",path:"/",callback:async function(t,e,i){return i.bus.subscribe(e[0]),!0}},{name:"unsubscribe",method:"jsonp",path:"/",callback:async function(t,e,i){return i.bus.unsubscribe(e[0]),!0}},{name:"filter.set",method:"jsonp",path:"/",callback:async function(t,e,i){const s=new r([e]).buf(0);if(!s)throw new Error("Invalid parameter.");return i.filter=c.fromRaw(s),null}},{name:"filter.reset",method:"jsonp",path:"/",callback:async function(t,e,i){i.filter=null}},{name:"filter.add",method:"jsonp",path:"/",callback:async function(t,e,i){const s=new r([e]).array(0);if(!s)throw new Error("Invalid parameter.");if(!i.filter)throw new Error("No filter set.");const n=new r([s]);for(let e=0;e<s.length;e++){const r=n.buf(e);if(!r)throw new Error("Bad data chunk.");i.filter.add(r),t.spv&&t.pool.watch(r)}}},{name:"canExecute",method:"jsonp",path:"/",callback:async function(t,e){const i=new r([e]);let s=i.obj(0,{}),n=i.str(1,"");return t.cpList.canExecute(s,n)}},{name:"prop.list.market",method:"jsonp",path:"/",callback:async function(t,e){const i=new r([e]);let s=i.str(0,""),o=i.uint(1,1),a=i.array(2,[]),h=[];s&&h.push(["cid",s]),a.length>0&&h.push(["pid","include",a]);let c=t.saleList.where(h),u=[];if(c){c=c.where([["status",n.status.Init]]).orderby("gold","desc").paginate(10,o).records(["oper","pid","cid","oid","current","gold","price","fixed","bid","times","status","period","addr"]);for(let e of c){let i=t.mempool.getTX(e.current.hash);!i||i.inputs.length<1||i.outputs.length<1||(e.raw=i.toRaw().toString("hex"),u.push(e))}}return u},remoteCb:async function(t){let e=[];for(let i of t)i.current.rev=s.revHex(i.current.hash),i.period=Math.max(0,this.wdb.state.height-i.period),this.wdb.addSaleOrder(i),e.push(i);return e}},{name:"contract.list",method:"jsonp",path:"/",callback:async function(t,e){if(0==e.length)return"contract.list type page ids: 查询并返回交易对 交易类型 页码 指定查询的ID数组";const i=new r([e]);let s=i.uint(0,1),n=i.uint(1,1),h=i.array(2,[]),c=[];c.push(["transStatus",a.CreatedOnMem]),s&&c.push(["type",s]),h.length>0&&c.push(["id","include",h]);let u=o.transactionList.where(c),l=[];if(u){u=u.paginate(10,n).records();for(let t of u)l.push(t)}return l},remoteCb:async function(t){if("string"==typeof t)return t;let e=[];for(let i of t)o.saveContract(i,this.wdb,h.tx),e.push(i);return e}},{name:"queryProps",method:"jsonp",path:"/",callback:async function(t,e){const i=new r([e]);let s=i.str(0,""),n=i.str(1,"");return await t.queryProps(s,n)}}]},function(t,e,i){const r=i(181),s=new class extends r{constructor(){super("block")}getPublishEvents(){return[{name:`${this.prefix}/block`,scope:this,subscribe:this.subscribe.bind(this,"block"),unsubscribe:this.unsubscribe.bind(this,"block")}]}};t.exports=s},function(t,e,i){const r=i(181),s=new class extends r{constructor(){super("header")}getPublishEvents(){return[{name:`${this.prefix}/block`,scope:this,subscribe:this.subscribe.bind(this,"block"),unsubscribe:this.unsubscribe.bind(this,"block")}]}};t.exports=s},function(t,e,i){const r=i(181),s=new class extends r{constructor(){super("inv")}getPublishEvents(){return[{name:"inv",scope:this,subscribe:this.subscribe.bind(this),unsubscribe:this.unsubscribe.bind(this),extraEvents:["tx","block"]}]}};t.exports=s},function(t,e,i){const r=i(181),s=new class extends r{constructor(){super("mempool")}getPublishEvents(){return[{name:`${this.prefix}/transaction`,scope:this,subscribe:this.subscribe.bind(this,"transaction"),unsubscribe:this.unsubscribe.bind(this,"transaction")}]}};t.exports=s},function(t,e,i){const r=i(181),s=new class extends r{constructor(){super("p2p")}getPublishEvents(){return[{name:`${this.prefix}/transaction`,scope:this,subscribe:this.subscribe.bind(this,"transaction"),unsubscribe:this.unsubscribe.bind(this,"transaction")},{name:`${this.prefix}/block`,scope:this,subscribe:this.subscribe.bind(this,"block"),unsubscribe:this.unsubscribe.bind(this,"block")},{name:`${this.prefix}/headers`,scope:this,subscribe:this.subscribe.bind(this,"headers"),unsubscribe:this.unsubscribe.bind(this,"headers")}]}};t.exports=s},function(t,e,i){"use strict";
/*!
 * mempool/index.js - mempool for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.Fees=i(203),e.layout=i(363),e.MempoolEntry=i(182),e.Mempool=i(364)},function(t,e,i){"use strict";
/*!
 * Confirmation.js - fee estimation for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 * Ported from:
 * https://github.com/bitcoin/bitcoin/blob/master/src/policy/fees.cpp
 */const r=i(4),s=i(1),n=i(2),o=i(6),a=i(45),h=i(3);class c{constructor(t,e){this.logger=a.global,this.type=t,this.decay=0,this.maxConfirms=0,this.buckets=new Float64Array(0),this.bucketMap=new u,this.confAvg=[],this.curBlockConf=[],this.unconfTX=[],this.oldUnconfTX=new Int32Array(0),this.curBlockTX=new Int32Array(0),this.txAvg=new Float64Array(0),this.curBlockVal=new Float64Array(0),this.avg=new Float64Array(0),e&&(s("object"==typeof e),this.logger=e.context("fees"))}init(t,e,i){this.maxConfirms=e,this.decay=i,this.buckets=new Float64Array(t.length),this.bucketMap=new u;for(let e=0;e<t.length;e++)this.buckets[e]=t[e],this.bucketMap.insert(t[e],e);this.confAvg=new Array(e),this.curBlockConf=new Array(e),this.unconfTX=new Array(e);for(let i=0;i<e;i++)this.confAvg[i]=new Float64Array(t.length),this.curBlockConf[i]=new Int32Array(t.length),this.unconfTX[i]=new Int32Array(t.length);this.oldUnconfTX=new Int32Array(t.length),this.curBlockTX=new Int32Array(t.length),this.txAvg=new Float64Array(t.length),this.curBlockVal=new Float64Array(t.length),this.avg=new Float64Array(t.length)}clearCurrent(t){for(let e=0;e<this.buckets.length;e++){this.oldUnconfTX[e]=this.unconfTX[t%this.unconfTX.length][e],this.unconfTX[t%this.unconfTX.length][e]=0;for(let t=0;t<this.curBlockConf.length;t++)this.curBlockConf[t][e]=0;this.curBlockTX[e]=0,this.curBlockVal[e]=0}}record(t,e){if(t<1)return;const i=this.bucketMap.search(e);for(let e=t;e<=this.curBlockConf.length;e++)this.curBlockConf[e-1][i]++;this.curBlockTX[i]++,this.curBlockVal[i]+=e}updateAverages(){for(let t=0;t<this.buckets.length;t++){for(let e=0;e<this.confAvg.length;e++)this.confAvg[e][t]=this.confAvg[e][t]*this.decay+this.curBlockConf[e][t];this.avg[t]=this.avg[t]*this.decay+this.curBlockVal[t],this.txAvg[t]=this.txAvg[t]*this.decay+this.curBlockTX[t]}}estimateMedian(t,e,i,r,s){const n=this.buckets.length-1,o=r?n:0,a=r?-1:1,h=this.unconfTX.length;let c=0,u=0,l=0,f=o,d=o,p=o,g=o,m=!1,w=-1,y=0;for(let w=o;w>=0&&w<=n;w+=a){d=w,c+=this.confAvg[t-1][w],u+=this.txAvg[w];for(let e=t;e<this.maxConfirms;e++)l+=this.unconfTX[Math.max(s-e,0)%h][w];if(l+=this.oldUnconfTX[w],u>=e/(1-this.decay)){const t=c/(u+l);if(r&&t<i)break;if(!r&&t>i)break;m=!0,c=0,u=0,l=0,p=f,g=d,f=w+a}}const b=p<g?p:g,v=p>g?p:g;for(let t=b;t<=v;t++)y+=this.txAvg[t];if(m&&0!==y){y/=2;for(let t=b;t<=v;t++){if(!(this.txAvg[t]<y)){w=this.avg[t]/this.txAvg[t];break}y-=this.txAvg[t]}}return w}addTX(t,e){const i=this.bucketMap.search(e),r=t%this.unconfTX.length;return this.unconfTX[r][i]++,this.logger.spam("Adding tx to %s.",this.type),i}removeTX(t,e,i){let r=e-t;if(0===e&&(r=0),r<0)this.logger.debug("Blocks ago is negative for mempool tx.");else if(r>=this.unconfTX.length)this.oldUnconfTX[i]>0?this.oldUnconfTX[i]--:this.logger.debug("Mempool tx removed >25 blocks (bucket=%d).",i);else{const e=t%this.unconfTX.length;this.unconfTX[e][i]>0?this.unconfTX[e][i]--:this.logger.debug("Mempool tx removed (block=%d, bucket=%d).",e,i)}}getSize(){let t=0;t+=8,t+=f(this.buckets),t+=f(this.avg),t+=f(this.txAvg),t+=r.sizeVarint(this.maxConfirms);for(let e=0;e<this.maxConfirms;e++)t+=f(this.confAvg[e]);return t}toRaw(){const t=this.getSize(),e=new o(t);e.writeDouble(this.decay),d(e,this.buckets),d(e,this.avg),d(e,this.txAvg),e.writeVarint(this.maxConfirms);for(let t=0;t<this.maxConfirms;t++)d(e,this.confAvg[t]);return e.render()}fromRaw(t){const e=new n(t),i=e.readDouble(),r=p(e),s=p(e),o=p(e),a=e.readVarint(),h=new Array(a);for(let t=0;t<a;t++)h[t]=p(e);if(i<=0||i>=1)throw new Error("Decay must be between 0 and 1 (non-inclusive).");if(r.length<=1||r.length>1e3)throw new Error("Must have between 2 and 1000 fee/pri buckets.");if(s.length!==r.length)throw new Error("Mismatch in fee/pri average bucket count.");if(o.length!==r.length)throw new Error("Mismatch in tx count bucket count.");if(a<=0||a>1008)throw new Error("Must maintain estimates for between 1 and 1008 confirms.");for(let t=0;t<a;t++)if(h[t].length!==r.length)throw new Error("Mismatch in fee/pri conf average bucket count.");return this.init(r,a,i),this.avg=s,this.txAvg=o,this.confAvg=h,this}static fromRaw(t,e,i){return new c(e,i).fromRaw(t)}}class u{constructor(){this.buckets=[]}insert(t,e){const i=h.binarySearch(this.buckets,t,l,!0);this.buckets.splice(i,0,[t,e])}search(t){const e=h.binarySearch(this.buckets,t,l,!0);return s(0!==this.buckets.length,"Cannot search."),this.buckets[e][1]}}function l(t,e){return t[0]-e}function f(t){return r.sizeVarint(t.length)+8*t.length}function d(t,e){t.writeVarint(e.length);for(let i=0;i<e.length;i++)t.writeDouble(e[i])}function p(t){const e=new Float64Array(t.readVarint());for(let i=0;i<e.length;i++)e[i]=t.readDouble();return e}t.exports=c},function(t,e,i){"use strict";
/*!
 * CoinIndex.js - CoinIndex for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(37),n=i(520);t.exports=class{constructor(){this.index=new Map,this.map=new Map}reset(){this.index.clear(),this.map.clear()}get(t){const e=this.index.get(t);if(!e)return[];const i=[];for(const t of e.values())i.push(t.toCoin());return i}insert(t,e){const i=t.outputs[e],o=t.hash("hex"),a=i.getHash("hex");if(!a)return;let h=this.index.get(a);h||(h=new Map,this.index.set(a,h));const c=s.toKey(o,e);r(!h.has(c)),h.set(c,new n(t,e)),this.map.set(c,a)}remove(t,e){const i=s.toKey(t,e),n=this.map.get(i);if(!n)return;const o=this.index.get(n);r(o),r(o.has(i)),o.delete(i),0===o.size&&this.index.delete(n),this.map.delete(i)}}},function(t,e,i){"use strict";
/*!
 * IndexedCoin.js - IndexedCoin for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(41);function s(t,e){this.tx=t,this.index=e}s.prototype.toCoin=function(){return r.fromTX(this.tx,this.index,-1)},t.exports=s},function(t,e,i){"use strict";(function(e){
/*!
 * MempoolCache.js - MempoolCache for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(3),s=i(182),n=i(4),o=i(363),a=i(138),h=i(203);class c{constructor(t){this.logger=t.logger,this.chain=t.chain,this.network=t.network,this.db=null,this.batch=null,t.persistent&&(this.db=a(t))}async getVersion(){const t=await this.db.get(o.V);return t?t.readUInt32LE(0,!0):-1}async getTip(){const t=await this.db.get(o.R);return t?t.toString("hex"):null}async getFees(){const t=await this.db.get(o.F);if(!t)return null;let e;try{e=h.fromRaw(t)}catch(t){this.logger.warning("Fee data failed deserialization: %s.",t.message)}return e}getEntries(){return this.db.values({gte:o.e(n.ZERO_HASH),lte:o.e(n.MAX_HASH),parse:s.fromRaw})}getKeys(){return this.db.keys({gte:o.e(n.ZERO_HASH),lte:o.e(n.MAX_HASH)})}async open(){this.db&&(await this.db.open(),await this.verify(),this.batch=this.db.batch())}async close(){this.db&&(await this.db.close(),this.batch=null)}save(t){this.db&&this.batch.put(o.e(t.tx.hash()),t.toRaw())}remove(t){this.db&&this.batch.del(o.e(t))}sync(t){this.db&&this.batch.put(o.R,e.from(t,"hex"))}writeFees(t){this.db&&this.batch.put(o.F,t.toRaw())}clear(){this.batch.clear(),this.batch=this.db.batch()}async flush(){this.db&&(await this.batch.write(),this.batch=this.db.batch())}async init(t){const i=this.db.batch();i.put(o.V,n.U32(c.VERSION)),i.put(o.R,e.from(t,"hex")),await i.write()}async verify(){let t,e=await this.getVersion();return-1===e&&(e=c.VERSION,t=this.chain.tip.hash,this.logger.info("Mempool cache is empty. Writing tip %s.",r.revHex(t)),await this.init(t)),e!==c.VERSION?(this.logger.warning("Mempool cache version mismatch (%d != %d)!",e,c.VERSION),this.logger.warning("Invalidating mempool cache."),await this.wipe(),!1):(t=await this.getTip())===this.chain.tip.hash||(this.logger.warning("Mempool tip not consistent with chain tip (%s != %s)!",r.revHex(t),this.chain.tip.rhash()),this.logger.warning("Invalidating mempool cache."),await this.wipe(),!1)}async wipe(){const t=this.db.batch(),i=await this.getKeys();for(const e of i)t.del(e);t.put(o.V,n.U32(c.VERSION)),t.put(o.R,e.from(this.chain.tip.hash,"hex")),t.del(o.F),await t.write(),this.logger.info("Removed %d mempool entries from disk.",i.length)}}c.VERSION=2,t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * MempoolOptions.js - MempoolOptions for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(74),n=i(33),o=i(3),a=i(16),h=i(363);i(180);class c{constructor(t){this.node=null,this.chain=null,this.network=a.primary,this.logger=null,this.workers=null,this.fees=null,this.limitFree=!0,this.limitFreeRelay=15,this.relayPriority=!0,this.requireStandard=this.network.requireStandard,this.rejectAbsurdFees=!0,this.paranoidChecks=!1,this.replaceByFee=!1,this.maxSize=n.MEMPOOL_MAX_SIZE,this.maxOrphans=n.MEMPOOL_MAX_ORPHANS,this.maxAncestors=n.MEMPOOL_MAX_ANCESTORS,this.expiryTime=n.MEMPOOL_EXPIRY_TIME,this.minRelay=this.network.minRelay,this.prefix=null,this.location=null,this.db="memory",this.maxFiles=64,this.cacheSize=32<<20,this.compression=!0,this.bufferKeys=h.binary,this.persistent=!1,this.fromOptions(t)}fromOptions(t){return r(t,"Mempool requires options."),r(t.node&&"object"==typeof t.node,"Mempool requires a node."),r(t.node.chain&&"object"==typeof t.node.chain,"Mempool requires a chain."),this.node=t.node,this.chain=this.node.chain,this.network=this.chain.network,this.logger=this.chain.logger,this.workers=this.chain.workers,this.requireStandard=this.network.requireStandard,this.minRelay=this.network.minRelay,null!=t.logger&&(r("object"==typeof t.logger),this.logger=t.logger),null!=t.workers&&(r("object"==typeof t.workers),this.workers=t.workers),null!=t.fees&&(r("object"==typeof t.fees),this.fees=t.fees),null!=t.limitFree&&(r("boolean"==typeof t.limitFree),this.limitFree=t.limitFree),null!=t.limitFreeRelay&&(r(o.isU32(t.limitFreeRelay)),this.limitFreeRelay=t.limitFreeRelay),null!=t.relayPriority&&(r("boolean"==typeof t.relayPriority),this.relayPriority=t.relayPriority),null!=t.requireStandard&&(r("boolean"==typeof t.requireStandard),this.requireStandard=t.requireStandard),null!=t.rejectAbsurdFees&&(r("boolean"==typeof t.rejectAbsurdFees),this.rejectAbsurdFees=t.rejectAbsurdFees),null!=t.paranoidChecks&&(r("boolean"==typeof t.paranoidChecks),this.paranoidChecks=t.paranoidChecks),null!=t.replaceByFee&&(r("boolean"==typeof t.replaceByFee),this.replaceByFee=t.replaceByFee),null!=t.maxSize&&(r(o.isU64(t.maxSize)),this.maxSize=t.maxSize),null!=t.maxOrphans&&(r(o.isU32(t.maxOrphans)),this.maxOrphans=t.maxOrphans),null!=t.maxAncestors&&(r(o.isU32(t.maxAncestors)),this.maxAncestors=t.maxAncestors),null!=t.expiryTime&&(r(o.isU32(t.expiryTime)),this.expiryTime=t.expiryTime),null!=t.minRelay&&(r(o.isU64(t.minRelay)),this.minRelay=t.minRelay),null!=t.prefix&&(r("string"==typeof t.prefix),this.prefix=t.prefix,this.location=s.join(this.prefix,"mempool")),null!=t.location&&(r("string"==typeof t.location),this.location=t.location),null!=t.db&&(r("string"==typeof t.db),this.db=t.db),null!=t.maxFiles&&(r(o.isU32(t.maxFiles)),this.maxFiles=t.maxFiles),null!=t.cacheSize&&(r(o.isU64(t.cacheSize)),this.cacheSize=t.cacheSize),null!=t.compression&&(r("boolean"==typeof t.compression),this.compression=t.compression),null!=t.persistent&&(r("boolean"==typeof t.persistent),this.persistent=t.persistent),null!=t.indexAddress&&(r("boolean"==typeof t.indexAddress),this.indexAddress=t.indexAddress),this}static fromOptions(t){return(new c).fromOptions(t)}}t.exports=c},function(t,e,i){"use strict";
/*!
 * Orphan.js - Orphan for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(17);t.exports=class{constructor(t,e,i){this.raw=t.toRaw(),this.missing=e,this.id=i}toTX(){return r.fromRaw(this.raw)}}},function(t,e,i){"use strict";
/*!
 * TXIndex.js - TXIndex for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(193);t.exports=class{constructor(){this.index=new Map,this.map=new Map}reset(){this.index.clear(),this.map.clear()}get(t){const e=this.index.get(t);if(!e)return[];const i=[];for(const t of e.values())i.push(t.tx);return i}getMeta(t){const e=this.index.get(t);if(!e)return[];const i=[];for(const t of e.values()){const e=s.fromTX(t.tx);e.mtime=t.time,i.push(e)}return i}insert(t,e){const i=t.tx,s=i.hash("hex"),n=i.getHashes(e,"hex");if(0!==n.length){for(const e of n){let i=this.index.get(e);i||(i=new Map,this.index.set(e,i)),r(!i.has(s)),i.set(s,t)}this.map.set(s,n)}}remove(t){const e=this.map.get(t);if(e){for(const i of e){const e=this.index.get(i);r(e),r(e.has(t)),e.delete(t),0===e.size&&this.index.delete(i)}this.map.delete(t)}}}},function(t,e,i){"use strict";
/*!
 * mining/index.js - mining infrastructure for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.common=i(92),e.CPUMiner=i(408),e.mine=i(174),e.Miner=i(366),e.BlockTemplate=i(205)},function(t,e,i){"use strict";
/*!
 * MerkleTree.js - block template object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(9),s=i(4);class n{constructor(){this.steps=[]}withFirst(t){for(const e of this.steps)t=r.root256(t,e);return t}toJSON(){const t=[];for(const e of this.steps)t.push(e.toString("hex"));return t}fromItems(t){const e=[];e.push(s.ZERO_HASH);for(const i of t)e.push(i.tx.hash());return this.fromLeaves(e)}fromBlock(t){const e=[];e.push(s.ZERO_HASH);for(let i=1;i<t.length;i++){const r=t[i];e.push(r.hash())}return this.fromLeaves(e)}fromLeaves(t){let e=t.length;for(;e>1;){const i=[s.ZERO_HASH];this.steps.push(t[1]),e%2&&t.push(t[e-1]);for(let s=2;s<e;s+=2){const e=r.root256(t[s],t[s+1]);i.push(e)}e=(t=i).length}return this}static fromItems(t){return(new n).fromItems(t)}static fromBlock(t){return(new n).fromBlock(t)}static fromLeaves(t){return(new n).fromLeaves(t)}}t.exports=n},function(t,e,i){"use strict";
/*!
 * BlockProof.js - block template object for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(3),s=i(92);t.exports=class{constructor(t,e,i,r,s,n){this.hash=t,this.root=e,this.nonce1=i,this.nonce2=r,this.time=s,this.nonce=n}rhash(){return r.revHex(this.hash.toString("hex"))}verify(t){return s.rcmp(this.hash,t)<=0}getDifficulty(){return s.hash2Bits(this.hash)}}},function(t,e,i){"use strict";
/*!
 * net/index.js - p2p for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.BIP150=i(206),e.BIP151=i(208),e.bip152=i(184),e.common=i(60),e.dns=i(183),e.external=i(427),e.Framer=i(413),e.HostList=i(428),e.packets=i(94),e.Parser=i(412),e.Peer=i(18),e.Pool=i(19),e.socks=i(561),e.tcp=i(185),e.UPNP=i(429)},function(t,e,i){"use strict";(function(e){
/*!
 * proxysocket.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(24),n=i(415),o=i(3),a=i(9),h=i(13);class c extends s{constructor(t){super(),this.info=null,this.socket=new n(t,{reconnection:!1,transports:["websocket"]}),this.sendBuffer=[],this.recvBuffer=[],this.paused=!1,this.snonce=null,this.bytesWritten=0,this.bytesRead=0,this.remoteAddress=null,this.remotePort=0,this.closed=!1,this._init()}_init(){this.socket.on("info",t=>{this.closed||(this.info=t,t.pow&&(this.snonce=e.from(t.snonce,"hex"),this.target=e.from(t.target,"hex")),this.emit("info",t))}),this.socket.on("error",t=>{console.error(t)}),this.socket.on("tcp connect",(t,e)=>{this.closed||(this.remoteAddress=t,this.remotePort=e,this.emit("connect"))}),this.socket.on("tcp data",t=>{t=e.from(t,"hex"),this.paused?this.recvBuffer.push(t):(this.bytesRead+=t.length,this.emit("data",t))}),this.socket.on("tcp close",t=>{this.closed||(this.closed=!0,this.emit("close"))}),this.socket.on("tcp error",t=>{const e=new Error(t.message);e.code=t.code,this.emit("error",e)}),this.socket.on("tcp timeout",()=>{this.emit("timeout")}),this.socket.on("disconnect",()=>{this.closed||(this.closed=!0,this.emit("close"))})}connect(t,e){if(this.remoteAddress=e,this.remotePort=t,this.closed)return void(this.sendBuffer.length=0);if(!this.info)return void this.once("info",this.connect.bind(this,t,e));let i=0;if(this.info.pow){const s=new h;s.writeU32(i),s.writeBytes(this.snonce),s.writeU32(t),s.writeString(e,"ascii");const n=s.render();o.log("Solving proof of work to create socket (%d, %s) -- please wait.",t,e);do{r(++i<=4294967295,"Could not create socket."),n.writeUInt32LE(i,0,!0)}while(a.hash256(n).compare(this.target)>0);o.log("Solved proof of work: %d",i)}this.socket.emit("tcp connect",t,e,i);for(const t of this.sendBuffer)this.write(t);this.sendBuffer.length=0}setKeepAlive(t,e){this.socket.emit("tcp keep alive",t,e)}setNoDelay(t){this.socket.emit("tcp no delay",t)}setTimeout(t,e){this.socket.emit("tcp set timeout",t),e&&this.on("timeout",e)}write(t,e){return this.info?(this.bytesWritten+=t.length,this.socket.emit("tcp data",t.toString("hex")),e&&e(),!0):(this.sendBuffer.push(t),e&&e(),!0)}pause(){this.paused=!0}resume(){const t=this.recvBuffer;this.paused=!1,this.recvBuffer=[];for(const e of t)this.bytesRead+=e.length,this.emit("data",e)}destroy(){this.closed||(this.closed=!0,this.socket.disconnect())}static connect(t,e,i){const r=new c(t);return r.connect(e,i),r}}t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){(function(e){var r=i(416),s=i(209)("socket.io-client:url");t.exports=function(t,i){var n=t;i=i||e.location,null==t&&(t=i.protocol+"//"+i.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?i.protocol+t:i.host+t),/^(https?|wss?):\/\//.test(t)||(s("protocol-less url %s",t),t=void 0!==i?i.protocol+"//"+t:"https://"+t),s("parse %s",t),n=r(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port,n.href=n.protocol+"://"+o+(i&&i.port===n.port?"":":"+n.port),n}}).call(this,i(12))},function(t,e,i){function r(t){var i;function r(){if(r.enabled){var t=r,s=+new Date,n=s-(i||s);t.diff=n,t.prev=i,t.curr=s,i=s;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var h=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(i,r){if("%%"===i)return i;h++;var s=e.formatters[r];if("function"==typeof s){var n=o[h];i=s.call(t,n),o.splice(h,1),h--}return i}),e.formatArgs.call(t,o),(r.log||e.log||console.log.bind(console)).apply(t,o)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var i,r=0;for(i in t)r=(r<<5)-r+t.charCodeAt(i),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=s,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function s(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var i;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),s=r.length;for(i=0;i<s;i++)r[i]&&("-"===(t=r[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(i=0;i<e.instances.length;i++){var n=e.instances[i];n.enabled=e.enabled(n.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var i,r;for(i=0,r=e.skips.length;i<r;i++)if(e.skips[i].test(t))return!1;for(i=0,r=e.names.length;i<r;i++)if(e.names[i].test(t))return!0;return!1},e.humanize=i(369),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e,i){(function(r){function s(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=i(533)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var i=this.useColors;if(t[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+t[0]+(i?"%c ":" ")+"+"+e.humanize(this.diff),i){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var s=0,n=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(n=++s)}),t.splice(n,0,r)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=s,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(s())}).call(this,i(23))},function(t,e,i){function r(t){var i;function r(){if(r.enabled){var t=r,s=+new Date,n=s-(i||s);t.diff=n,t.prev=i,t.curr=s,i=s;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var h=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(i,r){if("%%"===i)return i;h++;var s=e.formatters[r];if("function"==typeof s){var n=o[h];i=s.call(t,n),o.splice(h,1),h--}return i}),e.formatArgs.call(t,o),(r.log||e.log||console.log.bind(console)).apply(t,o)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var i,r=0;for(i in t)r=(r<<5)-r+t.charCodeAt(i),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=s,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function s(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var i;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),s=r.length;for(i=0;i<s;i++)r[i]&&("-"===(t=r[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(i=0;i<e.instances.length;i++){var n=e.instances[i];n.enabled=e.enabled(n.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var i,r;for(i=0,r=e.skips.length;i<r;i++)if(e.skips[i].test(t))return!1;for(i=0,r=e.names.length;i<r;i++)if(e.names[i].test(t))return!0;return!1},e.humanize=i(369),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e,i){(function(t){var r=i(417),s=i(418),n=Object.prototype.toString,o="function"==typeof t.Blob||"[object BlobConstructor]"===n.call(t.Blob),a="function"==typeof t.File||"[object FileConstructor]"===n.call(t.File);e.deconstructPacket=function(t){var e=[],i=t.data,n=t;return n.data=function t(e,i){if(!e)return e;if(s(e)){var n={_placeholder:!0,num:i.length};return i.push(e),n}if(r(e)){for(var o=new Array(e.length),a=0;a<e.length;a++)o[a]=t(e[a],i);return o}if("object"==typeof e&&!(e instanceof Date)){o={};for(var h in e)o[h]=t(e[h],i);return o}return e}(i,e),n.attachments=e.length,{packet:n,buffers:e}},e.reconstructPacket=function(t,e){return t.data=function t(e,i){if(!e)return e;if(e&&e._placeholder)return i[e.num];if(r(e))for(var s=0;s<e.length;s++)e[s]=t(e[s],i);else if("object"==typeof e)for(var n in e)e[n]=t(e[n],i);return e}(t.data,e),t.attachments=void 0,t},e.removeBlobs=function(t,e){var i=0,n=t;!function t(h,c,u){if(!h)return h;if(o&&h instanceof Blob||a&&h instanceof File){i++;var l=new FileReader;l.onload=function(){u?u[c]=this.result:n=this.result,--i||e(n)},l.readAsArrayBuffer(h)}else if(r(h))for(var f=0;f<h.length;f++)t(h[f],f,h);else if("object"==typeof h&&!s(h))for(var d in h)t(h[d],d,h)}(n),i||e(n)}}).call(this,i(12))},function(t,e,i){t.exports=i(536),t.exports.parser=i(123)},function(t,e,i){(function(e){var r=i(420),s=i(122),n=i(212)("engine.io-client:socket"),o=i(164),a=i(123),h=i(416),c=i(210);function u(t,i){if(!(this instanceof u))return new u(t,i);i=i||{},t&&"object"==typeof t&&(i=t,t=null),t?(t=h(t),i.hostname=t.host,i.secure="https"===t.protocol||"wss"===t.protocol,i.port=t.port,t.query&&(i.query=t.query)):i.host&&(i.hostname=h(i.host).host),this.secure=null!=i.secure?i.secure:e.location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.agent=i.agent||!1,this.hostname=i.hostname||(e.location?location.hostname:"localhost"),this.port=i.port||(e.location&&location.port?location.port:this.secure?443:80),this.query=i.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==i.upgrade,this.path=(i.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!i.forceJSONP,this.jsonp=!1!==i.jsonp,this.forceBase64=!!i.forceBase64,this.enablesXDR=!!i.enablesXDR,this.timestampParam=i.timestampParam||"t",this.timestampRequests=i.timestampRequests,this.transports=i.transports||["polling","websocket"],this.transportOptions=i.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=i.policyPort||843,this.rememberUpgrade=i.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=i.onlyBinaryUpgrades,this.perMessageDeflate=!1!==i.perMessageDeflate&&(i.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=i.pfx||null,this.key=i.key||null,this.passphrase=i.passphrase||null,this.cert=i.cert||null,this.ca=i.ca||null,this.ciphers=i.ciphers||null,this.rejectUnauthorized=void 0===i.rejectUnauthorized||i.rejectUnauthorized,this.forceNode=!!i.forceNode;var r="object"==typeof e&&e;r.global===r&&(i.extraHeaders&&Object.keys(i.extraHeaders).length>0&&(this.extraHeaders=i.extraHeaders),i.localAddress&&(this.localAddress=i.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}t.exports=u,u.priorWebsocketSuccess=!1,s(u.prototype),u.protocol=a.protocol,u.Socket=u,u.Transport=i(372),u.transports=i(420),u.parser=i(123),u.prototype.createTransport=function(t){n('creating transport "%s"',t);var e=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}(this.query);e.EIO=a.protocol,e.transport=t;var i=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new r[t]({query:e,socket:this,agent:i.agent||this.agent,hostname:i.hostname||this.hostname,port:i.port||this.port,secure:i.secure||this.secure,path:i.path||this.path,forceJSONP:i.forceJSONP||this.forceJSONP,jsonp:i.jsonp||this.jsonp,forceBase64:i.forceBase64||this.forceBase64,enablesXDR:i.enablesXDR||this.enablesXDR,timestampRequests:i.timestampRequests||this.timestampRequests,timestampParam:i.timestampParam||this.timestampParam,policyPort:i.policyPort||this.policyPort,pfx:i.pfx||this.pfx,key:i.key||this.key,passphrase:i.passphrase||this.passphrase,cert:i.cert||this.cert,ca:i.ca||this.ca,ciphers:i.ciphers||this.ciphers,rejectUnauthorized:i.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:i.perMessageDeflate||this.perMessageDeflate,extraHeaders:i.extraHeaders||this.extraHeaders,forceNode:i.forceNode||this.forceNode,localAddress:i.localAddress||this.localAddress,requestTimeout:i.requestTimeout||this.requestTimeout,protocols:i.protocols||void 0})},u.prototype.open=function(){var t;if(this.rememberUpgrade&&u.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},u.prototype.setTransport=function(t){n("setting transport %s",t.name);var e=this;this.transport&&(n("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},u.prototype.probe=function(t){n('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),i=!1,r=this;function s(){if(r.onlyBinaryUpgrades){var s=!this.supportsBinary&&r.transport.supportsBinary;i=i||s}i||(n('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",function(s){if(!i)if("pong"===s.type&&"probe"===s.data){if(n('probe transport "%s" pong',t),r.upgrading=!0,r.emit("upgrading",e),!e)return;u.priorWebsocketSuccess="websocket"===e.name,n('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){i||"closed"!==r.readyState&&(n("changing transport and sending upgrade packet"),f(),r.setTransport(e),e.send([{type:"upgrade"}]),r.emit("upgrade",e),e=null,r.upgrading=!1,r.flush())})}else{n('probe transport "%s" failed',t);var o=new Error("probe error");o.transport=e.name,r.emit("upgradeError",o)}}))}function o(){i||(i=!0,f(),e.close(),e=null)}function a(i){var s=new Error("probe error: "+i);s.transport=e.name,o(),n('probe transport "%s" failed because of error: %s',t,i),r.emit("upgradeError",s)}function h(){a("transport closed")}function c(){a("socket closed")}function l(t){e&&t.name!==e.name&&(n('"%s" works - aborting "%s"',t.name,e.name),o())}function f(){e.removeListener("open",s),e.removeListener("error",a),e.removeListener("close",h),r.removeListener("close",c),r.removeListener("upgrading",l)}u.priorWebsocketSuccess=!1,e.once("open",s),e.once("error",a),e.once("close",h),this.once("close",c),this.once("upgrading",l),e.open()},u.prototype.onOpen=function(){if(n("socket open"),this.readyState="open",u.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){n("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},u.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(n('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else n('packet received with socket readyState "%s"',this.readyState)},u.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},u.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!==e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},u.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){n("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},u.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},u.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},u.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(n("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},u.prototype.write=u.prototype.send=function(t,e,i){return this.sendPacket("message",t,e,i),this},u.prototype.sendPacket=function(t,e,i,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof i&&(r=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){(i=i||{}).compress=!1!==i.compress;var s={type:t,data:e,options:i};this.emit("packetCreate",s),this.writeBuffer.push(s),r&&this.once("flush",r),this.flush()}},u.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():e()}):this.upgrading?r():e()}function e(){t.onClose("forced close"),n("socket closing - telling transport to close"),t.transport.close()}function i(){t.removeListener("upgrade",i),t.removeListener("upgradeError",i),e()}function r(){t.once("upgrade",i),t.once("upgradeError",i)}return this},u.prototype.onError=function(t){n("socket error %j",t),u.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},u.prototype.onClose=function(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(n('socket close with reason: "%s"',t),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)},u.prototype.filterUpgrades=function(t){for(var e=[],i=0,r=t.length;i<r;i++)~o(this.transports,t[i])&&e.push(t[i]);return e}}).call(this,i(12))},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(t,e,i){(function(e){var r=i(371),s=i(421),n=i(122),o=i(211),a=i(212)("engine.io-client:polling-xhr");function h(){}function c(t){if(s.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,e.location){var i="https:"===location.protocol,r=location.port;r||(r=i?443:80),this.xd=t.hostname!==e.location.hostname||r!==t.port,this.xs=t.secure!==i}}function u(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function l(){for(var t in u.requests)u.requests.hasOwnProperty(t)&&u.requests[t].abort()}t.exports=c,t.exports.Request=u,o(c,s),c.prototype.supportsBinary=!0,c.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new u(t)},c.prototype.doWrite=function(t,e){var i="string"!=typeof t&&void 0!==t,r=this.request({method:"POST",data:t,isBinary:i}),s=this;r.on("success",e),r.on("error",function(t){s.onError("xhr post error",t)}),this.sendXhr=r},c.prototype.doPoll=function(){a("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},n(u.prototype),u.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var i=this.xhr=new r(t),s=this;try{a("xhr open %s: %s",this.method,this.uri),i.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var n in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(n)&&i.setRequestHeader(n,this.extraHeaders[n])}catch(t){}if("POST"===this.method)try{this.isBinary?i.setRequestHeader("Content-type","application/octet-stream"):i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{i.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in i&&(i.withCredentials=!0),this.requestTimeout&&(i.timeout=this.requestTimeout),this.hasXDR()?(i.onload=function(){s.onLoad()},i.onerror=function(){s.onError(i.responseText)}):i.onreadystatechange=function(){if(2===i.readyState)try{var t=i.getResponseHeader("Content-Type");s.supportsBinary&&"application/octet-stream"===t&&(i.responseType="arraybuffer")}catch(t){}4===i.readyState&&(200===i.status||1223===i.status?s.onLoad():setTimeout(function(){s.onError(i.status)},0))},a("xhr data %s",this.data),i.send(this.data)}catch(t){return void setTimeout(function(){s.onError(t)},0)}e.document&&(this.index=u.requestsCount++,u.requests[this.index]=this)},u.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},u.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},u.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},u.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=h:this.xhr.onreadystatechange=h,t)try{this.xhr.abort()}catch(t){}e.document&&delete u.requests[this.index],this.xhr=null}},u.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t="application/octet-stream"===e&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},u.prototype.hasXDR=function(){return void 0!==e.XDomainRequest&&!this.xs&&this.enablesXDR},u.prototype.abort=function(){this.cleanup()},u.requestsCount=0,u.requests={},e.document&&(e.attachEvent?e.attachEvent("onunload",l):e.addEventListener&&e.addEventListener("beforeunload",l,!1))}).call(this,i(12))},function(t,e){t.exports=Object.keys||function(t){var e=[],i=Object.prototype.hasOwnProperty;for(var r in t)i.call(t,r)&&e.push(r);return e}},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e){t.exports=function(t,e,i){var r=t.byteLength;if(e=e||0,i=i||r,t.slice)return t.slice(e,i);if(e<0&&(e+=r),i<0&&(i+=r),i>r&&(i=r),e>=r||e>=i||0===r)return new ArrayBuffer(0);for(var s=new Uint8Array(t),n=new Uint8Array(i-e),o=e,a=0;o<i;o++,a++)n[a]=s[o];return n.buffer}},function(t,e){function i(){}t.exports=function(t,e,r){var s=!1;return r=r||i,n.count=t,0===t?e():n;function n(t,i){if(n.count<=0)throw new Error("after called too many times");--n.count,t?(s=!0,e(t),e=r):0!==n.count||s||e(null,i)}}},function(t,e,i){(function(t,r){var s;/*! https://mths.be/utf8js v2.1.2 by @mathias */!function(n){var o=("object"==typeof t&&t&&t.exports,"object"==typeof r&&r);o.global!==o&&o.window;var a,h,c,u=String.fromCharCode;function l(t){for(var e,i,r=[],s=0,n=t.length;s<n;)(e=t.charCodeAt(s++))>=55296&&e<=56319&&s<n?56320==(64512&(i=t.charCodeAt(s++)))?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),s--):r.push(e);return r}function f(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function d(t,e){return u(t>>e&63|128)}function p(t,e){if(0==(4294967168&t))return u(t);var i="";return 0==(4294965248&t)?i=u(t>>6&31|192):0==(4294901760&t)?(f(t,e)||(t=65533),i=u(t>>12&15|224),i+=d(t,6)):0==(4292870144&t)&&(i=u(t>>18&7|240),i+=d(t,12),i+=d(t,6)),i+u(63&t|128)}function g(){if(c>=h)throw Error("Invalid byte index");var t=255&a[c];if(c++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function m(t){var e,i;if(c>h)throw Error("Invalid byte index");if(c==h)return!1;if(e=255&a[c],c++,0==(128&e))return e;if(192==(224&e)){if((i=(31&e)<<6|g())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&e)){if((i=(15&e)<<12|g()<<6|g())>=2048)return f(i,t)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(i=(7&e)<<18|g()<<12|g()<<6|g())>=65536&&i<=1114111)return i;throw Error("Invalid UTF-8 detected")}var w={version:"2.1.2",encode:function(t,e){for(var i=!1!==(e=e||{}).strict,r=l(t),s=r.length,n=-1,o="";++n<s;)o+=p(r[n],i);return o},decode:function(t,e){var i=!1!==(e=e||{}).strict;a=l(t),h=a.length,c=0;for(var r,s=[];!1!==(r=m(i));)s.push(r);return function(t){for(var e,i=t.length,r=-1,s="";++r<i;)(e=t[r])>65535&&(s+=u((e-=65536)>>>10&1023|55296),e=56320|1023&e),s+=u(e);return s}(s)}};void 0===(s=function(){return w}.call(e,i,e,t))||(t.exports=s)}()}).call(this,i(188)(t),i(12))},function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(256),r=0;r<t.length;r++)i[t.charCodeAt(r)]=r;e.encode=function(e){var i,r=new Uint8Array(e),s=r.length,n="";for(i=0;i<s;i+=3)n+=t[r[i]>>2],n+=t[(3&r[i])<<4|r[i+1]>>4],n+=t[(15&r[i+1])<<2|r[i+2]>>6],n+=t[63&r[i+2]];return s%3==2?n=n.substring(0,n.length-1)+"=":s%3==1&&(n=n.substring(0,n.length-2)+"=="),n},e.decode=function(t){var e,r,s,n,o,a=.75*t.length,h=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var u=new ArrayBuffer(a),l=new Uint8Array(u);for(e=0;e<h;e+=4)r=i[t.charCodeAt(e)],s=i[t.charCodeAt(e+1)],n=i[t.charCodeAt(e+2)],o=i[t.charCodeAt(e+3)],l[c++]=r<<2|s>>4,l[c++]=(15&s)<<4|n>>2,l[c++]=(3&n)<<6|63&o;return u}}()},function(t,e,i){(function(e){var i=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),s=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),n=i&&i.prototype.append&&i.prototype.getBlob;function o(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.buffer instanceof ArrayBuffer){var r=i.buffer;if(i.byteLength!==r.byteLength){var s=new Uint8Array(i.byteLength);s.set(new Uint8Array(r,i.byteOffset,i.byteLength)),r=s.buffer}t[e]=r}}}t.exports=r?s?e.Blob:function(t,e){return o(t),new Blob(t,e||{})}:n?function(t,e){e=e||{};var r=new i;o(t);for(var s=0;s<t.length;s++)r.append(t[s]);return e.type?r.getBlob(e.type):r.getBlob()}:void 0}).call(this,i(12))},function(t,e,i){function r(t){var i;function r(){if(r.enabled){var t=r,s=+new Date,n=s-(i||s);t.diff=n,t.prev=i,t.curr=s,i=s;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var h=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(i,r){if("%%"===i)return i;h++;var s=e.formatters[r];if("function"==typeof s){var n=o[h];i=s.call(t,n),o.splice(h,1),h--}return i}),e.formatArgs.call(t,o),(r.log||e.log||console.log.bind(console)).apply(t,o)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var i,r=0;for(i in t)r=(r<<5)-r+t.charCodeAt(i),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=s,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function s(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var i;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),s=r.length;for(i=0;i<s;i++)r[i]&&("-"===(t=r[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(i=0;i<e.instances.length;i++){var n=e.instances[i];n.enabled=e.enabled(n.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var i,r;for(i=0,r=e.skips.length;i<r;i++)if(e.skips[i].test(t))return!1;for(i=0,r=e.names.length;i<r;i++)if(e.names[i].test(t))return!0;return!1},e.humanize=i(369),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e,i){(function(e){var r=i(421),s=i(211);t.exports=c;var n,o=/\n/g,a=/\\n/g;function h(){}function c(t){r.call(this,t),this.query=this.query||{},n||(e.___eio||(e.___eio=[]),n=e.___eio),this.index=n.length;var i=this;n.push(function(t){i.onData(t)}),this.query.j=this.index,e.document&&e.addEventListener&&e.addEventListener("beforeunload",function(){i.script&&(i.script.onerror=h)},!1)}s(c,r),c.prototype.supportsBinary=!1,c.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},c.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(e,i):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},c.prototype.doWrite=function(t,e){var i=this;if(!this.form){var r,s=document.createElement("form"),n=document.createElement("textarea"),h=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=h,s.method="POST",s.setAttribute("accept-charset","utf-8"),n.name="d",s.appendChild(n),document.body.appendChild(s),this.form=s,this.area=n}function c(){u(),e()}function u(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(t){i.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+i.iframeId+'">';r=document.createElement(t)}catch(t){(r=document.createElement("iframe")).name=i.iframeId,r.src="javascript:0"}r.id=i.iframeId,i.form.appendChild(r),i.iframe=r}this.form.action=this.uri(),u(),t=t.replace(a,"\\\n"),this.area.value=t.replace(o,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&c()}:this.iframe.onload=c}}).call(this,i(12))},function(t,e,i){(function(e){var r,s=i(372),n=i(123),o=i(210),a=i(211),h=i(423),c=i(212)("engine.io-client:websocket"),u=e.WebSocket||e.MozWebSocket;if("undefined"==typeof window)try{r=i(549)}catch(t){}var l=u;function f(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=u&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(l=r),s.call(this,t)}l||"undefined"!=typeof window||(l=r),t.exports=f,a(f,s),f.prototype.name="websocket",f.prototype.supportsBinary=!0,f.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders),this.localAddress&&(i.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?e?new l(t,e):new l(t):new l(t,e,i)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},f.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},f.prototype.write=function(t){var i=this;this.writable=!1;for(var r=t.length,s=0,o=r;s<o;s++)!function(t){n.encodePacket(t,i.supportsBinary,function(s){if(!i.usingBrowserWebSocket){var n={};t.options&&(n.compress=t.options.compress),i.perMessageDeflate&&("string"==typeof s?e.Buffer.byteLength(s):s.length)<i.perMessageDeflate.threshold&&(n.compress=!1)}try{i.usingBrowserWebSocket?i.ws.send(s):i.ws.send(s,n)}catch(t){c("websocket closed before onclose event")}--r||(i.emit("flush"),setTimeout(function(){i.writable=!0,i.emit("drain")},0))})}(t[s])},f.prototype.onClose=function(){s.prototype.onClose.call(this)},f.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},f.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",i="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=h()),this.supportsBinary||(t.b64=1),(t=o.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t},f.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===f.prototype.name)}}).call(this,i(12))},function(t,e){},function(t,e){t.exports=function(t,e){for(var i=[],r=(e=e||0)||0;r<t.length;r++)i[r-e]=t[r];return i}},function(t,e){function i(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=i,i.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(t){this.ms=t},i.prototype.setMax=function(t){this.max=t},i.prototype.setJitter=function(t){this.jitter=t}},function(t,e){t.exports=function(t){this.next=null,this.prev=null,this.value=t}},function(t,e,i){"use strict";(function(e){
/*!
 * hostlist.js - address management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(74),n=i(3),o=i(48),a=i(35),h=i(16),c=i(82),u=i(186),l=i(108),f=i(60),d=i(554),p=i(183),g=i(45),m=(i(71),e.allocUnsafe(32));class w{constructor(t){this.options=new b(t),this.network=this.options.network,this.logger=this.options.logger.context("hostlist"),this.address=this.options.address,this.resolve=this.options.resolve,this.dnsSeeds=[],this.dnsNodes=[],this.map=new Map,this.fresh=[],this.totalFresh=0,this.used=[],this.totalUsed=0,this.nodes=[],this.local=new Map,this.banned=new Map,this.timer=null,this.needsFlush=!1,this._init()}_init(){const t=this.options,e=w.scores,i=o.getPublic(),r=this.address.port;for(let t=0;t<this.options.maxBuckets;t++)this.fresh.push(new Map);for(let t=0;t<this.options.maxBuckets;t++)this.used.push(new u);this.setSeeds(t.seeds),this.setNodes(t.nodes),this.pushLocal(this.address,e.MANUAL),this.addLocal(t.host,t.port,e.BIND);for(const t of i)this.addLocal(t,r,e.IF)}async open(){try{await this.loadFile()}catch(t){this.logger.warning("Hosts deserialization failed."),this.logger.error(t)}0===this.size()&&this.injectSeeds(),await this.discoverNodes(),this.start()}async close(){this.stop(),await this.flush(),this.reset()}async loadFile(){}async flush(){}start(){this.options.persistent&&this.options.filename&&(r(null==this.timer),this.timer=a.setInterval(this.flush,this.options.flushInterval,this))}stop(){this.options.persistent&&this.options.filename&&(r(null!=this.timer),a.clearInterval(this.timer),this.timer=null)}injectSeeds(){const t=d.get(this.network.type);for(const e of t){const t=c.fromHostname(e,this.network);t.isRoutable()&&(!this.options.onion&&t.isOnion()||0!==t.port&&this.add(t))}}size(){return this.totalFresh+this.totalUsed}isFull(){const t=this.options.maxBuckets*this.options.maxEntries;return this.size()>=t}reset(){this.map.clear();for(const t of this.fresh)t.clear();for(const t of this.used)t.reset();this.totalFresh=0,this.totalUsed=0,this.nodes.length=0}ban(t){this.banned.set(t,n.now())}unban(t){this.banned.delete(t)}clearBanned(){this.banned.clear()}isBanned(t){const e=this.banned.get(t);return!(null==e||n.now()>e+this.options.banTime&&(this.banned.delete(t),1))}getHost(){let t=null;if(this.totalFresh>0&&(t=this.fresh),this.totalUsed>0&&(0!==this.totalFresh&&0!==n.random(0,2)||(t=this.used)),!t)return null;const e=this.network.now();let i=1;for(;;){let r=n.random(0,t.length);const s=t[r];if(0===s.size)continue;let o;if(r=n.random(0,s.size),t===this.used)for(o=s.head;r--;)o=o.next;else for(o of s.values()){if(0===r)break;r--}if(n.random(0,1<<30)<i*o.chance(e)*(1<<30))return o;i*=1.2}}freshBucket(t){const e=t.addr,i=t.src,r=function(t,e){const i=m;return t.copy(i,0),e.copy(i,32),i}(e.raw,i.raw),s=l(r,4221880213)%this.fresh.length;return this.fresh[s]}usedBucket(t){const e=t.addr,i=l(e.raw,4221880213)%this.used.length;return this.used[i]}add(t,e){r(0!==t.port);let i=this.map.get(t.hostname);if(i){const s=this.network.now();let o=7200,a=86400;if(e||(o=0),i.addr.services|=t.services,i.addr.services>>>=0,s-t.time<86400&&(a=3600),i.addr.time<t.time-a-o&&(i.addr.time=t.time,this.needsFlush=!0),i.addr.time&&t.time<=i.addr.time)return!1;if(i.used)return!1;if(r(i.refCount>0),i.refCount===w.MAX_REFS)return!1;r(i.refCount<w.MAX_REFS);let h=1;for(let t=0;t<i.refCount;t++)h*=2;if(0!==n.random(0,h))return!1}else{if(this.isFull())return!1;e||(e=this.address),i=new y(t,e),this.totalFresh++}const s=this.freshBucket(i);return!s.has(i.key())&&(s.size>=this.options.maxEntries&&this.evictFresh(s),s.set(i.key(),i),i.refCount++,this.map.set(i.key(),i),this.needsFlush=!0,!0)}evictFresh(t){let e=null;for(const i of t.values())this.isStale(i)?(t.delete(i.key()),0==--i.refCount&&(this.map.delete(i.key()),this.totalFresh--)):e?i.addr.time<e.addr.time&&(e=i):e=i;e&&(t.delete(e.key()),0==--e.refCount&&(this.map.delete(e.key()),this.totalFresh--))}isStale(t){const e=this.network.now();return!(t.lastAttempt&&t.lastAttempt>=e-60)&&(t.addr.time>e+600||0===t.addr.time||e-t.addr.time>24*w.HORIZON_DAYS*60*60||0===t.lastSuccess&&t.attempts>=w.RETRIES||e-t.lastSuccess>24*w.MIN_FAIL_DAYS*60*60&&t.attempts>=w.MAX_FAILURES)}remove(t){const e=this.map.get(t);if(!e)return null;if(e.used){let t=e;for(r(0===e.refCount);t.prev;)t=t.prev;for(const i of this.used)if(i.head===t){i.remove(e),this.totalUsed--,t=null;break}r(!t)}else{for(const t of this.fresh)t.delete(e.key())&&e.refCount--;this.totalFresh--,r(0===e.refCount)}return this.map.delete(e.key()),e.addr}markAttempt(t){const e=this.map.get(t),i=this.network.now();e&&(e.attempts++,e.lastAttempt=i)}markSuccess(t){const e=this.map.get(t),i=this.network.now();e&&i-e.addr.time>1200&&(e.addr.time=i)}markAck(t,e){const i=this.map.get(t);if(!i)return;const s=this.network.now();if(i.addr.services|=e,i.addr.services>>>=0,i.lastSuccess=s,i.lastAttempt=s,i.attempts=0,i.used)return;let n;r(i.refCount>0);for(const t of this.fresh)t.delete(i.key())&&(i.refCount--,n=t);r(n),r(0===i.refCount),this.totalFresh--;const o=this.usedBucket(i);if(o.size<this.options.maxEntries)return i.used=!0,o.push(i),void this.totalUsed++;const a=this.evictUsed(o);let h=this.freshBucket(a);h.size>=this.options.maxEntries&&(h=n),i.used=!0,o.replace(a,i),a.used=!1,h.set(a.key(),a),r(0===a.refCount),a.refCount++,this.totalFresh++}evictUsed(t){let e=t.head;for(let i=t.head;i;i=i.next)i.addr.time<e.addr.time&&(e=i);return e}toArray(){const t=[];for(const e of this.map.values())t.push(e.addr);return r.strictEqual(t.length,this.size()),t}addSeed(t){const e=o.fromHostname(t,this.network.port);if(e.type===o.types.DNS)return this.dnsSeeds.push(e),null;const i=c.fromHost(e.host,e.port,this.network);return this.add(i),i}addNode(t){const e=o.fromHostname(t,this.network.port);if(e.type===o.types.DNS)return this.dnsNodes.push(e),null;const i=c.fromHost(e.host,e.port,this.network);return this.nodes.push(i),this.add(i),i}removeNode(t){const e=o.fromHostname(t,this.network.port);for(let t=0;t<this.nodes.length;t++){const i=this.nodes[t];if(i.host===e.host&&i.port===e.port)return this.nodes.splice(t,1),!0}return!1}setSeeds(t){this.dnsSeeds.length=0;for(const e of t)this.addSeed(e)}setNodes(t){this.dnsNodes.length=0,this.nodes.length=0;for(const e of t)this.addNode(e)}addLocal(t,e,i){const r=c.fromHost(t,e,this.network);return r.services=this.options.services,this.pushLocal(r,i)}pushLocal(t,e){if(!t.isRoutable())return!1;if(this.local.has(t.hostname))return!1;const i=new function(t,e){this.addr=t,this.score=e||0}(t,e);return this.local.set(t.hostname,i),!0}getLocal(t){let e=-1,i=-1,r=null;if(t||(t=this.address),0===this.local.size)return null;for(const s of this.local.values()){const n=t.getReachability(s.addr);n<e||(n>e||s.score>i)&&(e=n,i=s.score,r=s.addr)}return r.time=this.network.now(),r}markLocal(t){const e=this.local.get(t.hostname);return!!e&&(e.score++,!0)}async discoverSeeds(){const t=[];for(const e of this.dnsSeeds)t.push(this.populateSeed(e));await Promise.all(t)}async discoverNodes(){const t=[];for(const e of this.dnsNodes)t.push(this.populateNode(e));await Promise.all(t)}async populateNode(t){const e=await this.populate(t);0!==e.length&&(this.nodes.push(e[0]),this.add(e[0]))}async populateSeed(t){const e=await this.populate(t);for(const t of e)this.add(t)}async populate(t){const e=[];let i;r(t.type===o.types.DNS,"Resolved host passed."),this.logger.info("Resolving host: %s.",t.host);try{i=await this.resolve(t.host)}catch(t){return this.logger.error(t),e}for(const r of i){const i=c.fromHost(r,t.port,this.network);e.push(i)}return e}toJSON(){const t=[],e=[],i=[];for(const e of this.map.values())t.push(e.toJSON());for(const t of this.fresh){const i=[];for(const e of t.keys())i.push(e);e.push(i)}for(const t of this.used){const e=[];for(let i=t.head;i;i=i.next)e.push(i.key());i.push(e)}return{version:w.VERSION,addrs:t,fresh:e,used:i}}fromJSON(t){const e=new Map,i=new Map;let s=0,n=0;const o=[],a=[];r(t&&"object"==typeof t),r(t.version===w.VERSION,"Bad address serialization version."),r(Array.isArray(t.addrs));for(const r of t.addrs){const t=y.fromJSON(r,this.network);let s=e.get(t.src.hostname);s||(s=t.src,e.set(s.hostname,s)),t.src=s,i.set(t.key(),t)}r(Array.isArray(t.fresh)),r(t.fresh.length<=this.options.maxBuckets,"Buckets mismatch.");for(const e of t.fresh){const t=new Map;for(const n of e){const e=i.get(n);r(e),0===e.refCount&&s++,e.refCount++,t.set(n,e)}r(t.size<=this.options.maxEntries,"Bucket size mismatch."),o.push(t)}r(o.length===this.fresh.length,"Buckets mismatch."),r(Array.isArray(t.used)),r(t.used.length<=this.options.maxBuckets,"Buckets mismatch.");for(const e of t.used){const t=new u;for(const s of e){const e=i.get(s);r(e),r(0===e.refCount),r(!e.used),e.used=!0,n++,t.push(e)}r(t.size<=this.options.maxEntries,"Bucket size mismatch."),a.push(t)}r(a.length===this.used.length,"Buckets mismatch.");for(const t of i.values())r(t.used||t.refCount>0);return this.map=i,this.fresh=o,this.totalFresh=s,this.used=a,this.totalUsed=n,this}static fromJSON(t,e){return new y(t).fromJSON(e)}}w.HORIZON_DAYS=30,w.RETRIES=3,w.MIN_FAIL_DAYS=7,w.MAX_FAILURES=10,w.MAX_REFS=8,w.VERSION=0,w.scores={NONE:0,IF:1,BIND:2,UPNP:3,HTTP:3,MANUAL:4,MAX:5};class y{constructor(t,e){this.addr=t||new c,this.src=e||new c,this.prev=null,this.next=null,this.used=!1,this.refCount=0,this.attempts=0,this.lastSuccess=0,this.lastAttempt=0,t&&this.fromOptions(t,e)}fromOptions(t,e){return r(t instanceof c),r(e instanceof c),this.addr=t,this.src=e,this}static fromOptions(t,e){return(new y).fromOptions(t,e)}key(){return this.addr.hostname}chance(t){let e=1;return t-this.lastAttempt<600&&(e*=.01),e*Math.pow(.66,Math.min(this.attempts,8))}inspect(){return{addr:this.addr,src:this.src,used:this.used,refCount:this.refCount,attempts:this.attempts,lastSuccess:n.date(this.lastSuccess),lastAttempt:n.date(this.lastAttempt)}}toJSON(){return{addr:this.addr.hostname,src:this.src.hostname,services:this.addr.services.toString(2),time:this.addr.time,attempts:this.attempts,lastSuccess:this.lastSuccess,lastAttempt:this.lastAttempt}}fromJSON(t,e){if(r(t&&"object"==typeof t),r("string"==typeof t.addr),r("string"==typeof t.src),this.addr.fromHostname(t.addr,e),null!=t.services){r("string"==typeof t.services),r(t.services.length>0),r(t.services.length<=32);const e=parseInt(t.services,2);r(n.isU32(e)),this.addr.services=e}return null!=t.time&&(r(n.isU64(t.time)),this.addr.time=t.time),null!=t.src&&(r("string"==typeof t.src),this.src.fromHostname(t.src,e)),null!=t.attempts&&(r(n.isU64(t.attempts)),this.attempts=t.attempts),null!=t.lastSuccess&&(r(n.isU64(t.lastSuccess)),this.lastSuccess=t.lastSuccess),null!=t.lastAttempt&&(r(n.isU64(t.lastAttempt)),this.lastAttempt=t.lastAttempt),this}static fromJSON(t,e){return(new y).fromJSON(t,e)}}class b{constructor(t){this.network=h.primary,this.logger=g.global,this.resolve=p.lookup,this.host="0.0.0.0",this.port=this.network.port,this.services=f.LOCAL_SERVICES,this.onion=!1,this.banTime=f.BAN_TIME,this.address=new c,this.address.services=this.services,this.address.time=this.network.now(),this.seeds=this.network.seeds,this.nodes=[],this.maxBuckets=20,this.maxEntries=50,this.prefix=null,this.filename=null,this.persistent=!1,this.flushInterval=12e4,t&&this.fromOptions(t)}fromOptions(t){if(r(t,"Options are required."),null!=t.node&&(r("object"==typeof t.node),this.node=t.node),null!=t.network&&(this.network=h.get(t.network),this.seeds=this.network.seeds,this.address.port=this.network.port,this.port=this.network.port),null!=t.logger&&(r("object"==typeof t.logger),this.logger=t.logger),null!=t.resolve&&(r("function"==typeof t.resolve),this.resolve=t.resolve),null!=t.banTime&&(r(t.banTime>=0),this.banTime=t.banTime),t.seeds&&(r(Array.isArray(t.seeds)),this.seeds=t.seeds),t.nodes&&(r(Array.isArray(t.nodes)),this.nodes=t.nodes),null!=t.host){r("string"==typeof t.host);const e=o.toBuffer(t.host);this.host=o.toString(e),o.isRoutable(e)&&this.address.setHost(this.host)}return null!=t.port&&(r("number"==typeof t.port),r(t.port>0&&t.port<=65535),this.port=t.port,this.address.setPort(this.port)),null!=t.publicHost&&(r("string"==typeof t.publicHost),this.address.setHost(t.publicHost)),null!=t.publicPort&&(r("number"==typeof t.publicPort),r(t.publicPort>0&&t.publicPort<=65535),this.address.setPort(t.publicPort)),null!=t.services&&(r("number"==typeof t.services),this.services=t.services),null!=t.onion&&(r("boolean"==typeof t.onion),this.onion=t.onion),null!=t.maxBuckets&&(r("number"==typeof t.maxBuckets),this.maxBuckets=t.maxBuckets),null!=t.maxEntries&&(r("number"==typeof t.maxEntries),this.maxEntries=t.maxEntries),null!=t.persistent&&(r("boolean"==typeof t.persistent),this.persistent=t.persistent),null!=t.prefix&&(r("string"==typeof t.prefix),this.prefix=t.prefix,this.filename=s.join(this.prefix,"hosts.json")),null!=t.filename&&(r("string"==typeof t.filename),this.filename=t.filename),null!=t.flushInterval&&(r(t.flushInterval>=0),this.flushInterval=t.flushInterval),this.address.time=this.network.now(),this.address.services=this.services,this}}t.exports=w}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * seeds.js - seeds for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(555),s=i(556);e.get=function(t){switch(t){case"main":return r;case"testnet":return s;default:return[]}}},function(t,e,i){"use strict";t.exports=[]},function(t,e,i){"use strict";t.exports=[]},function(t,e,i){"use strict";
/*!
 * BroadcastItem.js - peer management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=i(24),n=i(3),o=i(35),a=(i(52),i(18),i(39).types);t.exports=class extends s{constructor(t,e){super(),r(!e.mutable,"Cannot broadcast mutable item.");const i=e.toInv();this.pool=t,this.hash=i.hash,this.type=i.type,this.msg=e,this.jobs=[]}addJob(t,e){this.jobs.push(o.job(t,e))}start(){return r(!this.timeout,"Already started."),r(!this.pool.hasInv(this.hash),"Already started."),this.pool.setInv(this.hash,this),this.refresh(),this}refresh(){null!=this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.timeout=setTimeout(()=>{this.emit("timeout"),this.reject(new Error("Timed out."))},this.pool.options.invTimeout)}announce(){switch(this.type){case a.TX:this.pool.announceTX(this.msg);break;case a.BLOCK:this.pool.announceBlock(this.msg);break;default:r(!1,"Bad type.")}}cleanup(){r(null!=this.timeout,"Already finished."),r(this.pool.hasInv(this.hash),"Already finished."),clearTimeout(this.timeout),this.timeout=null,this.pool.delInv(this.hash)}reject(t){this.cleanup();for(const e of this.jobs)e.reject(t);this.jobs.length=0}resolve(){this.cleanup();for(const t of this.jobs)t.resolve(!1);this.jobs.length=0}handleAck(t){setTimeout(()=>{this.emit("ack",t);for(const t of this.jobs)t.resolve(!0);this.jobs.length=0},1e3)}handleReject(t){this.emit("reject",t);for(const t of this.jobs)t.resolve(!1);this.jobs.length=0}inspect(){return`<BroadcastItem: type=${this.type===a.TX?"tx":"block"} hash=${n.revHex(this.hash)}>`}}},function(t,e,i){"use strict";(function(e){
/*!
 * PoolOptions.js - peer management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(3),n=i(48),o=i(60),a=i(30),h=i(16),c=i(185),u=i(183),l=(o.services,i(559));function f(t){if(!(this instanceof f))return new f(t);this.network=h.primary,this.logger=null,this.node=null,this.chain=null,this.mempool=null,this.nonces=new l,this.prefix=null,this.checkpoints=!0,this.spv=!1,this.bip37=!1,this.listen=!1,this.compact=!0,this.noRelay=!1,this.host="0.0.0.0",this.port=this.network.port,this.publicHost="0.0.0.0",this.publicPort=this.network.port,this.maxOutbound=8,this.maxInbound=8,this.createSocket=this._createSocket.bind(this),this.createServer=c.createServer,this.resolve=this._resolve.bind(this),this.proxy=null,this.wsport=this.network.wsport,this.onion=!1,this.upnp=!1,this.selfish=!1,this.version=o.PROTOCOL_VERSION,this.agent=o.USER_AGENT,this.bip151=!1,this.bip150=!1,this.authPeers=[],this.knownPeers={},this.identityKey=a.generatePrivateKey(),this.banScore=o.BAN_SCORE,this.banTime=o.BAN_TIME,this.feeRate=-1,this.seeds=this.network.seeds,this.nodes=[],this.invTimeout=6e4,this.blockMode=0,this.services=o.LOCAL_SERVICES,this.requiredServices=o.REQUIRED_SERVICES,this.persistent=!1,this.fromOptions(t)}f.prototype.fromOptions=function(t){if(r(t,"Pool requires options."),r(t.node&&"object"==typeof t.node,"Pool options require a node."),r(t.node.chain&&"object"==typeof t.node.chain,"Pool options require a blockchain."),this.node=t.node,null!=this.node.mempool&&(r("object"==typeof this.node.mempool),this.mempool=this.node.mempool),this.chain=this.node.chain,this.network=this.chain.network,this.logger=this.chain.logger,this.port=this.network.port,this.seeds=this.network.seeds,this.port=this.network.port,this.publicPort=this.network.port,null!=t.logger&&(r("object"==typeof t.logger),this.logger=t.logger),null!=t.prefix&&(r("string"==typeof t.prefix),this.prefix=t.prefix),null!=t.checkpoints?(r("boolean"==typeof t.checkpoints),r(t.checkpoints===this.chain.options.checkpoints),this.checkpoints=t.checkpoints):this.checkpoints=this.chain.options.checkpoints,null!=t.spv?(r("boolean"==typeof t.spv),r(t.spv===this.chain.options.spv),this.spv=t.spv):this.spv=this.chain.options.spv,null!=t.bip37&&(r("boolean"==typeof t.bip37),this.bip37=t.bip37),null!=t.listen&&(r("boolean"==typeof t.listen),this.listen=t.listen),null!=t.compact&&(r("boolean"==typeof t.compact),this.compact=t.compact),null!=t.noRelay&&(r("boolean"==typeof t.noRelay),this.noRelay=t.noRelay),null!=t.host){r("string"==typeof t.host);const e=n.toBuffer(t.host);this.host=n.toString(e),n.isRoutable(e)&&(this.publicHost=this.host)}return null!=t.port&&(r(s.isU16(t.port)),this.port=t.port,this.publicPort=t.port),null!=t.publicHost&&(r("string"==typeof t.publicHost),this.publicHost=n.normalize(t.publicHost)),null!=t.publicPort&&(r(s.isU16(t.publicPort)),this.publicPort=t.publicPort),null!=t.maxOutbound&&(r("number"==typeof t.maxOutbound),r(t.maxOutbound>0),this.maxOutbound=t.maxOutbound),null!=t.maxInbound&&(r("number"==typeof t.maxInbound),this.maxInbound=t.maxInbound),t.createSocket&&(r("function"==typeof t.createSocket),this.createSocket=t.createSocket),t.createServer&&(r("function"==typeof t.createServer),this.createServer=t.createServer),t.resolve&&(r("function"==typeof t.resolve),this.resolve=t.resolve),t.proxy&&(r("string"==typeof t.proxy),this.proxy=t.proxy),t.wsport&&(r("number"==typeof t.wsport),this.wsport=t.wsport),null!=t.onion&&(r("boolean"==typeof t.onion),this.onion=t.onion),null!=t.upnp&&(r("boolean"==typeof t.upnp),this.upnp=t.upnp),t.selfish&&(r("boolean"==typeof t.selfish),this.selfish=t.selfish),t.version&&(r("number"==typeof t.version),this.version=t.version),t.agent&&(r("string"==typeof t.agent),r(t.agent.length<=255),this.agent=t.agent),null!=t.bip151&&(r("boolean"==typeof t.bip151),this.bip151=t.bip151),null!=t.bip150&&(r("boolean"==typeof t.bip150),r(!t.bip150||this.bip151,"Cannot enable bip150 without bip151."),t.knownPeers&&(r("object"==typeof t.knownPeers),r(!Array.isArray(t.knownPeers)),this.knownPeers=t.knownPeers),t.authPeers&&(r(Array.isArray(t.authPeers)),this.authPeers=t.authPeers),t.identityKey&&(r(e.isBuffer(t.identityKey),"Identity key must be a buffer."),r(a.privateKeyVerify(t.identityKey),"Invalid identity key."),this.identityKey=t.identityKey)),null!=t.banScore&&(r("number"==typeof this.options.banScore),this.banScore=this.options.banScore),null!=t.banTime&&(r("number"==typeof this.options.banTime),this.banTime=this.options.banTime),null!=t.feeRate&&(r("number"==typeof this.options.feeRate),this.feeRate=this.options.feeRate),t.seeds&&(r(Array.isArray(t.seeds)),this.seeds=t.seeds),t.nodes&&(r(Array.isArray(t.nodes)),this.nodes=t.nodes),null!=t.only&&(r(Array.isArray(t.only)),t.only.length>0&&(this.nodes=t.only,this.maxOutbound=t.only.length)),null!=t.invTimeout&&(r("number"==typeof t.invTimeout),this.invTimeout=t.invTimeout),null!=t.blockMode&&(r("number"==typeof t.blockMode),this.blockMode=t.blockMode),null!=t.persistent&&(r("boolean"==typeof t.persistent),this.persistent=t.persistent),this.spv&&(this.requiredServices|=o.services.BLOOM,this.services&=~o.services.NETWORK,this.noRelay=!0,this.checkpoints=!0,this.compact=!1,this.bip37=!1,this.listen=!1),this.selfish&&(this.services&=~o.services.NETWORK,this.bip37=!1),this.bip37&&(this.services|=o.services.BLOOM),this.proxy&&(this.listen=!1),null!=t.services&&(r(s.isU32(t.services)),this.services=t.services),null!=t.requiredServices&&(r(s.isU32(t.requiredServices)),this.requiredServices=t.requiredServices),this},f.fromOptions=function(t){return(new f).fromOptions(t)},f.prototype.getHeight=function(){return this.chain.height},f.prototype.isFull=function(){return this.chain.synced},f.prototype.getRequiredServices=function(){let t=this.requiredServices;return this.hasWitness()&&(t|=o.services.WITNESS),t},f.prototype.hasWitness=function(){return this.chain.state.hasWitness()},f.prototype.createNonce=function(t){return this.nonces.alloc(t)},f.prototype.hasNonce=function(t){return this.nonces.has(t)},f.prototype.getRate=function(t){if(!this.mempool)return-1;const e=this.mempool.getEntry(t);return e?e.getRate():-1},f.prototype._createSocket=function(t,e){let i={proxy:this.proxy,wsport:this.wsport};return c.createSocket(t,e,i)},f.prototype._resolve=function(t){return this.onion?u.lookup(t,this.proxy):u.lookup(t)},t.exports=f}).call(this,i(0).Buffer)},function(t,e,i){const r=i(1),s=i(3);function n(){this.map=new Map,this.hosts=new Map}n.prototype.alloc=function(t){for(;;){const e=s.nonce(),i=e.toString("hex");if(!this.map.has(i))return this.map.set(i,t),r(!this.hosts.has(t)),this.hosts.set(t,i),e}},n.prototype.has=function(t){const e=t.toString("hex");return this.map.has(e)},n.prototype.remove=function(t){const e=this.hosts.get(t);return!!e&&(this.hosts.delete(t),r(this.map.has(e)),this.map.delete(e),!0)},t.exports=n},function(t,e,i){"use strict";
/*!
 * PeerList.js - peer management for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(1),s=(i(18),i(186));function n(){this.map=new Map,this.ids=new Map,this.list=new s,this.load=null,this.inbound=0,this.outbound=0}n.prototype.head=function(){return this.list.head},n.prototype.tail=function(){return this.list.tail},n.prototype.size=function(){return this.list.size},n.prototype.add=function(t){r(this.list.push(t)),r(!this.map.has(t.hostname())),this.map.set(t.hostname(),t),r(!this.ids.has(t.id)),this.ids.set(t.id,t),t.outbound?this.outbound++:this.inbound++},n.prototype.remove=function(t){r(this.list.remove(t)),r(this.ids.has(t.id)),this.ids.delete(t.id),r(this.map.has(t.hostname())),this.map.delete(t.hostname()),t===this.load&&(r(t.loader),t.loader=!1,this.load=null),t.outbound?this.outbound--:this.inbound--},n.prototype.get=function(t){return this.map.get(t)},n.prototype.has=function(t){return this.map.has(t)},n.prototype.find=function(t){return this.ids.get(t)},n.prototype.destroy=function(){let t;for(let e=this.list.head;e;e=t)t=e.next,e.destroy()},t.exports=n},function(t,e,i){"use strict";e.unsupported=!0},function(t,e){t.exports=function(t){}},function(t,e,i){"use strict";
/*!
 * primitives/index.js - primitives for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.AbstractBlock=i(110),e.Address=i(26),e.Block=i(52),e.Coin=i(41),e.Headers=i(69),e.Input=i(68),e.InvItem=i(39),e.KeyRing=i(46),e.MemBlock=i(440),e.MerkleBlock=i(111),e.MTX=i(51),e.NetAddress=i(82),e.Outpoint=i(37),e.Output=i(28),e.TX=i(17),e.TXMeta=i(193)},function(t,e,i){"use strict";
/*!
 * protocol/index.js - protocol constants for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.consensus=i(10),e.errors=i(36),e.Network=i(16),e.networks=i(132),e.policy=i(33),e.timedata=i(133)},function(t,e,i){"use strict";
/*!
 * script/index.js - scripting for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.common=i(27),e.Opcode=i(107),e.Program=i(134),e.Script=i(20),e.ScriptError=i(67),e.ScriptNum=i(57),e.sigcache=i(454),e.Stack=i(77),e.Witness=i(78)},function(t,e,i){"use strict";
/*!
 * utils/index.js - utils for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.ASN1=i(251),e.AsyncObject=i(59),e.base32=i(146),e.base58=i(56),e.bech32=i(189),e.Bloom=i(79),e.co=i(35),e.encoding=i(4),e.enforce=i(567),e.fs=i(71),e.GCSFilter=i(568),e.Heap=i(365),e.Int64=i(87),e.IP=i(48),e.List=i(186),e.Lock=i(34),e.LRU=i(98),e.MappedLock=i(384),e.murmur3=i(108),e.nfkd=i(404),e.PEM=i(252),e.ProtoWriter=i(131),e.ProtoReader=i(127),e.RBT=i(396),e.BufferReader=i(2),e.RollingFilter=i(204),e.StaticWriter=i(6),e.util=i(3),e.Validator=i(179),e.BufferWriter=i(13),e.verifyData=i(196)},function(t,e,i){"use strict";(function(e){
/*!
 * enforce.js - type enforcement for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(3);function s(t,e,i,r){t||(r||(r=s),e&&!i&&n(e,r),e||(e="value"),n(`'${e}' must be a(n) ${i}.`,r))}function n(t,e){const i=new TypeError(t);throw Error.captureStackTrace&&e&&Error.captureStackTrace(i,e),i}s.none=function t(e,i){s(null==e,i,"object",t)},s.nul=function t(e,i){s(null===e,i,"object",t)},s.undef=function t(e,i){s(void 0===e,i,"object",t)},s.str=function t(e,i){s("string"==typeof e,i,"string",t)},s.bool=function t(e,i){s("boolean"==typeof e,i,"boolean",t)},s.num=function t(e,i){s(r.isNumber(e),i,"number",t)},s.obj=function t(e,i){s(e&&"object"==typeof e&&!Array.isArray(e),i,"object",t)},s.array=function t(e,i){s(Array.isArray(e),i,"object",t)},s.func=function t(e,i){s("function"==typeof e,i,"function",t)},s.error=function t(e,i){s(e instanceof Error,i,"object",t)},s.regexp=function t(e,i){s(e&&"function"==typeof e.exec,i,"object",t)},s.buf=function t(i,r){s(e.isBuffer(i),r,"buffer",t)},s.len=function t(e,i,r){("string"!=typeof e&&!e||e.length!==i)&&(r||(r="value"),n(`'${r}' must have a length of ${i}.`,t))},s.instance=function t(e,i,r){e instanceof i||(r||(r="value"),n(`'${r}' must be an instance of ${i.name}.`,t))},s.uint=function t(e,i){s(r.isUInt(e),i,"uint",t)},s.int=function t(e,i){s(r.isInt(e),i,"int",t)},s.u8=function t(e,i){s(r.isU8(e),i,"uint8",t)},s.u16=function t(e,i){s(r.isU16(e),i,"uint16",t)},s.u32=function t(e,i){s(r.isU32(e),i,"uint32",t)},s.u64=function t(e,i){s(r.isU64(e),i,"uint64",t)},s.i8=function t(e,i){s(r.isI8(e),i,"int8",t)},s.i16=function t(e,i){s(r.isI16(e),i,"int16",t)},s.i32=function t(e,i){s(r.isI32(e),i,"int32",t)},s.i64=function t(e,i){s(r.isI64(e),i,"int64",t)},s.ufloat=function t(e,i){s(r.isUfloat(e),i,"positive float",t)},s.float=function t(e,i){s(r.isFloat(e),i,"float",t)},s.ascii=function t(e,i){s(r.isAscii(e),i,"ascii string",t)},s.hex=function t(e,i){s(r.isHex(e),i,"hex string",t)},s.hex160=function t(e,i){s(r.isHex160(e),i,"160 bit hex string",t)},s.hex256=function t(e,i){s(r.isHex256(e),i,"256 bit hex string",t)},s.base58=function t(e,i){s(r.isBase58(e),i,"base58 string",t)},t.exports=s}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * gcs.js - gcs filters for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),{U64:s}=i(87),n=i(9),o=i(357),a=e.alloc(0),h=new s(-1);function c(){this.n=0,this.p=0,this.m=new s(0),this.data=a}function u(){this.stream=[],this.remain=0}function l(t){this.stream=t,this.pos=0,this.remain=8}function f(t,e){return t.cmp(e)}function d(t,e){const[i,r]=o(t,e);return s.fromBits(i,r)}function p(t,e){for(const i of e.code)i.data&&0!==i.data.length&&t.push(i.data)}function g(t,e){for(const i of e.items)0!==i.length&&t.push(i)}c.prototype.hash=function(t){const e=n.hash256(this.data);return"hex"===t?e.toString("hex"):e},c.prototype.header=function(t){return n.root256(this.hash(),t)},c.prototype.match=function(t,e){const i=new l(this.data),r=d(e,t).imod(this.m);let n=new s(0);for(;n.lt(r);){const t=this.readU64(i);if(t===h)return!1;if(t.iadd(n),t.eq(r))return!0;n=t}return!1},c.prototype.matchAny=function(t,e){r(e.length>0);const i=new l(this.data),n=new s(0),o=[];for(const i of e){const e=d(i,t).imod(this.m);o.push(e)}o.sort(f);let a=o[0],c=1;for(;;){const t=n.cmp(a);if(0===t)break;if(t>0){if(c<o.length){a=o[c],c+=1;continue}return!1}const e=this.readU64(i);if(e===h)return!1;n.iadd(e)}return!0},c.prototype.readU64=function(t){try{return this._readU64(t)}catch(t){if("EOF"===t.message)return h;throw t}},c.prototype._readU64=function(t){const e=new s(0);for(;t.readBit();)e.iaddn(1);const i=t.readBits64(this.p);return e.ishln(this.p).ior(i)},c.prototype.toBytes=function(){return this.data},c.prototype.toNBytes=function(){const t=e.allocUnsafe(4+this.data.length);return t.writeUInt32BE(this.n,0,!0),this.data.copy(t,4),t},c.prototype.toPBytes=function(){const t=e.allocUnsafe(1+this.data.length);return t.writeUInt8(this.p,0,!0),this.data.copy(t,1),t},c.prototype.toNPBytes=function(){const t=e.allocUnsafe(5+this.data.length);return t.writeUInt32BE(this.n,0,!0),t.writeUInt8(this.p,4,!0),this.data.copy(t,5),t},c.prototype.toRaw=function(){return r(20===this.p),this.toNBytes()},c.prototype.fromItems=function(t,i,n){r("number"==typeof t&&isFinite(t)),r(t>=0&&t<=32),r(e.isBuffer(i)),r(16===i.length),r(Array.isArray(n)),r(n.length>0),r(n.length<=4294967295),this.n=n.length,this.p=t,this.m=s(this.n).ishln(this.p);const o=[];for(const t of n){r(e.isBuffer(t));const s=d(t,i).imod(this.m);o.push(s)}o.sort(f);const a=new u;let h=new s(0);for(const t of o){const e=t.sub(h).imaskn(this.p),i=t.sub(h).isub(e).ishrn(this.p);for(h=t;!i.isZero();)a.writeBit(1),i.isubn(1);a.writeBit(0),a.writeBits64(e,this.p)}return this.data=a.render(),this},c.prototype.fromBytes=function(t,i,n){return r("number"==typeof t&&isFinite(t)),r("number"==typeof i&&isFinite(i)),r(i>=0&&i<=32),r(e.isBuffer(n)),this.n=t,this.p=i,this.m=s(this.n).ishln(this.p),this.data=n,this},c.prototype.fromNBytes=function(t,i){r("number"==typeof t&&isFinite(t)),r(e.isBuffer(i)),r(i.length>=4);const s=i.readUInt32BE(0,!0);return this.fromBytes(s,t,i.slice(4))},c.prototype.fromPBytes=function(t,i){r("number"==typeof t&&isFinite(t)),r(e.isBuffer(i)),r(i.length>=1);const s=i.readUInt8(0,!0);return this.fromBytes(t,s,i.slice(1))},c.prototype.fromNPBytes=function(t){r(e.isBuffer(t)),r(t.length>=5);const i=t.readUInt32BE(0,!0),s=t.readUInt8(4,!0);return this.fromBytes(i,s,t.slice(5))},c.prototype.fromRaw=function(t){return this.fromNBytes(20,t)},c.prototype.fromBlock=function(t){const e=t.hash().slice(0,16),i=[];for(let e=0;e<t.txs.length;e++){const r=t.txs[e];if(e>0)for(const t of r.inputs)i.push(t.prevout.toRaw());for(const t of r.outputs)p(i,t.script)}return this.fromItems(20,e,i)},c.prototype.fromExtended=function(t){const e=t.hash().slice(0,16),i=[];for(let e=0;e<t.txs.length;e++){const r=t.txs[e];if(i.push(r.hash()),e>0)for(const t of r.inputs)g(i,t.witness),p(i,t.script)}return this.fromItems(20,e,i)},c.fromItems=function(t,e,i){return(new c).fromItems(t,e,i)},c.fromBytes=function(t,e,i){return(new c).fromBytes(t,e,i)},c.fromNBytes=function(t,e){return(new c).fromNBytes(t,e)},c.fromPBytes=function(t,e){return(new c).fromPBytes(t,e)},c.fromNPBytes=function(t){return(new c).fromNPBytes(t)},c.fromRaw=function(t){return(new c).fromRaw(t)},c.fromBlock=function(t){return(new c).fromBlock(t)},c.fromExtended=function(t){return(new c).fromExtended(t)},u.prototype.writeBit=function(t){if(0===this.remain&&(this.stream.push(0),this.remain=8),t){const t=this.stream.length-1;this.stream[t]|=1<<this.remain-1}this.remain--},u.prototype.writeByte=function(t){0===this.remain&&(this.stream.push(0),this.remain=8);const e=this.stream.length-1;this.stream[e]|=t>>8-this.remain&255,this.stream.push(0),this.stream[e+1]=t<<this.remain&255},u.prototype.writeBits=function(t,e){for(r(e>=0),r(e<=32),t<<=32-e;e>=8;){const i=t>>>24;this.writeByte(i),t<<=8,e-=8}for(;e>0;){const i=t>>>31;this.writeBit(i),t<<=1,e-=1}},u.prototype.writeBits64=function(t,e){r(e>=0),r(e<=64),e>32?(this.writeBits(t.hi,e-32),this.writeBits(t.lo,32)):this.writeBits(t.lo,e)},u.prototype.render=function(){const t=e.allocUnsafe(this.stream.length);for(let e=0;e<this.stream.length;e++)t[e]=this.stream[e];return t},l.prototype.readBit=function(){if(this.pos>=this.stream.length)throw new Error("EOF");if(0===this.remain){if(this.pos+=1,this.pos>=this.stream.length)throw new Error("EOF");this.remain=8}return this.remain-=1,this.stream[this.pos]>>this.remain&1},l.prototype.readByte=function(){if(this.pos>=this.stream.length)throw new Error("EOF");if(0===this.remain){if(this.pos+=1,this.pos>=this.stream.length)throw new Error("EOF");this.remain=8}if(8===this.remain){const t=this.stream[this.pos];return this.pos+=1,t}let t=this.stream[this.pos]&(1<<this.remain)-1;if(t<<=8-this.remain,this.pos+=1,this.pos>=this.stream.length)throw new Error("EOF");return t|this.stream[this.pos]>>this.remain},l.prototype.readBits=function(t){r(t>=0),r(t<=32);let e=0;for(;t>=8;)e<<=8,e|=this.readByte(),t-=8;for(;t>0;)e<<=1,e|=this.readBit(),t-=1;return e},l.prototype.readBits64=function(t){r(t>=0),r(t<=64);const e=new s;return t>32?(e.hi=this.readBits(t-32),e.lo=this.readBits(32)):e.lo=this.readBits(t),e},t.exports=c}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * wallet/index.js - wallet for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.Account=i(215),e.common=i(95),e.layout=i(121),e.MasterKey=i(455),e.Path=i(124),e.plugin=i(570),e.TXDB=i(456),e.WalletDB=i(217),e.Wallet=i(218),e.WalletKey=i(216)},function(t,e,i){"use strict";
/*!
 * plugin.js - wallet plugin for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(217),{Node:s}=i(450),n=i(579),o=i(407),a=e;a.id="walletdb",a.init=function(t,e){const i=t.config;let s=t.pool.getOnlineHost(),a=s?`http://${s.host}:${t.network.rpcPort}`:`http://${i.str("http-remote-host")}:${t.network.rpcPort}`,h=new n({network:i.network,apiKey:i.str("api-key"),mode:"jsonp",uri:a});const c=new r({network:t.network,logger:t.logger,workers:t.workers,client:e,jsonp:h,prefix:i.prefix,db:i.str(["wallet-db","db"]),maxFiles:i.uint("wallet-max-files"),cacheSize:i.mb("wallet-cache-size"),checkpoints:i.bool("wallet-checkpoints"),startHeight:i.uint("wallet-start-height"),wipeNoReally:i.bool("wallet-wipe-no-really"),hmacSalt:i.buf("hmac-salt"),devMode:i.bool("dev-mode")||!1,acl:new o(i),apiKey:i.str(["wallet-api-key","api-key"]),ssl:i.str("wallet-ssl"),host:i.str("http-host"),spv:t.spv,verify:t.spv,listen:!1});return t.http&&c.http&&t.http.mount("/wallet",c.http),t.rpc&&c.rpc&&t.rpc.mount(c.rpc),c}},function(t,e,i){"use strict";
/*!
 * TXMapWids.js - walletdb records
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(4),s=i(2),n=i(6),o=i(95);class a{constructor(t,e){this.hash=t||r.NULL_HASH,this.wids=e||new Set}add(t){return!this.wids.has(t)&&(this.wids.add(t),!0)}remove(t){return this.wids.delete(t)}toWriter(t){return o.serializeWallets(t,this.wids)}getSize(){return o.sizeWallets(this.wids)}toRaw(){const t=this.getSize();return this.toWriter(new n(t)).render()}fromReader(t){return this.wids=o.parseWallets(t),this}fromRaw(t){return this.fromReader(new s(t))}static fromReader(t,e){return new a(t).fromReader(e)}static fromRaw(t,e){return new a(t).fromRaw(e)}}t.exports=a},function(t,e,i){"use strict";
/*!
 * TXDBState.js - persistent transaction pool
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(459),s=i(6),n=i(2);class o{constructor(t,e){this.wid=t,this.id=e,this.tx=0,this.coin=0,this.unconfirmed=0,this.confirmed=0,this.committed=!1}clone(){const t=new o(this.wid,this.id);return t.tx=this.tx,t.coin=this.coin,t.unconfirmed=this.unconfirmed,t.confirmed=this.confirmed,t}commit(){return this.committed=!0,this.toRaw()}toBalance(){const t=new r(this.wid,this.id,-1);return t.unconfirmed=this.unconfirmed,t.confirmed=this.confirmed,t}toRaw(){const t=new s(32);return t.writeU64(this.tx),t.writeU64(this.coin),t.writeU64(this.unconfirmed),t.writeU64(this.confirmed),t.render()}fromRaw(t){const e=new n(t);return this.tx=e.readU64(),this.coin=e.readU64(),this.unconfirmed=e.readU64(),this.confirmed=e.readU64(),this}static fromRaw(t,e,i){return new o(t,e).fromRaw(i)}toJSON(t){return{wid:t?void 0:this.wid,id:t?void 0:this.id,tx:this.tx,coin:this.coin,unconfirmed:this.unconfirmed,confirmed:this.confirmed}}inspect(){return this.toJSON()}}t.exports=o},function(t,e,i){"use strict";
/*!
 * Credit.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(2),s=i(6),n=i(41);class o{constructor(t,e){this.coin=t||new n,this.spent=e||!1,this.own=!1}fromRaw(t){const e=new r(t);return this.coin.fromReader(e),this.spent=1===e.readU8(),this.own=!0,e.left()>0&&(this.own=1===e.readU8()),this}static fromRaw(t){return(new o).fromRaw(t)}getSize(){return this.coin.getSize()+2}toRaw(){const t=this.getSize(),e=new s(t);return this.coin.toWriter(e),e.writeU8(this.spent?1:0),e.writeU8(this.own?1:0),e.render()}fromTX(t,e,i){return this.coin.fromTX(t,e,i),this.spent=!1,this.own=!1,this}static fromTX(t,e,i){return(new o).fromTX(t,e,i)}}t.exports=o},function(t,e,i){"use strict";
/*!
 * BlockRecord.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */const r=i(3),s=i(1),n=i(2),o=i(6),a=i(4);i(187);class h{constructor(t,e,i){this.hash=t||a.NULL_HASH,this.height=null!=e?e:-1,this.time=i||0,this.hashes=[],this.index=new Set}add(t){return!this.index.has(t)&&(this.index.add(t),this.hashes.push(t),!0)}remove(t){if(!this.index.has(t))return!1;if(this.index.delete(t),this.hashes[this.hashes.length-1]===t)return this.hashes.pop(),!0;const e=this.hashes.indexOf(t);return s(-1!==e),this.hashes.splice(e,1),!0}fromRaw(t){const e=new n(t);this.hash=e.readHash("hex"),this.height=e.readU32(),this.time=e.readU32();const i=e.readU32();for(let t=0;t<i;t++){const t=e.readHash("hex");this.index.add(t),this.hashes.push(t)}return this}static fromRaw(t){return(new h).fromRaw(t)}getSize(){return 44+32*this.hashes.length}toRaw(){const t=this.getSize(),e=new o(t);e.writeHash(this.hash),e.writeU32(this.height),e.writeU32(this.time),e.writeU32(this.hashes.length);for(const t of this.hashes)e.writeHash(t);return e.render()}toJSON(){return{hash:r.revHex(this.hash),height:this.height,time:this.time,hashes:this.hashes.map(r.revHex)}}fromMeta(t){return this.hash=t.hash,this.height=t.height,this.time=t.time,this}static fromMeta(t){return(new h).fromMeta(t)}}t.exports=h},function(t,e,i){"use strict";(function(e){
/*!
 * rpc.js - bitcoind-compatible json rpc for gamegold.
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */
const r=i(1),s=i(71),n=i(3),o=i(9),a=i(31),h=i(20),c=i(26),u=i(46),l=i(111),f=i(51),d=i(37),p=i(28),g=i(17),m=i(4),w=i(113),y=w.errors,b=w.MAGIC_STRING,v=i(91),k=i(114),S=i(179),x=i(95),E=i(10),{OperType:R}=i(8),_=(i(218),i(217),i(48)),A=i(215);t.exports=class extends w{constructor(t){super(),r(t,"RPC requires a WalletDB."),this.wdb=t,this.network=t.network,this.logger=t.logger.context("rpc"),this.client=t.client,this.init()}init(){this.add("wallet",this.routerOfWallet),this.add("wallet.select",this.selectWallet),this.add("wallet.create",this.mkwallet),this.add("wallet.list",this.getWallets),this.add("wallet.info",this.getWalletInfo),this.add("wallet.block",this.getWalletBlock),this.add("wallet.dump",this.dumpWallet),this.add("wallet.import",this.importWallet),this.add("wallet.backup",this.backup),this.add("wallet.encrypt",this.encryptWallet),this.add("wallet.decrypt",this.decryptWallet),this.add("wallet.changepassphrase",this.changePassphrase),this.add("wallet.lock",this.walletLock),this.add("wallet.unlock",this.unlock),this.add("wallet.blocks",this.getblocks),this.add("wallet.auth",this.walletAuth),this.add("key",this.routerOfKey),this.add("key.export.private",this.dumpPrivKey),this.add("key.export.public",this.getKey),this.add("key.master",this.masterkey),this.add("key.import.private",this.importPrivKey),this.add("key.import.public",this.importPubkey),this.add("key.import.address",this.importAddress),this.add("key.shared.add",this.addShared),this.add("key.shared.del",this.removeShared),this.add("account",this.routerOfAccount),this.add("account.list",this.listAccounts),this.add("account.get",this.accountGet),this.add("account.create",this.accountCreate),this.add("account.amount",this.listReceivedByAccount),this.add("account.received",this.getReceivedByAccount),this.add("account.listreceived",this.listReceivedByAccount),this.add("balance.confirmed",this.getBalance),this.add("balance.all",this.getBalanceAll),this.add("balance.unconfirmed",this.getUnconfirmedBalance),this.add("sys.walletdb.stop",this.stop),this.add("sys.walletdb.create",this.createWalletDb),this.add("sys.walletdb.destroy",this.destroyWalletDb),this.add("sys.zap",this.zap),this.add("sys.setfee",this.setTXFee),this.add("sys.message.sign",this.signMessage),this.add("sys.rescan",this.rescan),this.add("sys.groupPrefix",this.addGroupPrefix),this.add("sys.groupSuffix",this.addGroupSuffix),this.add("sys.notify",this.sysNotify),this.add("sys.listNotify",this.listNotify),this.add("address",this.routerOfAddress),this.add("address.list",this.getAddressesByAccount),this.add("address.receive",this.getAccountAddress),this.add("address.change",this.getAccountChangeAddress),this.add("address.nested",this.getAccountNestedAddress),this.add("address.create",this.createAddress),this.add("address.receive.create",this.createAddress),this.add("address.change.create",this.createChange),this.add("address.nested.create",this.createNested),this.add("address.import",this.importAddress),this.add("address.key",this.getKey),this.add("address.wif",this.getwif),this.add("address.amount",this.getReceivedByAddress),this.add("address.account",this.getAccount),this.add("address.received",this.getReceivedByAddress),this.add("address.received.list",this.listReceivedByAddress),this.add("cp",this.routerOfCp),this.add("cp.create",this.cpRegister),this.add("cp.change",this.cpChange),this.add("cp.byName",this.cpByName),this.add("cp.byId",this.cpById),this.add("cp.list.wallet",this.cpList),this.add("token.user",this.getUserToken),this.add("order.pay",this.payOrder),this.add("order.notify",this.orderNotify),this.add("order.list",this.orderList),this.add("prop",this.routerOfProp),this.add("prop.create",this.propCreate),this.add("prop.send",this.propExchange),this.add("prop.donate",this.propDonate),this.add("prop.receive",this.propReceive),this.add("prop.createlist",this.propCreateList),this.add("prop.sendlist",this.propSendList),this.add("prop.order",this.propOrder),this.add("prop.found",this.propFound),this.add("prop.sale",this.propSale),this.add("prop.buy",this.propBuy),this.add("prop.list",this.getProps),this.add("prop.count",this.getPropsCount),this.add("prop.list.details",this.getPropsDetails),this.add("prop.list.created",this.propCreatedList),this.add("prop.list.auction",this.mySaleList),this.add("prop.list.bid",this.onSaleList),this.add("contract",this.routerOfContract),this.add("contract.create",this.contractCreate),this.add("contract.promise",this.contractPromise),this.add("contract.execute",this.contractExecute),this.add("contract.mine",this.contractOfMine),this.add("tx.get.wallet",this.getTransaction),this.add("tx.list",this.listTransactions),this.add("tx.sign",this.signTX),this.add("tx.create",this.createTX),this.add("tx.send",this.sendTX),this.add("tx.sendfrom",this.sendFrom),this.add("tx.sendto",this.sendToAddress),this.add("tx.sendmany",this.sendMany),this.add("tx.last",this.getLast),this.add("tx.resendall",this.resend),this.add("tx.penging",this.getpending),this.add("tx.abandon",this.abandonTransaction),this.add("tx.importprunedfunds",this.importPrunedFunds),this.add("tx.removeprunedfunds",this.removePrunedFunds),this.add("tx.resend",this.resendWalletTransactions),this.add("tx.range",this.getRange),this.add("tx.history",this.getHistory),this.add("tx.history.since",this.listSinceBlock),this.add("tx.fund",this.fundRawTransaction),this.add("coin",this.routerOfCoin),this.add("coin.get",this.getCoin),this.add("coin.locked.add",this.lockCoin),this.add("coin.locked.get",this.getLockedCoins),this.add("coin.locked.del",this.unlockCoin),this.add("txo.locked",this.listLockUnspent),this.add("txo.list",this.listUnspent),this.add("txo.lock",this.lockUnspent)}async isReady(t){return(await this.wallet(t)).db.isFull()}async wallet(t){let e=null;return t&&t.options&&(e=await this.wdb.get(t.options.wid)),e||(e=await this.wdb.get("primary")),e}async simulateAccount(t,e){return this.wdb.options.acl.isRoot(this.$account)?e:(await t.ensureAccount({name:this.$account,witness:!0}),this.$account)}async stop(t,e,i){if(e||0!==t.length)throw new v(y.MISC_ERROR,"sys.walletdb.stop");return this.wdb.close(),"Stopping walletdb..."}async destroyWalletDb(t,e,i){if(e||0!==t.length)throw new v(y.MISC_ERROR,"sys.walletdb.destroy: 删除钱包数据库");return await this.wdb.close(),await this.wdb.destroy(),"Destroyed."}async createWalletDb(t,e,i){if(e||0!==t.length)throw new v(y.MISC_ERROR,"sys.walletdb.create: 删除原有钱包数据库并重建");return await this.wdb.close(),await this.wdb.destroy(),await this.wdb.open(),"Created."}async fundRawTransaction(t,e,i){if(e||t.length<1||t.length>2)throw new v(y.MISC_ERROR,'tx.fund "hexstring" ( options )');const r=await this.wallet(i),s=new S([t]),n=s.buf(0),o=s.obj(1);if(!n)throw new v(y.TYPE_ERROR,"Invalid hex string.");const h=f.fromRaw(n);if(0===h.outputs.length)throw new v(y.INVALID_PARAMETER,"TX must have at least one output.");let c=null,u=null;if(o){const t=new S([o]);c=t.ufixed("feeRate",8),(u=t.str("changeAddress"))&&(u=w.parseAddress(u,this.network))}return await r.fund(h,{rate:c,changeAddress:u}),{hex:h.toRaw().toString("hex"),changepos:h.changeIndex,fee:a.btc(h.getFee(),!0)}}async backup(t,e,i){const r=new S([t]).str(0);if(!r)throw new v(y.MISC_ERROR,'backup "destination"');return await this.wdb.backup(r),!0}async dumpPrivKey(t,e,i){if(e||1!==t.length)throw new v(y.MISC_ERROR,'key.export.private "bitcoinaddress"');const r=await this.wallet(i),s=new S([t]).str(0,""),n=w.parseHash(s,this.network),o=await r.getPrivateKey(n);if(!o)throw new v(y.MISC_ERROR,"Key not found.");return o.toSecret()}async dumpWallet(t,e,i){if(e||1!==t.length)throw new v(y.MISC_ERROR,'wallet.dump "filename"');const r=await this.wallet(i),o=new S([t]).str(0);if(!o)throw new v(y.TYPE_ERROR,"Invalid parameter.");const a=await this.wdb.getTip(),h=n.date(),c=[n.fmt("# Wallet Dump created by Gamegold %s",k.version),n.fmt("# * Created on %s",h),n.fmt("# * Best block at time of backup was %d (%s).",a.height,n.revHex(a.hash)),n.fmt("# * File: %s",o),""],u=await r.getAddressHashes();for(const t of u){const e=await r.getPrivateKey(t);if(!e)continue;const i=e.getAddress("string");let s="%s %s label= addr=%s";1===e.branch?s="%s %s change=1 addr=%s":2==e.branch&&(s="%s %s nested=1 addr=%s");const o=n.fmt(s,e.toSecret(),h,i);c.push(o)}c.push(""),c.push("# End of dump"),c.push("");const l=c.join("\n");return s.unsupported?l:(await s.writeFile(o,l,"utf8"),null)}async encryptWallet(t,e,i){const r=await this.wallet(i);if(!r.master.encrypted&&(e||1!==t.length))throw new v(y.MISC_ERROR,'wallet.encrypt "passphrase"');const s=new S([t]).str(0,"");if(r.master.encrypted)throw new v(y.WALLET_WRONG_ENC_STATE,"Already running with an encrypted wallet.");if(s.length<1)throw new v(y.MISC_ERROR,'wallet.encrypt "passphrase"');try{await r.setPassphrase(null,s)}catch(t){throw new v(y.WALLET_ENCRYPTION_FAILED,"Encryption failed.")}return"wallet encrypted"}async getAccount(t,e,i){if(e||1!==t.length)throw new v(y.MISC_ERROR,'address.account "address"');const r=await this.wallet(i),s=new S([t]).str(0,""),n=w.parseHash(s,this.network),o=await r.getPath(n);return o?o.name:""}async getAddressesByAccount(t,e,i){if(e)throw new v(y.MISC_ERROR,'address.list "account"');const r=await this.wallet(i),s=new S([t]);let n=await this.simulateAccount(r,s.str(0,""));""===n&&(n="default");const o=[],a=[],h=[],c=await r.getPaths(n);for(const t of c){const e=t.toAddress();0==t.branch?o.push(e.toString(this.network)):1==t.branch?a.push(e.toString(this.network)):h.push(e.toString(this.network))}return[o,a,h]}async getAccountAddress(t,e,i){if(e)throw new v(y.MISC_ERROR,'address.receive "account"');const r=await this.wallet(i),s=new S([t]);let n=await this.simulateAccount(r,s.str(0,""));n||(n="default");const o=await r.getAccount(n);return o?o.receive.getAddress("string"):""}async getAccountChangeAddress(t,e,i){if(e)throw new v(y.MISC_ERROR,'address.change.list "account"');const r=await this.wallet(i),s=new S([t]);let n=await this.simulateAccount(r,s.str(0,""));n||(n="default");const o=await r.getAccount(n);return o?o.change.getAddress("string"):""}async getAccountNestedAddress(t,e,i){if(e)throw new v(y.MISC_ERROR,'address.nested.list "account"');const r=await this.wallet(i),s=new S([t]);let n=await this.simulateAccount(r,s.str(0,""));n||(n="default");const o=await r.getAccount(n);return o?o.nested.getAddress("string"):""}async getBalance(t,e,i){if(e||t.length>3)throw new v(y.MISC_ERROR,'balance.confirmed ( "account" minconf includeWatchonly )');const r=await this.wallet(i),s=new S([t]);let n=await this.simulateAccount(r,s.str(0));const o=s.u32(1,1),h=s.bool(2,!1);if(""===n&&(n="default"),"*"===n&&(n=null),r.watchOnly!==h)return 0;const c=await r.getBalance(n);let u;return u=o>0?c.confirmed:c.unconfirmed,a.btc(u,!0)}async getBalanceAll(t,e,i){if(e||t.length>3)throw new v(y.MISC_ERROR,'getbalance ( "account" minconf includeWatchonly )');const r=await this.wallet(i),s=new S([t]);let n=await this.simulateAccount(r,s.str(0));return""===n&&(n="default"),"*"===n&&(n=null),await r.getBalance(n)}async getUserToken(t,e,i){if(e||t.length<2)throw new v(y.MISC_ERROR,"token.user cid uid (gaddr openid): 生成登录令牌 厂商编码 玩家游戏内编码 (推荐人地址 玩家账号)");const s=await this.wallet(i),n=new S([t]);let o=n.str(0),a=n.str(1),h=n.str(2),c=await this.simulateAccount(s,n.str(3,"game"));r(o),r(a);let u={cid:o,uid:a};return h&&(u.gaddr=h),await s.tokenCreate(u,c)}async masterkey(t,e,i){return(await this.wallet(i)).master.toJSON(!0)}async getHistory(t,e,i){if(e||t.length>1)throw new v(y.MISC_ERROR,"tx.history (page acct):查询交易历史记录 (页码 账号)");let r=await this.wallet(i);const s=new S([t]),n=s.uint(0,1);if(n<1)throw new v(y.MISC_ERROR,"页面必须是大于0的数字");const o=await this.simulateAccount(r,s.str(1)),a=await r.getHistory(o);x.sortTX(a);let h=0,c=[];for(let t of a)if(h<10*(n-1))h++;else{if(h>=10*n)break;c.push(t),h++}const u=await r.toDetails(c),l={};return l.items=u,l.pageSize=10,l.pageNum=n,l.total=a.length,l}async orderNotify(t,e,i){if(e||t.length<4)throw new v(y.MISC_ERROR,"order.notify cid uid sn sum (openid): 支付通知 厂商编码 玩家游戏内编码 订单编码 总额 (玩家账号)");let r=await this.wallet(i);const s=new S([t]);let n=s.str(0,""),o=s.str(1,""),a=s.str(2,""),h=s.uint(3,0),c=await this.simulateAccount(r,s.str(4,null)),u=await this.getUserToken([n,o,await r.db.getGuider(n,o),c],e,i);return await r.orderNotify(n,o,a,h,c,u.data.addr)}async sysNotify(t,e,i){if(e||t.length<2)throw new v(y.MISC_ERROR,"sys.notify addr content (openid): 发送点对点消息 地址 内容 (玩家账号)");let r=await this.wallet(i);const s=new S([t]);let n=s.str(0,""),o=s.str(1,""),a=await this.simulateAccount(r,s.str(2,null));return await r.sysNotify(n,o,a)}async payOrder(t,e,i){if(e||t.length<4)throw new v(y.MISC_ERROR,"order.pay cid uid sn sum (openid): 支付订单 厂商编码 玩家游戏内编码 订单编码 总额 (玩家账号)");let r=await this.wallet(i);const s=new S([t]);let n=s.str(0,""),o=s.str(1,""),a=s.str(2,""),h=s.uint(3,0),c=await this.simulateAccount(r,s.str(4,null)),u=await this.getUserToken([n,o,await r.db.getGuider(n,o),c],e,i);return await r.payOrder(n,o,a,h,c,u.data.addr)}async listNotify(t,e,i){if(e)throw new v(y.MISC_ERROR,"sys.listNotify (page): 通知列表 (页码)");let r=await this.wallet(i),s=new S([t]).uint(0,1);return await r.db.listNotify(s)}async orderList(t,e,i){if(e)throw new v(y.MISC_ERROR,"order.list (cid page): 支付订单列表 (厂商编码 页码)");let r=await this.wallet(i);const s=new S([t]);let n=s.str(0,""),o=s.uint(1,1),a=await r.orderList(n),h={};if(n){h[n]=[];let t=0;for(let e of Object.keys(a[n]))if(t<10*(o-1))t++;else{if(t>=10*o)break;h[n].push(a[n][e]),t++}return h}for(let t of Object.keys(a)){h[t]=[];for(let e of Object.keys(a[t])){if(h[t].length>=5)break;h[t].push(a[t][e])}}return h}async getReceivedByAccount(t,e,i){if(e||t.length<1||t.length>2)throw new v(y.MISC_ERROR,'account.received "account" ( minconf )');const r=await this.wallet(i),s=new S([t]);let n=await this.simulateAccount(r,s.str(0));const o=s.u32(1,0),h=this.wdb.state.height;""===n&&(n="default");const c=await r.getPaths(n),u=new Set;for(const t of c)u.add(t.hash);const l=await r.getHistory(n);let f=0,d=-1;for(const t of l){const e=t.getDepth(h);if(!(e<o)){(-1===d||e<d)&&(d=e);for(const e of t.tx.outputs){const t=e.getHash("hex");t&&u.has(t)&&(f+=e.value)}}}return a.btc(f,!0)}async getReceivedByAddress(t,e,i){if(e||t.length<1||t.length>2)throw new v(y.MISC_ERROR,'address.received "address" ( minconf )');const r=await this.wallet(i),s=new S([t]),n=s.str(0,""),o=s.u32(1,0),h=this.wdb.state.height,c=w.parseHash(n,this.network),u=await r.getHistory();let l=0;for(const t of u)if(!(t.getDepth(h)<o))for(const e of t.tx.outputs)e.getHash("hex")===c&&(l+=e.value);return a.btc(l,!0)}async _toWalletTX(t,e){const i=await this.wallet(t),r=await i.toDetails(e);if(!r)throw new v(y.WALLET_ERROR,"TX not found.");let s=!0;for(const t of r.inputs)if(t.path){s=!1;break}const o=[];let h=0,c=0;for(let t=0;t<r.outputs.length;t++){const e=r.outputs[t];if(e.path){if(1===e.path.branch)continue;o.push({account:e.path.name,address:e.address.toString(this.network),category:"receive",amount:a.btc(e.value,!0),label:e.path.name,vout:t}),c+=e.value}else s||(o.push({account:"",address:e.address?e.address.toString(this.network):null,category:"send",amount:-a.btc(e.value,!0),fee:-a.btc(r.getFee(),!0),vout:t}),h+=e.value)}return{amount:a.btc(s?c:-h,!0),confirmations:r.confirmations,blockhash:r.block?n.revHex(r.block):null,blockindex:r.index,blocktime:r.time,txid:n.revHex(r.hash),walletconflicts:[],time:r.mtime,timereceived:r.mtime,"bip125-replaceable":"no",details:o,hex:r.tx.toRaw().toString("hex")}}async getTransaction(t,e,i){if(e||t.length<1||t.length>2)throw new v(y.MISC_ERROR,'gettransaction "txid" ( includeWatchonly )');const s=await this.wallet(i),n=new S([t]),o=n.hash(0);r(o,"Hash is required.");const a=n.bool(1,!1);if(!o)throw new v(y.TYPE_ERROR,"Invalid parameter");const h=await s.getTX(o);if(!h)throw new v(y.WALLET_ERROR,"TX not found.");return await this._toWalletTX(i,h,a)}async abandonTransaction(t,e,i){if(e||1!==t.length)throw new v(y.MISC_ERROR,'tx.abandon "txid"');const r=await this.wallet(i),s=new S([t]).hash(0);if(!s)throw new v(y.TYPE_ERROR,"Invalid parameter.");if(!await r.abandon(s))throw new v(y.WALLET_ERROR,"Transaction not in wallet.");return null}async getUnconfirmedBalance(t,e,i){if(e||t.length>1)throw new v(y.MISC_ERROR,"balance.unconfirmed");const r=new S([t]);let s=await this.simulateAccount(n,r.str(0));""===s&&(s="default"),"*"===s&&(s=null);const n=await this.wallet(i),o=await n.getBalance(s);return a.btc(o.unconfirmed,!0)}async getWalletInfo(t,e,i){if(e||0!==t.length)throw new v(y.MISC_ERROR,"wallet.info");return(await this.wallet(i)).toJSON()}async importPrivKey(t,e,i){if(e||t.length<1||t.length>4)throw new v(y.MISC_ERROR,'key.import.private account "privatekey" passphrase [rescan]');let r=await this.wallet(i);const s=new S([t]),n=await this.simulateAccount(r,s.str(0,"default")),o=s.str(1),a=s.str(2),h=s.bool(3,!1),c=w.parseSecret(o,this.network);return c.witness=!0,await r.importKey(n,c,a),h&&await this.wdb.rescan(0),null}async walletAuth(t,e,i){return!0}async importWallet(t,e,i){if(e||1!==t.length)throw new v(y.MISC_ERROR,'wallet.import "filename" ( rescan )');const r=await this.wallet(i),n=new S([t]),o=n.str(0),a=n.bool(1,!1);if(s.unsupported)throw new v(y.INTERNAL_ERROR,"FS not available.");const h=(await s.readFile(o,"utf8")).split(/\n+/),c=[];for(let t of h){if(0===(t=t.trim()).length)continue;if(/^\s*#/.test(t))continue;const e=t.split(/\s+/);if(e.length<4)throw new v(y.DESERIALIZATION_ERROR,"Malformed wallet.");const i=w.parseSecret(e[0],this.network);c.push(i)}for(const t of c)await r.importKey(0,t);return a&&await this.wdb.rescan(0),null}async importAddress(t,e,i){if(e||t.length<1||t.length>4)throw new v(y.MISC_ERROR,'address.import "address" [rescan p2sh]');let r=await this.wallet(i);const s=new S([t]),n=s.str(0,"default");let o=s.str(1,"");const a=s.bool(2,!1);if(s.bool(3,!1)){let t=s.buf(0);if(!t)throw new v(y.TYPE_ERROR,"Invalid parameters.");t=h.fromRaw(t),t=h.createScript(t.hash160(),h.types.SCRIPTHASH),o=c.fromScript(t)}else o=w.parseAddress(o,this.network);return await r.importAddress(n,o),a&&await this.wdb.rescan(0),null}async importPubkey(t,e,i){if(e||t.length<1||t.length>4)throw new v(y.MISC_ERROR,'key.import.public "pubkey" [rescan]');let r=await this.wallet(i);const s=new S([t]),n=s.str(0,"default"),o=s.buf(1),a=s.bool(2,!1);if(!o)throw new v(y.TYPE_ERROR,"Invalid parameter.");const h=u.fromPublic(o,this.network);return await r.importKey(n,h),a&&await this.wdb.rescan(0),null}async listAccounts(t,e,i){if(e||t.length>2)throw new v(y.MISC_ERROR,"account.list ( minconf includeWatchonly)");const r=await this.wallet(i),s=new S([t]),n=s.u32(0,0),o=s.bool(1,!1),h=await r.getAccounts(),c={};for(const t of h){const e=await r.getBalance(t);let i=e.unconfirmed;n>0&&(i=e.confirmed),r.watchOnly!==o&&(i=0),c[t]=a.btc(i,!0)}return c}async listLockUnspent(t,e,i){if(e||t.length>0)throw new v(y.MISC_ERROR,"txo.locked");const r=(await this.wallet(i)).getLocked(),s=[];for(const t of r)s.push({txid:t.txid(),vout:t.index});return s}async listReceivedByAccount(t,e,i){if(e||t.length>3)throw new v(y.MISC_ERROR,"account.listreceived ( minconf includeempty includeWatchonly )");const r=new S([t]),s=r.u32(0,0),n=r.bool(1,!1),o=r.bool(2,!1);return await this._listReceived(i,s,n,o,!0)}async listReceivedByAddress(t,e,i){if(e||t.length>3)throw new v(y.MISC_ERROR,"address.received.list ( minconf includeempty includeWatchonly )");const r=new S([t]),s=r.u32(0,0),n=r.bool(1,!1),o=r.bool(2,!1);return await this._listReceived(i,s,n,o,!1)}async _listReceived(t,e,i,r,s){const n=await this.wallet(t),o=await n.getPaths(),h=this.wdb.state.height,c=new Map;for(const t of o){const e=t.toAddress();c.set(t.hash,{involvesWatchonly:n.watchOnly,address:e.toString(this.network),account:t.name,amount:0,confirmations:-1,label:""})}const u=await n.getHistory();for(const t of u){const i=t.getDepth(h);if(!(i<e))for(const e of t.tx.outputs){const t=e.getAddress();if(!t)continue;const r=t.getHash("hex"),s=c.get(r);s&&((-1===s.confirmations||i<s.confirmations)&&(s.confirmations=i),s.address=t.toString(this.network),s.amount+=e.value)}}let l=[];for(const t of c.values())l.push(t);if(s){const t=new Map;for(const e of l){const i=t.get(e.account);i?i.amount+=e.amount:(t.set(e.account,e),e.address=void 0)}l=[];for(const e of t.values())l.push(e)}const f=[];for(const t of l)(i||0!==t.amount)&&(-1===t.confirmations&&(t.confirmations=0),t.amount=a.btc(t.amount,!0),f.push(t));return f}async listSinceBlock(t,e,i){if(e)throw new v(y.MISC_ERROR,'tx.history.since ( "blockhash" target-confirmations includeWatchonly)');const r=await this.wallet(i),s=this.wdb.state.height,o=new S([t]),a=o.hash(0),h=o.u32(1,0),c=o.bool(2,!1);if(r.watchOnly!==c)return[];let u=-1;if(a){const t=await this.client.getEntry(a);t&&(u=t.height)}-1===u&&(u=this.chain.height);const l=await r.getHistory(),f=[];let d;for(const t of l){if(t.height<u)continue;if(t.getDepth(s)<h)continue;(!d||t.height>d)&&(d=t);const e=await this._toListTX(i,t);f.push(e)}return{transactions:f,lastblock:d&&d.block?n.revHex(d.block):m.NULL_HASH}}async _toListTX(t,e){const i=await this.wallet(t),s=await i.toDetails(e);if(!s)throw new v(y.WALLET_ERROR,"TX not found.");let o=!0;for(const t of s.inputs)if(t.path){o=!1;break}let h,c,u,l,f,d,p=0,g=0;for(let t=0;t<s.outputs.length;t++){const e=s.outputs[t];e.path?1!==e.path.branch&&(g+=e.value,c=e,l=t):(p+=e.value,h=e,u=t)}return o?(f=c,d=l):(f=h,d=u),f||(r(!o),o=!0,f=c,d=l),{account:f.path?f.path.name:"",address:f.address?f.address.toString(this.network):null,category:o?"receive":"send",amount:a.btc(o?g:-p,!0),label:f.path?f.path.name:void 0,vout:d,confirmations:s.getDepth(),blockhash:s.block?n.revHex(s.block):null,blockindex:s.index,blocktime:s.time,txid:n.revHex(s.hash),walletconflicts:[],time:s.mtime,timereceived:s.mtime,"bip125-replaceable":"no"}}async listTransactions(t,e,i){if(e||t.length>4)throw new v(y.MISC_ERROR,'tx.list ( "account" count from includeWatchonly)');const r=await this.wallet(i),s=new S([t]);let n=await this.simulateAccount(r,s.str(0));const o=s.u32(1,10),a=s.u32(2,0),h=s.bool(3,!1);if(r.watchOnly!==h)return[];""===n&&(n="default");const c=await r.getHistory(n);x.sortTX(c);const u=a+o,l=Math.min(u,c.length),f=[];for(let t=a;t<l;t++){const e=c[t],r=await this._toListTX(i,e);f.push(r)}return f}async listUnspent(t,e,i){if(e||t.length>3)throw new v(y.MISC_ERROR,'txo.list ( minconf maxconf  ["address",...] )');const r=await this.wallet(i),s=new S([t]),n=s.u32(0,1),o=s.u32(1,9999999),h=s.array(2),c=s.str(3,"default"),u=this.wdb.state.height,l=new Set;if(h){const t=new S([h]);for(let e=0;e<h.length;e++){const i=t.str(e,""),r=w.parseHash(i,this.network);if(l.has(r))throw new v(y.INVALID_PARAMETER,"Duplicate address.");l.add(r)}}const f=await r.getCoins(c);x.sortCoins(f);const d=[];for(const t of f){const e=t.getDepth(u);if(e<n||e>o)continue;const i=t.getAddress();if(!i)continue;const s=t.getHash("hex");if(h&&(!s||!l.has(s)))continue;const c=await r.getKey(s);d.push({txid:t.txid(),vout:t.index,address:i?i.toString(this.network):null,account:c?c.name:void 0,redeemScript:c&&c.script?c.script.toJSON():void 0,scriptPubKey:t.script.toJSON(),amount:a.btc(t.value,!0),confirmations:e,spendable:!r.isLocked(t),solvable:!0})}return d}async lockUnspent(t,e,i){if(e||t.length<1||t.length>2)throw new v(y.MISC_ERROR,'txo.lock unlock ([{"txid":"txid","vout":n},...])');const r=await this.wallet(i),s=new S([t]),n=s.bool(0,!1),o=s.array(1);if(!o)throw new v(y.TYPE_ERROR,"Invalid parameter.");for(const t of o){const e=new S([t]),i=e.hash("txid"),s=e.u32("vout");if(null==i||null==s)throw new v(y.INVALID_PARAMETER,"Invalid parameter.");const o=new d(i,s);n?r.unlockCoin(o):r.lockCoin(o)}return!0}async setTXFee(t,e,i){if(e||t.length<1||t.length>1)throw new v(y.MISC_ERROR,"sys.setfee rate");const r=new S([t]).ufixed(0,8);if(null==r)throw new v(y.TYPE_ERROR,"Invalid parameter.");return this.wdb.feeRate=r,!0}async signMessage(t,i,r){if(i||2!==t.length)throw new v(y.MISC_ERROR,'sys.message.sign "address" "message"');const s=await this.wallet(r),n=new S([t]),a=n.str(0,""),h=n.str(1,""),c=w.parseHash(a,this.network),u=await s.getKey(c);if(!u)throw new v(y.WALLET_ERROR,"Address not found.");if(!s.master.key)throw new v(y.WALLET_UNLOCK_NEEDED,"Wallet is locked.");const l=e.from(b+h,"utf8"),f=o.hash256(l);return u.sign(f).toString("base64")}async changePassphrase(t,e,i){const r=await this.wallet(i);if(e||r.master.encrypted&&2!==t.length)throw new v(y.MISC_ERROR,'wallet.changepassphrase "oldpassphrase" "newpassphrase"');const s=new S([t]),n=s.str(0,""),o=s.str(1,"");if(!r.master.encrypted)throw new v(y.WALLET_WRONG_ENC_STATE,"Wallet is not encrypted.");if(n.length<1||o.length<1)throw new v(y.INVALID_PARAMETER,"Invalid parameter");return await r.setPassphrase(n,o),null}async unlock(t,e,i){const r=await this.wallet(i),s=new S([t]),n=s.str(0),o=s.u32(1,60);if(e||r.master.encrypted&&0==t.length)throw new v(y.MISC_ERROR,'wallet.unlock "passphrase" timeout');if(!r.master.encrypted)throw new v(y.WALLET_WRONG_ENC_STATE,"Wallet is not encrypted.");if(n.length<1)throw new v(y.INVALID_PARAMETER,"Invalid parameter");if(null==o)throw new v(y.TYPE_ERROR,"Invalid parameter");return await r.unlock(n,o),null}async decryptWallet(t,e,i){const r=await this.wallet(i);if(!r.master.encrypted&&(e||1!==t.length))throw new v(y.MISC_ERROR,'wallet.decrypt "passphrase"');const s=new S([t]).str(0,"");if(!r.master.encrypted)throw new v(y.WALLET_WRONG_ENC_STATE,"Running with an decrypted wallet.");if(s.length<1)throw new v(y.MISC_ERROR,'wallet.decrypt "passphrase"');try{await r.setPassphrase(s)}catch(t){throw new v(y.WALLET_ENCRYPTION_FAILED,"Decryption failed.")}return"wallet decrypted"}async importPrunedFunds(t,e,i){if(e||t.length<2||t.length>3)throw new v(y.MISC_ERROR,'tx.importprunedfunds "rawtransaction" "txoutproof" ( "label" )');const r=new S([t]),s=r.buf(0),n=r.buf(1);if(!s||!n)throw new v(y.TYPE_ERROR,"Invalid parameter.");const o=g.fromRaw(s),a=l.fromRaw(n),h=a.hash("hex");if(!a.verify())throw new v(y.VERIFY_ERROR,"Invalid proof.");if(!a.hasTX(o.hash("hex")))throw new v(y.VERIFY_ERROR,"Invalid proof.");const c=await this.client.getEntry(h);if(-1===c)throw new v(y.VERIFY_ERROR,"Invalid proof.");const u={hash:h,time:a.time,height:c};if(!await this.wdb.addTX(o,u))throw new v(y.WALLET_ERROR,"No tracked address for TX.");return null}async removePrunedFunds(t,e,i){if(e||1!==t.length)throw new v(y.MISC_ERROR,'tx.removeprunedfunds "txid"');const r=await this.wallet(i),s=new S([t]).hash(0);if(!s)throw new v(y.TYPE_ERROR,"Invalid parameter.");if(!await r.remove(s))throw new v(y.WALLET_ERROR,"Transaction not in wallet.");return null}async getWallets(t,e,i){return await this.wdb.getWallets()}async getWalletBlock(t,e,i){if(e||t.length<1)throw new v(y.MISC_ERROR,"wallet.block height");let r=await this.wallet(i);const s=new S([t]).uint(0),n=await r.getBlock(s);return n?n.toJSON():null}async selectWallet(t,e,i){if(e||1!==t.length)throw new v(y.MISC_ERROR,'wallet.select "id"');const r=new S([t]).str(0),s=await this.wdb.get(r);if(!s)throw new v(y.WALLET_ERROR,"Wallet not found.");return s.toJSON(!1)}async cpRegister(t,e,i){if(e||t.length<2)throw new v(y.MISC_ERROR,'cp.create "name" "url" ("addr" "cls" "grate" "ip"): 注册厂商 名称(不少于4个字符) URL地址 (收款地址 游戏类别 媒体分成比例 IP地址)');let r=await this.wallet(i);const s=new S([t]);let o=decodeURIComponent(s.str(0)),a=decodeURIComponent(s.str(1)),h=s.str(2,""),c=s.str(3,""),u=s.uint(4,15),l=s.str(5,""),f=await this.simulateAccount(r,null);if(!o||!/^(?![_.-])(?!.*?[_.-]$)[.a-zA-Z0-9_-\u4e00-\u9fa5]{4,40}$/.test(o))throw new v(y.MISC_ERROR,"error name format, length 4~40");if(!a||"string"!=typeof a)throw new v(y.MISC_ERROR,"error url format");if(a.length<4||a.length>=50||!/^(https?):\/\/([\w\-]+(\.[\w\-]+)*\/)*[\w\-]+(\.[\w\-]+)*\/?(\?([\w\-\.,@?^=%&:\/~\+#]*)+)?/.test(a))throw new v(y.MISC_ERROR,"error url format, length 4~50");if(u<=0||u>30)throw new v(y.MISC_ERROR,"error grate value");if(c&&!/^(?![_.-])(?!.*?[_.-]$)[.a-zA-Z0-9_-\u4e00-\u9fa5]{2,20}$/.test(c))throw new v(y.MISC_ERROR,"error class format, length 2~20");if(l&&!_.isIPv4(_.toBuffer(l))&&!_.isIPv6(_.toBuffer(l)))throw new v(y.MISC_ERROR,"error ip format");let d={name:o,url:a,addr:n.isBech32(h)?h:null,cls:c,grate:u,ip:l};return await r.cpRegister(d,f),d}async cpList(t,e,i){if(e)throw new v(y.MISC_ERROR,"cp.list.wallet (page): 查询钱包中的厂商列表 (页码)");let r=await this.wallet(i);r.db.cpList.dirty&&await r.db.flushCP([],!0);const s=new S([t]).uint(0,1);return r.db.cpList.paginate(10,s).records(["cid","cls","grate","name","url","ip","current","owned","status"])}async cpById(t,e,i){if(e||t.length<1)throw new v(y.MISC_ERROR,'cp.byId "clientNo": 根据编码查询厂商记录');let r=await this.wallet(i);const s=new S([t]).str(0);return s?(r.db.cpList.dirty&&await r.db.flushCP([],!0),r.db.cpList.getRecord(s)):null}async cpByName(t,e,i){if(e||t.length<1)throw new v(y.MISC_ERROR,'cp.byName "name": 根据名称查询厂商记录');let r=await this.wallet(i);const s=new S([t]).str(0);return s?(r.db.cpList.dirty&&await r.db.flushCP([],!0),r.db.cpList.getItemByName(decodeURIComponent(s))):null}async cpChange(t,e,i){if(e||t.length<2)throw new v(y.MISC_ERROR,'cp.change "name" "newname" "url" "ip" "addr" "grate" "cls" "openid": 修改厂商信息 名称 新的名称 URL IP 转入地址 分成比例 分类 授权账号');let s=await this.wallet(i);s.db.cpList.dirty&&await s.db.flushCP([],!0);const n=new S([t]),o=decodeURIComponent(n.str(0));r(!!o&&/^(?![_.])(?!.*?[_.]$)[.a-zA-Z0-9_\u4e00-\u9fa5]{4,20}$/.test(o));let a=decodeURIComponent(n.str(1));a?r(!!a&&/^(?![_.])(?!.*?[_.]$)[.a-zA-Z0-9_\u4e00-\u9fa5]{4,20}$/.test(a)):a=o;let h=decodeURIComponent(n.str(2,""));h&&"string"==typeof h&&r(h.length<50&&/^(https?):\/\/([\w\-]+(\.[\w\-]+)*\/)*[\w\-]+(\.[\w\-]+)*\/?(\?([\w\-\.,@?^=%&:\/~\+#]*)+)?/.test(h));const u=n.str(3,"");u&&r(_.isIPv4(_.toBuffer(u))||_.isIPv6(_.toBuffer(u)));let l=n.str(4,""),f=n.uint(5,null),d=n.str(6,null),p=await this.simulateAccount(s,n.str(7,""));l?(l=c.fromString(l),r(l instanceof c,"Not an address.")):l=p?(await s.createReceive(p)).getAddress():s.getAddress();let g={name:o,newName:a,url:h,ip:u,addr:l,grate:f,cls:d};const[m,w]=await s.cpChange(g,p);return g.addr=l.toString(),g}async contractExecute(t,e,i){if(e||t.length<1||t.length>2)throw new v(y.MISC_ERROR,"contract.execute tid master: 执行交易对合约 交易编号 执行人");let r=await this.wallet(i);const s=new S([t]),n=s.str(0),o=s.u32(1,2),[a,h]=await r.contractExecute(n,o);return a.toJSON()}async contractPromise(t,e,i){if(e||t.length<1||t.length>2)throw new v(y.MISC_ERROR,"contract.promise tid [openid]: 签署交易对合约 交易编号 [子账号]");let r=await this.wallet(i);const s=new S([t]),n=s.str(0),o=await this.simulateAccount(r,s.str(1,null)),[a,h]=await r.contractPromise(n,o);return a.toJSON()}async contractOfMine(t,e,i){if(e||t.length>1)throw new v(y.MISC_ERROR,"contract.mine [openid]: 获取已签署交易对合约列表 [子账号]");let r=await this.wallet(i);const s=new S([t]),n=await this.simulateAccount(r,s.str(0,null));return await r.db.getContracts(n)}async contractCreate(t,e,i){if(e||t.length<4||t.length>5)throw new v(y.MISC_ERROR,"contract.create type src dst addr [openid] : 发布一个交易对合约 交易对类型 出让游戏金数值 换取兑换币数值 兑换币收款地址 [子账号]");let r=await this.wallet(i);const s=new S([t]),n=s.u64(0),o=s.u64(1),a=s.u64(2),h=s.str(3),c=await this.simulateAccount(r,s.str(4,null)),[u,l]=await r.contractCreate(n,o,a,h,c);return u.toJSON()}async getProps(t,e,i){if(e)throw new v(y.MISC_ERROR,"prop.list (page acct oid): 查询自己的已发布物品 (页码 账户 道具id)");let r=await this.wallet(i);const s=new S([t]),n=s.uint(0,1),o=s.str(1,null),a=s.str(2,null);if(n<=0)throw new v(y.MISC_ERROR,"prop.list (page acct oid): 查询自己的已发布物品 (页码必须大于0)");return await r.getProps(n,o,a)}async getPropsCount(t,e,i){if(e)throw new v(y.MISC_ERROR,"prop.list (acct): 查询自己的已发布物品 (账户)");let r=await this.wallet(i);const s=new S([t]),n=s.str(0,null),o=s.str(1,null);return await r.getPropsCount(n,o)}async getPropsDetails(t,e,i){if(e)throw new v(y.MISC_ERROR,"prop.list.details (acct page size): 查询自己的已发布物品 (账户 页码 页宽)");let r=await this.wallet(i);const s=new S([t]),n=s.str(0,null),o=s.uint(1,1),a=s.uint(2,10);return await r.getPropsDetails(o,a,n)}async propCreatedList(t,e,i){let r=await this.wallet(i);const s=new S([t]),n=s.uint(0,1),o=s.str(1,null);return await r.propCreatedList(n,o)}async mySaleList(t,e,i){let r=await this.wallet(i);const s=new S([t]),n=s.uint(0,1),o=s.str(1,null);return await r.mySaleList(n,o)}async onSaleList(t,e,i){let r=await this.wallet(i);const s=new S([t]),n=s.uint(0,1),o=s.str(1,null);return await r.onSaleList(n,o)}async propBuy(t,e,i){let r=await this.wallet(i);const s=new S([t]),n=s.str(0),o=s.u64(1,0),a=await this.simulateAccount(r,s.str(2,null)),[h,c]=await r.propBuy(n,o,a);return h.toJSON()}async propFound(t,e,i){if(e||t.length<1)throw new v(y.MISC_ERROR,"prop.found txid: 熔铸道具 交易ID");let r=await this.wallet(i);const s=new S([t]).hash(0),[n,o,a]=await r.propFound(s);if(n&&a)return{hash:n.hash("hex"),txid:n.rhash(),index:0,cid:a.cid,pid:a.pid,oid:a.oid,gold:n.outputs[0].value}}async propSale(t,e,i){if(e||t.length<3)throw new v(y.MISC_ERROR,'prop.sale "hash" "index" "fixedPrice" ["openid"]');let r=await this.wallet(i);const s=new S([t]),o=n.revHex(s.str(0)),a=s.u32(1,0),h=s.u64(2,0),c=await this.simulateAccount(r,s.str(3,null)),[u,l]=await r.propSale(o,a,h,c);return u.toJSON()}async propSendList(t,e,i){if(e||t.length<1)throw new v(y.MISC_ERROR,"prop.sendlist [addr|txid|index, ...]: 批量转移道具 数组[地址|交易ID|输出索引]");let r=await this.wallet(i);const s=new S([t]).str(0).split(",");let o=[];if(s&&Array.isArray(s))for(let t of s){const e=t.split("|");if(e.length>=3){const t=e[0],i=new d(n.revHex(e[1]),parseInt(e[2]));o.push([i,c.fromString(t)])}}const[a,h,u]=await r.propExchangeList(o);if(a&&u){let t=a.hash("hex"),e=a.rhash();return u.map(i=>({hash:t,txid:e,cid:i.cid,pid:i.pid,oid:i.oid,gold:i.gold,addr:i.addr}))}}async propReceive(t,e,i){if(e||t.length<1)throw new v(y.MISC_ERROR,"prop.receive hexstring [account]: 捐赠接收函数 捐赠交易字符串 [接收账户]");let r=await this.wallet(i);const s=new S([t]),n=s.buf(0),o=await this.simulateAccount(r,s.str(1,null));if(!n)throw new v(y.TYPE_ERROR,"Invalid hex string.");const a=g.fromRaw(n),[h,c,u]=await r.propReceive(a,o);if(h&&u)return u.gaddr&&o&&r.db.setGuider(u.cid,o,u.gaddr,!1),{hash:h.hash("hex"),txid:h.rhash(),cid:u.cid,pid:u.pid,oid:u.oid,gold:u.gold,addr:u.simAddr,gaddr:u.gaddr}}async propDonate(t,e,i){if(e||t.length<2)throw new v(y.MISC_ERROR,"prop.donate txid index [openid]: 捐赠道具函数 交易ID 交易内索引 [发起账户]");let r=await this.wallet(i);const s=new S([t]),n=new d(s.hash(0),s.uint(1,0)),o=await this.simulateAccount(r,s.str(2,null)),[a,h,c]=await r.propDonate(n,o);if(a&&c)return{hash:a.hash("hex"),txid:a.rhash(),cid:c.cid,pid:c.pid,oid:c.oid,gold:c.gold,raw:a.toRaw().toString("hex")}}async propExchange(t,e,i){if(e||t.length<3)throw new v(y.MISC_ERROR,"prop.send addr hash index [openid]: 转移道具函数 接收地址 交易ID 交易内索引 [发起账户]");let r=await this.wallet(i);const s=new S([t]),n=s.str(0),o=new d(s.hash(1),s.uint(2,0)),a=await this.simulateAccount(r,s.str(3,null)),[h,u,l]=await r.propExchange(o,c.fromString(n),a);if(h&&l)return{hash:h.hash("hex"),txid:h.rhash(),cid:l.cid,pid:l.pid,oid:l.oid,gold:l.gold,addr:n}}async propCreateList(t,e,i){let r=await this.wallet(i);const s=new S([t]).str(0).split(",");let n=[];if(s&&Array.isArray(s))for(let t of s){const e=t.split("|");if(e.length>=3){const t=e[0],i=e[1],r=parseInt(e[2]);if(r<E.MINPROPVALUE)continue;n.push([t,i,r])}}n=n.map(t=>{let[e,i,r]=t;return{oper:R.propCreate,cid:e,oid:i,gold:r}});const[o,a]=await r.propCreate(n);return o?n:null}async routerOfCoin(t){throw new v(y.MISC_ERROR,"\n      coin.get              查询硬币\n      coin.locked.add       锁定硬币\n      coin.locked.get       查询锁定硬币\n      coin.locked.del       解锁硬币\n      txo.locked            列表锁定的UTXO\n      txo.list              列表UTXO\n      txo.lock              锁定/解锁一组UTXO\n    ")}async routerOfContract(t){throw new v(y.MISC_ERROR,"\n      contract.create       发布交易对合约\n      contract.promise      签署交易对合约\n      contract.execute      执行交易对合约\n      contract.mine         获取已签署交易对合约列表\n      contract.list         查询并返回交易对\n    ")}async routerOfWallet(t){throw new v(y.MISC_ERROR,"\n      wallet.select             输入钱包名称，查看钱包详情\n      wallet.create             创建钱包\n      wallet.list               列表钱包\n      wallet.info               查询钱包概要\n      wallet.block              查询区块信息\n      wallet.dump               转储钱包信息\n      wallet.import             导入钱包备份\n      wallet.backup             备份钱包\n      wallet.encrypt            将主私钥永久加密\n      wallet.decrypt            将主私钥永久解密\n      wallet.changepassphrase   在主私钥已经加密的情况下，修改其加密密码，要提交旧/新两个密码。如果尚未加密则执行失败\n      wallet.lock               在主私钥已加密的前提下，清理内存中的密钥信息以确保锁定，相当于手工执行自动锁定\n      wallet.unlock             在主私钥已加密的前提下，解密主私钥，持续一段时间后自动锁定\n      wallet.blocks             列表钱包相关区块\n    ")}async routerOfAddress(t){throw new v(y.MISC_ERROR,"\n      address.list              列表指定账户下地址\n      address.receive           列表指定账户下收款地址\n      address.change            列表指定账户下找零地址\n      address.nested            列表指定账户下嵌套地址\n      address.create            创建一个收款地址\n      address.receive.create    创建一个收款地址\n      address.change.create     创建一个找零地址\n      address.nested.create     创建一个嵌套地址\n      address.import            导入一个地址\n      address.key               查询地址的密钥\n      address.amount            查询指定地址上的余额\n      address.account           查询指定地址对应的账户\n      address.wif               查询地址对应的私钥\n      address.received          根据地址查询进项总额\n      address.received.list     根据地址查询进项\n      address.filter            在订单流水中，查询符合筛选条件的地址集\n    ")}async routerOfAccount(t){throw new v(y.MISC_ERROR,"\n      account.list              列表账户\n      account.get               查询账户\n      account.create            创建账户\n      account.amount            账户余额\n      account.received          查询收款总额\n      account.listreceived      列表收款记录\n      balance.confirmed         已确认余额\n      balance.all               余额\n      balance.unconfirmed       未确认余额\n    ")}async routerOfKey(t){throw new v(y.MISC_ERROR,"\n      key.export.private        根据输入地址，导出私钥\n      key.export.public         根据输入地址，打出公钥\n      key.master                导出根密钥, 注意 encrypt 状态下无法导出私钥\n      key.import.private        导入私钥\n      key.import.public         导入公钥\n      key.import.address        导入地址\n      key.shared.add            新增共享公钥\n      key.shared.del            删除共享公钥\n    ")}async routerOfCp(t){throw new v(y.MISC_ERROR,"\n        cp.create         创建CP记录\n        cp.change         修改CP记录\n        cp.byName         根据名称查询CP记录\n        cp.byId           根据ID查询CP记录\n        cp.list           查询本地节点中的CP列表\n        cp.list.wallet    查询本地钱包中的CP列表\n        token.auth        制备令牌固定量(本地屏显)\n        token.random      获取令牌随机量\n        order.query       查询订单(特约节点)\n        token.user        生成用户令牌(钱包)\n        order.pay         支付订单(钱包)\n        order.notify      通知(钱包)\n        order.list        查询订单列表(钱包)\n    ")}async routerOfProp(t){throw new v(y.MISC_ERROR,"\n      prop.create         创建道具\n      prop.send           转移道具\n      prop.donate         捐赠道具\n      prop.receive        接收捐赠道具\n      prop.createlist     批量创建道具\n      prop.sendlist       批量转移道具\n      prop.order          订购：制备并发送\n      prop.found          熔铸道具\n      prop.sale           拍卖道具\n      prop.buy            购买道具\n      prop.list           列表自己拥有的道具\n      prop.count          列表自己拥有的道具数量\n      prop.list.created   列表自己创建的道具\n      prop.list.auction   列表自己正在拍卖的道具\n      prop.list.bid       列表自己参与拍卖的道具\n      prop.list.market    查询并返回正在拍卖的虚拟道具: 厂商ID 页码 道具ID集合\n    ")}async propCreate(t,e,i){if(e||t.length<3)throw new v(y.MISC_ERROR,"prop.create cid oid gold (openid): 创建道具 厂商编码 道具原始码 含金量 (账户)");let r=await this.wallet(i);const s=new S([t]),n=s.str(0),o=s.str(1),a=s.u64(2,E.MINPROPVALUE),h=await this.simulateAccount(r,s.str(3,null));if(a<E.MINPROPVALUE)throw new v(y.PROP_MINVALUE,"prop.create: not a valid value");let c={oper:R.propCreate,cid:n,oid:o,gold:a};const[u,l]=await r.propCreate([c],h);return u?c:null}async propOrder(t,e,i){if(e||t.length<3)throw new v(y.MISC_ERROR,"prop.order cid oid gold (addr): 制备道具 厂商编码 道具原始码 含金量 (接收地址)");let r=await this.wallet(i);const s=new S([t]),n=s.str(0),o=s.str(1),a=s.u64(2);let h=s.str(3);h||(h=r.getAddress());const[c,u]=await r.propCreate([{oper:R.propCreate,cid:n,oid:o,gold:a}]);if(c){let[t,e,i]=await r.propExchange([c,0],h);if(t)return{hash:t.hash("hex"),txid:t.rhash(),cid:n,pid:i.pid,oid:o,gold:a,addr:h}}return null}async walletLock(t,e,i){if(e)throw new v(y.MISC_ERROR,"wallet.lock [passphrase]");const r=await this.wallet(i);if(!r.master.encrypted){const e=new S([t]).str(0,"");if(e.length<1)throw new v(y.MISC_ERROR,"Wallet is not encrypted, please run wallet.lock passphrase");try{await r.setPassphrase(null,e)}catch(t){throw new v(y.WALLET_ENCRYPTION_FAILED,"Encryption failed.")}}return await r.lock(),null}async resendWalletTransactions(t,e,i){if(e||0!==t.length)throw new v(y.MISC_ERROR,"tx.resend");const r=await this.wallet(i),s=await r.resend(),n=[];for(const t of s)n.push(t.txid());return n}async resend(t,e,i){if(e||0!==t.length)throw new v(y.MISC_ERROR,"tx.resendall: 重发挂起交易");let r=await this.wdb.resend();if(r)for(let t of Object.keys(r))if(t)for(const e of r[t])await this.send(e);return!0}addGroupPrefix(t,e,i){if(e||1!=t.length)throw new v(y.MISC_ERROR,'sys.groupPrefix "[[prefix, cid]]"');const r=new S([t]).array(0);for(let t of r)this.wdb.options.acl.addGroupPrefix(t[0],t[1]);return!0}addGroupSuffix(t,e,i){if(e||1!=t.length)throw new v(y.MISC_ERROR,'sys.groupSuffix "[[suffix, cid]]"');const r=new S([t]).array(0);for(let t of r)this.wdb.options.acl.addGroupSuffix(t[0],t[1]);return!0}async rescan(t,e,i){if(e)throw new v(y.MISC_ERROR,'sys.rescan ( "height" )');const r=new S([t]).u32(0);return await this.wdb.rescan(r),this.logger.info("Rescanning..."),!0}async createAddress(t,e,i){if(e||t.length>1)throw new v(y.MISC_ERROR,'address.create ( "account" )');let r=await this.wallet(i);const s=new S([t]),n=await this.simulateAccount(r,s.str(0));""===n&&(n="default");const o=await r.createReceive(n);return o?o.toJSON():null}async createChange(t,e,i){if(e||t.length>1)throw new v(y.MISC_ERROR,'address.change.create ( "account" )');let r=await this.wallet(i);const s=new S([t]),n=await this.simulateAccount(r,s.str(0));""===n&&(n="default");const o=await r.createChange(n);return o?o.toJSON():null}async createNested(t,e,i){if(e||t.length>1)throw new v(y.MISC_ERROR,'address.nested.create ( "account" )');let r=await this.wallet(i);const s=new S([t]),n=await this.simulateAccount(r,s.str(0));""===n&&(n="default");const o=await r.createNested(n);return o?o.toJSON():null}async mkwallet(t,e,i){const r=new S([t]),s=await this.wdb.ensure({id:r.str(0),type:r.str(1),m:r.u32(2),n:r.u32(3),mnemonic:r.str(4),passphrase:r.str(5),master:r.str(6),witness:r.bool(7),watchOnly:r.bool(8),accountKey:r.str(9)});return s?s.toJSON():null}async accountGet(t,e,i){let r=await this.wallet(i);const s=new S([t]),n=await this.simulateAccount(r,s.str(0)),o=await r.getAccount(n);return o?o.toJSON():null}async getpending(t,e,i){if(e)throw new v(y.MISC_ERROR,"tx.penging [account]: 查询挂起的交易");let r=await this.wallet(i);const s=new S([t]),n=await this.simulateAccount(r,s.str(0)),o=await r.getPending(n);x.sortTX(o);const a=[],h=await r.toDetails(o);for(const t of h)a.push(t.toJSON());return a}async accountCreate(t,e,i){let r=await this.wallet(i);const s=new S([t]),n=s.obj(0),o=s.str(1),a=new S([n]),h={name:a.str("name"),witness:a.bool("witness",!0),type:a.str("type","pubkeyhash"),m:a.u32("m",1),n:a.u32("n",1),watchOnly:a.bool("watch",!1),accountKey:a.str("key",null),lookahead:a.u32("lookahead",10)};try{return(await r.createAccount(h,o)).toJSON()}catch(t){return null}}async getblocks(t,e,i){if(e)throw new v(y.MISC_ERROR,"wallet.blocks");let r=await this.wallet(i);return await r.getBlocks()}async getKey(t,e,i){if(e||1!==t.length)throw new v(y.MISC_ERROR,"address.key address: 查询地址的密钥");let s=await this.wallet(i);const n=new S([t]).str(0);r(n,"Address is required.");const o=await s.getKey(n);return o?o.toJSON():null}async getwif(t,e,i){if(e||1!=t.length)throw new v(y.MISC_ERROR,"address.wif address: 查询地址对应的私钥 地址");let s=await this.wallet(i);const n=new S([t]),o=n.str(0),a=n.str(1);r(o,"Address is required.");const h=await s.getPrivateKey(o,a);return h?h.toSecret():null}async getCoin(t,e,i){let s=await this.wallet(i);const n=new S([t]),o=n.hash(0),a=n.u32(1);r(o,"Hash is required."),r(null!=a,"Index is required.");const h=await s.getCoin(o,a);return h?h.getJSON(this.network):null}async lockCoin(t,e,i){let s=await this.wallet(i);const n=new S([t]),o=n.hash(0),a=n.u32(1);r(o,"Hash is required."),r(null!=a,"Index is required.");const h=new d(o,a);return s.lockCoin(h),!0}async getLockedCoins(t,e,i){const r=[],s=(await this.wallet(i)).getLocked();for(const t of s)r.push(t.toJSON());return r}async unlockCoin(t,e,i){let s=await this.wallet(i);const n=new S([t]),o=n.hash(0),a=n.u32(1);r(o,"Hash is required."),r(null!=a,"Index is required.");const h=new d(o,a);return s.unlockCoin(h),!0}async addShared(t,e,i){if(e||t.length<1)throw new v(y.MISC_ERROR,"key.shared.add [account] key: 新增共享公钥 [账号] 公钥");let r=await this.wallet(i);const s=new S([t]),n=await this.simulateAccount(r,s.str(0)),o=s.str(1);return await r.addSharedKey(n,o),!0}async removeShared(t,e,i){if(e||t.length<1)throw new v(y.MISC_ERROR,"key.shared.del [account] key: 删除共享公钥 [账号] 公钥");let r=await this.wallet(i);const s=new S([t]),n=await this.simulateAccount(r,s.str(0)),o=s.str(1);return await r.removeSharedKey(n,o),!0}async zap(t,e,i){if(e)throw new v(y.MISC_ERROR,"sys.zap [age]: 移除挂起交易 挂起时长(默认三天)");let s=await this.wallet(i);const n=new S([t]),o=n.str(0),a=n.u32(1,259200);return r(a,"Age is required."),await s.zap(o,a),!0}async sendFrom(t,e,i){if(e||t.length<3||t.length>6)throw new v(y.MISC_ERROR,'tx.sendfrom "fromaccount" "toaddress" amount ( minconf "comment" "comment-to" )');const r=await this.wallet(i),s=new S([t]);let n=await this.simulateAccount(r,s.str(0));const o=s.str(1),a=s.ufixed(2,8),h=s.u32(3,0),c=w.parseAddress(o,this.network);if(!c||null==a)throw new v(y.TYPE_ERROR,"Invalid parameter.");""===n&&(n="default");const u={account:n,depth:h,outputs:[{address:c,value:a}]};return(await r.send(u)).txid()}async sendMany(t,e,i){if(e||t.length<2||t.length>5)throw new v(y.MISC_ERROR,'tx.sendmany "fromaccount" {"address":amount,...} ( minconf "comment" ["address",...] )');const r=await this.wallet(i),s=new S([t]);let n=await this.simulateAccount(r,s.str(0));const o=s.obj(1),a=s.u32(2,1),h=s.bool(4,!1);if(""===n&&(n="default"),!o)throw new v(y.TYPE_ERROR,"Invalid parameter.");const c=new S([o]),u=new Set,l=[];for(const t of Object.keys(o)){const e=c.ufixed(t,8),i=w.parseAddress(t,this.network),r=i.getHash("hex");if(null==e)throw new v(y.INVALID_PARAMETER,"Invalid parameter.");if(u.has(r))throw new v(y.INVALID_PARAMETER,"Invalid parameter.");u.add(r);const s=new p;s.value=e,s.script.fromAddress(i),l.push(s)}const f={outputs:l,subtractFee:h,account:n,depth:a};return(await r.send(f)).txid()}async sendToAddress(t,e,i){if(e||t.length<2||t.length>4)throw new v(y.MISC_ERROR,'tx.sendto "address" amount ( "comment" "openid" )');let r=await this.wallet(i);const s=new S([t]),n=s.str(0),o=s.u64(1),a=s.obj(2,null),h=await this.simulateAccount(r,s.str(3)),c=w.parseAddress(n,this.network);if(!c||null==o)throw new v(y.TYPE_ERROR,"Invalid parameter.");const u={subtractFee:!1,sort:!1,outputs:[{address:c,value:o}],comment:a},l=await r.send(u,h);return(await r.getDetails(l.hash("hex"))).toJSON()}async sendTX(t,e,i){if(e||t.length<2)throw new v(y.MISC_ERROR,"tx.send addr amount [openid]");let r=await this.wallet(i);const s=new S([t]),n=s.str(0),o=s.u64(1),a=await this.simulateAccount(r,s.str(2)),h={outputs:[]};h.outputs.push({address:n,value:o});const c=await r.send(h,a);return(await r.getDetails(c.hash("hex"))).toJSON()}async signTX(t,e,i){if(e||t.length<1)throw new v(y.MISC_ERROR,"tx.sign txdata [sendnow passphrase]: 对交易签名/发送 交易原始数据 [立即发送 解锁密码]");let s=await this.wallet(i);const n=new S([t]),o=n.buf(0);r(o,"TX is required.");const a=n.bool(1,!1),h=n.str(2),c=f.fromRaw(o);c.view=await s.getCoinView(c),await s.sign(c,h);let u=null;if(u=a&&c.isSigned()?(await s.sendMTX(c)).getJSON(this.network):c.getJSON(this.network),s.account.type==A.types.MULTISIG){let t=c.getMultisig(this.network);u.ms={m:t.m,n:t.n,c:t.c}}return u}async createTX(t,e,i){let r=await this.wallet(i);const s=new S([t]),n=s.obj(0),o=s.array(1),a=await this.simulateAccount(r,s.str(2)),c=new S([n]),u={sendnow:c.bool("sendnow",!0),account:c.str("account"),rate:c.u64("rate"),blocks:c.u32("blocks"),maxFee:c.u64("maxFee"),selection:c.str("selection"),smart:c.bool("smart"),subtractFee:c.bool("subtractFee"),subtractIndex:c.get("subtractIndex"),depth:c.u32(["confirmations","depth"]),outputs:[]};for(const t of o){const e=new S([t]),i=e.buf("script");let r=null;i&&(r=h.fromRaw(i)),u.outputs.push({script:r,address:e.str("address"),value:e.u64("value")})}if(a&&(u.account=a),u.sendnow){const t=await r.send(u);return(await r.getDetails(t.hash("hex"))).toJSON()}{const t=await r.createTX(u);await r.sign(t);let e=t.getJSON(this.network);if(r.account.type==A.types.MULTISIG){let i=t.getMultisig(this.network);e.ms={m:i.m,n:i.n,c:i.c}}return e}}async getLast(t,e,i){if(e||t.length<1)throw new v(y.MISC_ERROR,"tx.last account [limit]: 最近的交易 账号 [最大记录数]");let r=await this.wallet(i);const s=new S([t]),n=await this.simulateAccount(r,s.str(0)),o=s.u32(1),a=[],h=await r.getLast(n,o),c=await r.toDetails(h);for(const t of c)a.push(t.toJSON());return a}async getRange(t,e,i){if(e||t.length<4)throw new v(y.MISC_ERROR,"tx.range account start end limit [reserve]: 指定时限内的交易 账号 开始时间 结束时间 最大记录数 [反转]");let r=await this.wallet(i);const s=new S([t]),n=await this.simulateAccount(r,s.str(0)),o={start:s.u32(1),end:s.u32(2),limit:s.u32(3),reverse:s.bool(4)},a=await r.getRange(n,o),h=await r.toDetails(a),c=[];for(const t of h)c.push(t.toJSON());return c}}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * ChainState.js - walletdb records
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(4),s=i(2),n=i(6);class o{constructor(){this.startHeight=-1,this.startHash=r.NULL_HASH,this.height=-1,this.marked=!1}clone(){const t=new o;return t.startHeight=this.startHeight,t.startHash=this.startHash,t.height=this.height,t.marked=this.marked,t}fromRaw(t){const e=new s(t);return this.startHeight=e.readU32(),this.startHash=e.readHash("hex"),this.height=e.readU32(),this.marked=!0,e.left()>0&&(this.marked=1===e.readU8()),this}static fromRaw(t){return(new o).fromRaw(t)}toRaw(){const t=new n(41);return t.writeU32(this.startHeight),t.writeHash(this.startHash),t.writeU32(this.height),t.writeU8(this.marked?1:0),t.render()}}t.exports=o},function(t,e,i){"use strict";
/*!
 * PathMapWids.js - walletdb records
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */const r=i(4),s=i(2),n=i(6),o=i(95);class a{constructor(t,e){this.hash=t||r.NULL_HASH,this.wids=e||new Set}add(t){return!this.wids.has(t)&&(this.wids.add(t),!0)}remove(t){return this.wids.delete(t)}toWriter(t){return o.serializeWallets(t,this.wids)}getSize(){return o.sizeWallets(this.wids)}toRaw(){const t=this.getSize();return this.toWriter(new n(t)).render()}fromReader(t){return this.wids=o.parseWallets(t),this}fromRaw(t){return this.fromReader(new s(t))}static fromReader(t,e){return new a(t).fromReader(e)}static fromRaw(t,e){return new a(t).fromRaw(e)}}t.exports=a},function(t,e,i){"use strict";(function(e){
/*!
 * WalletOptions.js
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(1),s=i(74),n=i(3),o=i(4),a=i(16),h=i(45),c=i(121).walletdb;class u{constructor(t){this.network=a.primary,this.logger=h.global,this.workers=null,this.client=null,this.feeRate=0,this.prefix=null,this.location=null,this.db="memory",this.maxFiles=64,this.cacheSize=16<<20,this.compression=!0,this.bufferKeys=c.binary,this.spv=!1,this.witness=!1,this.checkpoints=!1,this.startHeight=0,this.keepBlocks=this.network.block.keepBlocks,this.wipeNoReally=!1,this.apiKey=null,this.hmacSalt=null,this.devMode=!1,this.acl=null,this.ssl=!1,this.host="127.0.0.1",this.port=this.network.rpcPort+2,this.listen=!1,t&&this.fromOptions(t)}fromOptions(t){return null!=t.network&&(this.network=a.get(t.network),this.keepBlocks=this.network.block.keepBlocks,this.port=this.network.rpcPort+2),null!=t.logger&&(r("object"==typeof t.logger),this.logger=t.logger),null!=t.workers&&(r("object"==typeof t.workers),this.workers=t.workers),null!=t.client&&(r("object"==typeof t.client),this.client=t.client),null!=t.jsonp&&(r("object"==typeof t.jsonp),this.jsonp=t.jsonp),null!=t.feeRate&&(r(n.isU64(t.feeRate)),this.feeRate=t.feeRate),null!=t.prefix&&(r("string"==typeof t.prefix),this.prefix=t.prefix,this.location=s.join(this.prefix,"walletdb")),null!=t.location&&(r("string"==typeof t.location),this.location=t.location),null!=t.db&&(r("string"==typeof t.db),this.db=t.db),null!=t.maxFiles&&(r(n.isU32(t.maxFiles)),this.maxFiles=t.maxFiles),null!=t.cacheSize&&(r(n.isU64(t.cacheSize)),this.cacheSize=t.cacheSize),null!=t.compression&&(r("boolean"==typeof t.compression),this.compression=t.compression),null!=t.spv&&(r("boolean"==typeof t.spv),this.spv=t.spv),null!=t.checkpoints&&(r("boolean"==typeof t.checkpoints),this.checkpoints=t.checkpoints),null!=t.startHeight&&(r("number"==typeof t.startHeight),r(t.startHeight>=0),this.startHeight=t.startHeight),null!=t.wipeNoReally&&(r("boolean"==typeof t.wipeNoReally),this.wipeNoReally=t.wipeNoReally),null!=t.apiKey&&(r("string"==typeof t.apiKey),this.apiKey=t.apiKey),t.hmacSalt&&(r(e.isBuffer(t.hmacSalt)),this.hmacSalt=t.hmacSalt),this.hmacSalt=this.hmacSalt||o.DefaultChainCode,this.devMode=t.devMode,null!=t.acl&&(r("object"==typeof t.acl),this.acl=t.acl),this.acl=this.acl||{},null!=t.ssl&&(r("boolean"==typeof t.ssl),this.ssl=t.ssl),null!=t.host&&(r("string"==typeof t.host),this.host=t.host),null!=t.port&&(r("number"==typeof t.port),this.port=t.port),null!=t.listen&&(r("boolean"==typeof t.listen),this.listen=t.listen),this}static fromOptions(t){return(new u).fromOptions(t)}}t.exports=u}).call(this,i(0).Buffer)},function(t,e,i){"use strict";(function(e){
/*!
 * conn_s2remote.js - 基于 Web Socket 的客户端，为钱包系统提供主链交互功能
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 */
const r=i(415),s=i(16),n=i(59),o=i(17),a=i(187),h=i(69),c=i(3),u=i(2),{openapi:l}=i(362);function f(t,i){"string"==typeof t&&(t=e.from(t,"hex"));const r=h.fromHead(t),s=new u(t);s.seek(80);const n=s.readU32(),o=r.hash("hex");return new a(o,n,r.time)}function d(t,e){const i=f(t),r=[];for(const t of e){const e=p(t);r.push(e)}return new function(t,e){this.entry=t,this.txs=e}(i,r)}function p(t){return o.fromRaw(t,"hex")}function g(t,e,i){return async function(r,s){if(r)e(new Error(r.message));else if(s)if(i){try{s=await i(s)}catch(t){return void e(t)}t(s)}else t(s);else t(null)}}t.exports=class extends n{constructor(t){super(),t||(t={}),"string"==typeof t&&(t={uri:t}),this.options=t,this.network=s.get(t.network),this.uri=t.uri,this.apiKey=t.apiKey,this.mode=t.mode||"jsonp",this.socket=null}async _open(){this.uri&&(this.socket=new r(this.uri,{transports:["websocket"],forceNew:!0}),this.socket.on("error",t=>{this.emit("error",t)}),"relay"==this.mode&&(this.socket.on("version",t=>{t.network!==this.network.type&&this.emit("error",new Error("Wrong network."))}),this.socket.on("block.connect",(t,e)=>{let i;try{i=d(t,e)}catch(t){return void this.emit("error",t)}this.emit("block.connect",i.entry,i.txs)}),this.socket.on("block.disconnect",t=>{let e;try{e=f(t)}catch(t){return void this.emit("error",t)}this.emit("block.disconnect",e)}),this.socket.on("block.rescan",(t,e,i)=>{let r;try{r=d(t,e)}catch(t){return this.emit("error",t),void i()}this.fire("block.rescan",r.entry,r.txs).then(i,i)}),this.socket.on("chain.reset",t=>{let e;try{e=f(t)}catch(t){return void this.emit("error",t)}this.emit("chain.reset",e)}),this.socket.on("tx",t=>{try{t=p(t)}catch(t){return void this.emit("error",t)}this.emit("tx",t)})),await this.onConnect(),"relay"==this.mode&&(await this.watchChain(),await this.watchMempool()))}_close(){return this.socket?(this.socket.disconnect(),this.socket=null,Promise.resolve()):Promise.resolve()}onConnect(){return new Promise((t,e)=>{this.socket.once("connect",t)})}async removeTX(t){return Promise.resolve()}execute(t,e){e=e||[],Array.isArray(e)||(e=[e]);let i=l[t];return i?i.remoteCb?new Promise((t,r)=>{this.socket.emit(i.name,...e,g(t,r,i.remoteCb.bind({wdb:this.wdb})))}):new Promise((t,r)=>{this.socket.emit(i.name,...e,g(t,r))}):null}watchChain(){return new Promise((t,e)=>{this.socket.emit("request","chain.watch",g(t,e))})}watchMempool(){return new Promise((t,e)=>{this.socket.emit("request","mempool.watch",g(t,e))})}getTip(){return new Promise((t,e)=>{this.socket.emit("request","block.tip",g(t,e,f))})}getEntry(t){return new Promise((e,i)=>{"string"==typeof t&&(t=c.revHex(t)),this.socket.emit("request","block.entry",t,g(e,i,f))})}send(t){return new Promise((e,i)=>{this.socket.emit("request","tx.broadcast",t.toRaw(),g(e,i))})}setFilter(t){return new Promise((e,i)=>{this.socket.emit("request","filter.set",t.toRaw(),g(e,i))})}addFilter(t){return Array.isArray(t)||(t=[t]),new Promise((e,i)=>{this.socket.emit("request","filter.add",t,g(e,i))})}resetFilter(){return new Promise((t,e)=>{this.socket.emit("request","filter.reset",g(t,e))})}estimateFee(t){return new Promise((e,i)=>{this.socket.emit("request","estimate.fee",t,g(e,i))})}rescan(t){return new Promise((e,i)=>{"string"==typeof t&&(t=c.revHex(t)),this.socket.emit("request","chain.rescan",t,g(e,i))})}}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";t.exports=i(461)},function(t,e,i){const r=i(1),s=i(74),n=i(3),o=i(34),a=i(71),h=i(582);i(9),t.exports=class{constructor(t){this.network=t.network,this.logger=t.logger,this.location=s.resolve(t.prefix,"users.json"),this.locker=new o,this.lastFail=0,this.stream=null,this.map=new Map,this.size=0}async open(){const t=await this.locker.lock();try{return await this._open()}finally{t()}}async _open(){await this.load()}async close(){const t=await this.locker.lock();try{return await this._close()}finally{t()}}async _close(){if(this.stream){try{this.stream.close()}catch(t){}this.stream=null}}load(){return new Promise((t,e)=>{this._load(t,e)})}_load(t,e){let i="",r=0,s=a.createReadStream(this.location,{flags:"r",encoding:"utf8",autoClose:!0});const n=()=>{if(s){try{s.close()}catch(t){}s=null}};s.on("error",i=>{if(s){if("ENOENT"===i.code)return n(),void t();n(),e(i)}}),s.on("data",t=>{if(!s)return;if((i+=t).length>=1e4)return n(),void e(new Error(`UserDB parse error. Line: ${r}.`));const o=i.split(/\n+/);i=o.pop();for(const i of o){if(r+=1,0===i.length)continue;let s,o;try{s=JSON.parse(i),o=h.fromJSON(s)}catch(t){return n(),void e(new Error(`UserDB parse error. Line: ${r}.`))}this.map.has(o.username)||(this.size+=1),this.map.set(o.username,o)}}),s.on("end",()=>{s&&(this.logger.debug("Loaded %d users into memory.",this.size),s=null,t())})}get(t){return this.map.get(t)}has(t){return this.map.has(t)}add(t){const e=new h(t);r(!this.map.has(e.username),"User already exists."),this.logger.debug("Adding new user (%s).",e.username),this.map.set(e.username,e),this.size+=1,this.write(e.toJSON())}setPassword(t,e){const i=this.map.get(t);r(i,"User does not exist."),i.setPassword(e),this.write(i.toJSON())}write(t){const e=this.getStream();if(!e)return;const i=JSON.stringify(t)+"\n";e.write(i,"utf8")}getStream(){return this.stream?this.stream:this.lastFail>n.now()-10?null:(this.lastFail=0,this.stream=a.createWriteStream(this.location,{flags:"a"}),this.stream.on("error",t=>{this.logger.warning("UserDB file stream died!"),this.logger.error(t);try{this.stream.close()}catch(t){}this.stream=null,this.lastFail=n.now()}),this.stream)}}},function(t,e,i){(function(e){const r=i(1),s=i(9),n=i(4),{isUsername:o,isPassword:a,isHex:h}=i(125);t.exports=class{constructor(t){this.username="",this.password=n.ZERO_HASH,t&&this.fromOptions(t)}fromOptions(t){return r(t,"Options required."),r(o(t.username),"Username required."),r(t.hash||t.password,"Password required."),this.setUsername(t.username),null!=t.hash&&this.setHash(t.hash),null!=t.password&&this.setPassword(t.password),this}static fromOptions(t){return(new this).fromOptions(t)}setUsername(t){r(o(t),"Username must be a string."),this.username=t}setHash(t){"string"==typeof t?(r(h(t),"Hash must be a hex string."),r(64===t.length,"Hash must be 32 bytes."),this.password=e.from(t,"hex")):(r(e.isBuffer(t),"Hash must be a buffer."),r(32===t.length,"Hash must be 32 bytes."),this.password=t)}setPassword(t){r(a(t),"Password must be a string."),t=e.from(t,"utf8"),this.password=s.hash256(t)}toJSON(){return{username:this.username,password:this.password.toString("hex")}}fromJSON(t){return r(t),r("string"==typeof t.username),this.username=t.username,this.setHash(t.password),this}static fromJSON(t){return(new this).fromJSON(t)}}}).call(this,i(0).Buffer)},function(t,e,i){const r=i(1),{NONCE_SIZE:s,isJob:n,isUsername:o,isHex:a}=i(125);class h{constructor(){this.username="",this.job="",this.nonce2=0,this.ts=0,this.nonce=0}static fromPacket(t){const e=new h;return r(t.params.length>=5,"Invalid parameters."),r(o(t.params[0]),"Name must be a string."),r(n(t.params[1]),"Job ID must be a string."),r("string"==typeof t.params[2],"Nonce2 must be a string."),r(t.params[2].length===2*s,"Nonce2 must be a string."),r(a(t.params[2]),"Nonce2 must be a string."),r("string"==typeof t.params[3],"Time must be a string."),r(8===t.params[3].length,"Time must be a string."),r(a(t.params[3]),"Time must be a string."),r("string"==typeof t.params[4],"Nonce must be a string."),r(8===t.params[4].length,"Nonce must be a string."),r(a(t.params[4]),"Nonce must be a string."),e.username=t.params[0],e.job=t.params[1],e.nonce2=parseInt(t.params[2],16),e.ts=parseInt(t.params[3],16),e.nonce=parseInt(t.params[4],16),e}}t.exports=h},function(t,e){t.exports=class{constructor(t,e){this.code=t,this.reason=e}}},function(t,e,i){const r=i(1),s=i(4),{hex32:n}=i(125),o=i(92);t.exports=class{constructor(t){r("string"==typeof t),this.id=t,this.attempt=null,this.target=s.ZERO_HASH,this.difficulty=0,this.submissions={},this.committed=!1,this.prev=null,this.next=null}fromTemplate(t){return this.attempt=t,this.attempt.refresh(),this.target=t.target,this.difficulty=t.getDifficulty(),this}static fromTemplate(t,e){return new this(t).fromTemplate(e)}insert(t){return t=t.toString("hex"),!this.submissions[t]&&(this.submissions[t]=!0,!0)}check(t,e){const i=e.nonce2,r=e.ts,s=e.nonce;return this.attempt.getProof(t,i,r,s)}commit(t){return r(!this.committed,"Already committed."),this.committed=!0,this.attempt.commit(t)}toJSON(){return[this.id,o.swap32hex(this.attempt.prevBlock),this.attempt.left.toString("hex"),this.attempt.right.toString("hex"),this.attempt.tree.toJSON(),n(this.attempt.version),n(this.attempt.bits),n(this.attempt.time),!1]}}},function(t,e,i){const r=i(1),s=i(74),n=i(3),o=i(71);t.exports=class{constructor(t){this.network=t.network,this.logger=t.logger,this.location=s.resolve(t.prefix,"shares"),this.map=Object.create(null),this.total=0,this.size=0}async open(){await o.mkdirp(this.location)}async close(){}file(t){const e=t.height+"-"+t.rhash();return s.resolve(this.location,e+".json")}add(t,e){this.map[t]||(this.map[t]=0,this.size++),this.map[t]+=e,this.total+=e}clear(){this.map=Object.create(null),this.size=0,this.total=0}async commit(t,e){const i=e.txs[0],s=i.outputs[0].getAddress();r(s);const a={network:this.network.type,height:t.height,block:e.rhash(),ts:e.ts,time:n.now(),txid:i.txid(),address:s.toBase58(this.network),reward:i.getOutputValue(),size:this.size,total:this.total,shares:this.map};this.clear();const h=this.file(t),c=JSON.stringify(a,null,2);this.logger.info("Committing %d payouts to disk for block %d (file=%s).",a.size,t.height,h),await o.writeFile(h,c)}}},function(t,e,i){(function(e){const r=i(1),{StringDecoder:s}=i(90),n=i(24),{format:o}=i(66),a=i(34),h=i(48),c=i(588),{SHARES_PER_MINUTE:u,BAN_SCORE:l}=i(125);i(461),t.exports=class extends n{constructor(t,e){super(),this.locker=new a,this.stratum=t,this.logger=t.logger,this.socket=e,this.host=h.normalize(e.remoteAddress),this.port=e.remotePort,this.hostname=h.toHostname(this.host,this.port),this.decoder=new s("utf8"),this.agent="",this.recv="",this.admin=!1,this.users=new Set,this.sid=-1,this.difficulty=-1,this.nextDifficulty=-1,this.banScore=0,this.lastBan=0,this.drainSize=0,this.destroyed=!1,this.lastRetarget=-1,this.submissions=0,this.prev=null,this.next=null,this._init()}_init(){this.on("packet",async t=>{try{await this.readPacket(t)}catch(t){this.error(t)}}),this.socket.on("data",t=>{this.feed(t)}),this.socket.on("error",t=>{this.emit("error",t)}),this.socket.on("close",()=>{this.error("Socket hangup."),this.destroy()}),this.socket.on("drain",()=>{this.drainSize=0})}destroy(){this.destroyed||(this.destroyed=!0,this.locker.destroy(),this.socket.destroy(),this.socket=null,this.emit("close"))}send(t){this.destroyed||(t=JSON.stringify(t),t+="\n",this.write(t))}write(t){this.destroyed||!1===this.socket.write(t,"utf8")&&(this.drainSize+=e.byteLength(t,"utf8"),this.drainSize>5<<20&&(this.logger.warning("Client is not reading (%s).",this.id()),this.destroy()))}error(t){if(this.destroyed)return;if(t instanceof Error)return t.message+=` (${this.id()})`,void this.emit("error",t);let e=o.apply(null,arguments);e+=` (${this.id()})`,this.emit("error",new Error(e))}redirect(){const t=["HTTP/1.1 200 OK",`X-Stratum: stratum+tcp://${this.stratum.options.publicHost}:${this.stratum.options.publicPort}`,"Connection: Close","Content-Type: application/json; charset=utf-8","Content-Length: 38","","",'{"error":null,"result":false,"id":0}'];this.write(t.join("\r\n")),this.logger.debug("Redirecting client (%s).",this.id()),this.destroy()}feed(t){if(this.recv+=this.decoder.write(t),this.recv.length>=1e5)return this.error("Too much data buffered (%s).",this.id()),void this.destroy();if(/HTTP\/1\.1/i.test(this.recv))return void this.redirect();const e=this.recv.replace(/\r+/g,"").split(/\n+/);this.recv=e.pop();for(const i of e){if(0===i.length)continue;let e;try{e=c.fromRaw(i)}catch(t){this.error(t);continue}this.emit("packet",e)}}async readPacket(t){const e=await this.locker.lock();try{this.socket.pause(),await this.handlePacket(t)}finally{this.destroyed||this.socket.resume(),e()}}async handlePacket(t){return await this.stratum.handlePacket(this,t)}addUser(t){return!this.users.has(t)&&(this.users.add(t),!0)}hasUser(t){return this.users.has(t)}increaseBan(t){const e=Date.now();this.banScore*=Math.pow(1-1/6e4,e-this.lastBan),this.banScore+=t,this.lastBan=e,this.banScore>=l&&(this.logger.debug("Ban score exceeds threshold %d (%s).",this.banScore,this.id()),this.ban())}ban(){this.emit("ban")}sendError(t,e,i){this.logger.spam("Sending error %s (%s).",i,this.id()),this.send({id:t.id,result:null,error:[e,i,!1]})}sendResponse(t,e){this.logger.spam("Sending response %s (%s).",t.id,this.id()),this.send({method:t.method,id:t.id,result:e,error:null})}sendMethod(t,e){this.logger.spam("Sending method %s (%s).",t,this.id()),this.send({id:null,method:t,params:e})}sendDifficulty(t){r(t>0,"Difficulty must be at least 1."),this.logger.debug("Setting difficulty=%d for client (%s).",t,this.id()),this.sendMethod("mining.set_difficulty",[t])}setDifficulty(t){this.nextDifficulty=t}sendJob(t){this.logger.debug("Sending job %s to client (%s).",t.id,this.id()),-1!==this.nextDifficulty&&(this.submissions=0,this.lastRetarget=Date.now(),this.sendDifficulty(this.nextDifficulty),this.difficulty=this.nextDifficulty,this.nextDifficulty=-1),this.sendMethod("mining.notify",t.toJSON())}retarget(t){const e=Date.now(),i=u;if(r(this.difficulty>0),r(-1!==this.lastRetarget),this.submissions+=1,this.submissions%i==0){const r=this.submissions/i*6e4;let s=e-this.lastRetarget,n=4294967296/this.difficulty;return t>-1>>>0&&(t=-1>>>0),!(Math.abs(r-s)<=5e3||(s<r/4&&(s=r/4),s>4*r&&(s=4*r),n*=s,n=4294967296/(n/=r),n>>>=0,n=Math.min(t,n),n=Math.max(1,n),this.setDifficulty(n),0))}return!1}id(){let t=this.host;return this.agent&&(t+="/"+this.agent),t}}}).call(this,i(0).Buffer)},function(t,e,i){const r=i(1);class s{constructor(){this.id=null,this.method="unknown",this.params=[]}static fromRaw(t){const e=new s;try{const i=JSON.parse(t);null!=i.id&&(r("string"==typeof i.id||"number"==typeof i.id),e.id=i.id),r("string"==typeof i.method),r(i.method.length<=50),e.method=i.method,i.params&&(r(Array.isArray(i.params)),e.params=i.params)}catch(t){}return e}}t.exports=s},function(t,e,i){(function(e){const r=i(1),s=i(74),n=i(115),o=i(9),a=i(16),h=i(45),{isPassword:c}=i(125);t.exports=class{constructor(t){this.node=null,this.chain=null,this.logger=h.global,this.network=a.primary,this.host="0.0.0.0",this.port=3008,this.publicHost="127.0.0.1",this.publicPort=3008,this.maxInbound=50,this.difficulty=545259519,this.dynamic=!0,this.prefix=s.resolve(n.homedir(),".gamegold","stratum"),this.password=null,this.fromOptions(t)}fromOptions(t){return r(t,"Options are required."),r(t.node&&"object"==typeof t.node,"Node is required."),this.node=t.node,this.chain=this.node.chain,this.network=this.node.network,this.logger=this.node.logger,this.prefix=this.node.location("stratum"),null!=t.host&&(r("string"==typeof t.host),this.host=t.host),null!=t.port&&(r("number"==typeof t.port),this.port=t.port),null!=t.publicHost&&(r("string"==typeof t.publicHost),this.publicHost=t.publicHost),null!=t.publicPort&&(r("number"==typeof t.publicPort),this.publicPort=t.publicPort),null!=t.maxInbound&&(r("number"==typeof t.maxInbound),this.maxInbound=t.maxInbound),null!=t.difficulty&&(r("number"==typeof t.difficulty),this.difficulty=t.difficulty),null!=t.dynamic&&(r("boolean"==typeof t.dynamic),this.dynamic=t.dynamic),null!=t.password&&(r(c(t.password)),this.password=o.hash256(e.from(t.password,"utf8"))),this}static fromOptions(t){return(new this).fromOptions(t)}}}).call(this,i(0).Buffer)},function(t,e,i){"use strict";
/*!
 * workers/index.js - workers for gamegold
 * Copyright (c) 2018-2020, Bookman Software (MIT License).
 * https://gitee.com/bookmanSoftware/ggserver
 */e.Framer=i(119),e.jobs=i(72),e.packets=i(73),e.Parser=i(118),e.WorkerPool=i(116)}]);